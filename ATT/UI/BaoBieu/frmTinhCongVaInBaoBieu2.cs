using System;
using System.Collections.Generic;
using System.ComponentModel;
using System.Data;
using System.Drawing;
using System.Linq;
using System.Text;
using System.Threading.Tasks;
using System.Windows.Forms;
using System.Configuration;
using System.Globalization;
using System.Resources;
using System.Threading;
using Microsoft.Office.Interop.Excel;
using CHBK2014_N9.ATT.BLL.BaoBieuBLL;
using CHBK2014_N9.ATT.BLL.BaoBieuBLL.LuongBLL;
using CHBK2014_N9.ATT.BLL.ChamCongBLL;
using CHBK2014_N9.ATT.BLL.ChamCongBLL.CheDoBLL;
using CHBK2014_N9.ATT.BLL.MayChamCong.DuLieuTuMayChamCongBLL;
using CHBK2014_N9.ATT.BLL.QuanLyNhanVienBLL;
using CHBK2014_N9.ATT.BLL.QuanLyNhanVienBLL.SoDoQuanLyBLL;
using CHBK2014_N9.ATT.DAL.Common;
using CHBK2014_N9.ATT.DTO.BaoBieuDTO;
using CHBK2014_N9.ATT.DTO.BaoBieuDTO.LuongDTO;
using CHBK2014_N9.ATT.DTO.ChamCongDTO;
using CHBK2014_N9.ATT.DTO.ChamCongDTO.CheDoDTO;
using CHBK2014_N9.ATT.DTO.MayChamCong.DuLieuMayChamCongDTO;
using CHBK2014_N9.ATT.DTO.QuanLyNhanVienDTO;
using CHBK2014_N9.ATT.DTO.QuanLyNhanVienDTO.SoDoQuanLyDTO;
using CHBK2014_N9.ATT.UI.CommonGUI;

namespace CHBK2014_N9.ATT.UI.BaoBieu
{
    public partial class frmTinhCongVaInBaoBieu2 : Form
    {
        private byte[] imageData;

        private ConvertMoney _convertMoney = new ConvertMoney();

        private CongTyBLL _congTyBLL = new CongTyBLL();

        private CongTyDTO _congTyDTO = new CongTyDTO();

        private KhuVucDTO _khuVucDTO = new KhuVucDTO();

        private KhuVucBLL _khuVucBLL = new KhuVucBLL();

        private PhongBanDTO _phongBanDTO = new PhongBanDTO();

        private PhongBanBLL _phongBanBLL = new PhongBanBLL();

        private ChucVuDTO _chucVuDTO = new ChucVuDTO();

        private ChucVuBLL _chucVuBLL = new ChucVuBLL();

        private NhanVienBLL _nhanVienBLL = new NhanVienBLL();

        private NhanVienDTO _nhanVienDTO = new NhanVienDTO();

        private KyHieuChamCongDTO _kyHieuChamCongDTO = new KyHieuChamCongDTO();

        private KyHieuChamCongBLL _kyHieuChamCongBLL = new KyHieuChamCongBLL();

        private TuyChonDTO _tuyChonDTO = new TuyChonDTO();

        private TuyChonBLL _tuyChonBLL = new TuyChonBLL();

        private ChiTietTamUngLuongDTO _chiTietTamUngLuongDTO = new ChiTietTamUngLuongDTO();

        private ChiTietTamUngLuongBLL _chiTietTamUngLuongBLL = new ChiTietTamUngLuongBLL();

        private ChiTietPhuCapNhanVienBLL _chiTietPhuCapNhanVienBLL = new ChiTietPhuCapNhanVienBLL();

        private ChiTietPhuCapNhanVienDTO _chiTietPhuCapNhanVienDTO = new ChiTietPhuCapNhanVienDTO();

        private ViPhamDTO _viPhamDTO = new ViPhamDTO();

        private ViPhamBLL _viPhamBLL = new ViPhamBLL();

        private ThuongDTO _thuongDTO = new ThuongDTO();

        private ThuongBLL _thuongBLL = new ThuongBLL();

        private NgayLeDTO _ngayLeDTO = new NgayLeDTO();

        private NgayLeBLL _ngayLeBLL = new NgayLeBLL();

        private ChiTietDiCongTacDTO _chiTietDiCongTacDTO = new ChiTietDiCongTacDTO();

        private ChiTietDiCongTacBLL _chiTietDiCongTacBLL = new ChiTietDiCongTacBLL();

        private PhepNamDTO _phepNamDTO = new PhepNamDTO();

        private PhepNamBLL _phepNamBLL = new PhepNamBLL();

        private KhaiBaoVangChoNhanVienDTO _khaiBaoVangChoNhanVienDTO = new KhaiBaoVangChoNhanVienDTO();

        private KhaiBaoVangChoNhanVienBLL _khaiBaoVangChoNhanVienBLL = new KhaiBaoVangChoNhanVienBLL();

        private CacLoaiVangDTO _cacLoaiVangDTO = new CacLoaiVangDTO();

        private CacLoaiVangBLL _cacLoaiVangBLL = new CacLoaiVangBLL();

        private SapXepLichTrinhChoNhanVienDTO _sapXepLichTrinhChoNhanVienDTO = new SapXepLichTrinhChoNhanVienDTO();

        private SapXepLichTrinhChoNhanVienBLL _sapXepLichTrinhChoNhanVienBLL = new SapXepLichTrinhChoNhanVienBLL();

        private LichTrinhVaoRaDTO _lichTrinhVaoRaDTO = new LichTrinhVaoRaDTO();

        private LichTrinhVaoRaBLL _lichTrinhVaoRaBLL = new LichTrinhVaoRaBLL();

        private CheckInOutDTO _checkInOutDTO = new CheckInOutDTO();

        private CheckInOutBLL _checkInOutBLL = new CheckInOutBLL();

        private ChiTietLichTrinhChoCaLamViecBLL _chiTietLichTrinhChoCaLamViecBLL = new ChiTietLichTrinhChoCaLamViecBLL();

        private ChiTietLichTrinhChoCaLamViecDTO _chiTietLichTrinhChoCalamViecDTO = new ChiTietLichTrinhChoCaLamViecDTO();

        private CaLamViecBLL _caLamViecBLL = new CaLamViecBLL();

        private CaLamViecDTO _caLamViecDTO = new CaLamViecDTO();

        private PhanTheoGioBLL _phanTheoGioBLL = new PhanTheoGioBLL();

        private PhanTheoGioDTO _phanTheoGioDTO = new PhanTheoGioDTO();

        private NgayCuoiTuanBLL _ngayCuoiTuanBLL = new NgayCuoiTuanBLL();

        private NgayCuoiTuanDTO _ngayCuoiTuanDTO = new NgayCuoiTuanDTO();

    //    private Configuration _ngonNgu = ConfigurationManager.OpenExeConfiguration("MitaAttendance.exe");

        private int iNgonNgu = 0;

        private string sTenCongTyReport;

        private string sDiaChiCongTyReport;

        private NgayTinhCongBLL _ngayTinhCongBLL = new NgayTinhCongBLL();

        private NgayTinhCongDTO _ngayTinhCongDTO = new NgayTinhCongDTO();

        private string sTongNgayTinh;

        private string sMaChamCong;

        private string sMaNhanVien;

        private string sTenNhanVien;

        private string sGioVao;

        private string sGioRa;

        private string sMaKyHieu;

        private string sDungGio;

        private string sVang;

        private string sNgayVaoLamViec;

        private string sPhongBanTinhCong;

        private string sKHMaKyHieu;

        private string sKHDiTre;

        private string sKHVeSom;

        private string sKHDungGio;

        private string sKHTangCa;

        private string sKHThieuGioVao;

        private string sKHThieuGioRa;

        private string sKHVang;

        private string sKHChuaXepCa;

        private string sKHPhepNam;

        private string sKHLe;

        private string sKHCongTac;

        private string sKHVeTre;

        private string sKHCuoiTuan;

        private string sKiemTraMin;

        private string sKiemTraMax;

        private int iLuaChon = 0;

        private int demNhanVienVangTinhCong = 0;

        private int demNhanVienNghiLeTinhCong = 0;

        private string sID;

        private string sMaLichTrinhCalamViec;

        private string sThu;

        private string sCaThu1;

        private string sCaThu2;

        private string sCaThu3;

        private string sCaThu4;

        private string sCaThu5;

        private string sCaThu6;

        private string sCaThu7;

        private string sCaThu8;

        private string sCaThu9;

        private string sCaThu10;

        private string sFiloTenCaLamViec;

        private string sFiloMaCaLamViec;

        private string sTuDongQuaDemMaCaLamViec;

        private string sTuDongQuaDemTenCaLamViec;

        private string sChonTuMayMaCaLamViec;

        private string sChonTuMayTenCaLamViec;

        private string sTheoIDMayMaCaLamViec;

        private string sTheoIDMayTenCaLamViec;

        private string sTinhTheoGioTenCaLamViec;

        private string sTinhTheoGioMaCaLamViec;

        private string sPhanTheoGioTenCaLamViec;

        private string sPhanTheoGioMaCaLamViec;

        private double dTongTienPhuCap = 0;

        private double dTongTienPhuCapTienCom = 0;

        private double dTongTienPhuCapKhac = 0;

        private double dTongTienTamUng = 0;

        private double dTongTienViPham = 0;

        private double dTongTienThuong = 0;

        private int iDemCuoiTuan = 0;

        private TinhCongBLL _tinhCongBLL = new TinhCongBLL();

        private TinhCongDTO _tinhCongDTO = new TinhCongDTO();

        private TinhLuongDTO _tinhLuongDTO = new TinhLuongDTO();

        private TinhLuongBLL _tinhLuongBLL = new TinhLuongBLL();

        private ChiTietCongTruLuongDTO _chiTietCongTruLuongDTO = new ChiTietCongTruLuongDTO();

        private ChiTietCongTruLuongBLL _chiTietCongTruLuongBLL = new ChiTietCongTruLuongBLL();

        private string sLoadCaLamViec;

        private string sMaCaLamViec;

        private string sCaLamViec;

        private int iLamTronCong;

        private int iLamTronGio;

        private string sDinhDangThoiGian;

        private string sLuaChonKhaiBaoLuongBaoHiem;

        private double dTangCa1HeSo;

        private double dTangCa2HeSo;

        private double dTangCa3HeSo;

        private double dTangCa4HeSo;

        private double dSoTienKhaiBao;

        private double dTangCaChuNhatHeSo;

        private double dHeSoBaoHiemXaHoi;

        private double dHeSoBaoHiemYTe;

        private double dHeSoBaoHiemThatNghiep;

        private string sMaChamCongSuaXoaGioCham;

        private string sNgayChamSuaXoaGioCham;

        private string sGioChamSuaXoaGioCham;

        private string sKieuChamSuaXoaGioCham;

        private string sMaSoMaySuaXoaGioCham;

        private string sIDSuaXoaGioCham;

        private string _tenNode;

        private string sMaPhongBanTreeView;

        private string sMaCongTyTreeView;

        private string sMaKhuVucTreeView;

        private string sMaChucVuTreeView;

        private string sDanhSachNhanVienMoi;

        private string sNghiViecTamThoi;

        private int iChonLanXuat;

        private string sTuNgayChiTietThoiGianLamViec;

        private string sDenNgayChiTietThoiGianLamViec;


        public frmTinhCongVaInBaoBieu2()
        {
            InitializeComponent();
        }

        private void frmTinhCongVaInBaoBieu2_Load(object sender, EventArgs e)
        {
            
            this.xuatThuTuNgay();
            this.xuatThuDenNgay();
            this.loadTreeView();
           // this.panel6.Hide();
            this.DGVDanhSachNhanVien.Columns.Insert(0, new DataGridViewCheckBoxColumn());
            this.DGVDanhSachNhanVien.Columns[0].Width = 30;
            this.ngayTinhCong();
            this.loadControlTinhCong();
            this.loadControlTinhLuong();
            this.loadTuyChon();
          //  this.loadListViewBaoCao();
            this.loadThongTinCongTy();
        }

        private void loadThongTinCongTy()
        {
            System.Data.DataTable dtloadThongTinCongTy = new System.Data.DataTable();
            this._congTyDTO.MaCongTy = "CT00001";
            dtloadThongTinCongTy = this._congTyBLL.showLoadCongTy(this._congTyDTO);
            for (int iLoadThongTinCongTy = 0; iLoadThongTinCongTy < dtloadThongTinCongTy.Rows.Count; iLoadThongTinCongTy++)
            {
                this.sTenCongTyReport = dtloadThongTinCongTy.Rows[iLoadThongTinCongTy]["TenCongTy"].ToString();
                this.sDiaChiCongTyReport = dtloadThongTinCongTy.Rows[iLoadThongTinCongTy]["DiaChi"].ToString();
            }
            System.Data.DataTable dtKyHieu = new System.Data.DataTable();
            this._kyHieuChamCongDTO.MaKyHieu = "KH00001";
            dtKyHieu = this._kyHieuChamCongBLL.showLoadKyHieuChamCong(this._kyHieuChamCongDTO);
            for (int _kyHieu = 0; _kyHieu < dtKyHieu.Rows.Count; _kyHieu++)
            {
                this.sKHDiTre = dtKyHieu.Rows[_kyHieu]["DiTre"].ToString();
                this.sKHVeSom = dtKyHieu.Rows[_kyHieu]["VeSom"].ToString();
                this.sKHDungGio = dtKyHieu.Rows[_kyHieu]["DungGio"].ToString();
                this.sKHTangCa = dtKyHieu.Rows[_kyHieu]["TangCa"].ToString();
                this.sKHThieuGioVao = dtKyHieu.Rows[_kyHieu]["ThieuGioVao"].ToString();
                this.sKHThieuGioRa = dtKyHieu.Rows[_kyHieu]["ThieuGioRa"].ToString();
                this.sKHVang = dtKyHieu.Rows[_kyHieu]["Vang"].ToString();
                this.sKHChuaXepCa = dtKyHieu.Rows[_kyHieu]["ChuaXepCa"].ToString();
                this.sKHPhepNam = dtKyHieu.Rows[_kyHieu]["PhepNam"].ToString();
                this.sKHLe = dtKyHieu.Rows[_kyHieu]["Le"].ToString();
                this.sKHCongTac = dtKyHieu.Rows[_kyHieu]["CongTac"].ToString();
                this.sKHVeTre = dtKyHieu.Rows[_kyHieu]["VeTre"].ToString();
                this.sKHCuoiTuan = dtKyHieu.Rows[_kyHieu]["CuoiTuan"].ToString();
            }
        }
        private void loadControlTinhCong()
        {
            this.DGVTinhCong.Columns[7].DefaultCellStyle.Alignment = DataGridViewContentAlignment.MiddleRight;
            this.DGVTinhCong.Columns[8].DefaultCellStyle.Alignment = DataGridViewContentAlignment.MiddleRight;
            this.DGVTinhCong.Columns[9].DefaultCellStyle.Alignment = DataGridViewContentAlignment.MiddleRight;
            this.DGVTinhCong.Columns[10].DefaultCellStyle.Alignment = DataGridViewContentAlignment.MiddleRight;
            this.DGVTinhCong.Columns[11].DefaultCellStyle.Alignment = DataGridViewContentAlignment.MiddleRight;
            this.DGVTinhCong.Columns[12].DefaultCellStyle.Alignment = DataGridViewContentAlignment.MiddleRight;
            this.DGVTinhCong.Columns[13].DefaultCellStyle.Alignment = DataGridViewContentAlignment.MiddleRight;
            this.DGVTinhCong.Columns[14].DefaultCellStyle.Alignment = DataGridViewContentAlignment.MiddleRight;
            this.DGVTinhCong.Columns[15].DefaultCellStyle.Alignment = DataGridViewContentAlignment.MiddleRight;
            this.DGVTinhCong.Columns[16].DefaultCellStyle.Alignment = DataGridViewContentAlignment.MiddleRight;
            this.DGVTinhCong.Columns[17].DefaultCellStyle.Alignment = DataGridViewContentAlignment.MiddleRight;
            this.DGVTinhCong.Columns[18].DefaultCellStyle.Alignment = DataGridViewContentAlignment.MiddleRight;
        }

        private void loadControlTinhLuong()
        {
            this.DGVChiTietLuong.Columns[3].DefaultCellStyle.Alignment = DataGridViewContentAlignment.MiddleRight;
            this.DGVChiTietLuong.Columns[4].DefaultCellStyle.Alignment = DataGridViewContentAlignment.MiddleRight;
            this.DGVChiTietLuong.Columns[5].DefaultCellStyle.Alignment = DataGridViewContentAlignment.MiddleRight;
            this.DGVChiTietLuong.Columns[6].DefaultCellStyle.Alignment = DataGridViewContentAlignment.MiddleRight;
            this.DGVChiTietLuong.Columns[7].DefaultCellStyle.Alignment = DataGridViewContentAlignment.MiddleRight;
            this.DGVChiTietLuong.Columns[8].DefaultCellStyle.Alignment = DataGridViewContentAlignment.MiddleRight;
            this.DGVChiTietLuong.Columns[9].DefaultCellStyle.Alignment = DataGridViewContentAlignment.MiddleRight;
            this.DGVChiTietLuong.Columns[10].DefaultCellStyle.Alignment = DataGridViewContentAlignment.MiddleRight;
            this.DGVChiTietLuong.Columns[11].DefaultCellStyle.Alignment = DataGridViewContentAlignment.MiddleRight;
            this.DGVChiTietLuong.Columns[12].DefaultCellStyle.Alignment = DataGridViewContentAlignment.MiddleRight;
            this.DGVChiTietLuong.Columns[13].DefaultCellStyle.Alignment = DataGridViewContentAlignment.MiddleRight;
            this.DGVChiTietLuong.Columns[14].DefaultCellStyle.Alignment = DataGridViewContentAlignment.MiddleRight;
            this.DGVChiTietLuong.Columns[15].DefaultCellStyle.Alignment = DataGridViewContentAlignment.MiddleRight;
            this.DGVChiTietLuong.Columns[16].DefaultCellStyle.Alignment = DataGridViewContentAlignment.MiddleRight;
            this.DGVChiTietLuong.Columns[17].DefaultCellStyle.Alignment = DataGridViewContentAlignment.MiddleRight;
            this.DGVChiTietLuong.Columns[18].DefaultCellStyle.Alignment = DataGridViewContentAlignment.MiddleRight;
            this.DGVChiTietLuong.Columns[19].DefaultCellStyle.Alignment = DataGridViewContentAlignment.MiddleRight;
            this.DGVChiTietLuong.Columns[20].DefaultCellStyle.Alignment = DataGridViewContentAlignment.MiddleRight;
            this.DGVChiTietLuong.Columns[21].DefaultCellStyle.Alignment = DataGridViewContentAlignment.MiddleRight;
            this.checkBoxCoTinhLuong.Checked = false;
            this.txtNgayCongTinh.Enabled = false;
        }

        private void loadDangTinhCong()
        {
        }

        private void loadTreeView()
        {
            System.Data.DataTable dtCongTy = this._congTyBLL.showThongTinCongTy(this._congTyDTO);
            for (int i = 0; i < dtCongTy.Rows.Count; i++)
            {
                TreeNode treeCongTy = new TreeNode()
                {
                    Text = dtCongTy.Rows[i][1].ToString(),
                    Tag = dtCongTy.Rows[i][0].ToString()
                };
                this.treeViewSoDoQuanLy.Nodes.Add(treeCongTy);
                this._khuVucDTO.MaCongTy = dtCongTy.Rows[i]["MaCongTy"].ToString();
                System.Data.DataTable dtKhuVuc = this._khuVucBLL.GETKHUVUCTREEVIEW(this._khuVucDTO);
                for (int j = 0; j < dtKhuVuc.Rows.Count; j++)
                {
                    TreeNode treeKhuVuc = new TreeNode()
                    {
                        Text = dtKhuVuc.Rows[j][2].ToString(),
                        Tag = dtKhuVuc.Rows[j][0].ToString()
                    };
                    this.treeViewSoDoQuanLy.Nodes[i + 2].Nodes.Add(treeKhuVuc);
                    this._phongBanDTO.MaKhuVuc = dtKhuVuc.Rows[j]["MaKhuVuc"].ToString();
                    System.Data.DataTable dtPhongBan = this._phongBanBLL.GETPHONGBANTREEVIEW(this._phongBanDTO);
                    for (int z = 0; z < dtPhongBan.Rows.Count; z++)
                    {
                        TreeNode treePhongBan = new TreeNode()
                        {
                            Text = dtPhongBan.Rows[z][3].ToString(),
                            Tag = dtPhongBan.Rows[z][0].ToString()
                        };
                        this.treeViewSoDoQuanLy.Nodes[i + 2].Nodes[j].Nodes.Add(treePhongBan);
                        this._chucVuDTO.MaPhongBan = dtPhongBan.Rows[z]["MaPhongBan"].ToString();
                        System.Data.DataTable dtChucVu = this._chucVuBLL.GETCHUCVUTREEVIEW(this._chucVuDTO);
                        for (int v = 0; v < dtChucVu.Rows.Count; v++)
                        {
                            TreeNode treeChucVu = new TreeNode()
                            {
                                Text = dtChucVu.Rows[v][4].ToString(),
                                Tag = dtChucVu.Rows[v][0].ToString()
                            };
                            this.treeViewSoDoQuanLy.Nodes[i + 2].Nodes[j].Nodes[z].Nodes.Add(treeChucVu);
                            this._chucVuDTO.MaChucVu = dtChucVu.Rows[v]["MaChucVu"].ToString();
                        }
                    }
                }
            }
        }
        private void xuatThuDenNgay()
        {
            DateTime thuB;
            if (this.iNgonNgu == 0)
            {
                thuB = DateTime.Now;
                thuB = this.dateTimeDenNgay.Value;
                this.lbThuB.Text = DateTimeProgress.XuatThu((int)thuB.DayOfWeek);
                if (!(this.lbThuB.Text == "Chủ nhật"))
                {
                    this.lbThuB.ForeColor = Color.Blue;
                }
                else
                {
                    this.lbThuB.ForeColor = Color.Red;
                }
            }
            if (this.iNgonNgu == 1)
            {
                thuB = DateTime.Now;
                thuB = this.dateTimeDenNgay.Value;
                this.lbThuB.Text = DateTimeProgress.XuatThuEnglish((int)thuB.DayOfWeek);
                if (!(this.lbThuB.Text == "Sunday"))
                {
                    this.lbThuB.ForeColor = Color.Blue;
                }
                else
                {
                    this.lbThuB.ForeColor = Color.Red;
                }
            }
        }

        private void xuatThuTuNgay()
        {
            DateTime thuA;
            if (this.iNgonNgu == 0)
            {
                thuA = DateTime.Now;
                thuA = this.dateTimeTuNgay.Value;
                this.lbThuA.Text = DateTimeProgress.XuatThu((int)thuA.DayOfWeek);
                if (!(this.lbThuA.Text == "Chủ nhật"))
                {
                    this.lbThuA.ForeColor = Color.Blue;
                }
                else
                {
                    this.lbThuA.ForeColor = Color.Red;
                }
            }
            if (this.iNgonNgu == 1)
            {
                thuA = DateTime.Now;
                thuA = this.dateTimeTuNgay.Value;
                this.lbThuA.Text = DateTimeProgress.XuatThuEnglish((int)thuA.DayOfWeek);
                if (!(this.lbThuA.Text == "Sunday"))
                {
                    this.lbThuA.ForeColor = Color.Blue;
                }
                else
                {
                    this.lbThuA.ForeColor = Color.Red;
                }
            }
        }

        private void btnTestTongCong_Click(object sender, EventArgs e)
        {
            int iTest = 0;
            for (int iNhanVien = 0; iNhanVien < this.DGVDanhSachNhanVien.Rows.Count; iNhanVien++)
            {
                if (Convert.ToBoolean(this.DGVDanhSachNhanVien[0, iNhanVien].Value))
                {
                    string sMaNhanVien = this.DGVDanhSachNhanVien.Rows[iNhanVien].Cells[1].Value.ToString();
                    double iTongCong = 0;
                    int i = iTest;
                    while (i < this.DGVTinhCong.Rows.Count)
                    {
                        string sMaNhanVienTinhCong = this.DGVTinhCong.Rows[i].Cells[0].Value.ToString();
                        double iCongTungNgay = Convert.ToDouble(this.DGVTinhCong.Rows[i].Cells[7].Value.ToString());
                        iTongCong += iCongTungNgay;
                        if (!(sMaNhanVienTinhCong != sMaNhanVien))
                        {
                            iTest++;
                            i++;
                        }
                        else
                        {
                            break;
                        }
                    }
                    MessageBox.Show(string.Concat(sMaNhanVien, " :", iTongCong.ToString()));
                }
            }
        }

        private void loadCaLamViec()
        {
            System.Data.DataTable dtCaLamViec = new System.Data.DataTable();
            this._caLamViecDTO.MaCaLamViec = this.sLoadCaLamViec;
            dtCaLamViec = this._caLamViecBLL.CaLamViecGetByMaCaLamViec(this._caLamViecDTO);
            for (int iCaLamViec = 0; iCaLamViec < dtCaLamViec.Rows.Count; iCaLamViec++)
            {
                this.sMaCaLamViec = dtCaLamViec.Rows[iCaLamViec]["MaCaLamViec"].ToString();
                this.sCaLamViec = dtCaLamViec.Rows[iCaLamViec]["CaLamViec"].ToString();
            }
        }
        private void button8_Click(object sender, EventArgs e)
        {
            int dem;
            string sLTCCLVNhanVien;
            int kiemTraVao;
            int kiemTraRa;
            DateTime dt;
            string sNgayCham;
            string sThu;
            int iKiemTraLanChamLichTrinhVaoRa;
            int iKiemTraLanChamKhoangCachTuDongQuaDemLichTrinhVaoRa;
            DateTime dGioVaoTuDongQuaDemKiemTraLichTrinhVaoRa;
            DateTime dGioRaTuDongQuaDemKiemTraLichTrinhVaoRa;
            DateTime iKiemTraLanChamTuDongQuaDemLichTrinhVaoRa;
            int iLanCham;
            int addChonTuMay;
            int iKiemTra;
            int iKiemTraB;
            DateTime dGioVaoChonTuMay;
            DateTime dGioRaChonTuMay;
            DateTime dateGioChamChonTuMay;
            System.Data.DataTable dtChonTuMay;
            int iChonTuMay;
            int addGioNguonTuDongQuaDemQuaDem=0;
            int iLapLaiTuDongQuaDem;
            DateTime dGioNgayHomTruoc;
            System.Data.DataTable dtChonTuMayCa1;
            int iChonTuMayCa1;
            DateTime dBatDauVaoChonTuMayA;
            string sBatDauVaoChonTuMayA;
            string sBatDauVaoChonTuMayB;
            DateTime dBatDauVaoChonTuMayB;
            DateTime dKetThucVaoChonTuMayA;
            string sKetThucVaoChonTuMayA;
            string sKetThucVaoChonTuMayB;
            DateTime dKetThucVaoChonTuMayB;
            DateTime dBatDauRaChonTuMayA;
            string sBatDauRaChonTuMayA;
            string sBatDauRaChonTuMayB;
            DateTime dBatDauRaChonTuMayB;
            DateTime dKetThucRaChonTuMayA;
            string sKetThucRaChonTuMayA;
            string sKetThucRaChonTuMayB;
            DateTime dKetThucRaChonTuMayB;
            string sGiayGioVao;
            string sGiayGioRa;
            DateTime dGioVaoKhaiBaoChonTuMayA;
            string sGioVaoKhaiBaoChonTuMayA;
            string sGioVaoKhaiBaoChonTuMayB;
            DateTime dGioRaKhaiBaoChonTuMayA;
            string sGioRaKhaiBaoChonTuMayA;
            string sGioRaKhaiBaoChonTuMayB;
            string sCatChuoi;
            string sTruGioDiTre;
            string sBatDauTinhDiTre;
            int iPhutTreChonTuMay;
            string sTruGioVeSom;
            string sBatDauTinhVeSom;
            int iPhutVeSomChonTuMay;
            int iPhutVeTre;
            double dSoPhutLamDuocTrongCa;
            string sChoPhepTangCaTruocGioLamViecChonTuMay;
            int iPhutTangCaTruocGioLamViecChonTuMay;
            int iPhutTangCaTruocGioLamViecDatDen;
            int iPhutTruTangCaTruoc;
            string sChoPhepTangCaSauGioLamViecChonTuMay;
            int iPhutTangCaSauGioLamViecChonTuMay;
            int iPhutTangCaSauGioLamViecDatDen;
            int iPhutTruTangCaSau;
            int iGioiHanTC1ChonTuMay;
            int iGioiHanTC2ChonTuMay;
            int iGioiHanTC3ChonTuMay;
            int iGioiHanTC4ChonTuMay;
            int iTongGioTangCaSauChonTuMay;
            int iTongGioTangCaTruocChonTuMay;
            int iThoiGianTruocGioLamChonTuMay;
            int iThoiGianSauGioLamViecChonTuMay;
            double dTongThoiGianTangCaChonTuMay;
            System.Data.DataTable dtNhanCaChonTuMay;
            int iChiTietLichTrinhChoCaLamViecChonTuMay;
            int cellChiTietLichTrinhChoCaLamViecChonTuMay;
            System.Data.DataTable dtCaLamViecChonTuMay;
            int iCaLamViecChonTuMay;
            DateTime dGioVaoKhaiBaoChonTuMayB;
            DateTime dGioRaKhaiBaoChonTuMayB;
            int iChoPhepDiTre;
            string sPhutTre;
            int iPhutTre;
            int iChoPhepVeSom;
            string sPhutVeSom;
            int iPhutVeSom;
            string sVeTre;
            float iPhut;
            double dGio;
            double iGio;
            double dCongTinh;
            double dCong;
            string sTangCaTruocGioLamViec;
            string sTangCaSauGioLamViec;
            string sXemCaNayLaTangCa;
            int iTangCaMuc;
            string sTongGio;
            int iKiemTraLanChamTuDongKhongQuaDemLichTrinhVaoRa;
            int iKiemTraLanChamKhoangCachTuDongKhongQuaDemLichTrinhVaoRa;
            int iKiemTraLanCham;
            DateTime dGioVaoTuDongKhongQuaDemLichTrinhVaoRa;
            DateTime dGioRaTuDongKhongQuaDemLichTrinhVaoRa;
            System.Data.DataTable dtTuDong;
            int iTuDong = 0;
            int addGioNguonTuDongKhongQuaDem = 0;
            int iLapLaiTuDongKhongQuaDem;
            System.Data.DataTable dtNhanCaTuDongKhongQuaDem;
            int iChiTietLichTrinhChoCaLamViecTuDongKhongQuaDem;
            int cellChiTietLichTrinhChoCaLamViecTuDongKhongQuaDem;
            System.Data.DataTable dtTuDongQuaDemCa;
            int iTuDongQuaDemCa;
            DateTime dBatDauVaoA;
            string sBatDauVaoA;
            string sBatDauVaoB;
            DateTime dBatDauVaoB;
            DateTime dKetThucVaoA;
            string sKetThucVaoA;
            string sKetThucVaoB;
            DateTime dKetThucVaoB;
            DateTime dBatDauRaA;
            string sBatDauRaA;
            string sBatDauRaB;
            DateTime dBatDauRaB;
            DateTime dKetThucRaA;
            string sKetThucRaA;
            string sKetThucRaB;
            DateTime dKetThucRaB;
            int addTuDongKhongQuaDemThoiGianLonNhat;
            System.Data.DataTable dtCaLamViecTuDongKhongQuaDem;
            int iCaLamViecTuDongKhongQuaDem;
            DateTime dGioVaoKhaiBaoTuDongKhongQuaDemA;
            string sGioVaoKhaiBaoTuDongKhongQuaDemA;
            string sGioVaoKhaiBaoTuDongKhongQuaDemB;
            DateTime dGioVaoKhaiBaoTuDongKhongQuaDemB;
            DateTime dGioRaKhaiBaoTuDongKhongQuaDemA;
            string sGioRaKhaiBaoTuDongKhongQuaDemA;
            string sGioRaKhaiBaoTuDongKhongQuaDemB;
            DateTime dGioRaKhaiBaoTuDongKhongQuaDemB;
            string sXemChuNhatLaTangCa;
            int iTangCaChuNhatMuc;
            double dTongPhutTangCaTuDongKhongQuaDem;
            double dTongGioTangCaTuDongKhongQuaDem;
            double dTongPhutTangCaTuDongKhongQuaDemA;
            double dTongGioTangCaTuDongKhongQuaDemA;
            double dTongGioThucTeTuDongKhongQuaDem;
            string sChoPhepTangCaTruocGioLamViecTuDongKhongQuaDem;
            int iPhutTangCaTruocGioLamViecTuDongKhongQuaDem;
            string sChoPhepTangCaSauGioLamViecTuDongKhongQuaDem;
            int iPhutTangCaSauGioLamViecTuDongKhongQuaDem;
            int iGioiHanTC1TuDongKhongQuaDem;
            int iGioiHanTC2TuDongKhongQuaDem;
            int iGioiHanTC3TuDongKhongQuaDem;
            int iGioiHanTC4TuDongKhongQuaDem;
            int iTongGioTangCaSauTuDongKhongQuaDem;
            int iTongGioTangCaTruocTuDongKhongQuaDem;
            int iThoiGianTruocGioLamTuDongKhongQuaDem;
            int iThoiGianSauGioLamViecTuDongKhongQuaDem;
            double dTongThoiGianTangCaTuDongKhongQuaDem;
            System.Data.DataTable dtPhanTheoGio;
            int iPhanTheoGio =0;
            int iCaTrongLIchtrinh;
            System.Data.DataTable dtNhanCaPhanTheoGio;
            int iChiTietLichTrinhChoCaLamViecPhanTheoGio;
            int cellChiTietLichTrinhChoCaLamViecPhanTheoGio;
            System.Data.DataTable dtPhanTheoGioCa1;
            int iPhanTheoGioCa1;
            DateTime dBatDauVaoPhanTheoGioA;
            string sBatDauVaoPhanTheoGioA;
            string sBatDauVaoPhanTheoGioB;
            DateTime dBatDauVaoPhanTheoGioB;
            DateTime dKetThucVaoPhanTheoGioA;
            string sKetThucVaoPhanTheoGioA;
            string sKetThucVaoPhanTheoGioB;
            DateTime dKetThucVaoPhanTheoGioB;
            DateTime dBatDauRaPhanTheoGioA;
            string sBatDauRaPhanTheoGioA;
            string sBatDauRaPhanTheoGioB;
            DateTime dBatDauRaPhanTheoGioB;
            DateTime dKetThucRaPhanTheoGioA;
            string sKetThucRaPhanTheoGioA;
            string sKetThucRaPhanTheoGioB;
            DateTime dKetThucRaPhanTheoGioB;
            System.Data.DataTable dtCaLamViecPhanTheoGio;
            int iCaLamViecPhanTheoGio;
            DateTime dGioVaoKhaiBaoPhanTheoGioA;
            string sGioVaoKhaiBaoPhanTheoGioA;
            string sGioVaoKhaiBaoPhanTheoGioB;
            DateTime dGioVaoKhaiBaoPhanTheoGioB;
            DateTime dGioRaKhaiBaoPhanTheoGioA;
            string sGioRaKhaiBaoPhanTheoGioA;
            string sGioRaKhaiBaoPhanTheoGioB;
            DateTime dGioRaKhaiBaoPhanTheoGioB;
            double dTongPhutTangCaPhanTheoGio;
            double dTongGioTangCaPhanTheoGio;
            double dTongPhutTangCaPhanTheoGioA;
            double dTongGioTangCaPhanTheoGioA;
            string sChoPhepTangCaTruocGioLamViecPhanTheoGio;
            int iPhutTangCaTruocGioLamViecPhanTheoGio;
            string sChoPhepTangCaSauGioLamViecPhanTheoGio;
            int iPhutTangCaSauGioLamViecPhanTheoGio;
            int iGioiHanTC1PhanTheoGio;
            int iGioiHanTC2PhanTheoGio;
            int iGioiHanTC3PhanTheoGio;
            int iGioiHanTC4PhanTheoGio;
            int iTongGioTangCaSauPhanTheoGio;
            int iTongGioTangCaTruocPhanTheoGio;
            int iThoiGianTruocGioLamPhanTheoGio;
            int iThoiGianSauGioLamViecPhanTheoGio;
            double dTongThoiGianTangCaPhanTheoGio;
            int addTheoIDMay=0;
            DateTime dGioVaoTheoIDMay;
            DateTime dGioRaTheoIDMay;
            DateTime dateGioChamTheoIDMay;
            System.Data.DataTable dtTheoIDMay;
            int iTheoIDMay=0;
            System.Data.DataTable dtTheoIDMayCa1;
            int iTheoIDMayCa1;
            DateTime dBatDauVaoTheoIDMayA;
            string sBatDauVaoTheoIDMayA;
            string sBatDauVaoTheoIDMayB;
            DateTime dBatDauVaoTheoIDMayB;
            DateTime dKetThucVaoTheoIDMayA;
            string sKetThucVaoTheoIDMayA;
            string sKetThucVaoTheoIDMayB;
            DateTime dKetThucVaoTheoIDMayB;
            DateTime dBatDauRaTheoIDMayA;
            string sBatDauRaTheoIDMayA;
            string sBatDauRaTheoIDMayB;
            DateTime dBatDauRaTheoIDMayB;
            DateTime dKetThucRaTheoIDMayA;
            string sKetThucRaTheoIDMayA;
            string sKetThucRaTheoIDMayB;
            DateTime dKetThucRaTheoIDMayB;
            DateTime dGioVaoKhaiBaoTheoIDMayA;
            string sGioVaoKhaiBaoTheoIDMayA;
            string sGioVaoKhaiBaoTheoIDMayB;
            DateTime dGioRaKhaiBaoTheoIDMayA;
            string sGioRaKhaiBaoTheoIDMayA;
            string sGioRaKhaiBaoTheoIDMayB;
            int iPhutTreTheoIDMay;
            int iPhutVeSomTheoIDMay;
            string sChoPhepTangCaTruocGioLamViecTheoIDMay;
            int iPhutTangCaTruocGioLamViecTheoIDMay;
            string sChoPhepTangCaSauGioLamViecTheoIDMay;
            int iPhutTangCaSauGioLamViecTheoIDMay;
            int iGioiHanTC1TheoIDMay;
            int iGioiHanTC2TheoIDMay;
            int iGioiHanTC3TheoIDMay;
            int iGioiHanTC4TheoIDMay;
            int iTongGioTangCaSauTheoIDMay;
            int iTongGioTangCaTruocTheoIDMay;
            int iThoiGianTruocGioLamTheoIDMay;
            int iThoiGianSauGioLamViecTheoIDMay;
            double dTongThoiGianTangCaTheoIDMay;
            System.Data.DataTable dtNhanCaTheoIDMay;
            int iChiTietLichTrinhChoCaLamViecTheoIDMay;
            int cellChiTietLichTrinhChoCaLamViecTheoIDMay;
            System.Data.DataTable dtCaLamViecTheoIDMay;
            int iCaLamViecTheoIDMay;
            DateTime dGioVaoKhaiBaoTheoIDMayB;
            DateTime dGioRaKhaiBaoTheoIDMayB;
            System.Data.DataTable dtNhanCaFilo;
            int iChiTietLichTrinhChoCaLamViecFilo;
            int cellChiTietLichTrinhChoCaLamViecFilo;
            System.Data.DataTable dtFiloCa1;
            int iFiloCa1;
            DateTime dBatDauVaoFiloA;
            string sBatDauVaoFiloA;
            string sBatDauVaoFiloB;
            DateTime dBatDauVaoFiloB;
            DateTime dKetThucVaoFiloA;
            string sKetThucVaoFiloA;
            string sKetThucVaoFiloB;
            DateTime dKetThucVaoFiloB;
            DateTime dBatDauRaFiloA;
            string sBatDauRaFiloA;
            string sBatDauRaFiloB;
            DateTime dBatDauRaFiloB;
            DateTime dKetThucRaFiloA;
            string sKetThucRaFiloA;
            string sKetThucRaFiloB;
            DateTime dKetThucRaFiloB;
            DateTime dGioVaoKhaiBaoFiLoA;
            string sGioVaoKhaiBaoFiloA;
            string sGioVaoKhaiBaoFiloB;
            DateTime dGioVaoKhaiBaoFiloB;
            string sChoPhepTangCaTruocGioLamViecFiLo;
            int iPhutTangCaTruocGioLamViecFiLo;
            string sChoPhepTangCaSauGioLamViecFiLo;
            int iPhutTangCaSauGioLamViecFiLo;
            int iGioiHanTC1FiLo;
            int iGioiHanTC2FiLo;
            int iGioiHanTC3FiLo;
            int iGioiHanTC4FiLo;
            int iTongGioTangCaSauFiLo;
            int iTongGioTangCaTruocFiLo;
            int iThoiGianTruocGioLamFiLo;
            int iThoiGianSauGioLamViecFiLo;
            double dTongThoiGianTangCaFiLo;
            int iKiemTraLanChamTinhTheoGioLichTrinhVaoRa;
            DateTime dGioRaTinhTheoGioLichTrinhVaoRa;
            DateTime dGioVaoTinhTheoGioLichTrinhVaoRa;
            System.Data.DataTable dtTinhTheoGio;
            int iTinhTheoGio =0;
            int addGioNguonTinhTheoGio = 0;
            int iLapLaiTinhTheoGio;
            int addTinhTheoGioThoiGianLonNhat;
            System.Data.DataTable dtNhanCaTinhTheoGio;
            int iChiTietLichTrinhChoCaLamViecTinhTheoGio;
            int cellChiTietLichTrinhChoCaLamViecTinhTheoGio;
            System.Data.DataTable dtTinhTheoGioCa1;
            int iTinhTheoGioCa1;
            DateTime dBatDauVaoTinhTheoGioA;
            string sBatDauVaoTinhTheoGioA;
            string sBatDauVaoTinhTheoGioB;
            DateTime dBatDauVaoTinhTheoGioB;
            DateTime dKetThucVaoTinhTheoGioA;
            string sKetThucVaoTinhTheoGioA;
            string sKetThucVaoTinhTheoGioB;
            DateTime dKetThucVaoTinhTheoGioB;
            DateTime dBatDauRaTinhTheoGioA;
            string sBatDauRaTinhTheoGioA;
            string sBatDauRaTinhTheoGioB;
            DateTime dBatDauRaTinhTheoGioB;
            DateTime dKetThucRaTinhTheoGioA;
            string sKetThucRaTinhTheoGioA;
            string sKetThucRaTinhTheoGioB;
            DateTime dKetThucRaTinhTheoGioB;
            System.Data.DataTable dtCaLamViecTinhTheoGio;
            int iCaLamViecTinhTheoGio;
            DateTime dGioVaoKhaiBaoTinhTheoGioA;
            string sGioVaoKhaiBaoTinhTheoGioA;
            string sGioVaoKhaiBaoTinhTheoGioB;
            DateTime dGioVaoKhaiBaoTinhTheoGioB;
            DateTime dGioRaKhaiBaoTinhTheoGioA;
            string sGioRaKhaiBaoTinhTheoGioA;
            string sGioRaKhaiBaoTinhTheoGioB;
            DateTime dGioRaKhaiBaoTinhTheoGioB;
            string sChoPhepTangCaTruocGioLamViecTinhTheoGio;
            int iPhutTangCaTruocGioLamViecTinhTheoGio;
            string sChoPhepTangCaSauGioLamViecTinhTheoGio;
            int iPhutTangCaSauGioLamViecTinhTheoGio;
            int iGioiHanTC1TinhTheoGio;
            int iGioiHanTC2TinhTheoGio;
            int iGioiHanTC3TinhTheoGio;
            int iGioiHanTC4TinhTheoGio;
            int iTongGioTangCaSauTinhTheoGio;
            int iTongGioTangCaTruocTinhTheoGio;
            int iThoiGianTruocGioLamTinhTheoGio;
            int iThoiGianSauGioLamViecTinhTheoGio;
            double dTongThoiGianTangCaTinhTheoGio;
            System.Data.DataTable dtTuDongQuaDem;
            int iTuDongQuaDem = 0;
            System.Data.DataTable dtNhanCaTuDongQuaDem;
            int iChiTietLichTrinhChoCaLamViecTuDongQuaDem;
            int cellChiTietLichTrinhChoCaLamViecTuDongQuaDem;
            System.Data.DataTable dtCaLamViecTuDongQuaDem;
            int iCaLamViecTuDongQuaDem;
            DateTime dGioVaoKhaiBaoTuDongQuaDemA;
            string sGioVaoKhaiBaoTuDongQuaDemA;
            string sGioVaoKhaiBaoTuDongQuaDemB;
            DateTime dGioVaoKhaiBaoTuDongQuaDemB;
            DateTime dGioRaKhaiBaoTuDongQuaDemA;
            string sGioRaKhaiBaoTuDongQuaDemA;
            string sGioRaKhaiBaoTuDongQuaDemB;
            DateTime dGioRaKhaiBaoTuDongQuaDemB;
            double dTongGioThucTeTuDongQuaDem;
            string sChoPhepTangCaTruocGioLamViecTuDongQuaDem;
            int iPhutTangCaTruocGioLamViecTuDongQuaDem;
            string sChoPhepTangCaSauGioLamViecTuDongQuaDem;
            int iPhutTangCaSauGioLamViecTuDongQuaDem;
            int iGioiHanTC1TuDongQuaDem;
            int iGioiHanTC2TuDongQuaDem;
            int iGioiHanTC3TuDongQuaDem;
            int iGioiHanTC4TuDongQuaDem;
            int iTongGioTangCaSauTuDongQuaDem;
            int iTongGioTangCaTruocTuDongQuaDem;
            int iThoiGianTruocGioLamTuDongQuaDem;
            int iThoiGianSauGioLamViecTuDongQuaDem;
            double dTongThoiGianTangCaTuDongQuaDem;
            DateTime dGioRaNgayTruocTuDongQuaDem;
            System.Data.DataTable dtTuDongQuaDemCa1;
            int iTuDongQuaDemCa1;
            DateTime dBatDauVaoTuDongQuaDemA;
            string sBatDauVaoTuDongQuaDemA;
            string sBatDauVaoTuDongQuaDemB;
            DateTime dBatDauVaoTuDongQuaDemB;
            DateTime dKetThucVaoTuDongQuaDemA;
            string sKetThucVaoTuDongQuaDemA;
            string sKetThucVaoTuDongQuaDemB;
            DateTime dKetThucVaoTuDongQuaDemB;
            DateTime dBatDauRaTuDongQuaDemA;
            string sBatDauRaTuDongQuaDemA;
            string sBatDauRaTuDongQuaDemB;
            DateTime dBatDauRaTuDongQuaDemB;
            DateTime dKetThucRaTuDongQuaDemA;
            string sKetThucRaTuDongQuaDemA;
            string sKetThucRaTuDongQuaDemB;
            DateTime dKetThucRaTuDongQuaDemB;
            System.Data.DataTable dtThongSoCaLamViecTuDongQuaDem;
            int iThongSoCaLamViecTuDongQuaDem;
            int iTongPhutTuDongQuaDem;
            double dTongGioTuDongQuaDem;
            int iChoPhepTreTuDongQuaDem;
            int iPhutTreTuDongQuaDem;
            int iChoPhepVeSomTuDongQuaDem;
            int iPhutVeSomTuDongQuaDem;
            double dTongGioTrongCaTuDongQuaDem;
            double dTongCongTrongCaTuDongQuaDem;
            double dTongPhutTreSomTuDongQuaDem;
            double fCongTinh;
            double fGio;
            string sMaCacLoaiVang;
            System.Data.DataTable dtCacLoaiVang;
            int iCacLoaiVang;
            DateTime dateTime;
            double num;
         //  this.tabControl2.SelectedTabIndex = 0;
            this._tinhCongBLL.TinhCongDelete(this._tinhCongDTO);
            this._tinhLuongBLL.TinhLuongDelete(this._tinhLuongDTO);
            this._chiTietCongTruLuongBLL.ChiTietCongTruLuongDelete(this._chiTietCongTruLuongDTO);
            int TestDemNhanVien = 0;
            for (int iTestDemNhanVien = 0; iTestDemNhanVien < this.DGVDanhSachNhanVien.Rows.Count; iTestDemNhanVien++)
            {
                if (Convert.ToBoolean(this.DGVDanhSachNhanVien[0, iTestDemNhanVien].Value))
                {
                    TestDemNhanVien++;
                }
            }
            this.loadTuyChon();
            System.Data.DataTable dtKyHieu = new System.Data.DataTable();
            this._kyHieuChamCongDTO.MaKyHieu = "KH00001";
            dtKyHieu = this._kyHieuChamCongBLL.showLoadKyHieuChamCong(this._kyHieuChamCongDTO);
            for (int _kyHieu = 0; _kyHieu < dtKyHieu.Rows.Count; _kyHieu++)
            {
                this.sKHDiTre = dtKyHieu.Rows[_kyHieu]["DiTre"].ToString();
                this.sKHVeSom = dtKyHieu.Rows[_kyHieu]["VeSom"].ToString();
                this.sKHDungGio = dtKyHieu.Rows[_kyHieu]["DungGio"].ToString();
                this.sKHTangCa = dtKyHieu.Rows[_kyHieu]["TangCa"].ToString();
                this.sKHThieuGioVao = dtKyHieu.Rows[_kyHieu]["ThieuGioVao"].ToString();
                this.sKHThieuGioRa = dtKyHieu.Rows[_kyHieu]["ThieuGioRa"].ToString();
                this.sKHVang = dtKyHieu.Rows[_kyHieu]["Vang"].ToString();
                this.sKHChuaXepCa = dtKyHieu.Rows[_kyHieu]["ChuaXepCa"].ToString();
                this.sKHPhepNam = dtKyHieu.Rows[_kyHieu]["PhepNam"].ToString();
                this.sKHLe = dtKyHieu.Rows[_kyHieu]["Le"].ToString();
                this.sKHCongTac = dtKyHieu.Rows[_kyHieu]["CongTac"].ToString();
                this.sKHVeTre = dtKyHieu.Rows[_kyHieu]["VeTre"].ToString();
                this.sKHCuoiTuan = dtKyHieu.Rows[_kyHieu]["CuoiTuan"].ToString();
            }
            System.Data.DataTable _dtNgayTinhCong = new System.Data.DataTable();
            _dtNgayTinhCong = this._ngayTinhCongBLL.showThongTinNgayTinhCong(this._ngayTinhCongDTO);
            if (_dtNgayTinhCong.Rows.Count == 0)
            {
                this._ngayTinhCongDTO.ID = 1;
                this._ngayTinhCongDTO.NgayBatDau = Convert.ToDateTime(this.dateTimeTuNgay.Text);
                this._ngayTinhCongDTO.NgayKetThuc = Convert.ToDateTime(this.dateTimeDenNgay.Text);
                this._ngayTinhCongBLL.Insert_NgayTinhCong(this._ngayTinhCongDTO);
            }
            if (_dtNgayTinhCong.Rows.Count == 1)
            {
                this._ngayTinhCongDTO.ID = 1;
                this._ngayTinhCongDTO.NgayBatDau = Convert.ToDateTime(this.dateTimeTuNgay.Text);
                this._ngayTinhCongDTO.NgayKetThuc = Convert.ToDateTime(this.dateTimeDenNgay.Text);
                this._ngayTinhCongBLL.Update_NgayTinhCong(this._ngayTinhCongDTO);
            }
            this.DGVChiTietLuong.Rows.Clear();
            this.DGVTinhCong.Rows.Clear();
            this.DGVDuLieuChamCongNguon.Rows.Clear();
            this.DGVSuaXoaGioCham.Rows.Clear();
            TimeSpan value = this.dateTimeDenNgay.Value - this.dateTimeTuNgay.Value;
            int second = Convert.ToInt32(value.TotalDays);
            this.sTongNgayTinh = second.ToString();
            if (Convert.ToInt32(this.sTongNgayTinh) >= 0)
            {
                frmLoadTinhCong _loadTinhCong = new frmLoadTinhCong();
                _loadTinhCong.Show();
                int demNhanVienDuocChon = 0;
                int demProcess = -1;
                int testProcess = TestDemNhanVien;
                for (int abc = 0; abc < this.DGVDanhSachNhanVien.Rows.Count; abc++)
                {
                    this.iDemCuoiTuan = 0;
                    dem = 0;
                    string sLTVRNhanVien = "";
                    sLTCCLVNhanVien = "";
                    int iChonLichTrinh = 0;
                    int iThoiGianNhoNhat = 0;
                    int iThoiGianLonNhat = 0;
                    int iKhoangCachGiuaHaiCapVaoRa = 0;
                    if (Convert.ToBoolean(this.DGVDanhSachNhanVien[0, abc].Value))
                    {
                        int demSapXep = 0;
                        this.dTongTienPhuCap = 0;
                        this.dTongTienPhuCapTienCom = 0;
                        this.dTongTienPhuCapKhac = 0;
                        this.dTongTienTamUng = 0;
                        this.dTongTienViPham = 0;
                        this.dTongTienThuong = 0;
                        this.demNhanVienNghiLeTinhCong = 0;
                        this.demNhanVienVangTinhCong = 0;
                        this.sMaChamCong = this.DGVDanhSachNhanVien.Rows[abc].Cells[3].Value.ToString();
                        this.sMaNhanVien = this.DGVDanhSachNhanVien.Rows[abc].Cells[1].Value.ToString();
                        this.sTenNhanVien = this.DGVDanhSachNhanVien.Rows[abc].Cells[2].Value.ToString();
                        this.sPhongBanTinhCong = this.DGVDanhSachNhanVien.Rows[abc].Cells[7].Value.ToString();
                        if (this.iNgonNgu == 0)
                        {
                            _loadTinhCong.lbTenNhanVien.Text = string.Concat("Nhân viên: ", this.sTenNhanVien);
                        }
                        if (this.iNgonNgu == 1)
                        {
                            _loadTinhCong.lbTenNhanVien.Text = string.Concat("Employee: ", this.sTenNhanVien);
                        }
                        System.Windows.Forms.Application.DoEvents();
                        System.Data.DataTable dtSapXepLichTrinh = new System.Data.DataTable();
                        this._sapXepLichTrinhChoNhanVienDTO.MaChamCong = Convert.ToInt32(this.sMaChamCong);
                        dtSapXepLichTrinh = this._sapXepLichTrinhChoNhanVienBLL.get_SapXepLichTrinhChoNhanVienByMaChamCong(this._sapXepLichTrinhChoNhanVienDTO);
                        for (int iSapXepLichTrinh = 0; iSapXepLichTrinh < dtSapXepLichTrinh.Rows.Count; iSapXepLichTrinh++)
                        {
                            sLTVRNhanVien = dtSapXepLichTrinh.Rows[iSapXepLichTrinh]["MaLichTrinhVaoRa"].ToString();
                            System.Data.DataTable dtLichTrinhVaoRa = new System.Data.DataTable();
                            this._lichTrinhVaoRaDTO.MaLichTrinhVaoRa = sLTVRNhanVien;
                            dtLichTrinhVaoRa = this._lichTrinhVaoRaBLL.get_LichTrinhVaoRaByMaLichTrinhVaoRa(this._lichTrinhVaoRaDTO);
                            for (int iLichTrinhVaoRa = 0; iLichTrinhVaoRa < dtLichTrinhVaoRa.Rows.Count; iLichTrinhVaoRa++)
                            {
                                dtLichTrinhVaoRa.Rows[iLichTrinhVaoRa]["TenLichTrinhVaoRa"].ToString();
                                iChonLichTrinh = Convert.ToInt32(dtLichTrinhVaoRa.Rows[iLichTrinhVaoRa]["ChonLichTrinhVaoRa"].ToString());
                                dtLichTrinhVaoRa.Rows[iLichTrinhVaoRa]["MotLanChamCong"].ToString();
                                dtLichTrinhVaoRa.Rows[iLichTrinhVaoRa]["LoaiBoGio"].ToString();
                                dtLichTrinhVaoRa.Rows[iLichTrinhVaoRa]["TuGio"].ToString();
                                dtLichTrinhVaoRa.Rows[iLichTrinhVaoRa]["DenGio"].ToString();
                                iThoiGianNhoNhat = Convert.ToInt32(dtLichTrinhVaoRa.Rows[iLichTrinhVaoRa]["ThoiGianNhoNhat"].ToString());
                                iThoiGianLonNhat = Convert.ToInt32(dtLichTrinhVaoRa.Rows[iLichTrinhVaoRa]["ThoiGianLonNhat"].ToString());
                                iKhoangCachGiuaHaiCapVaoRa = Convert.ToInt32(dtLichTrinhVaoRa.Rows[iLichTrinhVaoRa]["KhoangCachGiuaHaiCapVaoRa"].ToString());
                            }
                            sLTCCLVNhanVien = dtSapXepLichTrinh.Rows[iSapXepLichTrinh]["MaLichTrinhCaLamViec"].ToString();
                            System.Data.DataTable dtChiTietLichTrinhChoCalamViec = new System.Data.DataTable();
                            this._chiTietLichTrinhChoCalamViecDTO.MaLichTrinhCaLamViec = sLTCCLVNhanVien;
                            dtChiTietLichTrinhChoCalamViec = this._chiTietLichTrinhChoCaLamViecBLL.ChiTietLichTrinhChoCaLamViecgetByMaLichTrinhCalamViec(this._chiTietLichTrinhChoCalamViecDTO);
                            for (int iChiTietLichTrinhChoCaLamViec = 0; iChiTietLichTrinhChoCaLamViec < dtChiTietLichTrinhChoCalamViec.Rows.Count; iChiTietLichTrinhChoCaLamViec++)
                            {
                                this.sID = dtChiTietLichTrinhChoCalamViec.Rows[iChiTietLichTrinhChoCaLamViec]["ID"].ToString();
                                this.sMaLichTrinhCalamViec = dtChiTietLichTrinhChoCalamViec.Rows[iChiTietLichTrinhChoCaLamViec]["MaLichTrinhCaLamViec"].ToString();
                                this.sThu = dtChiTietLichTrinhChoCalamViec.Rows[iChiTietLichTrinhChoCaLamViec]["Thu"].ToString();
                                this.sCaThu1 = dtChiTietLichTrinhChoCalamViec.Rows[iChiTietLichTrinhChoCaLamViec]["CaThu1"].ToString();
                                this.sLoadCaLamViec = this.sCaThu1;
                                if (!(this.sLoadCaLamViec == ""))
                                {
                                    this.loadCaLamViec();
                                    this.sCaThu2 = dtChiTietLichTrinhChoCalamViec.Rows[iChiTietLichTrinhChoCaLamViec]["CaThu2"].ToString();
                                    this.sLoadCaLamViec = this.sCaThu2;
                                    if (!(this.sLoadCaLamViec == ""))
                                    {
                                        this.loadCaLamViec();
                                        this.sCaThu3 = dtChiTietLichTrinhChoCalamViec.Rows[iChiTietLichTrinhChoCaLamViec]["CaThu3"].ToString();
                                        this.sLoadCaLamViec = this.sCaThu3;
                                        if (!(this.sLoadCaLamViec == ""))
                                        {
                                            this.loadCaLamViec();
                                            this.sCaThu4 = dtChiTietLichTrinhChoCalamViec.Rows[iChiTietLichTrinhChoCaLamViec]["CaThu4"].ToString();
                                            this.sLoadCaLamViec = this.sCaThu4;
                                            if (!(this.sLoadCaLamViec == ""))
                                            {
                                                this.loadCaLamViec();
                                                this.sCaThu5 = dtChiTietLichTrinhChoCalamViec.Rows[iChiTietLichTrinhChoCaLamViec]["CaThu5"].ToString();
                                                this.sLoadCaLamViec = this.sCaThu5;
                                                if (!(this.sLoadCaLamViec == ""))
                                                {
                                                    this.loadCaLamViec();
                                                    this.sCaThu6 = dtChiTietLichTrinhChoCalamViec.Rows[iChiTietLichTrinhChoCaLamViec]["CaThu6"].ToString();
                                                    this.sLoadCaLamViec = this.sCaThu6;
                                                    if (!(this.sLoadCaLamViec == ""))
                                                    {
                                                        this.loadCaLamViec();
                                                        this.sCaThu7 = dtChiTietLichTrinhChoCalamViec.Rows[iChiTietLichTrinhChoCaLamViec]["CaThu7"].ToString();
                                                        this.sLoadCaLamViec = this.sCaThu7;
                                                        if (!(this.sLoadCaLamViec == ""))
                                                        {
                                                            this.loadCaLamViec();
                                                            this.sCaThu8 = dtChiTietLichTrinhChoCalamViec.Rows[iChiTietLichTrinhChoCaLamViec]["CaThu8"].ToString();
                                                            this.sLoadCaLamViec = this.sCaThu8;
                                                            if (!(this.sLoadCaLamViec == ""))
                                                            {
                                                                this.loadCaLamViec();
                                                                this.sCaThu9 = dtChiTietLichTrinhChoCalamViec.Rows[iChiTietLichTrinhChoCaLamViec]["CaThu9"].ToString();
                                                                this.sLoadCaLamViec = this.sCaThu9;
                                                                if (!(this.sLoadCaLamViec == ""))
                                                                {
                                                                    this.loadCaLamViec();
                                                                    this.sCaThu10 = dtChiTietLichTrinhChoCalamViec.Rows[iChiTietLichTrinhChoCaLamViec]["CaThu10"].ToString();
                                                                    this.sLoadCaLamViec = this.sCaThu10;
                                                                    this.loadCaLamViec();
                                                                }
                                                            }
                                                        }
                                                    }
                                                }
                                            }
                                        }
                                    }
                                }
                            }
                            demSapXep++;
                        }
                        this.sNgayVaoLamViec = this.DGVDanhSachNhanVien.Rows[abc].Cells[4].Value.ToString();
                        for (int _tongNgay = 0; _tongNgay <= Convert.ToInt32(this.sTongNgayTinh); _tongNgay++)
                        {
                            kiemTraVao = 0;
                            kiemTraRa = 0;
                            dt = new DateTime();
                            int _nhanVien = this.DGVTinhCong.Rows.Add();
                            this.DGVTinhCong.Rows[_nhanVien].Cells[0].Value = this.sMaNhanVien;
                            this.DGVTinhCong.Rows[_nhanVien].Cells[1].Value = this.sTenNhanVien;
                            dt = this.dateTimeTuNgay.Value;
                            dateTime = dt.AddDays((double)dem);
                            DateTime dtDinhDang = Convert.ToDateTime(dateTime.ToString());
                            sNgayCham = string.Format("{0:d}", dtDinhDang);
                            dateTime = dt.AddDays((double)dem);
                            sThu = DateTimeProgress.Test((int)dateTime.DayOfWeek);
                            this.DGVTinhCong.Rows[_nhanVien].Cells[2].Value = string.Format("{0:d}", dtDinhDang);
                            System.Data.DataTable dtSuaXoaGioCham = new System.Data.DataTable();
                            this._checkInOutDTO.MaChamCong = Convert.ToInt32(this.sMaChamCong);
                            this._checkInOutDTO.NgayCham = Convert.ToDateTime(this.DGVTinhCong.Rows[_nhanVien].Cells[2].Value.ToString());
                            dtSuaXoaGioCham = this._checkInOutBLL.getCheckInOutByMaChamCongAndNgayCham(this._checkInOutDTO);
                            for (int iSuaXoaGioCham = 0; iSuaXoaGioCham < dtSuaXoaGioCham.Rows.Count; iSuaXoaGioCham++)
                            {
                                int addSuaXoaGioCham = this.DGVSuaXoaGioCham.Rows.Add();
                                this.DGVSuaXoaGioCham.Rows[addSuaXoaGioCham].Cells[0].Value = this.sMaChamCong;
                                DateTime dtNgayChamSuaXoaGioCham = Convert.ToDateTime(dtSuaXoaGioCham.Rows[iSuaXoaGioCham]["NgayCham"].ToString());
                                this.DGVSuaXoaGioCham.Rows[addSuaXoaGioCham].Cells[1].Value = string.Format("{0:d}", dtNgayChamSuaXoaGioCham);
                                this.DGVSuaXoaGioCham.Rows[addSuaXoaGioCham].Cells[2].Value = dtSuaXoaGioCham.Rows[iSuaXoaGioCham]["GioCham"].ToString();
                                this.DGVSuaXoaGioCham.Rows[addSuaXoaGioCham].Cells[3].Value = dtSuaXoaGioCham.Rows[iSuaXoaGioCham]["KieuCham"].ToString();
                                this.DGVSuaXoaGioCham.Rows[addSuaXoaGioCham].Cells[4].Value = dtSuaXoaGioCham.Rows[iSuaXoaGioCham]["NguonCham"].ToString();
                                this.DGVSuaXoaGioCham.Rows[addSuaXoaGioCham].Cells[5].Value = dtSuaXoaGioCham.Rows[iSuaXoaGioCham]["MaSoMay"].ToString();
                                this.DGVSuaXoaGioCham.Rows[addSuaXoaGioCham].Cells[7].Value = dtSuaXoaGioCham.Rows[iSuaXoaGioCham]["ID"].ToString();
                            }
                            int iKiemTraSapXepCa = 0;
                            if (demSapXep <= 0)
                            {
                                this.DGVTinhCong.Rows[_nhanVien].Cells[4].Value = "Chưa xếp ca!";
                                this.DGVTinhCong.Rows[_nhanVien].Cells[7].Value = "0";
                                this.DGVTinhCong.Rows[_nhanVien].Cells[8].Value = "0";
                                this.DGVTinhCong.Rows[_nhanVien].Cells[9].Value = "0";
                                this.DGVTinhCong.Rows[_nhanVien].Cells[10].Value = "0";
                                this.DGVTinhCong.Rows[_nhanVien].Cells[11].Value = "0";
                                this.DGVTinhCong.Rows[_nhanVien].Cells[12].Value = "0";
                                this.DGVTinhCong.Rows[_nhanVien].Cells[13].Value = "0";
                                this.DGVTinhCong.Rows[_nhanVien].Cells[14].Value = "0";
                                this.DGVTinhCong.Rows[_nhanVien].Cells[15].Value = "0";
                                this.DGVTinhCong.Rows[_nhanVien].Cells[16].Value = "0";
                                this.DGVTinhCong.Rows[_nhanVien].Cells[17].Value = "0";
                                this.DGVTinhCong.Rows[_nhanVien].Cells[18].Value = this.sKHVang;
                                if (!(DateTimeProgress.XuatIDThu((int)dt.AddDays((double)dem).DayOfWeek) == "0"))
                                {
                                    this.DGVTinhCong.Rows[_nhanVien].Cells[19].Value = "NT";
                                }
                                else
                                {
                                    this.DGVTinhCong.Rows[_nhanVien].Cells[19].Value = "CN";
                                }
                                this.DGVTinhCong.Rows[_nhanVien].Cells[20].Value = this.sMaChamCong;
                                this.DGVTinhCong.Rows[_nhanVien].Cells[21].Value = this.sPhongBanTinhCong;
                                for (int iChuaXepCa = 0; iChuaXepCa < 19; iChuaXepCa++)
                                {
                                    this.DGVTinhCong.Rows[_nhanVien].Cells[iChuaXepCa].Style.ForeColor = Color.Red;
                                }
                                iKiemTraSapXepCa = 1;
                            }
                            else
                            {
                                if (iChonLichTrinh == 1)
                                {
                                    iKiemTraLanChamLichTrinhVaoRa = 0;
                                    iKiemTraLanChamKhoangCachTuDongQuaDemLichTrinhVaoRa = 0;
                                    dGioVaoTuDongQuaDemKiemTraLichTrinhVaoRa = new DateTime();
                                    dGioRaTuDongQuaDemKiemTraLichTrinhVaoRa = new DateTime();
                                    iKiemTraLanChamTuDongQuaDemLichTrinhVaoRa = new DateTime();
                                    iLanCham = 1;
                                    addChonTuMay = 0;
                                    iKiemTra = 0;
                                    iKiemTraB = 0;
                                    dGioVaoChonTuMay = new DateTime();
                                    dGioRaChonTuMay = new DateTime();
                                    dateGioChamChonTuMay = new DateTime();
                                    dtChonTuMay = new System.Data.DataTable();
                                    this._checkInOutDTO.MaChamCong = Convert.ToInt32(this.sMaChamCong);
                                    this._checkInOutDTO.NgayCham = Convert.ToDateTime(this.DGVTinhCong.Rows[_nhanVien].Cells[2].Value.ToString());
                                    dtChonTuMay = this._checkInOutBLL.getCheckInOutByMaChamCongAndNgayCham(this._checkInOutDTO);
                                    for (iChonTuMay = 0; iChonTuMay < dtChonTuMay.Rows.Count; iChonTuMay++)
                                    {
                                        addGioNguonTuDongQuaDemQuaDem = this.DGVDuLieuChamCongNguon.Rows.Add();
                                        iKiemTraLanChamLichTrinhVaoRa++;
                                        if (iKiemTraLanChamLichTrinhVaoRa == 1)
                                        {
                                            dGioVaoTuDongQuaDemKiemTraLichTrinhVaoRa = Convert.ToDateTime(dtChonTuMay.Rows[iChonTuMay]["GioCham"].ToString());
                                            if ((dtChonTuMay.Rows.Count <= 2 ? true : iKiemTraLanChamKhoangCachTuDongQuaDemLichTrinhVaoRa != 3))
                                            {
                                                this.DGVDuLieuChamCongNguon.Rows[addGioNguonTuDongQuaDemQuaDem].Cells[0].Value = this.sMaChamCong;
                                                this.DGVDuLieuChamCongNguon.Rows[addGioNguonTuDongQuaDemQuaDem].Cells[1].Value = string.Format("{0:d}", dGioVaoTuDongQuaDemKiemTraLichTrinhVaoRa);
                                                this.DGVDuLieuChamCongNguon.Rows[addGioNguonTuDongQuaDemQuaDem].Cells[2].Value = dGioVaoTuDongQuaDemKiemTraLichTrinhVaoRa;
                                                this.DGVDuLieuChamCongNguon.Rows[addGioNguonTuDongQuaDemQuaDem].Cells[3].Value = "Vào";
                                                this.DGVDuLieuChamCongNguon.Rows[addGioNguonTuDongQuaDemQuaDem].Cells[4].Value = "I";
                                                this.DGVDuLieuChamCongNguon.Rows[addGioNguonTuDongQuaDemQuaDem].Cells[6].Value = dtChonTuMay.Rows[iChonTuMay]["MaSoMay"].ToString();
                                            }
                                            else
                                            {
                                                if (Convert.ToInt32(Convert.ToInt32((dGioVaoTuDongQuaDemKiemTraLichTrinhVaoRa - dGioRaTuDongQuaDemKiemTraLichTrinhVaoRa).TotalMinutes).ToString()) < iKhoangCachGiuaHaiCapVaoRa)
                                                {
                                                    goto Label1;
                                                }
                                                this.DGVDuLieuChamCongNguon.Rows[addGioNguonTuDongQuaDemQuaDem].Cells[0].Value = this.sMaChamCong;
                                                this.DGVDuLieuChamCongNguon.Rows[addGioNguonTuDongQuaDemQuaDem].Cells[1].Value = string.Format("{0:d}", dGioVaoTuDongQuaDemKiemTraLichTrinhVaoRa);
                                                this.DGVDuLieuChamCongNguon.Rows[addGioNguonTuDongQuaDemQuaDem].Cells[2].Value = dGioVaoTuDongQuaDemKiemTraLichTrinhVaoRa;
                                                this.DGVDuLieuChamCongNguon.Rows[addGioNguonTuDongQuaDemQuaDem].Cells[3].Value = "Vào";
                                                this.DGVDuLieuChamCongNguon.Rows[addGioNguonTuDongQuaDemQuaDem].Cells[4].Value = "I";
                                                this.DGVDuLieuChamCongNguon.Rows[addGioNguonTuDongQuaDemQuaDem].Cells[6].Value = dtChonTuMay.Rows[iChonTuMay]["MaSoMay"].ToString();
                                                iKiemTraLanChamLichTrinhVaoRa = 1;
                                            }
                                        }
                                        if (iKiemTraLanChamLichTrinhVaoRa == 2)
                                        {
                                            dGioRaTuDongQuaDemKiemTraLichTrinhVaoRa = Convert.ToDateTime(dtChonTuMay.Rows[iChonTuMay]["GioCham"].ToString());
                                            if (Convert.ToInt32(Convert.ToInt32((dGioRaTuDongQuaDemKiemTraLichTrinhVaoRa - dGioVaoTuDongQuaDemKiemTraLichTrinhVaoRa).TotalMinutes).ToString()) < iThoiGianNhoNhat)
                                            {
                                                goto Label2;
                                            }
                                            iKiemTraLanChamLichTrinhVaoRa = 0;
                                            iKiemTraLanChamKhoangCachTuDongQuaDemLichTrinhVaoRa = 3;
                                            this.DGVDuLieuChamCongNguon.Rows[addGioNguonTuDongQuaDemQuaDem].Cells[0].Value = this.sMaChamCong;
                                            this.DGVDuLieuChamCongNguon.Rows[addGioNguonTuDongQuaDemQuaDem].Cells[1].Value = string.Format("{0:d}", dGioRaTuDongQuaDemKiemTraLichTrinhVaoRa);
                                            this.DGVDuLieuChamCongNguon.Rows[addGioNguonTuDongQuaDemQuaDem].Cells[2].Value = dGioRaTuDongQuaDemKiemTraLichTrinhVaoRa;
                                            this.DGVDuLieuChamCongNguon.Rows[addGioNguonTuDongQuaDemQuaDem].Cells[3].Value = "Ra";
                                            this.DGVDuLieuChamCongNguon.Rows[addGioNguonTuDongQuaDemQuaDem].Cells[4].Value = "O";
                                            this.DGVDuLieuChamCongNguon.Rows[addGioNguonTuDongQuaDemQuaDem].Cells[6].Value = dtChonTuMay.Rows[iChonTuMay]["MaSoMay"].ToString();
                                        }
                                        dateGioChamChonTuMay = Convert.ToDateTime(dtChonTuMay.Rows[iChonTuMay]["GioCham"].ToString());
                                        if (Convert.ToInt32(dtChonTuMay.Rows[iChonTuMay]["KieuCham"].ToString()) == 0)
                                        {
                                            if (iLanCham != 1)
                                            {
                                                addChonTuMay = this.DGVTinhCong.Rows.Add();
                                                dGioVaoChonTuMay = Convert.ToDateTime(dateGioChamChonTuMay.ToString());
                                                this.DGVTinhCong.Rows[addChonTuMay].Cells[5].Value = string.Format(this.sDinhDangThoiGian, dGioVaoChonTuMay);
                                                iKiemTraB = 1;
                                                this.DGVTinhCong.Rows[addChonTuMay].Cells[0].Value = this.sMaNhanVien;
                                                this.DGVTinhCong.Rows[addChonTuMay].Cells[1].Value = this.sTenNhanVien;
                                                this.DGVTinhCong.Rows[addChonTuMay].Cells[2].Value = this.DGVTinhCong.Rows[_nhanVien].Cells[2].Value.ToString();
                                                this.DGVTinhCong.Rows[addChonTuMay].Cells[4].Value = "***";
                                                this.DGVTinhCong.Rows[addChonTuMay].Cells[7].Value = "0";
                                                this.DGVTinhCong.Rows[addChonTuMay].Cells[8].Value = "0";
                                                if (this.iNgonNgu == 0)
                                                {
                                                    DataGridViewCell item = this.DGVTinhCong.Rows[addChonTuMay].Cells[3];
                                                    dateTime = dt.AddDays((double)dem);
                                                    item.Value = DateTimeProgress.XuatThuTinhCong((int)dateTime.DayOfWeek);
                                                }
                                                if (this.iNgonNgu == 1)
                                                {
                                                    DataGridViewCell dataGridViewCell = this.DGVTinhCong.Rows[addChonTuMay].Cells[3];
                                                    dateTime = dt.AddDays((double)dem);
                                                    dataGridViewCell.Value = DateTimeProgress.XuatThuEnglish((int)dateTime.DayOfWeek);
                                                }
                                                this.DGVTinhCong.Rows[addChonTuMay].Cells[17].Value = "0";
                                                this.DGVTinhCong.Rows[addChonTuMay].Cells[18].Value = this.sKHVang;
                                                if (!(DateTimeProgress.XuatIDThu((int)dt.AddDays((double)dem).DayOfWeek) == "0"))
                                                {
                                                    this.DGVTinhCong.Rows[addChonTuMay].Cells[19].Value = "NT";
                                                }
                                                else
                                                {
                                                    this.DGVTinhCong.Rows[addChonTuMay].Cells[19].Value = "CN";
                                                }
                                                this.DGVTinhCong.Rows[addChonTuMay].Cells[20].Value = this.sMaChamCong;
                                                this.DGVTinhCong.Rows[addChonTuMay].Cells[21].Value = this.sPhongBanTinhCong;
                                            }
                                            else
                                            {
                                                dGioVaoChonTuMay = Convert.ToDateTime(dateGioChamChonTuMay.ToString());
                                                this.DGVTinhCong.Rows[_nhanVien].Cells[4].Value = "***";
                                                this.DGVTinhCong.Rows[_nhanVien].Cells[5].Value = string.Format(this.sDinhDangThoiGian, dGioVaoChonTuMay);
                                                this.DGVTinhCong.Rows[_nhanVien].Cells[7].Value = "0";
                                                this.DGVTinhCong.Rows[_nhanVien].Cells[8].Value = "0";
                                                this.DGVTinhCong.Rows[_nhanVien].Cells[17].Value = "0";
                                                this.DGVTinhCong.Rows[_nhanVien].Cells[18].Value = this.sKHVang;
                                                if (!(DateTimeProgress.XuatIDThu((int)dt.AddDays((double)dem).DayOfWeek) == "0"))
                                                {
                                                    this.DGVTinhCong.Rows[_nhanVien].Cells[19].Value = "NT";
                                                }
                                                else
                                                {
                                                    this.DGVTinhCong.Rows[_nhanVien].Cells[19].Value = "CN";
                                                }
                                                this.DGVTinhCong.Rows[_nhanVien].Cells[20].Value = this.sMaChamCong;
                                                this.DGVTinhCong.Rows[_nhanVien].Cells[21].Value = this.sPhongBanTinhCong;
                                                iKiemTra = 1;
                                            }
                                        }
                                        else if ((iKiemTra != 1 || iLanCham != 2 ? iLanCham != 1 : false))
                                        {
                                            if (iKiemTraB == 1)
                                            {
                                                goto Label3;
                                            }
                                            if (iKiemTraB == 0)
                                            {
                                                int addChonTuMayB = this.DGVTinhCong.Rows.Add();
                                                dGioRaChonTuMay = Convert.ToDateTime(dateGioChamChonTuMay.ToString());
                                                this.DGVTinhCong.Rows[addChonTuMayB].Cells[6].Value = string.Format(this.sDinhDangThoiGian, dGioRaChonTuMay);
                                                this.DGVTinhCong.Rows[addChonTuMayB].Cells[0].Value = this.sMaNhanVien;
                                                this.DGVTinhCong.Rows[addChonTuMayB].Cells[1].Value = this.sTenNhanVien;
                                                this.DGVTinhCong.Rows[addChonTuMayB].Cells[2].Value = this.DGVTinhCong.Rows[_nhanVien].Cells[2].Value.ToString();
                                                this.DGVTinhCong.Rows[addChonTuMayB].Cells[4].Value = "***";
                                                this.DGVTinhCong.Rows[addChonTuMayB].Cells[7].Value = "0";
                                                this.DGVTinhCong.Rows[addChonTuMayB].Cells[8].Value = "0";
                                                if (this.iNgonNgu == 0)
                                                {
                                                    DataGridViewCell item1 = this.DGVTinhCong.Rows[addChonTuMayB].Cells[3];
                                                    dateTime = dt.AddDays((double)dem);
                                                    item1.Value = DateTimeProgress.XuatThuTinhCong((int)dateTime.DayOfWeek);
                                                }
                                                if (this.iNgonNgu == 1)
                                                {
                                                    DataGridViewCell dataGridViewCell1 = this.DGVTinhCong.Rows[addChonTuMayB].Cells[3];
                                                    dateTime = dt.AddDays((double)dem);
                                                    dataGridViewCell1.Value = DateTimeProgress.XuatThuEnglish((int)dateTime.DayOfWeek);
                                                }
                                                this.DGVTinhCong.Rows[addChonTuMayB].Cells[17].Value = "0";
                                                this.DGVTinhCong.Rows[addChonTuMayB].Cells[18].Value = this.sKHVang;
                                                if (!(DateTimeProgress.XuatIDThu((int)dt.AddDays((double)dem).DayOfWeek) == "0"))
                                                {
                                                    this.DGVTinhCong.Rows[addChonTuMayB].Cells[19].Value = "NT";
                                                }
                                                else
                                                {
                                                    this.DGVTinhCong.Rows[addChonTuMayB].Cells[19].Value = "CN";
                                                }
                                                this.DGVTinhCong.Rows[addChonTuMayB].Cells[20].Value = this.sMaChamCong;
                                                this.DGVTinhCong.Rows[addChonTuMayB].Cells[21].Value = this.sPhongBanTinhCong;
                                            }
                                        }
                                        else
                                        {
                                            if ((iKiemTra != 0 ? true : iLanCham != 1))
                                            {
                                                dGioRaChonTuMay = Convert.ToDateTime(dateGioChamChonTuMay.ToString());
                                                this.DGVTinhCong.Rows[_nhanVien].Cells[6].Value = string.Format(this.sDinhDangThoiGian, dGioRaChonTuMay);
                                                iLanCham++;
                                                dtNhanCaChonTuMay = new System.Data.DataTable();
                                                this._chiTietLichTrinhChoCalamViecDTO.MaLichTrinhCaLamViec = sLTCCLVNhanVien;
                                                this._chiTietLichTrinhChoCalamViecDTO.Thu = sThu;
                                                dtNhanCaChonTuMay = this._chiTietLichTrinhChoCaLamViecBLL.ChiTietLichTrinhChoCaLamViecNhanCa(this._chiTietLichTrinhChoCalamViecDTO);
                                                iChiTietLichTrinhChoCaLamViecChonTuMay = 0;
                                                if (iChiTietLichTrinhChoCaLamViecChonTuMay < dtNhanCaChonTuMay.Rows.Count)
                                                {
                                                    cellChiTietLichTrinhChoCaLamViecChonTuMay = 3;
                                                    while (cellChiTietLichTrinhChoCaLamViecChonTuMay < 13)
                                                    {
                                                        kiemTraVao = 0;
                                                        kiemTraRa = 0;
                                                        this.sChonTuMayMaCaLamViec = dtNhanCaChonTuMay.Rows[iChiTietLichTrinhChoCaLamViecChonTuMay][cellChiTietLichTrinhChoCaLamViecChonTuMay].ToString();
                                                        dtChonTuMayCa1 = new System.Data.DataTable();
                                                        this._caLamViecDTO.MaCaLamViec = this.sChonTuMayMaCaLamViec;
                                                        dtChonTuMayCa1 = this._caLamViecBLL.CaLamViecGetByMaCaLamViec(this._caLamViecDTO);
                                                        iChonTuMayCa1 = 0;
                                                        while (iChonTuMayCa1 < dtChonTuMayCa1.Rows.Count)
                                                        {
                                                            this.sChonTuMayTenCaLamViec = dtChonTuMayCa1.Rows[iChonTuMayCa1]["CaLamViec"].ToString();
                                                            dBatDauVaoChonTuMayA = Convert.ToDateTime(dtChonTuMayCa1.Rows[iChonTuMayCa1]["BatDauVao"].ToString());
                                                            sBatDauVaoChonTuMayA = string.Format("{0:T}", dBatDauVaoChonTuMayA);
                                                            sBatDauVaoChonTuMayB = string.Concat(sNgayCham, " ", sBatDauVaoChonTuMayA);
                                                            dBatDauVaoChonTuMayB = Convert.ToDateTime(sBatDauVaoChonTuMayB);
                                                            dKetThucVaoChonTuMayA = Convert.ToDateTime(dtChonTuMayCa1.Rows[iChonTuMayCa1]["KetThucVao"].ToString());
                                                            sKetThucVaoChonTuMayA = string.Format("{0:T}", dKetThucVaoChonTuMayA);
                                                            sKetThucVaoChonTuMayB = string.Concat(sNgayCham, " ", sKetThucVaoChonTuMayA);
                                                            dKetThucVaoChonTuMayB = Convert.ToDateTime(sKetThucVaoChonTuMayB);
                                                            dBatDauRaChonTuMayA = Convert.ToDateTime(dtChonTuMayCa1.Rows[iChonTuMayCa1]["BatDauRa"].ToString());
                                                            sBatDauRaChonTuMayA = string.Format("{0:T}", dBatDauRaChonTuMayA);
                                                            sBatDauRaChonTuMayB = string.Concat(sNgayCham, " ", sBatDauRaChonTuMayA);
                                                            dBatDauRaChonTuMayB = Convert.ToDateTime(sBatDauRaChonTuMayB);
                                                            if (!(sBatDauRaChonTuMayB == "12:01:00 AM"))
                                                            {
                                                                dBatDauRaChonTuMayB = Convert.ToDateTime(dBatDauRaChonTuMayB);
                                                            }
                                                            else
                                                            {
                                                                dateTime = dBatDauRaChonTuMayB.AddDays(1);
                                                                dBatDauRaChonTuMayB = Convert.ToDateTime(dateTime.ToString());
                                                            }
                                                            dKetThucRaChonTuMayA = Convert.ToDateTime(dtChonTuMayCa1.Rows[iChonTuMayCa1]["KetThucRa"].ToString());
                                                            sKetThucRaChonTuMayA = string.Format("{0:T}", dKetThucRaChonTuMayA);
                                                            sKetThucRaChonTuMayB = string.Concat(sNgayCham, " ", sKetThucRaChonTuMayA);
                                                            dKetThucRaChonTuMayB = Convert.ToDateTime(sKetThucRaChonTuMayB);
                                                            if (!(sKetThucRaChonTuMayA == "12:01:00 AM"))
                                                            {
                                                                dKetThucRaChonTuMayB = Convert.ToDateTime(dKetThucRaChonTuMayB);
                                                            }
                                                            else
                                                            {
                                                                dateTime = dKetThucRaChonTuMayB.AddDays(1);
                                                                dKetThucRaChonTuMayB = Convert.ToDateTime(dateTime.ToString());
                                                            }
                                                            if ((dGioVaoChonTuMay < dBatDauVaoChonTuMayB ? false : dGioVaoChonTuMay <= dKetThucVaoChonTuMayB))
                                                            {
                                                                kiemTraVao++;
                                                            }
                                                            if ((dGioRaChonTuMay < dBatDauRaChonTuMayB ? false : dGioRaChonTuMay <= dKetThucRaChonTuMayB))
                                                            {
                                                                kiemTraRa++;
                                                            }
                                                            if ((kiemTraVao != 1 ? true : kiemTraRa != 1))
                                                            {
                                                                iChonTuMayCa1++;
                                                            }
                                                            else
                                                            {
                                                                goto Label5;
                                                            }
                                                        }
                                                        if (!(this.sChonTuMayMaCaLamViec == ""))
                                                        {
                                                            cellChiTietLichTrinhChoCaLamViecChonTuMay++;
                                                        }
                                                        else
                                                        {
                                                            this.DGVTinhCong.Rows[_nhanVien].Cells[4].Value = "***";
                                                            this.DGVTinhCong.Rows[_nhanVien].Cells[7].Value = "0";
                                                            this.DGVTinhCong.Rows[_nhanVien].Cells[8].Value = "0";
                                                            this.DGVTinhCong.Rows[_nhanVien].Cells[9].Value = "0";
                                                            this.DGVTinhCong.Rows[_nhanVien].Cells[10].Value = "0";
                                                            this.DGVTinhCong.Rows[_nhanVien].Cells[11].Value = "0";
                                                            this.DGVTinhCong.Rows[_nhanVien].Cells[12].Value = "0";
                                                            this.DGVTinhCong.Rows[_nhanVien].Cells[13].Value = "0";
                                                            this.DGVTinhCong.Rows[_nhanVien].Cells[14].Value = "0";
                                                            this.DGVTinhCong.Rows[_nhanVien].Cells[15].Value = "0";
                                                            this.DGVTinhCong.Rows[_nhanVien].Cells[16].Value = "0";
                                                            this.DGVTinhCong.Rows[_nhanVien].Cells[17].Value = "0";
                                                            this.DGVTinhCong.Rows[_nhanVien].Cells[18].Value = this.sKHVang;
                                                           // goto Label4;
                                                        }
                                                    }
                                                Label5:
                                                    this.DGVTinhCong.Rows[_nhanVien].Cells[4].Value = this.sChonTuMayTenCaLamViec;
                                                    dtCaLamViecChonTuMay = new System.Data.DataTable();
                                                    this._caLamViecDTO.MaCaLamViec = this.sChonTuMayMaCaLamViec;
                                                    dtCaLamViecChonTuMay = this._caLamViecBLL.CaLamViecGetByMaCaLamViec(this._caLamViecDTO);
                                                    for (iCaLamViecChonTuMay = 0; iCaLamViecChonTuMay < dtCaLamViecChonTuMay.Rows.Count; iCaLamViecChonTuMay++)
                                                    {
                                                        second = dGioVaoChonTuMay.Second;
                                                        sGiayGioVao = second.ToString();
                                                        second = dGioRaChonTuMay.Second;
                                                        sGiayGioRa = second.ToString();
                                                        dGioVaoKhaiBaoChonTuMayA = Convert.ToDateTime(dtCaLamViecChonTuMay.Rows[iCaLamViecChonTuMay]["GioVaoLamViec"].ToString());
                                                        sGioVaoKhaiBaoChonTuMayA = string.Format("{0:T}", dGioVaoKhaiBaoChonTuMayA).Replace("00 ", string.Concat(sGiayGioVao, " "));
                                                        sGioVaoKhaiBaoChonTuMayB = string.Concat(sNgayCham, " ", sGioVaoKhaiBaoChonTuMayA);
                                                        dGioVaoKhaiBaoChonTuMayB = Convert.ToDateTime(sGioVaoKhaiBaoChonTuMayB);
                                                        dGioRaKhaiBaoChonTuMayA = Convert.ToDateTime(dtCaLamViecChonTuMay.Rows[iCaLamViecChonTuMay]["GioKetThucLamViec"].ToString());
                                                        sGioRaKhaiBaoChonTuMayA = string.Format("{0:T}", dGioRaKhaiBaoChonTuMayA).Replace("00 ", string.Concat(sGiayGioRa, " "));
                                                        sGioRaKhaiBaoChonTuMayB = string.Concat(sNgayCham, " ", sGioRaKhaiBaoChonTuMayA);
                                                        dGioRaKhaiBaoChonTuMayB = Convert.ToDateTime(sGioRaKhaiBaoChonTuMayB);
                                                        sTruGioDiTre = dtCaLamViecChonTuMay.Rows[iCaLamViecChonTuMay]["TruGioDiTre"].ToString();
                                                        sBatDauTinhDiTre = dtCaLamViecChonTuMay.Rows[iCaLamViecChonTuMay]["BatDauTinhDiTre"].ToString();
                                                        iChoPhepDiTre = Convert.ToInt32(dtCaLamViecChonTuMay.Rows[iCaLamViecChonTuMay]["ChoPhepDiTre"].ToString());
                                                        value = dGioVaoChonTuMay - dGioVaoKhaiBaoChonTuMayB;
                                                        second = Convert.ToInt32(value.TotalMinutes);
                                                        sPhutTre = second.ToString();
                                                        if (!(sTruGioDiTre == "True"))
                                                        {
                                                            this.DGVTinhCong.Rows[_nhanVien].Cells[9].Value = "0";
                                                        }
                                                        else if (Convert.ToInt32(sPhutTre) >= 0)
                                                        {
                                                            iPhutTre = Convert.ToInt32(sPhutTre) - iChoPhepDiTre;
                                                            if (sBatDauTinhDiTre == "True")
                                                            {
                                                                if (iPhutTre >= 1)
                                                                {
                                                                    this.DGVTinhCong.Rows[_nhanVien].Cells[9].Value = iPhutTre.ToString();
                                                                }
                                                                else
                                                                {
                                                                    this.DGVTinhCong.Rows[_nhanVien].Cells[9].Value = "0";
                                                                }
                                                            }
                                                            else if (iPhutTre >= 1)
                                                            {
                                                                this.DGVTinhCong.Rows[_nhanVien].Cells[9].Value = sPhutTre;
                                                            }
                                                            else
                                                            {
                                                                this.DGVTinhCong.Rows[_nhanVien].Cells[9].Value = "0";
                                                            }
                                                        }
                                                        else
                                                        {
                                                            this.DGVTinhCong.Rows[_nhanVien].Cells[9].Value = "0";
                                                        }
                                                        sTruGioVeSom = dtCaLamViecChonTuMay.Rows[iCaLamViecChonTuMay]["TruGioVeSom"].ToString();
                                                        sBatDauTinhVeSom = dtCaLamViecChonTuMay.Rows[iCaLamViecChonTuMay]["BatDauTinhVeSom"].ToString();
                                                        iChoPhepVeSom = Convert.ToInt32(dtCaLamViecChonTuMay.Rows[iCaLamViecChonTuMay]["ChoPhepVeSom"].ToString());
                                                        value = dGioRaKhaiBaoChonTuMayB - dGioRaChonTuMay;
                                                        second = Convert.ToInt32(value.TotalMinutes);
                                                        sPhutVeSom = second.ToString();
                                                        if (!(sTruGioVeSom == "True"))
                                                        {
                                                            this.DGVTinhCong.Rows[_nhanVien].Cells[10].Value = "0";
                                                        }
                                                        else if (Convert.ToInt32(sPhutVeSom) >= 0)
                                                        {
                                                            iPhutVeSom = Convert.ToInt32(sPhutVeSom) - iChoPhepVeSom;
                                                            if (iPhutVeSom < 1)
                                                            {
                                                                this.DGVTinhCong.Rows[_nhanVien].Cells[10].Value = "0";
                                                            }
                                                            else if (!(sBatDauTinhVeSom == "True"))
                                                            {
                                                                this.DGVTinhCong.Rows[_nhanVien].Cells[10].Value = sPhutVeSom;
                                                            }
                                                            else
                                                            {
                                                                this.DGVTinhCong.Rows[_nhanVien].Cells[10].Value = iPhutVeSom.ToString();
                                                            }
                                                        }
                                                        else
                                                        {
                                                            this.DGVTinhCong.Rows[_nhanVien].Cells[10].Value = "0";
                                                        }
                                                        value = dGioRaChonTuMay - dGioRaKhaiBaoChonTuMayB;
                                                        second = Convert.ToInt32(value.TotalMinutes);
                                                        sVeTre = second.ToString();
                                                        if (Convert.ToInt32(sVeTre) <= 0)
                                                        {
                                                            this.DGVTinhCong.Rows[_nhanVien].Cells[11].Value = "0";
                                                        }
                                                        else
                                                        {
                                                            this.DGVTinhCong.Rows[_nhanVien].Cells[11].Value = sVeTre;
                                                        }
                                                        iPhut = Convert.ToSingle(dtCaLamViecChonTuMay.Rows[iCaLamViecChonTuMay]["TongGioTrongCaLamViec"]) * 60f - (float)(Convert.ToInt32(this.DGVTinhCong.Rows[_nhanVien].Cells[9].Value.ToString()) + Convert.ToInt32(this.DGVTinhCong.Rows[_nhanVien].Cells[10].Value));
                                                        dGio = Math.Round(Convert.ToDouble(iPhut) / 60, this.iLamTronGio);
                                                        this.DGVTinhCong.Rows[_nhanVien].Cells[8].Value = dGio.ToString();
                                                        iGio = Convert.ToDouble(dtCaLamViecChonTuMay.Rows[iCaLamViecChonTuMay]["TongGioTrongCaLamViec"].ToString());
                                                        dCongTinh = Convert.ToDouble(dtCaLamViecChonTuMay.Rows[iCaLamViecChonTuMay]["CongTinh"].ToString());
                                                        dCong = Math.Round(dGio * dCongTinh / iGio, this.iLamTronCong);
                                                        this.DGVTinhCong.Rows[_nhanVien].Cells[7].Value = dCong.ToString();
                                                        sTangCaTruocGioLamViec = dtCaLamViecChonTuMay.Rows[iCaLamViecChonTuMay]["TangCaTruocGioLamViec"].ToString();
                                                        sTangCaSauGioLamViec = dtCaLamViecChonTuMay.Rows[iCaLamViecChonTuMay]["TangCaSauGioLamViec"].ToString();
                                                        if ((sTangCaTruocGioLamViec != "False" ? false : sTangCaSauGioLamViec == "False"))
                                                        {
                                                            this.DGVTinhCong.Rows[_nhanVien].Cells[12].Value = "0";
                                                            this.DGVTinhCong.Rows[_nhanVien].Cells[13].Value = "0";
                                                            this.DGVTinhCong.Rows[_nhanVien].Cells[14].Value = "0";
                                                            this.DGVTinhCong.Rows[_nhanVien].Cells[15].Value = "0";
                                                        }
                                                        sXemCaNayLaTangCa = dtCaLamViecChonTuMay.Rows[iCaLamViecChonTuMay]["XemCaNayLaTangCa"].ToString();
                                                        iTangCaMuc = Convert.ToInt32(dtCaLamViecChonTuMay.Rows[iCaLamViecChonTuMay]["TangCaMuc"].ToString());
                                                        if (sXemCaNayLaTangCa == "True")
                                                        {
                                                            if (iTangCaMuc == 1)
                                                            {
                                                                this.DGVTinhCong.Rows[_nhanVien].Cells[7].Value = "0";
                                                                this.DGVTinhCong.Rows[_nhanVien].Cells[8].Value = "0";
                                                                this.DGVTinhCong.Rows[_nhanVien].Cells[12].Value = dGio.ToString();
                                                                this.DGVTinhCong.Rows[_nhanVien].Cells[13].Value = "0";
                                                                this.DGVTinhCong.Rows[_nhanVien].Cells[14].Value = "0";
                                                                this.DGVTinhCong.Rows[_nhanVien].Cells[15].Value = "0";
                                                            }
                                                            if (iTangCaMuc == 2)
                                                            {
                                                                this.DGVTinhCong.Rows[_nhanVien].Cells[7].Value = "0";
                                                                this.DGVTinhCong.Rows[_nhanVien].Cells[8].Value = "0";
                                                                this.DGVTinhCong.Rows[_nhanVien].Cells[12].Value = "0";
                                                                this.DGVTinhCong.Rows[_nhanVien].Cells[13].Value = dGio.ToString();
                                                                this.DGVTinhCong.Rows[_nhanVien].Cells[14].Value = "0";
                                                                this.DGVTinhCong.Rows[_nhanVien].Cells[15].Value = "0";
                                                            }
                                                            if (iTangCaMuc == 3)
                                                            {
                                                                this.DGVTinhCong.Rows[_nhanVien].Cells[7].Value = "0";
                                                                this.DGVTinhCong.Rows[_nhanVien].Cells[8].Value = "0";
                                                                this.DGVTinhCong.Rows[_nhanVien].Cells[12].Value = "0";
                                                                this.DGVTinhCong.Rows[_nhanVien].Cells[13].Value = "0";
                                                                this.DGVTinhCong.Rows[_nhanVien].Cells[14].Value = dGio.ToString();
                                                                this.DGVTinhCong.Rows[_nhanVien].Cells[15].Value = "0";
                                                            }
                                                            if (iTangCaMuc == 4)
                                                            {
                                                                this.DGVTinhCong.Rows[_nhanVien].Cells[7].Value = "0";
                                                                this.DGVTinhCong.Rows[_nhanVien].Cells[8].Value = "0";
                                                                this.DGVTinhCong.Rows[_nhanVien].Cells[12].Value = "0";
                                                                this.DGVTinhCong.Rows[_nhanVien].Cells[13].Value = "0";
                                                                this.DGVTinhCong.Rows[_nhanVien].Cells[14].Value = "0";
                                                                this.DGVTinhCong.Rows[_nhanVien].Cells[15].Value = dGio.ToString();
                                                            }
                                                        }
                                                        sChoPhepTangCaTruocGioLamViecChonTuMay = dtCaLamViecChonTuMay.Rows[iCaLamViecChonTuMay]["TangCaTruocGioLamViec"].ToString();
                                                        iPhutTangCaTruocGioLamViecChonTuMay = Convert.ToInt32(dtCaLamViecChonTuMay.Rows[iCaLamViecChonTuMay]["SoPhutTangCaTruocGioLamViec"].ToString());
                                                        iPhutTangCaTruocGioLamViecDatDen = Convert.ToInt32(dtCaLamViecChonTuMay.Rows[iCaLamViecChonTuMay]["TangCaTruocGioLamViecDatDen"].ToString());
                                                        iPhutTruTangCaTruoc = Convert.ToInt32(dtCaLamViecChonTuMay.Rows[iCaLamViecChonTuMay]["PhutTruTangCaTruoc"].ToString());
                                                        sChoPhepTangCaSauGioLamViecChonTuMay = dtCaLamViecChonTuMay.Rows[iCaLamViecChonTuMay]["TangCaSauGioLamViec"].ToString();
                                                        iPhutTangCaSauGioLamViecChonTuMay = Convert.ToInt32(dtCaLamViecChonTuMay.Rows[iCaLamViecChonTuMay]["SoPhutTangCaSauGioLamViec"].ToString());
                                                        iPhutTangCaSauGioLamViecDatDen = Convert.ToInt32(dtCaLamViecChonTuMay.Rows[iCaLamViecChonTuMay]["TangCaSauGioLamViecDatDen"].ToString());
                                                        iPhutTruTangCaSau = Convert.ToInt32(dtCaLamViecChonTuMay.Rows[iCaLamViecChonTuMay]["PhutTruTangCaSau"].ToString());
                                                        iGioiHanTC1ChonTuMay = Convert.ToInt32(dtCaLamViecChonTuMay.Rows[iCaLamViecChonTuMay]["GioiHanTangCa1"].ToString());
                                                        iGioiHanTC2ChonTuMay = Convert.ToInt32(dtCaLamViecChonTuMay.Rows[iCaLamViecChonTuMay]["GioiHanTangCa2"].ToString());
                                                        iGioiHanTC3ChonTuMay = Convert.ToInt32(dtCaLamViecChonTuMay.Rows[iCaLamViecChonTuMay]["GioiHanTangCa3"].ToString());
                                                        iGioiHanTC4ChonTuMay = Convert.ToInt32(dtCaLamViecChonTuMay.Rows[iCaLamViecChonTuMay]["GioiHanTangCa4"].ToString());
                                                        iTongGioTangCaSauChonTuMay = 0;
                                                        iTongGioTangCaTruocChonTuMay = 0;
                                                        if ((sChoPhepTangCaTruocGioLamViecChonTuMay != "False" ? true : !(sChoPhepTangCaSauGioLamViecChonTuMay == "False")))
                                                        {
                                                            if (sChoPhepTangCaTruocGioLamViecChonTuMay == "True")
                                                            {
                                                                value = dGioVaoKhaiBaoChonTuMayB - dGioVaoChonTuMay;
                                                                second = Convert.ToInt32(value.TotalMinutes);
                                                                iThoiGianTruocGioLamChonTuMay = Convert.ToInt32(second.ToString());
                                                                if (iThoiGianTruocGioLamChonTuMay > 0)
                                                                {
                                                                    if (iThoiGianTruocGioLamChonTuMay > iPhutTangCaTruocGioLamViecChonTuMay)
                                                                    {
                                                                        if (iThoiGianTruocGioLamChonTuMay > iPhutTangCaTruocGioLamViecDatDen)
                                                                        {
                                                                            iTongGioTangCaTruocChonTuMay = iThoiGianTruocGioLamChonTuMay - iPhutTruTangCaTruoc;
                                                                        }
                                                                    }
                                                                }
                                                            }
                                                            if (sChoPhepTangCaSauGioLamViecChonTuMay == "True")
                                                            {
                                                                value = dGioRaChonTuMay - dGioRaKhaiBaoChonTuMayB;
                                                                second = Convert.ToInt32(value.TotalMinutes);
                                                                iThoiGianSauGioLamViecChonTuMay = Convert.ToInt32(second.ToString());
                                                                if (iThoiGianSauGioLamViecChonTuMay > 0)
                                                                {
                                                                    if (iThoiGianSauGioLamViecChonTuMay > iPhutTangCaSauGioLamViecChonTuMay)
                                                                    {
                                                                        if (iThoiGianSauGioLamViecChonTuMay > iPhutTangCaSauGioLamViecDatDen)
                                                                        {
                                                                            iTongGioTangCaSauChonTuMay = iThoiGianSauGioLamViecChonTuMay - iPhutTruTangCaSau;
                                                                        }
                                                                    }
                                                                }
                                                            }
                                                        }
                                                        else
                                                        {
                                                            this.DGVTinhCong.Rows[_nhanVien].Cells[12].Value = "0";
                                                            this.DGVTinhCong.Rows[_nhanVien].Cells[13].Value = "0";
                                                            this.DGVTinhCong.Rows[_nhanVien].Cells[14].Value = "0";
                                                            this.DGVTinhCong.Rows[_nhanVien].Cells[15].Value = "0";
                                                        }
                                                        dTongThoiGianTangCaChonTuMay = Convert.ToDouble(iTongGioTangCaTruocChonTuMay + iTongGioTangCaSauChonTuMay);
                                                        if (dTongThoiGianTangCaChonTuMay <= 0)
                                                        {
                                                            this.DGVTinhCong.Rows[_nhanVien].Cells[12].Value = "0";
                                                            this.DGVTinhCong.Rows[_nhanVien].Cells[13].Value = "0";
                                                            this.DGVTinhCong.Rows[_nhanVien].Cells[14].Value = "0";
                                                            this.DGVTinhCong.Rows[_nhanVien].Cells[15].Value = "0";
                                                        }
                                                        else
                                                        {
                                                            if (iGioiHanTC1ChonTuMay == 0)
                                                            {
                                                                this.DGVTinhCong.Rows[_nhanVien].Cells[12].Value = Math.Round(dTongThoiGianTangCaChonTuMay * this.dTangCa1HeSo / 60, this.iLamTronGio);
                                                                this.DGVTinhCong.Rows[_nhanVien].Cells[13].Value = "0";
                                                                this.DGVTinhCong.Rows[_nhanVien].Cells[14].Value = "0";
                                                                this.DGVTinhCong.Rows[_nhanVien].Cells[15].Value = "0";
                                                            }
                                                            if ((iGioiHanTC1ChonTuMay == 0 ? false : iGioiHanTC2ChonTuMay == 0))
                                                            {
                                                                if (dTongThoiGianTangCaChonTuMay >= Convert.ToDouble(iGioiHanTC1ChonTuMay))
                                                                {
                                                                    this.DGVTinhCong.Rows[_nhanVien].Cells[12].Value = Math.Round(Convert.ToDouble(iGioiHanTC1ChonTuMay) / 60 * this.dTangCa1HeSo, this.iLamTronGio);
                                                                    if (dTongThoiGianTangCaChonTuMay - Convert.ToDouble(iGioiHanTC1ChonTuMay) > 0)
                                                                    {
                                                                        this.DGVTinhCong.Rows[_nhanVien].Cells[13].Value = Math.Round((dTongThoiGianTangCaChonTuMay - Convert.ToDouble(iGioiHanTC1ChonTuMay)) * this.dTangCa2HeSo / 60, this.iLamTronGio);
                                                                    }
                                                                    this.DGVTinhCong.Rows[_nhanVien].Cells[14].Value = "0";
                                                                    this.DGVTinhCong.Rows[_nhanVien].Cells[15].Value = "0";
                                                                }
                                                                else
                                                                {
                                                                    this.DGVTinhCong.Rows[_nhanVien].Cells[12].Value = Math.Round(dTongThoiGianTangCaChonTuMay * this.dTangCa1HeSo / 60, this.iLamTronGio);
                                                                    this.DGVTinhCong.Rows[_nhanVien].Cells[13].Value = "0";
                                                                    this.DGVTinhCong.Rows[_nhanVien].Cells[14].Value = "0";
                                                                    this.DGVTinhCong.Rows[_nhanVien].Cells[15].Value = "0";
                                                                }
                                                            }
                                                            if ((iGioiHanTC1ChonTuMay == 0 || iGioiHanTC2ChonTuMay == 0 ? false : iGioiHanTC3ChonTuMay == 0))
                                                            {
                                                                if (dTongThoiGianTangCaChonTuMay >= Convert.ToDouble(iGioiHanTC1ChonTuMay))
                                                                {
                                                                    this.DGVTinhCong.Rows[_nhanVien].Cells[12].Value = Math.Round(Convert.ToDouble(iGioiHanTC1ChonTuMay) * this.dTangCa1HeSo / 60, this.iLamTronGio);
                                                                    if (dTongThoiGianTangCaChonTuMay - Convert.ToDouble(iGioiHanTC1ChonTuMay) >= Convert.ToDouble(iGioiHanTC2ChonTuMay))
                                                                    {
                                                                        this.DGVTinhCong.Rows[_nhanVien].Cells[12].Value = Math.Round(Convert.ToDouble(iGioiHanTC1ChonTuMay) * this.dTangCa1HeSo / 60, this.iLamTronGio);
                                                                        this.DGVTinhCong.Rows[_nhanVien].Cells[13].Value = Math.Round(Convert.ToDouble(iGioiHanTC2ChonTuMay) * this.dTangCa2HeSo / 60, this.iLamTronGio);
                                                                        this.DGVTinhCong.Rows[_nhanVien].Cells[14].Value = Math.Round((dTongThoiGianTangCaChonTuMay - Convert.ToDouble(iGioiHanTC1ChonTuMay) - Convert.ToDouble(iGioiHanTC2ChonTuMay)) * this.dTangCa3HeSo / 60, this.iLamTronGio);
                                                                        this.DGVTinhCong.Rows[_nhanVien].Cells[15].Value = "0";
                                                                    }
                                                                    else
                                                                    {
                                                                        this.DGVTinhCong.Rows[_nhanVien].Cells[13].Value = Math.Round((dTongThoiGianTangCaChonTuMay - Convert.ToDouble(iGioiHanTC1ChonTuMay)) * this.dTangCa2HeSo / 60, this.iLamTronGio);
                                                                        this.DGVTinhCong.Rows[_nhanVien].Cells[14].Value = "0";
                                                                        this.DGVTinhCong.Rows[_nhanVien].Cells[15].Value = "0";
                                                                    }
                                                                }
                                                                else
                                                                {
                                                                    this.DGVTinhCong.Rows[_nhanVien].Cells[12].Value = Math.Round(dTongThoiGianTangCaChonTuMay * this.dTangCa1HeSo / 60, this.iLamTronGio);
                                                                    this.DGVTinhCong.Rows[_nhanVien].Cells[13].Value = "0";
                                                                    this.DGVTinhCong.Rows[_nhanVien].Cells[14].Value = "0";
                                                                    this.DGVTinhCong.Rows[_nhanVien].Cells[15].Value = "0";
                                                                }
                                                            }
                                                            if ((iGioiHanTC1ChonTuMay == 0 || iGioiHanTC2ChonTuMay == 0 || iGioiHanTC3ChonTuMay == 0 ? false : iGioiHanTC4ChonTuMay == 0))
                                                            {
                                                            }
                                                        }
                                                        value = dGioRaChonTuMay - dGioVaoChonTuMay;
                                                        second = Convert.ToInt32(value.TotalMinutes);
                                                        num = Math.Round(Convert.ToDouble(second.ToString()) / 60, this.iLamTronGio);
                                                        sTongGio = num.ToString();
                                                        this.DGVTinhCong.Rows[_nhanVien].Cells[16].Value = sTongGio;
                                                        this.DGVTinhCong.Rows[_nhanVien].Cells[17].Value = dtCaLamViecChonTuMay.Rows[iCaLamViecChonTuMay]["CongTinh"].ToString();
                                                        this.DGVTinhCong.Rows[_nhanVien].Cells[18].Value = this.sKHDungGio;
                                                        if (!(DateTimeProgress.XuatIDThu((int)dt.AddDays((double)dem).DayOfWeek) == "0"))
                                                        {
                                                            this.DGVTinhCong.Rows[_nhanVien].Cells[19].Value = "NT";
                                                        }
                                                        else
                                                        {
                                                            this.DGVTinhCong.Rows[_nhanVien].Cells[19].Value = "CN";
                                                        }
                                                        this.DGVTinhCong.Rows[_nhanVien].Cells[20].Value = this.sMaChamCong;
                                                        this.DGVTinhCong.Rows[_nhanVien].Cells[21].Value = this.sPhongBanTinhCong;
                                                    }
                                                }
                                           // Label4:
                                            }
                                            else if (_nhanVien == 0)
                                            {
                                                dGioRaChonTuMay = Convert.ToDateTime(dateGioChamChonTuMay.ToString());
                                                this.DGVTinhCong.Rows[_nhanVien].Cells[6].Value = string.Format(this.sDinhDangThoiGian, dGioRaChonTuMay);
                                                this.DGVTinhCong.Rows[addChonTuMay].Cells[18].Value = this.sKHVang;
                                                if (!(DateTimeProgress.XuatIDThu((int)dt.AddDays((double)dem).DayOfWeek) == "0"))
                                                {
                                                    this.DGVTinhCong.Rows[addChonTuMay].Cells[19].Value = "NT";
                                                }
                                                else
                                                {
                                                    this.DGVTinhCong.Rows[addChonTuMay].Cells[19].Value = "CN";
                                                }
                                                this.DGVTinhCong.Rows[addChonTuMay].Cells[20].Value = this.sMaChamCong;
                                                this.DGVTinhCong.Rows[addChonTuMay].Cells[21].Value = this.sPhongBanTinhCong;
                                                iLanCham++;
                                            }
                                            else if ((this.DGVTinhCong.Rows[_nhanVien - 1].Cells[5].Value == null ? true : this.DGVTinhCong.Rows[_nhanVien - 1].Cells[6].Value != null))
                                            {
                                                dGioRaChonTuMay = Convert.ToDateTime(dateGioChamChonTuMay.ToString());
                                                this.DGVTinhCong.Rows[_nhanVien].Cells[6].Value = string.Format(this.sDinhDangThoiGian, dGioRaChonTuMay);
                                                iLanCham++;
                                                dtNhanCaChonTuMay = new System.Data.DataTable();
                                                this._chiTietLichTrinhChoCalamViecDTO.MaLichTrinhCaLamViec = sLTCCLVNhanVien;
                                                this._chiTietLichTrinhChoCalamViecDTO.Thu = sThu;
                                                dtNhanCaChonTuMay = this._chiTietLichTrinhChoCaLamViecBLL.ChiTietLichTrinhChoCaLamViecNhanCa(this._chiTietLichTrinhChoCalamViecDTO);
                                                iChiTietLichTrinhChoCaLamViecChonTuMay = 0;
                                                if (iChiTietLichTrinhChoCaLamViecChonTuMay < dtNhanCaChonTuMay.Rows.Count)
                                                {
                                                    cellChiTietLichTrinhChoCaLamViecChonTuMay = 3;
                                                    while (cellChiTietLichTrinhChoCaLamViecChonTuMay < 13)
                                                    {
                                                        kiemTraVao = 0;
                                                        kiemTraRa = 0;
                                                        this.sChonTuMayMaCaLamViec = dtNhanCaChonTuMay.Rows[iChiTietLichTrinhChoCaLamViecChonTuMay][cellChiTietLichTrinhChoCaLamViecChonTuMay].ToString();
                                                        dtChonTuMayCa1 = new System.Data.DataTable();
                                                        this._caLamViecDTO.MaCaLamViec = this.sChonTuMayMaCaLamViec;
                                                        dtChonTuMayCa1 = this._caLamViecBLL.CaLamViecGetByMaCaLamViec(this._caLamViecDTO);
                                                        iChonTuMayCa1 = 0;
                                                        while (iChonTuMayCa1 < dtChonTuMayCa1.Rows.Count)
                                                        {
                                                            this.sChonTuMayTenCaLamViec = dtChonTuMayCa1.Rows[iChonTuMayCa1]["CaLamViec"].ToString();
                                                            dBatDauVaoChonTuMayA = Convert.ToDateTime(dtChonTuMayCa1.Rows[iChonTuMayCa1]["BatDauVao"].ToString());
                                                            sBatDauVaoChonTuMayA = string.Format("{0:T}", dBatDauVaoChonTuMayA);
                                                            sBatDauVaoChonTuMayB = string.Concat(sNgayCham, " ", sBatDauVaoChonTuMayA);
                                                            dBatDauVaoChonTuMayB = Convert.ToDateTime(sBatDauVaoChonTuMayB);
                                                            dKetThucVaoChonTuMayA = Convert.ToDateTime(dtChonTuMayCa1.Rows[iChonTuMayCa1]["KetThucVao"].ToString());
                                                            sKetThucVaoChonTuMayA = string.Format("{0:T}", dKetThucVaoChonTuMayA);
                                                            sKetThucVaoChonTuMayB = string.Concat(sNgayCham, " ", sKetThucVaoChonTuMayA);
                                                            dKetThucVaoChonTuMayB = Convert.ToDateTime(sKetThucVaoChonTuMayB);
                                                            dBatDauRaChonTuMayA = Convert.ToDateTime(dtChonTuMayCa1.Rows[iChonTuMayCa1]["BatDauRa"].ToString());
                                                            sBatDauRaChonTuMayA = string.Format("{0:T}", dBatDauRaChonTuMayA);
                                                            sBatDauRaChonTuMayB = string.Concat(sNgayCham, " ", sBatDauRaChonTuMayA);
                                                            dBatDauRaChonTuMayB = Convert.ToDateTime(sBatDauRaChonTuMayB);
                                                            if (!(sBatDauRaChonTuMayB == "12:01:00 AM"))
                                                            {
                                                                dBatDauRaChonTuMayB = Convert.ToDateTime(dBatDauRaChonTuMayB);
                                                            }
                                                            else
                                                            {
                                                                dateTime = dBatDauRaChonTuMayB.AddDays(1);
                                                                dBatDauRaChonTuMayB = Convert.ToDateTime(dateTime.ToString());
                                                            }
                                                            dKetThucRaChonTuMayA = Convert.ToDateTime(dtChonTuMayCa1.Rows[iChonTuMayCa1]["KetThucRa"].ToString());
                                                            sKetThucRaChonTuMayA = string.Format("{0:T}", dKetThucRaChonTuMayA);
                                                            sKetThucRaChonTuMayB = string.Concat(sNgayCham, " ", sKetThucRaChonTuMayA);
                                                            dKetThucRaChonTuMayB = Convert.ToDateTime(sKetThucRaChonTuMayB);
                                                            if (!(sKetThucRaChonTuMayA == "12:01:00 AM"))
                                                            {
                                                                dKetThucRaChonTuMayB = Convert.ToDateTime(dKetThucRaChonTuMayB);
                                                            }
                                                            else
                                                            {
                                                                dateTime = dKetThucRaChonTuMayB.AddDays(1);
                                                                dKetThucRaChonTuMayB = Convert.ToDateTime(dateTime.ToString());
                                                            }
                                                            if ((dGioVaoChonTuMay < dBatDauVaoChonTuMayB ? false : dGioVaoChonTuMay <= dKetThucVaoChonTuMayB))
                                                            {
                                                                kiemTraVao++;
                                                            }
                                                            if ((dGioRaChonTuMay < dBatDauRaChonTuMayB ? false : dGioRaChonTuMay <= dKetThucRaChonTuMayB))
                                                            {
                                                                kiemTraRa++;
                                                            }
                                                            if ((kiemTraVao != 1 ? true : kiemTraRa != 1))
                                                            {
                                                                iChonTuMayCa1++;
                                                            }
                                                            else
                                                            {
                                                                goto Label7;
                                                            }
                                                        }
                                                        if (!(this.sChonTuMayMaCaLamViec == ""))
                                                        {
                                                            cellChiTietLichTrinhChoCaLamViecChonTuMay++;
                                                        }
                                                        else
                                                        {
                                                            this.DGVTinhCong.Rows[_nhanVien].Cells[4].Value = "***";
                                                            this.DGVTinhCong.Rows[_nhanVien].Cells[7].Value = "0";
                                                            this.DGVTinhCong.Rows[_nhanVien].Cells[8].Value = "0";
                                                            this.DGVTinhCong.Rows[_nhanVien].Cells[9].Value = "0";
                                                            this.DGVTinhCong.Rows[_nhanVien].Cells[10].Value = "0";
                                                            this.DGVTinhCong.Rows[_nhanVien].Cells[11].Value = "0";
                                                            this.DGVTinhCong.Rows[_nhanVien].Cells[12].Value = "0";
                                                            this.DGVTinhCong.Rows[_nhanVien].Cells[13].Value = "0";
                                                            this.DGVTinhCong.Rows[_nhanVien].Cells[14].Value = "0";
                                                            this.DGVTinhCong.Rows[_nhanVien].Cells[15].Value = "0";
                                                            this.DGVTinhCong.Rows[_nhanVien].Cells[16].Value = "0";
                                                            this.DGVTinhCong.Rows[_nhanVien].Cells[17].Value = "0";
                                                            this.DGVTinhCong.Rows[_nhanVien].Cells[18].Value = this.sKHVang;
                                                            if (!(DateTimeProgress.XuatIDThu((int)dt.AddDays((double)dem).DayOfWeek) == "0"))
                                                            {
                                                                this.DGVTinhCong.Rows[_nhanVien].Cells[19].Value = "NT";
                                                            }
                                                            else
                                                            {
                                                                this.DGVTinhCong.Rows[_nhanVien].Cells[19].Value = "CN";
                                                            }
                                                            this.DGVTinhCong.Rows[_nhanVien].Cells[20].Value = this.sMaChamCong;
                                                            this.DGVTinhCong.Rows[_nhanVien].Cells[21].Value = this.sPhongBanTinhCong;
                                                           // goto Label6;
                                                        }
                                                    }
                                                Label7:
                                                    this.DGVTinhCong.Rows[_nhanVien].Cells[4].Value = this.sChonTuMayTenCaLamViec;
                                                    dtCaLamViecChonTuMay = new System.Data.DataTable();
                                                    this._caLamViecDTO.MaCaLamViec = this.sChonTuMayMaCaLamViec;
                                                    dtCaLamViecChonTuMay = this._caLamViecBLL.CaLamViecGetByMaCaLamViec(this._caLamViecDTO);
                                                    for (iCaLamViecChonTuMay = 0; iCaLamViecChonTuMay < dtCaLamViecChonTuMay.Rows.Count; iCaLamViecChonTuMay++)
                                                    {
                                                        second = dGioVaoChonTuMay.Second;
                                                        sGiayGioVao = second.ToString();
                                                        second = dGioRaChonTuMay.Second;
                                                        sGiayGioRa = second.ToString();
                                                        dGioVaoKhaiBaoChonTuMayA = Convert.ToDateTime(dtCaLamViecChonTuMay.Rows[iCaLamViecChonTuMay]["GioVaoLamViec"].ToString());
                                                        sGioVaoKhaiBaoChonTuMayA = string.Format("{0:T}", dGioVaoKhaiBaoChonTuMayA).Replace("00 ", string.Concat(sGiayGioVao, " "));
                                                        sGioVaoKhaiBaoChonTuMayB = string.Concat(sNgayCham, " ", sGioVaoKhaiBaoChonTuMayA);
                                                        dGioVaoKhaiBaoChonTuMayB = Convert.ToDateTime(sGioVaoKhaiBaoChonTuMayB);
                                                        dGioRaKhaiBaoChonTuMayA = Convert.ToDateTime(dtCaLamViecChonTuMay.Rows[iCaLamViecChonTuMay]["GioKetThucLamViec"].ToString());
                                                        sGioRaKhaiBaoChonTuMayA = string.Format("{0:T}", dGioRaKhaiBaoChonTuMayA).Replace("00 ", string.Concat(sGiayGioRa, " "));
                                                        sGioRaKhaiBaoChonTuMayB = string.Concat(sNgayCham, " ", sGioRaKhaiBaoChonTuMayA);
                                                        dGioRaKhaiBaoChonTuMayB = Convert.ToDateTime(sGioRaKhaiBaoChonTuMayB);
                                                        sTruGioDiTre = dtCaLamViecChonTuMay.Rows[iCaLamViecChonTuMay]["TruGioDiTre"].ToString();
                                                        sBatDauTinhDiTre = dtCaLamViecChonTuMay.Rows[iCaLamViecChonTuMay]["BatDauTinhDiTre"].ToString();
                                                        iChoPhepDiTre = Convert.ToInt32(dtCaLamViecChonTuMay.Rows[iCaLamViecChonTuMay]["ChoPhepDiTre"].ToString());
                                                        value = dGioVaoChonTuMay - dGioVaoKhaiBaoChonTuMayB;
                                                        second = Convert.ToInt32(value.TotalMinutes);
                                                        sPhutTre = second.ToString();
                                                        if (!(sTruGioDiTre == "True"))
                                                        {
                                                            this.DGVTinhCong.Rows[_nhanVien].Cells[9].Value = "0";
                                                        }
                                                        else if (Convert.ToInt32(sPhutTre) >= 0)
                                                        {
                                                            iPhutTre = Convert.ToInt32(sPhutTre) - iChoPhepDiTre;
                                                            if (sBatDauTinhDiTre == "True")
                                                            {
                                                                if (iPhutTre >= 1)
                                                                {
                                                                    this.DGVTinhCong.Rows[_nhanVien].Cells[9].Value = iPhutTre.ToString();
                                                                }
                                                                else
                                                                {
                                                                    this.DGVTinhCong.Rows[_nhanVien].Cells[9].Value = "0";
                                                                }
                                                            }
                                                            else if (iPhutTre >= 1)
                                                            {
                                                                this.DGVTinhCong.Rows[_nhanVien].Cells[9].Value = sPhutTre;
                                                            }
                                                            else
                                                            {
                                                                this.DGVTinhCong.Rows[_nhanVien].Cells[9].Value = "0";
                                                            }
                                                        }
                                                        else
                                                        {
                                                            this.DGVTinhCong.Rows[_nhanVien].Cells[9].Value = "0";
                                                        }
                                                        sTruGioVeSom = dtCaLamViecChonTuMay.Rows[iCaLamViecChonTuMay]["TruGioVeSom"].ToString();
                                                        sBatDauTinhVeSom = dtCaLamViecChonTuMay.Rows[iCaLamViecChonTuMay]["BatDauTinhVeSom"].ToString();
                                                        iChoPhepVeSom = Convert.ToInt32(dtCaLamViecChonTuMay.Rows[iCaLamViecChonTuMay]["ChoPhepVeSom"].ToString());
                                                        value = dGioRaKhaiBaoChonTuMayB - dGioRaChonTuMay;
                                                        second = Convert.ToInt32(value.TotalMinutes);
                                                        sPhutVeSom = second.ToString();
                                                        if (!(sTruGioVeSom == "True"))
                                                        {
                                                            this.DGVTinhCong.Rows[_nhanVien].Cells[10].Value = "0";
                                                        }
                                                        else if (Convert.ToInt32(sPhutVeSom) >= 0)
                                                        {
                                                            iPhutVeSom = Convert.ToInt32(sPhutVeSom) - iChoPhepVeSom;
                                                            if (iPhutVeSom < 1)
                                                            {
                                                                this.DGVTinhCong.Rows[_nhanVien].Cells[10].Value = "0";
                                                            }
                                                            else if (!(sBatDauTinhVeSom == "True"))
                                                            {
                                                                this.DGVTinhCong.Rows[_nhanVien].Cells[10].Value = sPhutVeSom;
                                                            }
                                                            else
                                                            {
                                                                this.DGVTinhCong.Rows[_nhanVien].Cells[10].Value = iPhutVeSom.ToString();
                                                            }
                                                        }
                                                        else
                                                        {
                                                            this.DGVTinhCong.Rows[_nhanVien].Cells[10].Value = "0";
                                                        }
                                                        value = dGioRaChonTuMay - dGioRaKhaiBaoChonTuMayB;
                                                        second = Convert.ToInt32(value.TotalMinutes);
                                                        sVeTre = second.ToString();
                                                        if (Convert.ToInt32(sVeTre) <= 0)
                                                        {
                                                            this.DGVTinhCong.Rows[_nhanVien].Cells[11].Value = "0";
                                                        }
                                                        else
                                                        {
                                                            this.DGVTinhCong.Rows[_nhanVien].Cells[11].Value = sVeTre;
                                                        }
                                                        iPhut = Convert.ToSingle(dtCaLamViecChonTuMay.Rows[iCaLamViecChonTuMay]["TongGioTrongCaLamViec"]) * 60f - (float)(Convert.ToInt32(this.DGVTinhCong.Rows[_nhanVien].Cells[9].Value.ToString()) + Convert.ToInt32(this.DGVTinhCong.Rows[_nhanVien].Cells[10].Value));
                                                        dGio = Math.Round(Convert.ToDouble(iPhut) / 60, this.iLamTronGio);
                                                        this.DGVTinhCong.Rows[_nhanVien].Cells[8].Value = dGio.ToString();
                                                        iGio = Convert.ToDouble(dtCaLamViecChonTuMay.Rows[iCaLamViecChonTuMay]["TongGioTrongCaLamViec"].ToString());
                                                        dCongTinh = Convert.ToDouble(dtCaLamViecChonTuMay.Rows[iCaLamViecChonTuMay]["CongTinh"].ToString());
                                                        dCong = Math.Round(dGio * dCongTinh / iGio, this.iLamTronCong);
                                                        this.DGVTinhCong.Rows[_nhanVien].Cells[7].Value = dCong.ToString();
                                                        sTangCaTruocGioLamViec = dtCaLamViecChonTuMay.Rows[iCaLamViecChonTuMay]["TangCaTruocGioLamViec"].ToString();
                                                        sTangCaSauGioLamViec = dtCaLamViecChonTuMay.Rows[iCaLamViecChonTuMay]["TangCaSauGioLamViec"].ToString();
                                                        if ((sTangCaTruocGioLamViec != "False" ? false : sTangCaSauGioLamViec == "False"))
                                                        {
                                                            this.DGVTinhCong.Rows[_nhanVien].Cells[12].Value = "0";
                                                            this.DGVTinhCong.Rows[_nhanVien].Cells[13].Value = "0";
                                                            this.DGVTinhCong.Rows[_nhanVien].Cells[14].Value = "0";
                                                            this.DGVTinhCong.Rows[_nhanVien].Cells[15].Value = "0";
                                                        }
                                                        sXemCaNayLaTangCa = dtCaLamViecChonTuMay.Rows[iCaLamViecChonTuMay]["XemCaNayLaTangCa"].ToString();
                                                        iTangCaMuc = Convert.ToInt32(dtCaLamViecChonTuMay.Rows[iCaLamViecChonTuMay]["TangCaMuc"].ToString());
                                                        if (sXemCaNayLaTangCa == "True")
                                                        {
                                                            if (iTangCaMuc == 1)
                                                            {
                                                                this.DGVTinhCong.Rows[_nhanVien].Cells[7].Value = "0";
                                                                this.DGVTinhCong.Rows[_nhanVien].Cells[8].Value = "0";
                                                                this.DGVTinhCong.Rows[_nhanVien].Cells[12].Value = dGio.ToString();
                                                                this.DGVTinhCong.Rows[_nhanVien].Cells[13].Value = "0";
                                                                this.DGVTinhCong.Rows[_nhanVien].Cells[14].Value = "0";
                                                                this.DGVTinhCong.Rows[_nhanVien].Cells[15].Value = "0";
                                                            }
                                                            if (iTangCaMuc == 2)
                                                            {
                                                                this.DGVTinhCong.Rows[_nhanVien].Cells[7].Value = "0";
                                                                this.DGVTinhCong.Rows[_nhanVien].Cells[8].Value = "0";
                                                                this.DGVTinhCong.Rows[_nhanVien].Cells[12].Value = "0";
                                                                this.DGVTinhCong.Rows[_nhanVien].Cells[13].Value = dGio.ToString();
                                                                this.DGVTinhCong.Rows[_nhanVien].Cells[14].Value = "0";
                                                                this.DGVTinhCong.Rows[_nhanVien].Cells[15].Value = "0";
                                                            }
                                                            if (iTangCaMuc == 3)
                                                            {
                                                                this.DGVTinhCong.Rows[_nhanVien].Cells[7].Value = "0";
                                                                this.DGVTinhCong.Rows[_nhanVien].Cells[8].Value = "0";
                                                                this.DGVTinhCong.Rows[_nhanVien].Cells[12].Value = "0";
                                                                this.DGVTinhCong.Rows[_nhanVien].Cells[13].Value = "0";
                                                                this.DGVTinhCong.Rows[_nhanVien].Cells[14].Value = dGio.ToString();
                                                                this.DGVTinhCong.Rows[_nhanVien].Cells[15].Value = "0";
                                                            }
                                                            if (iTangCaMuc == 4)
                                                            {
                                                                this.DGVTinhCong.Rows[_nhanVien].Cells[7].Value = "0";
                                                                this.DGVTinhCong.Rows[_nhanVien].Cells[8].Value = "0";
                                                                this.DGVTinhCong.Rows[_nhanVien].Cells[12].Value = "0";
                                                                this.DGVTinhCong.Rows[_nhanVien].Cells[13].Value = "0";
                                                                this.DGVTinhCong.Rows[_nhanVien].Cells[14].Value = "0";
                                                                this.DGVTinhCong.Rows[_nhanVien].Cells[15].Value = dGio.ToString();
                                                            }
                                                        }
                                                        sChoPhepTangCaTruocGioLamViecChonTuMay = dtCaLamViecChonTuMay.Rows[iCaLamViecChonTuMay]["TangCaTruocGioLamViec"].ToString();
                                                        iPhutTangCaTruocGioLamViecChonTuMay = Convert.ToInt32(dtCaLamViecChonTuMay.Rows[iCaLamViecChonTuMay]["SoPhutTangCaTruocGioLamViec"].ToString());
                                                        iPhutTangCaTruocGioLamViecDatDen = Convert.ToInt32(dtCaLamViecChonTuMay.Rows[iCaLamViecChonTuMay]["TangCaTruocGioLamViecDatDen"].ToString());
                                                        iPhutTruTangCaTruoc = Convert.ToInt32(dtCaLamViecChonTuMay.Rows[iCaLamViecChonTuMay]["PhutTruTangCaTruoc"].ToString());
                                                        sChoPhepTangCaSauGioLamViecChonTuMay = dtCaLamViecChonTuMay.Rows[iCaLamViecChonTuMay]["TangCaSauGioLamViec"].ToString();
                                                        iPhutTangCaSauGioLamViecChonTuMay = Convert.ToInt32(dtCaLamViecChonTuMay.Rows[iCaLamViecChonTuMay]["SoPhutTangCaSauGioLamViec"].ToString());
                                                        iPhutTangCaSauGioLamViecDatDen = Convert.ToInt32(dtCaLamViecChonTuMay.Rows[iCaLamViecChonTuMay]["TangCaSauGioLamViecDatDen"].ToString());
                                                        iPhutTruTangCaSau = Convert.ToInt32(dtCaLamViecChonTuMay.Rows[iCaLamViecChonTuMay]["PhutTruTangCaSau"].ToString());
                                                        iGioiHanTC1ChonTuMay = Convert.ToInt32(dtCaLamViecChonTuMay.Rows[iCaLamViecChonTuMay]["GioiHanTangCa1"].ToString());
                                                        iGioiHanTC2ChonTuMay = Convert.ToInt32(dtCaLamViecChonTuMay.Rows[iCaLamViecChonTuMay]["GioiHanTangCa2"].ToString());
                                                        iGioiHanTC3ChonTuMay = Convert.ToInt32(dtCaLamViecChonTuMay.Rows[iCaLamViecChonTuMay]["GioiHanTangCa3"].ToString());
                                                        iGioiHanTC4ChonTuMay = Convert.ToInt32(dtCaLamViecChonTuMay.Rows[iCaLamViecChonTuMay]["GioiHanTangCa4"].ToString());
                                                        iTongGioTangCaSauChonTuMay = 0;
                                                        iTongGioTangCaTruocChonTuMay = 0;
                                                        if ((sChoPhepTangCaTruocGioLamViecChonTuMay != "False" ? true : !(sChoPhepTangCaSauGioLamViecChonTuMay == "False")))
                                                        {
                                                            if (sChoPhepTangCaTruocGioLamViecChonTuMay == "True")
                                                            {
                                                                value = dGioVaoKhaiBaoChonTuMayB - dGioVaoChonTuMay;
                                                                second = Convert.ToInt32(value.TotalMinutes);
                                                                iThoiGianTruocGioLamChonTuMay = Convert.ToInt32(second.ToString());
                                                                if (iThoiGianTruocGioLamChonTuMay > 0)
                                                                {
                                                                    if (iThoiGianTruocGioLamChonTuMay > iPhutTangCaTruocGioLamViecChonTuMay)
                                                                    {
                                                                        if (iThoiGianTruocGioLamChonTuMay > iPhutTangCaTruocGioLamViecDatDen)
                                                                        {
                                                                            iTongGioTangCaTruocChonTuMay = iThoiGianTruocGioLamChonTuMay - iPhutTruTangCaTruoc;
                                                                        }
                                                                    }
                                                                }
                                                            }
                                                            if (sChoPhepTangCaSauGioLamViecChonTuMay == "True")
                                                            {
                                                                value = dGioRaChonTuMay - dGioRaKhaiBaoChonTuMayB;
                                                                second = Convert.ToInt32(value.TotalMinutes);
                                                                iThoiGianSauGioLamViecChonTuMay = Convert.ToInt32(second.ToString());
                                                                if (iThoiGianSauGioLamViecChonTuMay > 0)
                                                                {
                                                                    if (iThoiGianSauGioLamViecChonTuMay > iPhutTangCaSauGioLamViecChonTuMay)
                                                                    {
                                                                        if (iThoiGianSauGioLamViecChonTuMay > iPhutTangCaSauGioLamViecDatDen)
                                                                        {
                                                                            iTongGioTangCaSauChonTuMay = iThoiGianSauGioLamViecChonTuMay - iPhutTruTangCaSau;
                                                                        }
                                                                    }
                                                                }
                                                            }
                                                        }
                                                        else
                                                        {
                                                            this.DGVTinhCong.Rows[_nhanVien].Cells[12].Value = "0";
                                                            this.DGVTinhCong.Rows[_nhanVien].Cells[13].Value = "0";
                                                            this.DGVTinhCong.Rows[_nhanVien].Cells[14].Value = "0";
                                                            this.DGVTinhCong.Rows[_nhanVien].Cells[15].Value = "0";
                                                        }
                                                        dTongThoiGianTangCaChonTuMay = Convert.ToDouble(iTongGioTangCaTruocChonTuMay + iTongGioTangCaSauChonTuMay);
                                                        if (dTongThoiGianTangCaChonTuMay <= 0)
                                                        {
                                                            this.DGVTinhCong.Rows[_nhanVien].Cells[12].Value = "0";
                                                            this.DGVTinhCong.Rows[_nhanVien].Cells[13].Value = "0";
                                                            this.DGVTinhCong.Rows[_nhanVien].Cells[14].Value = "0";
                                                            this.DGVTinhCong.Rows[_nhanVien].Cells[15].Value = "0";
                                                        }
                                                        else
                                                        {
                                                            if (iGioiHanTC1ChonTuMay == 0)
                                                            {
                                                                this.DGVTinhCong.Rows[_nhanVien].Cells[12].Value = Math.Round(dTongThoiGianTangCaChonTuMay * this.dTangCa1HeSo / 60, this.iLamTronGio);
                                                                this.DGVTinhCong.Rows[_nhanVien].Cells[13].Value = "0";
                                                                this.DGVTinhCong.Rows[_nhanVien].Cells[14].Value = "0";
                                                                this.DGVTinhCong.Rows[_nhanVien].Cells[15].Value = "0";
                                                            }
                                                            if ((iGioiHanTC1ChonTuMay == 0 ? false : iGioiHanTC2ChonTuMay == 0))
                                                            {
                                                                if (dTongThoiGianTangCaChonTuMay >= Convert.ToDouble(iGioiHanTC1ChonTuMay))
                                                                {
                                                                    this.DGVTinhCong.Rows[_nhanVien].Cells[12].Value = Math.Round(Convert.ToDouble(iGioiHanTC1ChonTuMay) / 60 * this.dTangCa1HeSo, this.iLamTronGio);
                                                                    if (dTongThoiGianTangCaChonTuMay - Convert.ToDouble(iGioiHanTC1ChonTuMay) > 0)
                                                                    {
                                                                        this.DGVTinhCong.Rows[_nhanVien].Cells[13].Value = Math.Round((dTongThoiGianTangCaChonTuMay - Convert.ToDouble(iGioiHanTC1ChonTuMay)) * this.dTangCa2HeSo / 60, this.iLamTronGio);
                                                                    }
                                                                    this.DGVTinhCong.Rows[_nhanVien].Cells[14].Value = "0";
                                                                    this.DGVTinhCong.Rows[_nhanVien].Cells[15].Value = "0";
                                                                }
                                                                else
                                                                {
                                                                    this.DGVTinhCong.Rows[_nhanVien].Cells[12].Value = Math.Round(dTongThoiGianTangCaChonTuMay * this.dTangCa1HeSo / 60, this.iLamTronGio);
                                                                    this.DGVTinhCong.Rows[_nhanVien].Cells[13].Value = "0";
                                                                    this.DGVTinhCong.Rows[_nhanVien].Cells[14].Value = "0";
                                                                    this.DGVTinhCong.Rows[_nhanVien].Cells[15].Value = "0";
                                                                }
                                                            }
                                                            if ((iGioiHanTC1ChonTuMay == 0 || iGioiHanTC2ChonTuMay == 0 ? false : iGioiHanTC3ChonTuMay == 0))
                                                            {
                                                                if (dTongThoiGianTangCaChonTuMay >= Convert.ToDouble(iGioiHanTC1ChonTuMay))
                                                                {
                                                                    this.DGVTinhCong.Rows[_nhanVien].Cells[12].Value = Math.Round(Convert.ToDouble(iGioiHanTC1ChonTuMay) * this.dTangCa1HeSo / 60, this.iLamTronGio);
                                                                    if (dTongThoiGianTangCaChonTuMay - Convert.ToDouble(iGioiHanTC1ChonTuMay) >= Convert.ToDouble(iGioiHanTC2ChonTuMay))
                                                                    {
                                                                        this.DGVTinhCong.Rows[_nhanVien].Cells[12].Value = Math.Round(Convert.ToDouble(iGioiHanTC1ChonTuMay) * this.dTangCa1HeSo / 60, this.iLamTronGio);
                                                                        this.DGVTinhCong.Rows[_nhanVien].Cells[13].Value = Math.Round(Convert.ToDouble(iGioiHanTC2ChonTuMay) * this.dTangCa2HeSo / 60, this.iLamTronGio);
                                                                        this.DGVTinhCong.Rows[_nhanVien].Cells[14].Value = Math.Round((dTongThoiGianTangCaChonTuMay - Convert.ToDouble(iGioiHanTC1ChonTuMay) - Convert.ToDouble(iGioiHanTC2ChonTuMay)) * this.dTangCa3HeSo / 60, this.iLamTronGio);
                                                                        this.DGVTinhCong.Rows[_nhanVien].Cells[15].Value = "0";
                                                                    }
                                                                    else
                                                                    {
                                                                        this.DGVTinhCong.Rows[_nhanVien].Cells[13].Value = Math.Round((dTongThoiGianTangCaChonTuMay - Convert.ToDouble(iGioiHanTC1ChonTuMay)) * this.dTangCa2HeSo / 60, this.iLamTronGio);
                                                                        this.DGVTinhCong.Rows[_nhanVien].Cells[14].Value = "0";
                                                                        this.DGVTinhCong.Rows[_nhanVien].Cells[15].Value = "0";
                                                                    }
                                                                }
                                                                else
                                                                {
                                                                    this.DGVTinhCong.Rows[_nhanVien].Cells[12].Value = Math.Round(dTongThoiGianTangCaChonTuMay * this.dTangCa1HeSo / 60, this.iLamTronGio);
                                                                    this.DGVTinhCong.Rows[_nhanVien].Cells[13].Value = "0";
                                                                    this.DGVTinhCong.Rows[_nhanVien].Cells[14].Value = "0";
                                                                    this.DGVTinhCong.Rows[_nhanVien].Cells[15].Value = "0";
                                                                }
                                                            }
                                                            if ((iGioiHanTC1ChonTuMay == 0 || iGioiHanTC2ChonTuMay == 0 || iGioiHanTC3ChonTuMay == 0 ? false : iGioiHanTC4ChonTuMay == 0))
                                                            {
                                                            }
                                                        }
                                                        value = dGioRaChonTuMay - dGioVaoChonTuMay;
                                                        second = Convert.ToInt32(value.TotalMinutes);
                                                        num = Math.Round(Convert.ToDouble(second.ToString()) / 60, this.iLamTronGio);
                                                        sTongGio = num.ToString();
                                                        this.DGVTinhCong.Rows[_nhanVien].Cells[16].Value = sTongGio;
                                                        this.DGVTinhCong.Rows[_nhanVien].Cells[17].Value = dtCaLamViecChonTuMay.Rows[iCaLamViecChonTuMay]["CongTinh"].ToString();
                                                        this.DGVTinhCong.Rows[_nhanVien].Cells[18].Value = this.sKHDungGio;
                                                        if (!(DateTimeProgress.XuatIDThu((int)dt.AddDays((double)dem).DayOfWeek) == "0"))
                                                        {
                                                            this.DGVTinhCong.Rows[_nhanVien].Cells[19].Value = "NT";
                                                        }
                                                        else
                                                        {
                                                            this.DGVTinhCong.Rows[_nhanVien].Cells[19].Value = "CN";
                                                        }
                                                        this.DGVTinhCong.Rows[_nhanVien].Cells[20].Value = this.sMaChamCong;
                                                        this.DGVTinhCong.Rows[_nhanVien].Cells[21].Value = this.sPhongBanTinhCong;
                                                    }
                                                }
                                            //Label6:
                                            }
                                            else
                                            {
                                                dGioNgayHomTruoc = new DateTime();
                                                dateTime = dt.AddDays((double)(dem - 1));
                                                DateTime dNgayTruocChonTuMay = Convert.ToDateTime(dateTime.ToString());
                                                System.Data.DataTable dtNgayTruocChonTuMay = new System.Data.DataTable();
                                                this._checkInOutDTO.MaChamCong = Convert.ToInt32(this.sMaChamCong);
                                                this._checkInOutDTO.NgayCham = dNgayTruocChonTuMay;
                                                dtNgayTruocChonTuMay = this._checkInOutBLL.getCheckInOutByMaChamCongAndNgayCham(this._checkInOutDTO);
                                                for (int iNgayTruocChonTuMay = 0; iNgayTruocChonTuMay < dtNgayTruocChonTuMay.Rows.Count; iNgayTruocChonTuMay++)
                                                {
                                                    dGioNgayHomTruoc = Convert.ToDateTime(dtNgayTruocChonTuMay.Rows[iNgayTruocChonTuMay]["GioCham"].ToString());
                                                }
                                                dGioRaChonTuMay = Convert.ToDateTime(dateGioChamChonTuMay.ToString());
                                                this.DGVTinhCong.Rows[_nhanVien - 1].Cells[6].Value = string.Format(this.sDinhDangThoiGian, dGioRaChonTuMay);
                                                System.Data.DataTable dtNhanCaQuaDemChonTuMay = new System.Data.DataTable();
                                                this._chiTietLichTrinhChoCalamViecDTO.MaLichTrinhCaLamViec = sLTCCLVNhanVien;
                                                this._chiTietLichTrinhChoCalamViecDTO.Thu = sThu;
                                                dtNhanCaQuaDemChonTuMay = this._chiTietLichTrinhChoCaLamViecBLL.ChiTietLichTrinhChoCaLamViecNhanCa(this._chiTietLichTrinhChoCalamViecDTO);
                                                int iChiTietLichTrinhChoCaLamViecQuaDemChonTuMay = 0;
                                                if (iChiTietLichTrinhChoCaLamViecQuaDemChonTuMay < dtNhanCaQuaDemChonTuMay.Rows.Count)
                                                {
                                                    int cellChiTietLichTrinhChoCaLamViecQuaDemChonTuMay = 3;
                                                    while (cellChiTietLichTrinhChoCaLamViecQuaDemChonTuMay < 13)
                                                    {
                                                        kiemTraVao = 0;
                                                        kiemTraRa = 0;
                                                        this.sChonTuMayMaCaLamViec = dtNhanCaQuaDemChonTuMay.Rows[iChiTietLichTrinhChoCaLamViecQuaDemChonTuMay][cellChiTietLichTrinhChoCaLamViecQuaDemChonTuMay].ToString();
                                                        dtChonTuMayCa1 = new System.Data.DataTable();
                                                        this._caLamViecDTO.MaCaLamViec = this.sChonTuMayMaCaLamViec;
                                                        dtChonTuMayCa1 = this._caLamViecBLL.CaLamViecGetByMaCaLamViec(this._caLamViecDTO);
                                                        iChonTuMayCa1 = 0;
                                                        while (iChonTuMayCa1 < dtChonTuMayCa1.Rows.Count)
                                                        {
                                                            this.sChonTuMayTenCaLamViec = dtChonTuMayCa1.Rows[iChonTuMayCa1]["CaLamViec"].ToString();
                                                            dBatDauVaoChonTuMayA = Convert.ToDateTime(dtChonTuMayCa1.Rows[iChonTuMayCa1]["BatDauVao"].ToString());
                                                            sBatDauVaoChonTuMayA = string.Format("{0:T}", dBatDauVaoChonTuMayA);
                                                            sBatDauVaoChonTuMayB = string.Concat(sNgayCham, " ", sBatDauVaoChonTuMayA);
                                                            dateTime = Convert.ToDateTime(sBatDauVaoChonTuMayB);
                                                            dBatDauVaoChonTuMayB = dateTime.AddDays(-1);
                                                            dKetThucVaoChonTuMayA = Convert.ToDateTime(dtChonTuMayCa1.Rows[iChonTuMayCa1]["KetThucVao"].ToString());
                                                            sKetThucVaoChonTuMayA = string.Format("{0:T}", dKetThucVaoChonTuMayA);
                                                            sKetThucVaoChonTuMayB = string.Concat(sNgayCham, " ", sKetThucVaoChonTuMayA);
                                                            dateTime = Convert.ToDateTime(sKetThucVaoChonTuMayB);
                                                            dKetThucVaoChonTuMayB = dateTime.AddDays(-1);
                                                            dBatDauRaChonTuMayA = Convert.ToDateTime(dtChonTuMayCa1.Rows[iChonTuMayCa1]["BatDauRa"].ToString());
                                                            sBatDauRaChonTuMayA = string.Format("{0:T}", dBatDauRaChonTuMayA);
                                                            sBatDauRaChonTuMayB = string.Concat(sNgayCham, " ", sBatDauRaChonTuMayA);
                                                            dateTime = Convert.ToDateTime(sBatDauRaChonTuMayB);
                                                            dBatDauRaChonTuMayB = dateTime.AddDays(-1);
                                                            if (!(sBatDauRaChonTuMayA == "12:01:00 AM"))
                                                            {
                                                                dBatDauRaChonTuMayB = Convert.ToDateTime(sBatDauRaChonTuMayB);
                                                            }
                                                            else
                                                            {
                                                                dateTime = dBatDauRaChonTuMayB.AddDays(1);
                                                                dBatDauRaChonTuMayB = Convert.ToDateTime(dateTime.ToString());
                                                            }
                                                            dKetThucRaChonTuMayA = Convert.ToDateTime(dtChonTuMayCa1.Rows[iChonTuMayCa1]["KetThucRa"].ToString());
                                                            sKetThucRaChonTuMayA = string.Format("{0:T}", dKetThucRaChonTuMayA);
                                                            sKetThucRaChonTuMayB = string.Concat(sNgayCham, " ", sKetThucRaChonTuMayA);
                                                            dateTime = Convert.ToDateTime(sKetThucRaChonTuMayB);
                                                            dKetThucRaChonTuMayB = dateTime.AddDays(-1);
                                                            if (!(sBatDauRaChonTuMayA == "12:01:00 AM"))
                                                            {
                                                                dKetThucRaChonTuMayB = Convert.ToDateTime(sKetThucRaChonTuMayB);
                                                            }
                                                            else
                                                            {
                                                                dateTime = dKetThucRaChonTuMayB.AddDays(1);
                                                                dKetThucRaChonTuMayB = Convert.ToDateTime(dateTime.ToString());
                                                            }
                                                            if ((dGioNgayHomTruoc < dBatDauVaoChonTuMayB ? false : dGioNgayHomTruoc <= dKetThucVaoChonTuMayB))
                                                            {
                                                                kiemTraVao++;
                                                            }
                                                            if ((dGioRaChonTuMay < dBatDauRaChonTuMayB ? false : dGioRaChonTuMay <= dKetThucRaChonTuMayB))
                                                            {
                                                                kiemTraRa++;
                                                            }
                                                            if ((kiemTraVao != 1 ? true : kiemTraRa != 1))
                                                            {
                                                                iChonTuMayCa1++;
                                                            }
                                                            else
                                                            {
                                                                goto Label9;
                                                            }
                                                        }
                                                        if (!(this.sChonTuMayMaCaLamViec == ""))
                                                        {
                                                            cellChiTietLichTrinhChoCaLamViecQuaDemChonTuMay++;
                                                        }
                                                        else
                                                        {
                                                            this.DGVTinhCong.Rows[_nhanVien - 1].Cells[4].Value = "***";
                                                            this.DGVTinhCong.Rows[_nhanVien - 1].Cells[7].Value = "0";
                                                            this.DGVTinhCong.Rows[_nhanVien - 1].Cells[8].Value = "0";
                                                            this.DGVTinhCong.Rows[_nhanVien - 1].Cells[9].Value = "0";
                                                            this.DGVTinhCong.Rows[_nhanVien - 1].Cells[10].Value = "0";
                                                            this.DGVTinhCong.Rows[_nhanVien - 1].Cells[11].Value = "0";
                                                            this.DGVTinhCong.Rows[_nhanVien - 1].Cells[12].Value = "0";
                                                            this.DGVTinhCong.Rows[_nhanVien - 1].Cells[13].Value = "0";
                                                            this.DGVTinhCong.Rows[_nhanVien - 1].Cells[14].Value = "0";
                                                            this.DGVTinhCong.Rows[_nhanVien - 1].Cells[15].Value = "0";
                                                            this.DGVTinhCong.Rows[_nhanVien - 1].Cells[16].Value = "0";
                                                            this.DGVTinhCong.Rows[_nhanVien - 1].Cells[17].Value = "0";
                                                            this.DGVTinhCong.Rows[_nhanVien - 1].Cells[18].Value = this.sKHVang;
                                                            if (!(DateTimeProgress.XuatThuQuaDem((int)dt.AddDays((double)dem).DayOfWeek) == "1"))
                                                            {
                                                                this.DGVTinhCong.Rows[_nhanVien - 1].Cells[19].Value = "NT";
                                                            }
                                                            else
                                                            {
                                                                this.DGVTinhCong.Rows[_nhanVien - 1].Cells[19].Value = "CN";
                                                            }
                                                            this.DGVTinhCong.Rows[_nhanVien - 1].Cells[20].Value = this.sMaChamCong;
                                                            this.DGVTinhCong.Rows[_nhanVien - 1].Cells[21].Value = this.sPhongBanTinhCong;
                                                       //     goto Label8;
                                                        }
                                                    }
                                                Label9:
                                                    this.DGVTinhCong.Rows[_nhanVien - 1].Cells[4].Value = this.sChonTuMayTenCaLamViec;
                                                    System.Data.DataTable dtThongSoCaLamViecChonTuMay = new System.Data.DataTable();
                                                    this._caLamViecDTO.MaCaLamViec = this.sChonTuMayMaCaLamViec;
                                                    dtThongSoCaLamViecChonTuMay = this._caLamViecBLL.CaLamViecGetByMaCaLamViec(this._caLamViecDTO);
                                                    for (int iThongSoCaLamViecChonTuMay = 0; iThongSoCaLamViecChonTuMay < dtThongSoCaLamViecChonTuMay.Rows.Count; iThongSoCaLamViecChonTuMay++)
                                                    {
                                                        value = dGioRaChonTuMay - dGioNgayHomTruoc;
                                                        int iTongPhutChonTuMay = Convert.ToInt32(value.TotalMinutes);
                                                        double dTongGioChonTuMay = Math.Round(Convert.ToDouble(iTongPhutChonTuMay) / 60, this.iLamTronGio);
                                                        this.DGVTinhCong.Rows[_nhanVien - 1].Cells[16].Value = dTongGioChonTuMay.ToString();
                                                        this.DGVTinhCong.Rows[_nhanVien - 1].Cells[17].Value = dtThongSoCaLamViecChonTuMay.Rows[iThongSoCaLamViecChonTuMay]["CongTinh"].ToString();
                                                        second = dGioNgayHomTruoc.Second;
                                                        sGiayGioVao = second.ToString();
                                                        second = dGioRaChonTuMay.Second;
                                                        sGiayGioRa = second.ToString();
                                                        dGioVaoKhaiBaoChonTuMayA = Convert.ToDateTime(dtThongSoCaLamViecChonTuMay.Rows[iThongSoCaLamViecChonTuMay]["GioVaoLamViec"].ToString());
                                                        sGioVaoKhaiBaoChonTuMayA = string.Format("{0:T}", dGioVaoKhaiBaoChonTuMayA).Replace("00 ", string.Concat(sGiayGioVao, " "));
                                                        sGioVaoKhaiBaoChonTuMayB = string.Concat(sNgayCham, " ", sGioVaoKhaiBaoChonTuMayA);
                                                        dGioRaKhaiBaoChonTuMayA = Convert.ToDateTime(dtThongSoCaLamViecChonTuMay.Rows[iThongSoCaLamViecChonTuMay]["GioKetThucLamViec"].ToString());
                                                        sGioRaKhaiBaoChonTuMayA = string.Format("{0:T}", dGioRaKhaiBaoChonTuMayA).Replace("00 ", string.Concat(sGiayGioRa, " "));
                                                        sGioRaKhaiBaoChonTuMayB = string.Concat(sNgayCham, " ", sGioRaKhaiBaoChonTuMayA);
                                                        sCatChuoi = sGioRaKhaiBaoChonTuMayB.Substring(sGioRaKhaiBaoChonTuMayB.Length - 2);
                                                        sTruGioDiTre = dtThongSoCaLamViecChonTuMay.Rows[iThongSoCaLamViecChonTuMay]["TruGioDiTre"].ToString();
                                                        sBatDauTinhDiTre = dtThongSoCaLamViecChonTuMay.Rows[iThongSoCaLamViecChonTuMay]["BatDauTinhDiTre"].ToString();
                                                        if (!(sTruGioDiTre == "True"))
                                                        {
                                                            this.DGVTinhCong.Rows[_nhanVien - 1].Cells[9].Value = "0";
                                                        }
                                                        else
                                                        {
                                                            int iChoPhepTreChonTuMay = Convert.ToInt32(dtThongSoCaLamViecChonTuMay.Rows[iThongSoCaLamViecChonTuMay]["ChoPhepDiTre"].ToString());
                                                            if (!(sBatDauTinhDiTre == "True"))
                                                            {
                                                                dateTime = Convert.ToDateTime(sGioVaoKhaiBaoChonTuMayB);
                                                                value = dGioNgayHomTruoc - dateTime.AddDays(-1);
                                                                iPhutTreChonTuMay = Convert.ToInt32(value.TotalMinutes) - iChoPhepTreChonTuMay;
                                                                if (iPhutTreChonTuMay <= 0)
                                                                {
                                                                    this.DGVTinhCong.Rows[_nhanVien - 1].Cells[9].Value = "0";
                                                                }
                                                                else
                                                                {
                                                                    DataGridViewCell str = this.DGVTinhCong.Rows[_nhanVien - 1].Cells[9];
                                                                    dateTime = Convert.ToDateTime(sGioVaoKhaiBaoChonTuMayB);
                                                                    value = dGioNgayHomTruoc - dateTime.AddDays(-1);
                                                                    second = Convert.ToInt32(value.TotalMinutes);
                                                                    str.Value = second.ToString();
                                                                }
                                                            }
                                                            else
                                                            {
                                                                dateTime = Convert.ToDateTime(sGioVaoKhaiBaoChonTuMayB);
                                                                value = dGioNgayHomTruoc - dateTime.AddDays(-1);
                                                                iPhutTreChonTuMay = Convert.ToInt32(value.TotalMinutes) - iChoPhepTreChonTuMay;
                                                                if (iPhutTreChonTuMay <= 0)
                                                                {
                                                                    this.DGVTinhCong.Rows[_nhanVien - 1].Cells[9].Value = "0";
                                                                }
                                                                else
                                                                {
                                                                    this.DGVTinhCong.Rows[_nhanVien - 1].Cells[9].Value = iPhutTreChonTuMay.ToString();
                                                                }
                                                            }
                                                        }
                                                        sTruGioVeSom = dtThongSoCaLamViecChonTuMay.Rows[iThongSoCaLamViecChonTuMay]["TruGioVeSom"].ToString();
                                                        sBatDauTinhVeSom = dtThongSoCaLamViecChonTuMay.Rows[iThongSoCaLamViecChonTuMay]["BatDauTinhVeSom"].ToString();
                                                        if (!(sTruGioVeSom == "True"))
                                                        {
                                                            this.DGVTinhCong.Rows[_nhanVien - 1].Cells[10].Value = "0";
                                                        }
                                                        else
                                                        {
                                                            int iChoPhepVeSomChonTuMay = Convert.ToInt32(dtThongSoCaLamViecChonTuMay.Rows[iThongSoCaLamViecChonTuMay]["ChoPhepVeSom"].ToString());
                                                            if (!(sBatDauTinhVeSom == "True"))
                                                            {
                                                                value = Convert.ToDateTime(sGioRaKhaiBaoChonTuMayB) - dGioRaChonTuMay;
                                                                iPhutVeSomChonTuMay = Convert.ToInt32(value.TotalMinutes) - iChoPhepVeSomChonTuMay;
                                                                if (iPhutVeSomChonTuMay <= 0)
                                                                {
                                                                    this.DGVTinhCong.Rows[_nhanVien - 1].Cells[10].Value = "0";
                                                                }
                                                                else
                                                                {
                                                                    DataGridViewCell str1 = this.DGVTinhCong.Rows[_nhanVien - 1].Cells[10];
                                                                    value = Convert.ToDateTime(sGioRaKhaiBaoChonTuMayB) - dGioRaChonTuMay;
                                                                    second = Convert.ToInt32(value.TotalMinutes);
                                                                    str1.Value = second.ToString();
                                                                }
                                                            }
                                                            else if (!(sCatChuoi == "PM"))
                                                            {
                                                                value = Convert.ToDateTime(sGioRaKhaiBaoChonTuMayB) - dGioRaChonTuMay;
                                                                iPhutVeSomChonTuMay = Convert.ToInt32(value.TotalMinutes) - iChoPhepVeSomChonTuMay;
                                                                if (iPhutVeSomChonTuMay <= 0)
                                                                {
                                                                    this.DGVTinhCong.Rows[_nhanVien - 1].Cells[10].Value = "0";
                                                                }
                                                                else
                                                                {
                                                                    this.DGVTinhCong.Rows[_nhanVien - 1].Cells[10].Value = iPhutVeSomChonTuMay.ToString();
                                                                }
                                                            }
                                                            else
                                                            {
                                                                dateTime = Convert.ToDateTime(sGioRaKhaiBaoChonTuMayB);
                                                                value = dateTime.AddDays(-1) - dGioRaChonTuMay;
                                                                iPhutVeSomChonTuMay = Convert.ToInt32(value.TotalMinutes) - iChoPhepVeSomChonTuMay;
                                                                if (iPhutVeSomChonTuMay <= 0)
                                                                {
                                                                    this.DGVTinhCong.Rows[_nhanVien - 1].Cells[10].Value = "0";
                                                                }
                                                                else
                                                                {
                                                                    this.DGVTinhCong.Rows[_nhanVien - 1].Cells[10].Value = iPhutVeSomChonTuMay.ToString();
                                                                }
                                                            }
                                                        }
                                                        if (!(sCatChuoi == "PM"))
                                                        {
                                                            value = dGioRaChonTuMay - Convert.ToDateTime(sGioRaKhaiBaoChonTuMayB);
                                                            iPhutVeTre = Convert.ToInt32(value.TotalMinutes);
                                                            if (iPhutVeTre <= 0)
                                                            {
                                                                this.DGVTinhCong.Rows[_nhanVien - 1].Cells[11].Value = "0";
                                                            }
                                                            else
                                                            {
                                                                this.DGVTinhCong.Rows[_nhanVien - 1].Cells[11].Value = iPhutVeTre;
                                                            }
                                                        }
                                                        else
                                                        {
                                                            dateTime = Convert.ToDateTime(sGioRaKhaiBaoChonTuMayB);
                                                            value = dGioRaChonTuMay - dateTime.AddDays(-1);
                                                            iPhutVeTre = Convert.ToInt32(value.TotalMinutes);
                                                            if (iPhutVeTre <= 0)
                                                            {
                                                                this.DGVTinhCong.Rows[_nhanVien - 1].Cells[11].Value = "0";
                                                            }
                                                            else
                                                            {
                                                                this.DGVTinhCong.Rows[_nhanVien - 1].Cells[11].Value = iPhutVeTre;
                                                            }
                                                        }
                                                        double dTongGioTrongCaChonTuMay = Convert.ToDouble(dtThongSoCaLamViecChonTuMay.Rows[iThongSoCaLamViecChonTuMay]["TongGioTrongCaLamViec"].ToString());
                                                        double dTongCongTrongCaChonTuMay = Convert.ToDouble(dtThongSoCaLamViecChonTuMay.Rows[iThongSoCaLamViecChonTuMay]["CongTinh"].ToString());
                                                        double dTongPhutTreSomChonTuMay = Convert.ToDouble(this.DGVTinhCong.Rows[_nhanVien - 1].Cells[9].Value.ToString()) + Convert.ToDouble(this.DGVTinhCong.Rows[_nhanVien - 1].Cells[10].Value.ToString());
                                                        dSoPhutLamDuocTrongCa = dTongGioTrongCaChonTuMay * 60 - dTongPhutTreSomChonTuMay;
                                                        this.DGVTinhCong.Rows[_nhanVien - 1].Cells[8].Value = Math.Round(dSoPhutLamDuocTrongCa / 60, this.iLamTronGio);
                                                        this.DGVTinhCong.Rows[_nhanVien - 1].Cells[7].Value = Math.Round(Convert.ToDouble(this.DGVTinhCong.Rows[_nhanVien - 1].Cells[8].Value.ToString()) * dTongCongTrongCaChonTuMay / dTongGioTrongCaChonTuMay, this.iLamTronCong);
                                                        sChoPhepTangCaTruocGioLamViecChonTuMay = dtThongSoCaLamViecChonTuMay.Rows[iThongSoCaLamViecChonTuMay]["TangCaTruocGioLamViec"].ToString();
                                                        iPhutTangCaTruocGioLamViecChonTuMay = Convert.ToInt32(dtThongSoCaLamViecChonTuMay.Rows[iThongSoCaLamViecChonTuMay]["SoPhutTangCaTruocGioLamViec"].ToString());
                                                        iPhutTangCaTruocGioLamViecDatDen = Convert.ToInt32(dtThongSoCaLamViecChonTuMay.Rows[iThongSoCaLamViecChonTuMay]["TangCaTruocGioLamViecDatDen"].ToString());
                                                        iPhutTruTangCaTruoc = Convert.ToInt32(dtThongSoCaLamViecChonTuMay.Rows[iThongSoCaLamViecChonTuMay]["PhutTruTangCaTruoc"].ToString());
                                                        sChoPhepTangCaSauGioLamViecChonTuMay = dtThongSoCaLamViecChonTuMay.Rows[iThongSoCaLamViecChonTuMay]["TangCaSauGioLamViec"].ToString();
                                                        iPhutTangCaSauGioLamViecChonTuMay = Convert.ToInt32(dtThongSoCaLamViecChonTuMay.Rows[iThongSoCaLamViecChonTuMay]["SoPhutTangCaSauGioLamViec"].ToString());
                                                        iPhutTangCaSauGioLamViecDatDen = Convert.ToInt32(dtThongSoCaLamViecChonTuMay.Rows[iThongSoCaLamViecChonTuMay]["TangCaSauGioLamViecDatDen"].ToString());
                                                        iPhutTruTangCaSau = Convert.ToInt32(dtThongSoCaLamViecChonTuMay.Rows[iThongSoCaLamViecChonTuMay]["PhutTruTangCaSau"].ToString());
                                                        iGioiHanTC1ChonTuMay = Convert.ToInt32(dtThongSoCaLamViecChonTuMay.Rows[iThongSoCaLamViecChonTuMay]["GioiHanTangCa1"].ToString());
                                                        iGioiHanTC2ChonTuMay = Convert.ToInt32(dtThongSoCaLamViecChonTuMay.Rows[iThongSoCaLamViecChonTuMay]["GioiHanTangCa2"].ToString());
                                                        iGioiHanTC3ChonTuMay = Convert.ToInt32(dtThongSoCaLamViecChonTuMay.Rows[iThongSoCaLamViecChonTuMay]["GioiHanTangCa3"].ToString());
                                                        iGioiHanTC4ChonTuMay = Convert.ToInt32(dtThongSoCaLamViecChonTuMay.Rows[iThongSoCaLamViecChonTuMay]["GioiHanTangCa4"].ToString());
                                                        iTongGioTangCaSauChonTuMay = 0;
                                                        iTongGioTangCaTruocChonTuMay = 0;
                                                        if ((sChoPhepTangCaTruocGioLamViecChonTuMay != "False" ? true : !(sChoPhepTangCaSauGioLamViecChonTuMay == "False")))
                                                        {
                                                            if (sChoPhepTangCaTruocGioLamViecChonTuMay == "True")
                                                            {
                                                                dateTime = Convert.ToDateTime(sGioVaoKhaiBaoChonTuMayB);
                                                                value = dateTime.AddDays(-1) - dGioNgayHomTruoc;
                                                                second = Convert.ToInt32(value.TotalMinutes);
                                                                iThoiGianTruocGioLamChonTuMay = Convert.ToInt32(second.ToString());
                                                                if (iThoiGianTruocGioLamChonTuMay > 0)
                                                                {
                                                                    if (iThoiGianTruocGioLamChonTuMay > iPhutTangCaTruocGioLamViecChonTuMay)
                                                                    {
                                                                        if (iThoiGianTruocGioLamChonTuMay > iPhutTangCaTruocGioLamViecDatDen)
                                                                        {
                                                                            iTongGioTangCaTruocChonTuMay = iThoiGianTruocGioLamChonTuMay - iPhutTruTangCaTruoc;
                                                                        }
                                                                    }
                                                                }
                                                            }
                                                            if (sChoPhepTangCaSauGioLamViecChonTuMay == "True")
                                                            {
                                                                if (!(sCatChuoi == "PM"))
                                                                {
                                                                    value = dGioRaChonTuMay - Convert.ToDateTime(sGioRaKhaiBaoChonTuMayB);
                                                                    second = Convert.ToInt32(value.TotalMinutes);
                                                                    iThoiGianSauGioLamViecChonTuMay = Convert.ToInt32(second.ToString());
                                                                    if (iThoiGianSauGioLamViecChonTuMay > 0)
                                                                    {
                                                                        if (iThoiGianSauGioLamViecChonTuMay > iPhutTangCaSauGioLamViecChonTuMay)
                                                                        {
                                                                            if (iThoiGianSauGioLamViecChonTuMay > iPhutTangCaSauGioLamViecDatDen)
                                                                            {
                                                                                iTongGioTangCaSauChonTuMay = iThoiGianSauGioLamViecChonTuMay - iPhutTruTangCaSau;
                                                                            }
                                                                        }
                                                                    }
                                                                }
                                                                else
                                                                {
                                                                    dateTime = Convert.ToDateTime(sGioRaKhaiBaoChonTuMayB);
                                                                    value = dGioRaChonTuMay - dateTime.AddDays(-1);
                                                                    second = Convert.ToInt32(value.TotalMinutes);
                                                                    iThoiGianSauGioLamViecChonTuMay = Convert.ToInt32(second.ToString());
                                                                    if (iThoiGianSauGioLamViecChonTuMay > 0)
                                                                    {
                                                                        if (iThoiGianSauGioLamViecChonTuMay > iPhutTangCaSauGioLamViecChonTuMay)
                                                                        {
                                                                            if (iThoiGianSauGioLamViecChonTuMay > iPhutTangCaSauGioLamViecDatDen)
                                                                            {
                                                                                iTongGioTangCaSauChonTuMay = iThoiGianSauGioLamViecChonTuMay - iPhutTruTangCaSau;
                                                                            }
                                                                        }
                                                                    }
                                                                }
                                                            }
                                                        }
                                                        else
                                                        {
                                                            this.DGVTinhCong.Rows[_nhanVien - 1].Cells[12].Value = "0";
                                                            this.DGVTinhCong.Rows[_nhanVien - 1].Cells[13].Value = "0";
                                                            this.DGVTinhCong.Rows[_nhanVien - 1].Cells[14].Value = "0";
                                                            this.DGVTinhCong.Rows[_nhanVien - 1].Cells[15].Value = "0";
                                                        }
                                                        dTongThoiGianTangCaChonTuMay = Convert.ToDouble(iTongGioTangCaTruocChonTuMay + iTongGioTangCaSauChonTuMay);
                                                        if (dTongThoiGianTangCaChonTuMay <= 0)
                                                        {
                                                            this.DGVTinhCong.Rows[_nhanVien - 1].Cells[12].Value = "0";
                                                            this.DGVTinhCong.Rows[_nhanVien - 1].Cells[13].Value = "0";
                                                            this.DGVTinhCong.Rows[_nhanVien - 1].Cells[14].Value = "0";
                                                            this.DGVTinhCong.Rows[_nhanVien - 1].Cells[15].Value = "0";
                                                        }
                                                        else
                                                        {
                                                            if (iGioiHanTC1ChonTuMay == 0)
                                                            {
                                                                this.DGVTinhCong.Rows[_nhanVien - 1].Cells[12].Value = Math.Round(dTongThoiGianTangCaChonTuMay * this.dTangCa1HeSo / 60, this.iLamTronGio);
                                                                this.DGVTinhCong.Rows[_nhanVien - 1].Cells[13].Value = "0";
                                                                this.DGVTinhCong.Rows[_nhanVien - 1].Cells[14].Value = "0";
                                                                this.DGVTinhCong.Rows[_nhanVien - 1].Cells[15].Value = "0";
                                                            }
                                                            if ((iGioiHanTC1ChonTuMay == 0 ? false : iGioiHanTC2ChonTuMay == 0))
                                                            {
                                                                if (dTongThoiGianTangCaChonTuMay >= Convert.ToDouble(iGioiHanTC1ChonTuMay))
                                                                {
                                                                    this.DGVTinhCong.Rows[_nhanVien - 1].Cells[12].Value = Math.Round(Convert.ToDouble(iGioiHanTC1ChonTuMay) / 60 * this.dTangCa1HeSo, this.iLamTronGio);
                                                                    if (dTongThoiGianTangCaChonTuMay - Convert.ToDouble(iGioiHanTC1ChonTuMay) > 0)
                                                                    {
                                                                        this.DGVTinhCong.Rows[_nhanVien - 1].Cells[13].Value = Math.Round((dTongThoiGianTangCaChonTuMay - Convert.ToDouble(iGioiHanTC1ChonTuMay)) * this.dTangCa2HeSo / 60, this.iLamTronGio);
                                                                    }
                                                                    this.DGVTinhCong.Rows[_nhanVien - 1].Cells[14].Value = "0";
                                                                    this.DGVTinhCong.Rows[_nhanVien - 1].Cells[15].Value = "0";
                                                                }
                                                                else
                                                                {
                                                                    this.DGVTinhCong.Rows[_nhanVien - 1].Cells[12].Value = Math.Round(dTongThoiGianTangCaChonTuMay * this.dTangCa1HeSo / 60, this.iLamTronGio);
                                                                    this.DGVTinhCong.Rows[_nhanVien - 1].Cells[13].Value = "0";
                                                                    this.DGVTinhCong.Rows[_nhanVien - 1].Cells[14].Value = "0";
                                                                    this.DGVTinhCong.Rows[_nhanVien - 1].Cells[15].Value = "0";
                                                                }
                                                            }
                                                            if ((iGioiHanTC1ChonTuMay == 0 || iGioiHanTC2ChonTuMay == 0 ? false : iGioiHanTC3ChonTuMay == 0))
                                                            {
                                                                if (dTongThoiGianTangCaChonTuMay >= Convert.ToDouble(iGioiHanTC1ChonTuMay))
                                                                {
                                                                    this.DGVTinhCong.Rows[_nhanVien - 1].Cells[12].Value = Math.Round(Convert.ToDouble(iGioiHanTC1ChonTuMay) * this.dTangCa1HeSo / 60, this.iLamTronGio);
                                                                    if (dTongThoiGianTangCaChonTuMay - Convert.ToDouble(iGioiHanTC1ChonTuMay) >= Convert.ToDouble(iGioiHanTC2ChonTuMay))
                                                                    {
                                                                        this.DGVTinhCong.Rows[_nhanVien - 1].Cells[12].Value = Math.Round(Convert.ToDouble(iGioiHanTC1ChonTuMay) * this.dTangCa1HeSo / 60, this.iLamTronGio);
                                                                        this.DGVTinhCong.Rows[_nhanVien - 1].Cells[13].Value = Math.Round(Convert.ToDouble(iGioiHanTC2ChonTuMay) * this.dTangCa2HeSo / 60, this.iLamTronGio);
                                                                        this.DGVTinhCong.Rows[_nhanVien - 1].Cells[14].Value = Math.Round((dTongThoiGianTangCaChonTuMay - Convert.ToDouble(iGioiHanTC1ChonTuMay) - Convert.ToDouble(iGioiHanTC2ChonTuMay)) * this.dTangCa3HeSo / 60, this.iLamTronGio);
                                                                        this.DGVTinhCong.Rows[_nhanVien - 1].Cells[15].Value = "0";
                                                                    }
                                                                    else
                                                                    {
                                                                        this.DGVTinhCong.Rows[_nhanVien - 1].Cells[13].Value = Math.Round((dTongThoiGianTangCaChonTuMay - Convert.ToDouble(iGioiHanTC1ChonTuMay)) * this.dTangCa2HeSo / 60, this.iLamTronGio);
                                                                        this.DGVTinhCong.Rows[_nhanVien - 1].Cells[14].Value = "0";
                                                                        this.DGVTinhCong.Rows[_nhanVien - 1].Cells[15].Value = "0";
                                                                    }
                                                                }
                                                                else
                                                                {
                                                                    this.DGVTinhCong.Rows[_nhanVien - 1].Cells[12].Value = Math.Round(dTongThoiGianTangCaChonTuMay * this.dTangCa1HeSo / 60, this.iLamTronGio);
                                                                    this.DGVTinhCong.Rows[_nhanVien - 1].Cells[13].Value = "0";
                                                                    this.DGVTinhCong.Rows[_nhanVien - 1].Cells[14].Value = "0";
                                                                    this.DGVTinhCong.Rows[_nhanVien - 1].Cells[15].Value = "0";
                                                                }
                                                            }
                                                            if ((iGioiHanTC1ChonTuMay == 0 || iGioiHanTC2ChonTuMay == 0 || iGioiHanTC3ChonTuMay == 0 ? false : iGioiHanTC4ChonTuMay == 0))
                                                            {
                                                            }
                                                        }
                                                        this.DGVTinhCong.Rows[_nhanVien - 1].Cells[18].Value = this.sKHDungGio;
                                                        if (!(DateTimeProgress.XuatThuQuaDem((int)dt.AddDays((double)dem).DayOfWeek) == "1"))
                                                        {
                                                            this.DGVTinhCong.Rows[_nhanVien - 1].Cells[19].Value = "NT";
                                                        }
                                                        else
                                                        {
                                                            this.DGVTinhCong.Rows[_nhanVien - 1].Cells[19].Value = "CN";
                                                        }
                                                        this.DGVTinhCong.Rows[_nhanVien - 1].Cells[20].Value = this.sMaChamCong;
                                                        this.DGVTinhCong.Rows[_nhanVien - 1].Cells[21].Value = this.sPhongBanTinhCong;
                                                    }
                                                }
                                            Label8:;
                                            }
                                           goto Label0;
                                        }
                                        iLanCham++;
                                    Label0:;
                                    }
                                    if (iLanCham == 1)
                                    {
                                        this.DGVTinhCong.Rows[_nhanVien].Cells[0].Value = this.sMaNhanVien;
                                        this.DGVTinhCong.Rows[_nhanVien].Cells[1].Value = this.sTenNhanVien;
                                        this.DGVTinhCong.Rows[_nhanVien].Cells[2].Value = this.DGVTinhCong.Rows[_nhanVien].Cells[2].Value.ToString();
                                        if (this.iNgonNgu == 0)
                                        {
                                            DataGridViewCell item2 = this.DGVTinhCong.Rows[_nhanVien].Cells[3];
                                            dateTime = dt.AddDays((double)dem);
                                            item2.Value = DateTimeProgress.XuatThuTinhCong((int)dateTime.DayOfWeek);
                                        }
                                        if (this.iNgonNgu == 1)
                                        {
                                            DataGridViewCell dataGridViewCell2 = this.DGVTinhCong.Rows[_nhanVien].Cells[3];
                                            dateTime = dt.AddDays((double)dem);
                                            dataGridViewCell2.Value = DateTimeProgress.XuatThuEnglish((int)dateTime.DayOfWeek);
                                        }
                                        this.DGVTinhCong.Rows[_nhanVien].Cells[7].Value = "0";
                                        this.DGVTinhCong.Rows[_nhanVien].Cells[8].Value = "0";
                                        this.DGVTinhCong.Rows[_nhanVien].Cells[17].Value = "0";
                                        this.DGVTinhCong.Rows[_nhanVien].Cells[18].Value = this.sKHVang;
                                        if (!(DateTimeProgress.XuatIDThu((int)dt.AddDays((double)dem).DayOfWeek) == "0"))
                                        {
                                            this.DGVTinhCong.Rows[_nhanVien].Cells[19].Value = "NT";
                                        }
                                        else
                                        {
                                            this.DGVTinhCong.Rows[_nhanVien].Cells[19].Value = "CN";
                                        }
                                        this.DGVTinhCong.Rows[_nhanVien].Cells[20].Value = this.sMaChamCong;
                                        this.DGVTinhCong.Rows[_nhanVien].Cells[21].Value = this.sPhongBanTinhCong;
                                    }
                                }
                                if (iChonLichTrinh == 2)
                                {
                                    iKiemTraLanChamTuDongKhongQuaDemLichTrinhVaoRa = 0;
                                    iKiemTraLanChamKhoangCachTuDongKhongQuaDemLichTrinhVaoRa = 0;
                                    int iKiemTraDuLieuTuDong = 0;
                                    iKiemTraLanCham = 0;
                                    int addTuDong = 1;
                                    int iHieuPhutTuDong = 0;
                                    DateTime dGioVaoTuDong = new DateTime();
                                    DateTime dGioRaTuDong = new DateTime();
                                    dGioVaoTuDongKhongQuaDemLichTrinhVaoRa = new DateTime();
                                    dGioRaTuDongKhongQuaDemLichTrinhVaoRa = new DateTime();
                                    dtTuDong = new System.Data.DataTable();
                                    this._checkInOutDTO.MaChamCong = Convert.ToInt32(this.sMaChamCong);
                                    this._checkInOutDTO.NgayCham = Convert.ToDateTime(Convert.ToDateTime(this.DGVTinhCong.Rows[_nhanVien].Cells[2].Value.ToString()));
                                    dtTuDong = this._checkInOutBLL.getCheckInOutByMaChamCongAndNgayCham(this._checkInOutDTO);
                                    for (iTuDong = 0; iTuDong < dtTuDong.Rows.Count; iTuDong++)
                                    {
                                        addGioNguonTuDongKhongQuaDem = this.DGVDuLieuChamCongNguon.Rows.Add();
                                        iKiemTraLanChamTuDongKhongQuaDemLichTrinhVaoRa++;
                                        if (iKiemTraLanChamTuDongKhongQuaDemLichTrinhVaoRa == 1)
                                        {
                                            dGioVaoTuDongKhongQuaDemLichTrinhVaoRa = Convert.ToDateTime(dtTuDong.Rows[iTuDong]["GioCham"].ToString());
                                            if ((dtTuDong.Rows.Count <= 2 ? true : iKiemTraLanChamKhoangCachTuDongKhongQuaDemLichTrinhVaoRa != 3))
                                            {
                                                this.DGVDuLieuChamCongNguon.Rows[addGioNguonTuDongKhongQuaDem].Cells[0].Value = this.sMaChamCong;
                                                this.DGVDuLieuChamCongNguon.Rows[addGioNguonTuDongKhongQuaDem].Cells[1].Value = string.Format("{0:d}", dGioVaoTuDongKhongQuaDemLichTrinhVaoRa);
                                                this.DGVDuLieuChamCongNguon.Rows[addGioNguonTuDongKhongQuaDem].Cells[2].Value = dGioVaoTuDongKhongQuaDemLichTrinhVaoRa;
                                                this.DGVDuLieuChamCongNguon.Rows[addGioNguonTuDongKhongQuaDem].Cells[3].Value = "Vào";
                                                this.DGVDuLieuChamCongNguon.Rows[addGioNguonTuDongKhongQuaDem].Cells[4].Value = "I";
                                                this.DGVDuLieuChamCongNguon.Rows[addGioNguonTuDongKhongQuaDem].Cells[6].Value = dtTuDong.Rows[iTuDong]["MaSoMay"].ToString();
                                            }
                                            else
                                            {
                                                if (Convert.ToInt32(Convert.ToInt32((dGioVaoTuDongKhongQuaDemLichTrinhVaoRa - dGioRaTuDongKhongQuaDemLichTrinhVaoRa).TotalMinutes).ToString()) < iKhoangCachGiuaHaiCapVaoRa)
                                                {
                                                    goto Label11;
                                                }
                                                this.DGVDuLieuChamCongNguon.Rows[addGioNguonTuDongKhongQuaDem].Cells[0].Value = this.sMaChamCong;
                                                this.DGVDuLieuChamCongNguon.Rows[addGioNguonTuDongKhongQuaDem].Cells[1].Value = string.Format("{0:d}", dGioVaoTuDongKhongQuaDemLichTrinhVaoRa);
                                                this.DGVDuLieuChamCongNguon.Rows[addGioNguonTuDongKhongQuaDem].Cells[2].Value = dGioVaoTuDongKhongQuaDemLichTrinhVaoRa;
                                                this.DGVDuLieuChamCongNguon.Rows[addGioNguonTuDongKhongQuaDem].Cells[3].Value = "Vào";
                                                this.DGVDuLieuChamCongNguon.Rows[addGioNguonTuDongKhongQuaDem].Cells[4].Value = "I";
                                                this.DGVDuLieuChamCongNguon.Rows[addGioNguonTuDongKhongQuaDem].Cells[6].Value = dtTuDong.Rows[iTuDong]["MaSoMay"].ToString();
                                                iKiemTraLanChamTuDongKhongQuaDemLichTrinhVaoRa = 1;
                                            }
                                        }
                                        if (iKiemTraLanChamTuDongKhongQuaDemLichTrinhVaoRa == 2)
                                        {
                                            dGioRaTuDongKhongQuaDemLichTrinhVaoRa = Convert.ToDateTime(dtTuDong.Rows[iTuDong]["GioCham"].ToString());
                                            if (Convert.ToInt32(Convert.ToInt32((dGioRaTuDongKhongQuaDemLichTrinhVaoRa - dGioVaoTuDongKhongQuaDemLichTrinhVaoRa).TotalMinutes).ToString()) < iThoiGianNhoNhat)
                                            {
                                                goto Label12;
                                            }
                                            iKiemTraLanChamTuDongKhongQuaDemLichTrinhVaoRa = 0;
                                            iKiemTraLanChamKhoangCachTuDongKhongQuaDemLichTrinhVaoRa = 3;
                                            this.DGVDuLieuChamCongNguon.Rows[addGioNguonTuDongKhongQuaDem].Cells[0].Value = this.sMaChamCong;
                                            this.DGVDuLieuChamCongNguon.Rows[addGioNguonTuDongKhongQuaDem].Cells[1].Value = string.Format("{0:d}", dGioRaTuDongKhongQuaDemLichTrinhVaoRa);
                                            this.DGVDuLieuChamCongNguon.Rows[addGioNguonTuDongKhongQuaDem].Cells[2].Value = dGioRaTuDongKhongQuaDemLichTrinhVaoRa;
                                            this.DGVDuLieuChamCongNguon.Rows[addGioNguonTuDongKhongQuaDem].Cells[3].Value = "Ra";
                                            this.DGVDuLieuChamCongNguon.Rows[addGioNguonTuDongKhongQuaDem].Cells[4].Value = "O";
                                            this.DGVDuLieuChamCongNguon.Rows[addGioNguonTuDongKhongQuaDem].Cells[6].Value = dtTuDong.Rows[iTuDong]["MaSoMay"].ToString();
                                        }
                                        iKiemTraDuLieuTuDong = 1;
                                        iKiemTraLanCham++;
                                        if (iKiemTraLanCham == 1)
                                        {
                                            dGioVaoTuDong = Convert.ToDateTime(dtTuDong.Rows[iTuDong]["GioCham"].ToString());
                                            this.DGVTinhCong.Rows[_nhanVien].Cells[5].Value = string.Format(this.sDinhDangThoiGian, dGioVaoTuDong);
                                            this.DGVTinhCong.Rows[_nhanVien].Cells[0].Value = this.sMaNhanVien;
                                            this.DGVTinhCong.Rows[_nhanVien].Cells[1].Value = this.sTenNhanVien;
                                            this.DGVTinhCong.Rows[_nhanVien].Cells[2].Value = this.DGVTinhCong.Rows[_nhanVien].Cells[2].Value.ToString();
                                            if (this.iNgonNgu == 0)
                                            {
                                                DataGridViewCell item3 = this.DGVTinhCong.Rows[_nhanVien].Cells[3];
                                                dateTime = dt.AddDays((double)dem);
                                                item3.Value = DateTimeProgress.XuatThuTinhCong((int)dateTime.DayOfWeek);
                                            }
                                            if (this.iNgonNgu == 1)
                                            {
                                                DataGridViewCell dataGridViewCell3 = this.DGVTinhCong.Rows[_nhanVien].Cells[3];
                                                dateTime = dt.AddDays((double)dem);
                                                dataGridViewCell3.Value = DateTimeProgress.XuatThuEnglish((int)dateTime.DayOfWeek);
                                            }
                                            dtNhanCaTuDongKhongQuaDem = new System.Data.DataTable();
                                            this._chiTietLichTrinhChoCalamViecDTO.MaLichTrinhCaLamViec = sLTCCLVNhanVien;
                                            this._chiTietLichTrinhChoCalamViecDTO.Thu = sThu;
                                            dtNhanCaTuDongKhongQuaDem = this._chiTietLichTrinhChoCaLamViecBLL.ChiTietLichTrinhChoCaLamViecNhanCa(this._chiTietLichTrinhChoCalamViecDTO);
                                            iChiTietLichTrinhChoCaLamViecTuDongKhongQuaDem = 0;
                                            if (iChiTietLichTrinhChoCaLamViecTuDongKhongQuaDem < dtNhanCaTuDongKhongQuaDem.Rows.Count)
                                            {
                                                cellChiTietLichTrinhChoCaLamViecTuDongKhongQuaDem = 3;
                                                while (cellChiTietLichTrinhChoCaLamViecTuDongKhongQuaDem < 13)
                                                {
                                                    kiemTraVao = 0;
                                                    kiemTraRa = 0;
                                                    this.sTuDongQuaDemMaCaLamViec = dtNhanCaTuDongKhongQuaDem.Rows[iChiTietLichTrinhChoCaLamViecTuDongKhongQuaDem][cellChiTietLichTrinhChoCaLamViecTuDongKhongQuaDem].ToString();
                                                    dtTuDongQuaDemCa = new System.Data.DataTable();
                                                    this._caLamViecDTO.MaCaLamViec = this.sTuDongQuaDemMaCaLamViec;
                                                    dtTuDongQuaDemCa = this._caLamViecBLL.CaLamViecGetByMaCaLamViec(this._caLamViecDTO);
                                                    iTuDongQuaDemCa = 0;
                                                    while (iTuDongQuaDemCa < dtTuDongQuaDemCa.Rows.Count)
                                                    {
                                                        this.sTuDongQuaDemTenCaLamViec = dtTuDongQuaDemCa.Rows[iTuDongQuaDemCa]["CaLamViec"].ToString();
                                                        dBatDauVaoA = Convert.ToDateTime(dtTuDongQuaDemCa.Rows[iTuDongQuaDemCa]["BatDauVao"].ToString());
                                                        sBatDauVaoA = string.Format("{0:T}", dBatDauVaoA);
                                                        sBatDauVaoB = string.Concat(sNgayCham, " ", sBatDauVaoA);
                                                        dBatDauVaoB = Convert.ToDateTime(sBatDauVaoB);
                                                        dKetThucVaoA = Convert.ToDateTime(dtTuDongQuaDemCa.Rows[iTuDongQuaDemCa]["KetThucVao"].ToString());
                                                        sKetThucVaoA = string.Format("{0:T}", dKetThucVaoA);
                                                        sKetThucVaoB = string.Concat(sNgayCham, " ", sKetThucVaoA);
                                                        dKetThucVaoB = Convert.ToDateTime(sKetThucVaoB);
                                                        dBatDauRaA = Convert.ToDateTime(dtTuDongQuaDemCa.Rows[iTuDongQuaDemCa]["BatDauRa"].ToString());
                                                        sBatDauRaA = string.Format("{0:T}", dBatDauRaA);
                                                        sBatDauRaB = string.Concat(sNgayCham, " ", sBatDauRaA);
                                                        dBatDauRaB = Convert.ToDateTime(sBatDauRaB);
                                                        dKetThucRaA = Convert.ToDateTime(dtTuDongQuaDemCa.Rows[iTuDongQuaDemCa]["KetThucRa"].ToString());
                                                        sKetThucRaA = string.Format("{0:T}", dKetThucRaA);
                                                        sKetThucRaB = string.Concat(sNgayCham, " ", sKetThucRaA);
                                                        dKetThucRaB = Convert.ToDateTime(sKetThucRaB);
                                                        if ((dGioVaoTuDong < dBatDauVaoB ? false : dGioVaoTuDong <= dKetThucVaoB))
                                                        {
                                                            kiemTraVao++;
                                                        }
                                                        if ((dGioRaTuDong < dBatDauRaB ? false : dGioRaTuDong <= dKetThucRaB))
                                                        {
                                                            kiemTraRa++;
                                                        }
                                                        if ((kiemTraVao != 1 ? true : kiemTraRa != 0))
                                                        {
                                                            iTuDongQuaDemCa++;
                                                        }
                                                        else
                                                        {
                                                            goto Label14;
                                                        }
                                                    }
                                                    if (!(this.sTuDongQuaDemMaCaLamViec == ""))
                                                    {
                                                        cellChiTietLichTrinhChoCaLamViecTuDongKhongQuaDem++;
                                                    }
                                                    else
                                                    {
                                                        this.DGVTinhCong.Rows[_nhanVien].Cells[4].Value = "***";
                                                        this.DGVTinhCong.Rows[_nhanVien].Cells[7].Value = "0";
                                                        this.DGVTinhCong.Rows[_nhanVien].Cells[8].Value = "0";
                                                        this.DGVTinhCong.Rows[_nhanVien].Cells[9].Value = "0";
                                                        this.DGVTinhCong.Rows[_nhanVien].Cells[10].Value = "0";
                                                        this.DGVTinhCong.Rows[_nhanVien].Cells[11].Value = "0";
                                                        this.DGVTinhCong.Rows[_nhanVien].Cells[12].Value = "0";
                                                        this.DGVTinhCong.Rows[_nhanVien].Cells[13].Value = "0";
                                                        this.DGVTinhCong.Rows[_nhanVien].Cells[14].Value = "0";
                                                        this.DGVTinhCong.Rows[_nhanVien].Cells[15].Value = "0";
                                                        this.DGVTinhCong.Rows[_nhanVien].Cells[16].Value = "0";
                                                        this.DGVTinhCong.Rows[_nhanVien].Cells[17].Value = "0";
                                                        this.DGVTinhCong.Rows[_nhanVien].Cells[18].Value = this.sKHVang;
                                                        if (!(DateTimeProgress.XuatIDThu((int)dt.AddDays((double)dem).DayOfWeek) == "0"))
                                                        {
                                                            this.DGVTinhCong.Rows[_nhanVien].Cells[19].Value = "NT";
                                                        }
                                                        else
                                                        {
                                                            this.DGVTinhCong.Rows[_nhanVien].Cells[19].Value = "CN";
                                                        }
                                                        this.DGVTinhCong.Rows[_nhanVien].Cells[20].Value = this.sMaChamCong;
                                                        this.DGVTinhCong.Rows[_nhanVien].Cells[21].Value = this.sPhongBanTinhCong;
                                                        goto Label13;
                                                    }
                                                }
                                            Label14:
                                                this.DGVTinhCong.Rows[_nhanVien].Cells[4].Value = this.sTuDongQuaDemTenCaLamViec;
                                                this.DGVTinhCong.Rows[_nhanVien].Cells[7].Value = "0";
                                                this.DGVTinhCong.Rows[_nhanVien].Cells[8].Value = "0";
                                                this.DGVTinhCong.Rows[_nhanVien].Cells[9].Value = "0";
                                                this.DGVTinhCong.Rows[_nhanVien].Cells[10].Value = "0";
                                                this.DGVTinhCong.Rows[_nhanVien].Cells[11].Value = "0";
                                                this.DGVTinhCong.Rows[_nhanVien].Cells[12].Value = "0";
                                                this.DGVTinhCong.Rows[_nhanVien].Cells[13].Value = "0";
                                                this.DGVTinhCong.Rows[_nhanVien].Cells[14].Value = "0";
                                                this.DGVTinhCong.Rows[_nhanVien].Cells[15].Value = "0";
                                                this.DGVTinhCong.Rows[_nhanVien].Cells[16].Value = "0";
                                                this.DGVTinhCong.Rows[_nhanVien].Cells[17].Value = "0";
                                                this.DGVTinhCong.Rows[_nhanVien].Cells[18].Value = this.sKHVang;
                                                if (!(DateTimeProgress.XuatIDThu((int)dt.AddDays((double)dem).DayOfWeek) == "0"))
                                                {
                                                    this.DGVTinhCong.Rows[_nhanVien].Cells[19].Value = "NT";
                                                }
                                                else
                                                {
                                                    this.DGVTinhCong.Rows[_nhanVien].Cells[19].Value = "CN";
                                                }
                                                this.DGVTinhCong.Rows[_nhanVien].Cells[20].Value = this.sMaChamCong;
                                                this.DGVTinhCong.Rows[_nhanVien].Cells[21].Value = this.sPhongBanTinhCong;
                                            }
                                        Label13:
                                            if (dtTuDong.Rows.Count == 1)
                                            {
                                            }
                                        }
                                        if (iKiemTraLanCham == 2)
                                        {
                                            dGioRaTuDong = Convert.ToDateTime(dtTuDong.Rows[iTuDong]["GioCham"].ToString());
                                            value = dGioRaTuDong - dGioVaoTuDong;
                                            iHieuPhutTuDong = Convert.ToInt32(value.TotalMinutes);
                                            if (Convert.ToInt32(Convert.ToInt32((dGioRaTuDongKhongQuaDemLichTrinhVaoRa - dGioVaoTuDongKhongQuaDemLichTrinhVaoRa).TotalMinutes).ToString()) <= iThoiGianLonNhat)
                                            {
                                                this.DGVTinhCong.Rows[_nhanVien].Cells[6].Value = string.Format(this.sDinhDangThoiGian, dGioRaTuDong);
                                                dtNhanCaTuDongKhongQuaDem = new System.Data.DataTable();
                                                this._chiTietLichTrinhChoCalamViecDTO.MaLichTrinhCaLamViec = sLTCCLVNhanVien;
                                                this._chiTietLichTrinhChoCalamViecDTO.Thu = sThu;
                                                dtNhanCaTuDongKhongQuaDem = this._chiTietLichTrinhChoCaLamViecBLL.ChiTietLichTrinhChoCaLamViecNhanCa(this._chiTietLichTrinhChoCalamViecDTO);
                                                iChiTietLichTrinhChoCaLamViecTuDongKhongQuaDem = 0;
                                                if (iChiTietLichTrinhChoCaLamViecTuDongKhongQuaDem < dtNhanCaTuDongKhongQuaDem.Rows.Count)
                                                {
                                                    cellChiTietLichTrinhChoCaLamViecTuDongKhongQuaDem = 3;
                                                    while (cellChiTietLichTrinhChoCaLamViecTuDongKhongQuaDem < 13)
                                                    {
                                                        kiemTraVao = 0;
                                                        kiemTraRa = 0;
                                                        this.sTuDongQuaDemMaCaLamViec = dtNhanCaTuDongKhongQuaDem.Rows[iChiTietLichTrinhChoCaLamViecTuDongKhongQuaDem][cellChiTietLichTrinhChoCaLamViecTuDongKhongQuaDem].ToString();
                                                        dtTuDongQuaDemCa = new System.Data.DataTable();
                                                        this._caLamViecDTO.MaCaLamViec = this.sTuDongQuaDemMaCaLamViec;
                                                        dtTuDongQuaDemCa = this._caLamViecBLL.CaLamViecGetByMaCaLamViec(this._caLamViecDTO);
                                                        iTuDongQuaDemCa = 0;
                                                        while (iTuDongQuaDemCa < dtTuDongQuaDemCa.Rows.Count)
                                                        {
                                                            second = dGioVaoTuDong.Second;
                                                            sGiayGioVao = second.ToString();
                                                            second = dGioRaTuDong.Second;
                                                            sGiayGioRa = second.ToString();
                                                            this.sTuDongQuaDemTenCaLamViec = dtTuDongQuaDemCa.Rows[iTuDongQuaDemCa]["CaLamViec"].ToString();
                                                            dBatDauVaoA = Convert.ToDateTime(dtTuDongQuaDemCa.Rows[iTuDongQuaDemCa]["BatDauVao"].ToString());
                                                            sBatDauVaoA = string.Format("{0:T}", dBatDauVaoA).Replace("00 ", string.Concat(sGiayGioVao, " "));
                                                            sBatDauVaoB = string.Concat(sNgayCham, " ", sBatDauVaoA);
                                                            dBatDauVaoB = Convert.ToDateTime(sBatDauVaoB);
                                                            dKetThucVaoA = Convert.ToDateTime(dtTuDongQuaDemCa.Rows[iTuDongQuaDemCa]["KetThucVao"].ToString());
                                                            sKetThucVaoA = string.Format("{0:T}", dKetThucVaoA).Replace("00 ", string.Concat(sGiayGioVao, " "));
                                                            sKetThucVaoB = string.Concat(sNgayCham, " ", sKetThucVaoA);
                                                            dKetThucVaoB = Convert.ToDateTime(sKetThucVaoB);
                                                            dBatDauRaA = Convert.ToDateTime(dtTuDongQuaDemCa.Rows[iTuDongQuaDemCa]["BatDauRa"].ToString());
                                                            sBatDauRaA = string.Format("{0:T}", dBatDauRaA).Replace("00 ", string.Concat(sGiayGioRa, " "));
                                                            sBatDauRaB = string.Concat(sNgayCham, " ", sBatDauRaA);
                                                            dBatDauRaB = Convert.ToDateTime(sBatDauRaB);
                                                            dKetThucRaA = Convert.ToDateTime(dtTuDongQuaDemCa.Rows[iTuDongQuaDemCa]["KetThucRa"].ToString());
                                                            sKetThucRaA = string.Format("{0:T}", dKetThucRaA).Replace("00 ", string.Concat(sGiayGioRa, " "));
                                                            sKetThucRaB = string.Concat(sNgayCham, " ", sKetThucRaA);
                                                            dKetThucRaB = Convert.ToDateTime(sKetThucRaB);
                                                            if ((dGioVaoTuDong < dBatDauVaoB ? false : dGioVaoTuDong <= dKetThucVaoB))
                                                            {
                                                                kiemTraVao++;
                                                            }
                                                            if ((dGioRaTuDong < dBatDauRaB ? false : dGioRaTuDong <= dKetThucRaB))
                                                            {
                                                                kiemTraRa++;
                                                            }
                                                            if ((kiemTraVao != 1 ? true : kiemTraRa != 1))
                                                            {
                                                                iTuDongQuaDemCa++;
                                                            }
                                                            else
                                                            {
                                                                goto Label16;
                                                            }
                                                        }
                                                        if (!(this.sTuDongQuaDemMaCaLamViec == ""))
                                                        {
                                                            cellChiTietLichTrinhChoCaLamViecTuDongKhongQuaDem++;
                                                        }
                                                        else
                                                        {
                                                            this.DGVTinhCong.Rows[_nhanVien].Cells[4].Value = "***";
                                                            this.DGVTinhCong.Rows[_nhanVien].Cells[7].Value = "0";
                                                            this.DGVTinhCong.Rows[_nhanVien].Cells[8].Value = "0";
                                                            this.DGVTinhCong.Rows[_nhanVien].Cells[9].Value = "0";
                                                            this.DGVTinhCong.Rows[_nhanVien].Cells[10].Value = "0";
                                                            this.DGVTinhCong.Rows[_nhanVien].Cells[11].Value = "0";
                                                            this.DGVTinhCong.Rows[_nhanVien].Cells[12].Value = "0";
                                                            this.DGVTinhCong.Rows[_nhanVien].Cells[13].Value = "0";
                                                            this.DGVTinhCong.Rows[_nhanVien].Cells[14].Value = "0";
                                                            this.DGVTinhCong.Rows[_nhanVien].Cells[15].Value = "0";
                                                            this.DGVTinhCong.Rows[_nhanVien].Cells[16].Value = "0";
                                                            this.DGVTinhCong.Rows[_nhanVien].Cells[17].Value = "0";
                                                            this.DGVTinhCong.Rows[_nhanVien].Cells[18].Value = this.sKHVang;
                                                            if (!(DateTimeProgress.XuatIDThu((int)dt.AddDays((double)dem).DayOfWeek) == "0"))
                                                            {
                                                                this.DGVTinhCong.Rows[_nhanVien].Cells[19].Value = "NT";
                                                            }
                                                            else
                                                            {
                                                                this.DGVTinhCong.Rows[_nhanVien].Cells[19].Value = "CN";
                                                            }
                                                            this.DGVTinhCong.Rows[_nhanVien].Cells[20].Value = this.sMaChamCong;
                                                            this.DGVTinhCong.Rows[_nhanVien].Cells[21].Value = this.sPhongBanTinhCong;
                                                            goto Label15;
                                                        }
                                                    }
                                                Label16:
                                                    this.DGVTinhCong.Rows[_nhanVien].Cells[4].Value = this.sTuDongQuaDemTenCaLamViec;
                                                    dtCaLamViecTuDongKhongQuaDem = new System.Data.DataTable();
                                                    this._caLamViecDTO.MaCaLamViec = this.sTuDongQuaDemMaCaLamViec;
                                                    dtCaLamViecTuDongKhongQuaDem = this._caLamViecBLL.CaLamViecGetByMaCaLamViec(this._caLamViecDTO);
                                                    for (iCaLamViecTuDongKhongQuaDem = 0; iCaLamViecTuDongKhongQuaDem < dtCaLamViecTuDongKhongQuaDem.Rows.Count; iCaLamViecTuDongKhongQuaDem++)
                                                    {
                                                        second = dGioVaoTuDong.Second;
                                                        sGiayGioVao = second.ToString();
                                                        second = dGioRaTuDong.Second;
                                                        sGiayGioRa = second.ToString();
                                                        dGioVaoKhaiBaoTuDongKhongQuaDemA = Convert.ToDateTime(dtCaLamViecTuDongKhongQuaDem.Rows[iCaLamViecTuDongKhongQuaDem]["GioVaoLamViec"].ToString());
                                                        sGioVaoKhaiBaoTuDongKhongQuaDemA = string.Format("{0:T}", dGioVaoKhaiBaoTuDongKhongQuaDemA).Replace("00 ", string.Concat(sGiayGioVao, " "));
                                                        sGioVaoKhaiBaoTuDongKhongQuaDemB = string.Concat(sNgayCham, " ", sGioVaoKhaiBaoTuDongKhongQuaDemA);
                                                        dGioVaoKhaiBaoTuDongKhongQuaDemB = Convert.ToDateTime(sGioVaoKhaiBaoTuDongKhongQuaDemB);
                                                        dGioRaKhaiBaoTuDongKhongQuaDemA = Convert.ToDateTime(dtCaLamViecTuDongKhongQuaDem.Rows[iCaLamViecTuDongKhongQuaDem]["GioKetThucLamViec"].ToString());
                                                        sGioRaKhaiBaoTuDongKhongQuaDemA = string.Format("{0:T}", dGioRaKhaiBaoTuDongKhongQuaDemA).Replace("00 ", string.Concat(sGiayGioRa, " "));
                                                        sGioRaKhaiBaoTuDongKhongQuaDemB = string.Concat(sNgayCham, " ", sGioRaKhaiBaoTuDongKhongQuaDemA);
                                                        dGioRaKhaiBaoTuDongKhongQuaDemB = Convert.ToDateTime(sGioRaKhaiBaoTuDongKhongQuaDemB);
                                                        sXemCaNayLaTangCa = dtCaLamViecTuDongKhongQuaDem.Rows[iCaLamViecTuDongKhongQuaDem]["XemCaNayLaTangCa"].ToString();
                                                        iTangCaMuc = Convert.ToInt32(dtCaLamViecTuDongKhongQuaDem.Rows[iCaLamViecTuDongKhongQuaDem]["TangCaMuc"].ToString());
                                                        sXemChuNhatLaTangCa = dtCaLamViecTuDongKhongQuaDem.Rows[iCaLamViecTuDongKhongQuaDem]["XemCuoiTuanLaTangCa"].ToString();
                                                        iTangCaChuNhatMuc = Convert.ToInt32(dtCaLamViecTuDongKhongQuaDem.Rows[iCaLamViecTuDongKhongQuaDem]["TangCaCuoiTuanMuc"].ToString());
                                                        if (sXemCaNayLaTangCa == "True")
                                                        {
                                                            sTruGioDiTre = dtCaLamViecTuDongKhongQuaDem.Rows[iCaLamViecTuDongKhongQuaDem]["TruGioDiTre"].ToString();
                                                            sBatDauTinhDiTre = dtCaLamViecTuDongKhongQuaDem.Rows[iCaLamViecTuDongKhongQuaDem]["BatDauTinhDiTre"].ToString();
                                                            iChoPhepDiTre = Convert.ToInt32(dtCaLamViecTuDongKhongQuaDem.Rows[iCaLamViecTuDongKhongQuaDem]["ChoPhepDiTre"].ToString());
                                                            value = dGioVaoTuDong - dGioVaoKhaiBaoTuDongKhongQuaDemB;
                                                            second = Convert.ToInt32(value.TotalMinutes);
                                                            sPhutTre = second.ToString();
                                                            if (Convert.ToInt32(sPhutTre) < 0)
                                                            {
                                                                sPhutTre = "0";
                                                            }
                                                            sTruGioVeSom = dtCaLamViecTuDongKhongQuaDem.Rows[iCaLamViecTuDongKhongQuaDem]["TruGioVeSom"].ToString();
                                                            sBatDauTinhVeSom = dtCaLamViecTuDongKhongQuaDem.Rows[iCaLamViecTuDongKhongQuaDem]["BatDauTinhVeSom"].ToString();
                                                            iChoPhepVeSom = Convert.ToInt32(dtCaLamViecTuDongKhongQuaDem.Rows[iCaLamViecTuDongKhongQuaDem]["ChoPhepVeSom"].ToString());
                                                            value = dGioRaKhaiBaoTuDongKhongQuaDemB - dGioRaTuDong;
                                                            second = Convert.ToInt32(value.TotalMinutes);
                                                            sPhutVeSom = second.ToString();
                                                            if (Convert.ToInt32(sPhutVeSom) < 0)
                                                            {
                                                                sPhutVeSom = "0";
                                                            }
                                                            dTongPhutTangCaTuDongKhongQuaDem = Convert.ToDouble(dtCaLamViecTuDongKhongQuaDem.Rows[iCaLamViecTuDongKhongQuaDem]["TongGioTrongCaLamViec"]) * 60 - (Convert.ToDouble(sPhutTre) + Convert.ToDouble(sPhutVeSom));
                                                            dTongGioTangCaTuDongKhongQuaDem = Math.Round(dTongPhutTangCaTuDongKhongQuaDem / 60, this.iLamTronGio);
                                                            if (iTangCaMuc == 1)
                                                            {
                                                                if (dTongGioTangCaTuDongKhongQuaDem > 3)
                                                                {
                                                                    this.DGVTinhCong.Rows[_nhanVien].Cells[12].Value = 3 * this.dTangCa1HeSo;
                                                                }
                                                                else
                                                                {
                                                                    this.DGVTinhCong.Rows[_nhanVien].Cells[12].Value = dTongGioTangCaTuDongKhongQuaDem * this.dTangCa1HeSo;
                                                                }
                                                                this.DGVTinhCong.Rows[_nhanVien].Cells[18].Value = this.sKHDungGio;
                                                            }
                                                            if (iTangCaMuc == 2)
                                                            {
                                                                this.DGVTinhCong.Rows[_nhanVien].Cells[13].Value = dTongGioTangCaTuDongKhongQuaDem * this.dTangCa2HeSo;
                                                                this.DGVTinhCong.Rows[_nhanVien].Cells[18].Value = this.sKHDungGio;
                                                            }
                                                            if (iTangCaMuc == 3)
                                                            {
                                                                this.DGVTinhCong.Rows[_nhanVien].Cells[14].Value = dTongGioTangCaTuDongKhongQuaDem * this.dTangCa3HeSo;
                                                                this.DGVTinhCong.Rows[_nhanVien].Cells[18].Value = this.sKHDungGio;
                                                            }
                                                            if (iTangCaMuc == 4)
                                                            {
                                                                this.DGVTinhCong.Rows[_nhanVien].Cells[15].Value = dTongGioTangCaTuDongKhongQuaDem * this.dTangCa4HeSo;
                                                                this.DGVTinhCong.Rows[_nhanVien].Cells[18].Value = this.sKHDungGio;
                                                            }
                                                        }
                                                        else if (!(DateTimeProgress.XuatIDThu((int)dt.AddDays((double)dem).DayOfWeek) == "0"))
                                                        {
                                                            sTruGioDiTre = dtCaLamViecTuDongKhongQuaDem.Rows[iCaLamViecTuDongKhongQuaDem]["TruGioDiTre"].ToString();
                                                            sBatDauTinhDiTre = dtCaLamViecTuDongKhongQuaDem.Rows[iCaLamViecTuDongKhongQuaDem]["BatDauTinhDiTre"].ToString();
                                                            iChoPhepDiTre = Convert.ToInt32(dtCaLamViecTuDongKhongQuaDem.Rows[iCaLamViecTuDongKhongQuaDem]["ChoPhepDiTre"].ToString());
                                                            value = dGioVaoTuDong - dGioVaoKhaiBaoTuDongKhongQuaDemB;
                                                            second = Convert.ToInt32(value.TotalMinutes);
                                                            sPhutTre = second.ToString();
                                                            if (!(sTruGioDiTre == "True"))
                                                            {
                                                                this.DGVTinhCong.Rows[_nhanVien].Cells[9].Value = "0";
                                                            }
                                                            else if (Convert.ToInt32(sPhutTre) >= 0)
                                                            {
                                                                iPhutTre = Convert.ToInt32(sPhutTre) - iChoPhepDiTre;
                                                                if (sBatDauTinhDiTre == "True")
                                                                {
                                                                    if (iPhutTre >= 1)
                                                                    {
                                                                        this.DGVTinhCong.Rows[_nhanVien].Cells[9].Value = iPhutTre.ToString();
                                                                    }
                                                                    else
                                                                    {
                                                                        this.DGVTinhCong.Rows[_nhanVien].Cells[9].Value = "0";
                                                                    }
                                                                }
                                                                else if (iPhutTre >= 1)
                                                                {
                                                                    this.DGVTinhCong.Rows[_nhanVien].Cells[9].Value = sPhutTre;
                                                                }
                                                                else
                                                                {
                                                                    this.DGVTinhCong.Rows[_nhanVien].Cells[9].Value = "0";
                                                                }
                                                            }
                                                            else
                                                            {
                                                                this.DGVTinhCong.Rows[_nhanVien].Cells[9].Value = "0";
                                                            }
                                                            sTruGioVeSom = dtCaLamViecTuDongKhongQuaDem.Rows[iCaLamViecTuDongKhongQuaDem]["TruGioVeSom"].ToString();
                                                            sBatDauTinhVeSom = dtCaLamViecTuDongKhongQuaDem.Rows[iCaLamViecTuDongKhongQuaDem]["BatDauTinhVeSom"].ToString();
                                                            iChoPhepVeSom = Convert.ToInt32(dtCaLamViecTuDongKhongQuaDem.Rows[iCaLamViecTuDongKhongQuaDem]["ChoPhepVeSom"].ToString());
                                                            value = dGioRaKhaiBaoTuDongKhongQuaDemB - dGioRaTuDong;
                                                            second = Convert.ToInt32(value.TotalMinutes);
                                                            sPhutVeSom = second.ToString();
                                                            if (!(sTruGioVeSom == "True"))
                                                            {
                                                                this.DGVTinhCong.Rows[_nhanVien].Cells[10].Value = "0";
                                                            }
                                                            else if (Convert.ToInt32(sPhutVeSom) >= 0)
                                                            {
                                                                iPhutVeSom = Convert.ToInt32(sPhutVeSom) - iChoPhepVeSom;
                                                                if (iPhutVeSom < 1)
                                                                {
                                                                    this.DGVTinhCong.Rows[_nhanVien].Cells[10].Value = "0";
                                                                }
                                                                else if (!(sBatDauTinhVeSom == "True"))
                                                                {
                                                                    this.DGVTinhCong.Rows[_nhanVien].Cells[10].Value = sPhutVeSom;
                                                                }
                                                                else
                                                                {
                                                                    this.DGVTinhCong.Rows[_nhanVien].Cells[10].Value = iPhutVeSom.ToString();
                                                                }
                                                            }
                                                            else
                                                            {
                                                                this.DGVTinhCong.Rows[_nhanVien].Cells[10].Value = "0";
                                                            }
                                                            value = dGioRaTuDong - dGioRaKhaiBaoTuDongKhongQuaDemB;
                                                            second = Convert.ToInt32(value.TotalMinutes);
                                                            sVeTre = second.ToString();
                                                            if (Convert.ToInt32(sVeTre) <= 0)
                                                            {
                                                                this.DGVTinhCong.Rows[_nhanVien].Cells[11].Value = "0";
                                                            }
                                                            else
                                                            {
                                                                this.DGVTinhCong.Rows[_nhanVien].Cells[11].Value = sVeTre;
                                                            }
                                                            iPhut = Convert.ToSingle(dtCaLamViecTuDongKhongQuaDem.Rows[iCaLamViecTuDongKhongQuaDem]["TongGioTrongCaLamViec"]) * 60f - (float)(Convert.ToInt32(this.DGVTinhCong.Rows[_nhanVien].Cells[9].Value.ToString()) + Convert.ToInt32(this.DGVTinhCong.Rows[_nhanVien].Cells[10].Value));
                                                            dGio = Math.Round(Convert.ToDouble(iPhut) / 60, this.iLamTronGio);
                                                            this.DGVTinhCong.Rows[_nhanVien].Cells[8].Value = dGio.ToString();
                                                            iGio = Convert.ToDouble(dtCaLamViecTuDongKhongQuaDem.Rows[iCaLamViecTuDongKhongQuaDem]["TongGioTrongCaLamViec"].ToString());
                                                            dCongTinh = Convert.ToDouble(dtCaLamViecTuDongKhongQuaDem.Rows[iCaLamViecTuDongKhongQuaDem]["CongTinh"].ToString());
                                                            dCong = Math.Round(dGio * dCongTinh / iGio, this.iLamTronCong);
                                                            this.DGVTinhCong.Rows[_nhanVien].Cells[7].Value = dCong.ToString();
                                                            value = dGioRaTuDong - dGioVaoTuDong;
                                                            second = Convert.ToInt32(value.TotalMinutes);
                                                            dTongGioThucTeTuDongKhongQuaDem = Math.Round(Convert.ToDouble(second.ToString()) / 60, this.iLamTronGio);
                                                            this.DGVTinhCong.Rows[_nhanVien].Cells[16].Value = dTongGioThucTeTuDongKhongQuaDem.ToString();
                                                            this.DGVTinhCong.Rows[_nhanVien].Cells[17].Value = dtCaLamViecTuDongKhongQuaDem.Rows[iCaLamViecTuDongKhongQuaDem]["CongTinh"].ToString();
                                                            this.DGVTinhCong.Rows[_nhanVien].Cells[18].Value = this.sKHDungGio;
                                                            sChoPhepTangCaTruocGioLamViecTuDongKhongQuaDem = dtCaLamViecTuDongKhongQuaDem.Rows[iCaLamViecTuDongKhongQuaDem]["TangCaTruocGioLamViec"].ToString();
                                                            iPhutTangCaTruocGioLamViecTuDongKhongQuaDem = Convert.ToInt32(dtCaLamViecTuDongKhongQuaDem.Rows[iCaLamViecTuDongKhongQuaDem]["SoPhutTangCaTruocGioLamViec"].ToString());
                                                            iPhutTangCaTruocGioLamViecDatDen = Convert.ToInt32(dtCaLamViecTuDongKhongQuaDem.Rows[iCaLamViecTuDongKhongQuaDem]["TangCaTruocGioLamViecDatDen"].ToString());
                                                            iPhutTruTangCaTruoc = Convert.ToInt32(dtCaLamViecTuDongKhongQuaDem.Rows[iCaLamViecTuDongKhongQuaDem]["PhutTruTangCaTruoc"].ToString());
                                                            sChoPhepTangCaSauGioLamViecTuDongKhongQuaDem = dtCaLamViecTuDongKhongQuaDem.Rows[iCaLamViecTuDongKhongQuaDem]["TangCaSauGioLamViec"].ToString();
                                                            iPhutTangCaSauGioLamViecTuDongKhongQuaDem = Convert.ToInt32(dtCaLamViecTuDongKhongQuaDem.Rows[iCaLamViecTuDongKhongQuaDem]["SoPhutTangCaSauGioLamViec"].ToString());
                                                            iPhutTangCaSauGioLamViecDatDen = Convert.ToInt32(dtCaLamViecTuDongKhongQuaDem.Rows[iCaLamViecTuDongKhongQuaDem]["TangCaSauGioLamViecDatDen"].ToString());
                                                            iPhutTruTangCaSau = Convert.ToInt32(dtCaLamViecTuDongKhongQuaDem.Rows[iCaLamViecTuDongKhongQuaDem]["PhutTruTangCaSau"].ToString());
                                                            iGioiHanTC1TuDongKhongQuaDem = Convert.ToInt32(dtCaLamViecTuDongKhongQuaDem.Rows[iCaLamViecTuDongKhongQuaDem]["GioiHanTangCa1"].ToString());
                                                            iGioiHanTC2TuDongKhongQuaDem = Convert.ToInt32(dtCaLamViecTuDongKhongQuaDem.Rows[iCaLamViecTuDongKhongQuaDem]["GioiHanTangCa2"].ToString());
                                                            iGioiHanTC3TuDongKhongQuaDem = Convert.ToInt32(dtCaLamViecTuDongKhongQuaDem.Rows[iCaLamViecTuDongKhongQuaDem]["GioiHanTangCa3"].ToString());
                                                            iGioiHanTC4TuDongKhongQuaDem = Convert.ToInt32(dtCaLamViecTuDongKhongQuaDem.Rows[iCaLamViecTuDongKhongQuaDem]["GioiHanTangCa4"].ToString());
                                                            iTongGioTangCaSauTuDongKhongQuaDem = 0;
                                                            iTongGioTangCaTruocTuDongKhongQuaDem = 0;
                                                            if ((sChoPhepTangCaTruocGioLamViecTuDongKhongQuaDem != "False" ? true : !(sChoPhepTangCaSauGioLamViecTuDongKhongQuaDem == "False")))
                                                            {
                                                                if (sChoPhepTangCaTruocGioLamViecTuDongKhongQuaDem == "True")
                                                                {
                                                                    value = dGioVaoKhaiBaoTuDongKhongQuaDemB - dGioVaoTuDong;
                                                                    second = Convert.ToInt32(value.TotalMinutes);
                                                                    iThoiGianTruocGioLamTuDongKhongQuaDem = Convert.ToInt32(second.ToString());
                                                                    if (iThoiGianTruocGioLamTuDongKhongQuaDem > 0)
                                                                    {
                                                                        if (iThoiGianTruocGioLamTuDongKhongQuaDem > iPhutTangCaTruocGioLamViecTuDongKhongQuaDem)
                                                                        {
                                                                            if (iThoiGianTruocGioLamTuDongKhongQuaDem > iPhutTangCaTruocGioLamViecDatDen)
                                                                            {
                                                                                iTongGioTangCaTruocTuDongKhongQuaDem = iThoiGianTruocGioLamTuDongKhongQuaDem - iPhutTruTangCaTruoc;
                                                                            }
                                                                        }
                                                                    }
                                                                }
                                                                if (sChoPhepTangCaSauGioLamViecTuDongKhongQuaDem == "True")
                                                                {
                                                                    value = dGioRaTuDong - dGioRaKhaiBaoTuDongKhongQuaDemB;
                                                                    second = Convert.ToInt32(value.TotalMinutes);
                                                                    iThoiGianSauGioLamViecTuDongKhongQuaDem = Convert.ToInt32(second.ToString());
                                                                    if (iThoiGianSauGioLamViecTuDongKhongQuaDem > 0)
                                                                    {
                                                                        if (iThoiGianSauGioLamViecTuDongKhongQuaDem > iPhutTangCaSauGioLamViecTuDongKhongQuaDem)
                                                                        {
                                                                            if (iThoiGianSauGioLamViecTuDongKhongQuaDem > iPhutTangCaSauGioLamViecDatDen)
                                                                            {
                                                                                iTongGioTangCaSauTuDongKhongQuaDem = iThoiGianSauGioLamViecTuDongKhongQuaDem - iPhutTruTangCaSau;
                                                                            }
                                                                        }
                                                                    }
                                                                }
                                                            }
                                                            else
                                                            {
                                                                this.DGVTinhCong.Rows[_nhanVien].Cells[12].Value = "0";
                                                                this.DGVTinhCong.Rows[_nhanVien].Cells[13].Value = "0";
                                                                this.DGVTinhCong.Rows[_nhanVien].Cells[14].Value = "0";
                                                                this.DGVTinhCong.Rows[_nhanVien].Cells[15].Value = "0";
                                                            }
                                                            dTongThoiGianTangCaTuDongKhongQuaDem = Convert.ToDouble(iTongGioTangCaTruocTuDongKhongQuaDem + iTongGioTangCaSauTuDongKhongQuaDem);
                                                            if (dTongThoiGianTangCaTuDongKhongQuaDem <= 0)
                                                            {
                                                                this.DGVTinhCong.Rows[_nhanVien].Cells[12].Value = "0";
                                                                this.DGVTinhCong.Rows[_nhanVien].Cells[13].Value = "0";
                                                                this.DGVTinhCong.Rows[_nhanVien].Cells[14].Value = "0";
                                                                this.DGVTinhCong.Rows[_nhanVien].Cells[15].Value = "0";
                                                            }
                                                            else
                                                            {
                                                                if (iGioiHanTC1TuDongKhongQuaDem == 0)
                                                                {
                                                                    this.DGVTinhCong.Rows[_nhanVien].Cells[12].Value = Math.Round(dTongThoiGianTangCaTuDongKhongQuaDem * this.dTangCa1HeSo / 60, this.iLamTronGio);
                                                                    this.DGVTinhCong.Rows[_nhanVien].Cells[13].Value = "0";
                                                                    this.DGVTinhCong.Rows[_nhanVien].Cells[14].Value = "0";
                                                                    this.DGVTinhCong.Rows[_nhanVien].Cells[15].Value = "0";
                                                                }
                                                                if ((iGioiHanTC1TuDongKhongQuaDem == 0 ? false : iGioiHanTC2TuDongKhongQuaDem == 0))
                                                                {
                                                                    if (dTongThoiGianTangCaTuDongKhongQuaDem >= Convert.ToDouble(iGioiHanTC1TuDongKhongQuaDem))
                                                                    {
                                                                        this.DGVTinhCong.Rows[_nhanVien].Cells[12].Value = Math.Round(Convert.ToDouble(iGioiHanTC1TuDongKhongQuaDem) / 60 * this.dTangCa1HeSo, this.iLamTronGio);
                                                                        if (dTongThoiGianTangCaTuDongKhongQuaDem - Convert.ToDouble(iGioiHanTC1TuDongKhongQuaDem) > 0)
                                                                        {
                                                                            this.DGVTinhCong.Rows[_nhanVien].Cells[13].Value = Math.Round((dTongThoiGianTangCaTuDongKhongQuaDem - Convert.ToDouble(iGioiHanTC1TuDongKhongQuaDem)) * this.dTangCa2HeSo / 60, this.iLamTronGio);
                                                                        }
                                                                        this.DGVTinhCong.Rows[_nhanVien].Cells[14].Value = "0";
                                                                        this.DGVTinhCong.Rows[_nhanVien].Cells[15].Value = "0";
                                                                    }
                                                                    else
                                                                    {
                                                                        this.DGVTinhCong.Rows[_nhanVien].Cells[12].Value = Math.Round(dTongThoiGianTangCaTuDongKhongQuaDem * this.dTangCa1HeSo / 60, this.iLamTronGio);
                                                                        this.DGVTinhCong.Rows[_nhanVien].Cells[13].Value = "0";
                                                                        this.DGVTinhCong.Rows[_nhanVien].Cells[14].Value = "0";
                                                                        this.DGVTinhCong.Rows[_nhanVien].Cells[15].Value = "0";
                                                                    }
                                                                }
                                                                if ((iGioiHanTC1TuDongKhongQuaDem == 0 || iGioiHanTC2TuDongKhongQuaDem == 0 ? false : iGioiHanTC3TuDongKhongQuaDem == 0))
                                                                {
                                                                    if (dTongThoiGianTangCaTuDongKhongQuaDem >= Convert.ToDouble(iGioiHanTC1TuDongKhongQuaDem))
                                                                    {
                                                                        this.DGVTinhCong.Rows[_nhanVien].Cells[12].Value = Math.Round(Convert.ToDouble(iGioiHanTC1TuDongKhongQuaDem) * this.dTangCa1HeSo / 60, this.iLamTronGio);
                                                                        if (dTongThoiGianTangCaTuDongKhongQuaDem - Convert.ToDouble(iGioiHanTC1TuDongKhongQuaDem) >= Convert.ToDouble(iGioiHanTC2TuDongKhongQuaDem))
                                                                        {
                                                                            this.DGVTinhCong.Rows[_nhanVien].Cells[12].Value = Math.Round(Convert.ToDouble(iGioiHanTC1TuDongKhongQuaDem) * this.dTangCa1HeSo / 60, this.iLamTronGio);
                                                                            this.DGVTinhCong.Rows[_nhanVien].Cells[13].Value = Math.Round(Convert.ToDouble(iGioiHanTC2TuDongKhongQuaDem) * this.dTangCa2HeSo / 60, this.iLamTronGio);
                                                                            this.DGVTinhCong.Rows[_nhanVien].Cells[14].Value = Math.Round((dTongThoiGianTangCaTuDongKhongQuaDem - Convert.ToDouble(iGioiHanTC1TuDongKhongQuaDem) - Convert.ToDouble(iGioiHanTC2TuDongKhongQuaDem)) * this.dTangCa3HeSo / 60, this.iLamTronGio);
                                                                            this.DGVTinhCong.Rows[_nhanVien].Cells[15].Value = "0";
                                                                        }
                                                                        else
                                                                        {
                                                                            this.DGVTinhCong.Rows[_nhanVien].Cells[13].Value = Math.Round((dTongThoiGianTangCaTuDongKhongQuaDem - Convert.ToDouble(iGioiHanTC1TuDongKhongQuaDem)) * this.dTangCa2HeSo / 60, this.iLamTronGio);
                                                                            this.DGVTinhCong.Rows[_nhanVien].Cells[14].Value = "0";
                                                                            this.DGVTinhCong.Rows[_nhanVien].Cells[15].Value = "0";
                                                                        }
                                                                    }
                                                                    else
                                                                    {
                                                                        this.DGVTinhCong.Rows[_nhanVien].Cells[12].Value = Math.Round(dTongThoiGianTangCaTuDongKhongQuaDem * this.dTangCa1HeSo / 60, this.iLamTronGio);
                                                                        this.DGVTinhCong.Rows[_nhanVien].Cells[13].Value = "0";
                                                                        this.DGVTinhCong.Rows[_nhanVien].Cells[14].Value = "0";
                                                                        this.DGVTinhCong.Rows[_nhanVien].Cells[15].Value = "0";
                                                                    }
                                                                }
                                                                if ((iGioiHanTC1TuDongKhongQuaDem == 0 || iGioiHanTC2TuDongKhongQuaDem == 0 || iGioiHanTC3TuDongKhongQuaDem == 0 ? false : iGioiHanTC4TuDongKhongQuaDem == 0))
                                                                {
                                                                }
                                                            }
                                                        }
                                                        else if (!(sXemChuNhatLaTangCa == "True"))
                                                        {
                                                            sTruGioDiTre = dtCaLamViecTuDongKhongQuaDem.Rows[iCaLamViecTuDongKhongQuaDem]["TruGioDiTre"].ToString();
                                                            sBatDauTinhDiTre = dtCaLamViecTuDongKhongQuaDem.Rows[iCaLamViecTuDongKhongQuaDem]["BatDauTinhDiTre"].ToString();
                                                            iChoPhepDiTre = Convert.ToInt32(dtCaLamViecTuDongKhongQuaDem.Rows[iCaLamViecTuDongKhongQuaDem]["ChoPhepDiTre"].ToString());
                                                            value = dGioVaoTuDong - dGioVaoKhaiBaoTuDongKhongQuaDemB;
                                                            second = Convert.ToInt32(value.TotalMinutes);
                                                            sPhutTre = second.ToString();
                                                            if (!(sTruGioDiTre == "True"))
                                                            {
                                                                this.DGVTinhCong.Rows[_nhanVien].Cells[9].Value = "0";
                                                            }
                                                            else if (Convert.ToInt32(sPhutTre) >= 0)
                                                            {
                                                                iPhutTre = Convert.ToInt32(sPhutTre) - iChoPhepDiTre;
                                                                if (sBatDauTinhDiTre == "True")
                                                                {
                                                                    if (iPhutTre >= 1)
                                                                    {
                                                                        this.DGVTinhCong.Rows[_nhanVien].Cells[9].Value = iPhutTre.ToString();
                                                                    }
                                                                    else
                                                                    {
                                                                        this.DGVTinhCong.Rows[_nhanVien].Cells[9].Value = "0";
                                                                    }
                                                                }
                                                                else if (iPhutTre >= 1)
                                                                {
                                                                    this.DGVTinhCong.Rows[_nhanVien].Cells[9].Value = sPhutTre;
                                                                }
                                                                else
                                                                {
                                                                    this.DGVTinhCong.Rows[_nhanVien].Cells[9].Value = "0";
                                                                }
                                                            }
                                                            else
                                                            {
                                                                this.DGVTinhCong.Rows[_nhanVien].Cells[9].Value = "0";
                                                            }
                                                            sTruGioVeSom = dtCaLamViecTuDongKhongQuaDem.Rows[iCaLamViecTuDongKhongQuaDem]["TruGioVeSom"].ToString();
                                                            sBatDauTinhVeSom = dtCaLamViecTuDongKhongQuaDem.Rows[iCaLamViecTuDongKhongQuaDem]["BatDauTinhVeSom"].ToString();
                                                            iChoPhepVeSom = Convert.ToInt32(dtCaLamViecTuDongKhongQuaDem.Rows[iCaLamViecTuDongKhongQuaDem]["ChoPhepVeSom"].ToString());
                                                            value = dGioRaKhaiBaoTuDongKhongQuaDemB - dGioRaTuDong;
                                                            second = Convert.ToInt32(value.TotalMinutes);
                                                            sPhutVeSom = second.ToString();
                                                            if (!(sTruGioVeSom == "True"))
                                                            {
                                                                this.DGVTinhCong.Rows[_nhanVien].Cells[10].Value = "0";
                                                            }
                                                            else if (Convert.ToInt32(sPhutVeSom) >= 0)
                                                            {
                                                                iPhutVeSom = Convert.ToInt32(sPhutVeSom) - iChoPhepVeSom;
                                                                if (iPhutVeSom < 1)
                                                                {
                                                                    this.DGVTinhCong.Rows[_nhanVien].Cells[10].Value = "0";
                                                                }
                                                                else if (!(sBatDauTinhVeSom == "True"))
                                                                {
                                                                    this.DGVTinhCong.Rows[_nhanVien].Cells[10].Value = sPhutVeSom;
                                                                }
                                                                else
                                                                {
                                                                    this.DGVTinhCong.Rows[_nhanVien].Cells[10].Value = iPhutVeSom.ToString();
                                                                }
                                                            }
                                                            else
                                                            {
                                                                this.DGVTinhCong.Rows[_nhanVien].Cells[10].Value = "0";
                                                            }
                                                            value = dGioRaTuDong - dGioRaKhaiBaoTuDongKhongQuaDemB;
                                                            second = Convert.ToInt32(value.TotalMinutes);
                                                            sVeTre = second.ToString();
                                                            if (Convert.ToInt32(sVeTre) <= 0)
                                                            {
                                                                this.DGVTinhCong.Rows[_nhanVien].Cells[11].Value = "0";
                                                            }
                                                            else
                                                            {
                                                                this.DGVTinhCong.Rows[_nhanVien].Cells[11].Value = sVeTre;
                                                            }
                                                            iPhut = Convert.ToSingle(dtCaLamViecTuDongKhongQuaDem.Rows[iCaLamViecTuDongKhongQuaDem]["TongGioTrongCaLamViec"]) * 60f - (float)(Convert.ToInt32(this.DGVTinhCong.Rows[_nhanVien].Cells[9].Value.ToString()) + Convert.ToInt32(this.DGVTinhCong.Rows[_nhanVien].Cells[10].Value));
                                                            dGio = Math.Round(Convert.ToDouble(iPhut) / 60, this.iLamTronGio);
                                                            this.DGVTinhCong.Rows[_nhanVien].Cells[8].Value = dGio * this.dTangCaChuNhatHeSo;
                                                            iGio = Convert.ToDouble(dtCaLamViecTuDongKhongQuaDem.Rows[iCaLamViecTuDongKhongQuaDem]["TongGioTrongCaLamViec"].ToString());
                                                            dCongTinh = Convert.ToDouble(dtCaLamViecTuDongKhongQuaDem.Rows[iCaLamViecTuDongKhongQuaDem]["CongTinh"].ToString());
                                                            dCong = Math.Round(dGio * dCongTinh / iGio, this.iLamTronCong);
                                                            this.DGVTinhCong.Rows[_nhanVien].Cells[7].Value = dCong * this.dTangCaChuNhatHeSo;
                                                            value = dGioRaTuDong - dGioVaoTuDong;
                                                            second = Convert.ToInt32(value.TotalMinutes);
                                                            dTongGioThucTeTuDongKhongQuaDem = Math.Round(Convert.ToDouble(second.ToString()) / 60, this.iLamTronGio);
                                                            this.DGVTinhCong.Rows[_nhanVien].Cells[16].Value = dTongGioThucTeTuDongKhongQuaDem * this.dTangCaChuNhatHeSo;
                                                            this.DGVTinhCong.Rows[_nhanVien].Cells[17].Value = Convert.ToDouble(dtCaLamViecTuDongKhongQuaDem.Rows[iCaLamViecTuDongKhongQuaDem]["CongTinh"].ToString()) * this.dTangCaChuNhatHeSo;
                                                            this.DGVTinhCong.Rows[_nhanVien].Cells[18].Value = this.sKHDungGio;
                                                            sChoPhepTangCaTruocGioLamViecTuDongKhongQuaDem = dtCaLamViecTuDongKhongQuaDem.Rows[iCaLamViecTuDongKhongQuaDem]["TangCaTruocGioLamViec"].ToString();
                                                            iPhutTangCaTruocGioLamViecTuDongKhongQuaDem = Convert.ToInt32(dtCaLamViecTuDongKhongQuaDem.Rows[iCaLamViecTuDongKhongQuaDem]["SoPhutTangCaTruocGioLamViec"].ToString());
                                                            iPhutTangCaTruocGioLamViecDatDen = Convert.ToInt32(dtCaLamViecTuDongKhongQuaDem.Rows[iCaLamViecTuDongKhongQuaDem]["TangCaTruocGioLamViecDatDen"].ToString());
                                                            iPhutTruTangCaTruoc = Convert.ToInt32(dtCaLamViecTuDongKhongQuaDem.Rows[iCaLamViecTuDongKhongQuaDem]["PhutTruTangCaTruoc"].ToString());
                                                            sChoPhepTangCaSauGioLamViecTuDongKhongQuaDem = dtCaLamViecTuDongKhongQuaDem.Rows[iCaLamViecTuDongKhongQuaDem]["TangCaSauGioLamViec"].ToString();
                                                            iPhutTangCaSauGioLamViecTuDongKhongQuaDem = Convert.ToInt32(dtCaLamViecTuDongKhongQuaDem.Rows[iCaLamViecTuDongKhongQuaDem]["SoPhutTangCaSauGioLamViec"].ToString());
                                                            iPhutTangCaSauGioLamViecDatDen = Convert.ToInt32(dtCaLamViecTuDongKhongQuaDem.Rows[iCaLamViecTuDongKhongQuaDem]["TangCaSauGioLamViecDatDen"].ToString());
                                                            iPhutTruTangCaSau = Convert.ToInt32(dtCaLamViecTuDongKhongQuaDem.Rows[iCaLamViecTuDongKhongQuaDem]["PhutTruTangCaSau"].ToString());
                                                            iGioiHanTC1TuDongKhongQuaDem = Convert.ToInt32(dtCaLamViecTuDongKhongQuaDem.Rows[iCaLamViecTuDongKhongQuaDem]["GioiHanTangCa1"].ToString());
                                                            iGioiHanTC2TuDongKhongQuaDem = Convert.ToInt32(dtCaLamViecTuDongKhongQuaDem.Rows[iCaLamViecTuDongKhongQuaDem]["GioiHanTangCa2"].ToString());
                                                            iGioiHanTC3TuDongKhongQuaDem = Convert.ToInt32(dtCaLamViecTuDongKhongQuaDem.Rows[iCaLamViecTuDongKhongQuaDem]["GioiHanTangCa3"].ToString());
                                                            iGioiHanTC4TuDongKhongQuaDem = Convert.ToInt32(dtCaLamViecTuDongKhongQuaDem.Rows[iCaLamViecTuDongKhongQuaDem]["GioiHanTangCa4"].ToString());
                                                            iTongGioTangCaSauTuDongKhongQuaDem = 0;
                                                            iTongGioTangCaTruocTuDongKhongQuaDem = 0;
                                                            if ((sChoPhepTangCaTruocGioLamViecTuDongKhongQuaDem != "False" ? true : !(sChoPhepTangCaSauGioLamViecTuDongKhongQuaDem == "False")))
                                                            {
                                                                if (sChoPhepTangCaTruocGioLamViecTuDongKhongQuaDem == "True")
                                                                {
                                                                    value = dGioVaoKhaiBaoTuDongKhongQuaDemB - dGioVaoTuDong;
                                                                    second = Convert.ToInt32(value.TotalMinutes);
                                                                    iThoiGianTruocGioLamTuDongKhongQuaDem = Convert.ToInt32(second.ToString());
                                                                    if (iThoiGianTruocGioLamTuDongKhongQuaDem > 0)
                                                                    {
                                                                        if (iThoiGianTruocGioLamTuDongKhongQuaDem > iPhutTangCaTruocGioLamViecTuDongKhongQuaDem)
                                                                        {
                                                                            if (iThoiGianTruocGioLamTuDongKhongQuaDem > iPhutTangCaTruocGioLamViecDatDen)
                                                                            {
                                                                                iTongGioTangCaTruocTuDongKhongQuaDem = iThoiGianTruocGioLamTuDongKhongQuaDem - iPhutTruTangCaTruoc;
                                                                            }
                                                                        }
                                                                    }
                                                                }
                                                                if (sChoPhepTangCaSauGioLamViecTuDongKhongQuaDem == "True")
                                                                {
                                                                    value = dGioRaTuDong - dGioRaKhaiBaoTuDongKhongQuaDemB;
                                                                    second = Convert.ToInt32(value.TotalMinutes);
                                                                    iThoiGianSauGioLamViecTuDongKhongQuaDem = Convert.ToInt32(second.ToString());
                                                                    if (iThoiGianSauGioLamViecTuDongKhongQuaDem > 0)
                                                                    {
                                                                        if (iThoiGianSauGioLamViecTuDongKhongQuaDem > iPhutTangCaSauGioLamViecTuDongKhongQuaDem)
                                                                        {
                                                                            if (iThoiGianSauGioLamViecTuDongKhongQuaDem > iPhutTangCaSauGioLamViecDatDen)
                                                                            {
                                                                                iTongGioTangCaSauTuDongKhongQuaDem = iThoiGianSauGioLamViecTuDongKhongQuaDem - iPhutTruTangCaSau;
                                                                            }
                                                                        }
                                                                    }
                                                                }
                                                            }
                                                            else
                                                            {
                                                                this.DGVTinhCong.Rows[_nhanVien].Cells[12].Value = "0";
                                                                this.DGVTinhCong.Rows[_nhanVien].Cells[13].Value = "0";
                                                                this.DGVTinhCong.Rows[_nhanVien].Cells[14].Value = "0";
                                                                this.DGVTinhCong.Rows[_nhanVien].Cells[15].Value = "0";
                                                            }
                                                            dTongThoiGianTangCaTuDongKhongQuaDem = Convert.ToDouble(iTongGioTangCaTruocTuDongKhongQuaDem + iTongGioTangCaSauTuDongKhongQuaDem);
                                                            if (dTongThoiGianTangCaTuDongKhongQuaDem <= 0)
                                                            {
                                                                this.DGVTinhCong.Rows[_nhanVien].Cells[12].Value = "0";
                                                                this.DGVTinhCong.Rows[_nhanVien].Cells[13].Value = "0";
                                                                this.DGVTinhCong.Rows[_nhanVien].Cells[14].Value = "0";
                                                                this.DGVTinhCong.Rows[_nhanVien].Cells[15].Value = "0";
                                                            }
                                                            else
                                                            {
                                                                if (iGioiHanTC1TuDongKhongQuaDem == 0)
                                                                {
                                                                    this.DGVTinhCong.Rows[_nhanVien].Cells[12].Value = Math.Round(dTongThoiGianTangCaTuDongKhongQuaDem * this.dTangCa1HeSo / 60, this.iLamTronGio);
                                                                    this.DGVTinhCong.Rows[_nhanVien].Cells[13].Value = "0";
                                                                    this.DGVTinhCong.Rows[_nhanVien].Cells[14].Value = "0";
                                                                    this.DGVTinhCong.Rows[_nhanVien].Cells[15].Value = "0";
                                                                }
                                                                if ((iGioiHanTC1TuDongKhongQuaDem == 0 ? false : iGioiHanTC2TuDongKhongQuaDem == 0))
                                                                {
                                                                    if (dTongThoiGianTangCaTuDongKhongQuaDem >= Convert.ToDouble(iGioiHanTC1TuDongKhongQuaDem))
                                                                    {
                                                                        this.DGVTinhCong.Rows[_nhanVien].Cells[12].Value = Math.Round(Convert.ToDouble(iGioiHanTC1TuDongKhongQuaDem) / 60 * this.dTangCa1HeSo, this.iLamTronGio);
                                                                        if (dTongThoiGianTangCaTuDongKhongQuaDem - Convert.ToDouble(iGioiHanTC1TuDongKhongQuaDem) > 0)
                                                                        {
                                                                            this.DGVTinhCong.Rows[_nhanVien].Cells[13].Value = Math.Round((dTongThoiGianTangCaTuDongKhongQuaDem - Convert.ToDouble(iGioiHanTC1TuDongKhongQuaDem)) * this.dTangCa2HeSo / 60, this.iLamTronGio);
                                                                        }
                                                                        this.DGVTinhCong.Rows[_nhanVien].Cells[14].Value = "0";
                                                                        this.DGVTinhCong.Rows[_nhanVien].Cells[15].Value = "0";
                                                                    }
                                                                    else
                                                                    {
                                                                        this.DGVTinhCong.Rows[_nhanVien].Cells[12].Value = Math.Round(dTongThoiGianTangCaTuDongKhongQuaDem * this.dTangCa1HeSo / 60, this.iLamTronGio);
                                                                        this.DGVTinhCong.Rows[_nhanVien].Cells[13].Value = "0";
                                                                        this.DGVTinhCong.Rows[_nhanVien].Cells[14].Value = "0";
                                                                        this.DGVTinhCong.Rows[_nhanVien].Cells[15].Value = "0";
                                                                    }
                                                                }
                                                                if ((iGioiHanTC1TuDongKhongQuaDem == 0 || iGioiHanTC2TuDongKhongQuaDem == 0 ? false : iGioiHanTC3TuDongKhongQuaDem == 0))
                                                                {
                                                                    if (dTongThoiGianTangCaTuDongKhongQuaDem >= Convert.ToDouble(iGioiHanTC1TuDongKhongQuaDem))
                                                                    {
                                                                        this.DGVTinhCong.Rows[_nhanVien].Cells[12].Value = Math.Round(Convert.ToDouble(iGioiHanTC1TuDongKhongQuaDem) * this.dTangCa1HeSo / 60, this.iLamTronGio);
                                                                        if (dTongThoiGianTangCaTuDongKhongQuaDem - Convert.ToDouble(iGioiHanTC1TuDongKhongQuaDem) >= Convert.ToDouble(iGioiHanTC2TuDongKhongQuaDem))
                                                                        {
                                                                            this.DGVTinhCong.Rows[_nhanVien].Cells[12].Value = Math.Round(Convert.ToDouble(iGioiHanTC1TuDongKhongQuaDem) * this.dTangCa1HeSo / 60, this.iLamTronGio);
                                                                            this.DGVTinhCong.Rows[_nhanVien].Cells[13].Value = Math.Round(Convert.ToDouble(iGioiHanTC2TuDongKhongQuaDem) * this.dTangCa2HeSo / 60, this.iLamTronGio);
                                                                            this.DGVTinhCong.Rows[_nhanVien].Cells[14].Value = Math.Round((dTongThoiGianTangCaTuDongKhongQuaDem - Convert.ToDouble(iGioiHanTC1TuDongKhongQuaDem) - Convert.ToDouble(iGioiHanTC2TuDongKhongQuaDem)) * this.dTangCa3HeSo / 60, this.iLamTronGio);
                                                                            this.DGVTinhCong.Rows[_nhanVien].Cells[15].Value = "0";
                                                                        }
                                                                        else
                                                                        {
                                                                            this.DGVTinhCong.Rows[_nhanVien].Cells[13].Value = Math.Round((dTongThoiGianTangCaTuDongKhongQuaDem - Convert.ToDouble(iGioiHanTC1TuDongKhongQuaDem)) * this.dTangCa2HeSo / 60, this.iLamTronGio);
                                                                            this.DGVTinhCong.Rows[_nhanVien].Cells[14].Value = "0";
                                                                            this.DGVTinhCong.Rows[_nhanVien].Cells[15].Value = "0";
                                                                        }
                                                                    }
                                                                    else
                                                                    {
                                                                        this.DGVTinhCong.Rows[_nhanVien].Cells[12].Value = Math.Round(dTongThoiGianTangCaTuDongKhongQuaDem * this.dTangCa1HeSo / 60, this.iLamTronGio);
                                                                        this.DGVTinhCong.Rows[_nhanVien].Cells[13].Value = "0";
                                                                        this.DGVTinhCong.Rows[_nhanVien].Cells[14].Value = "0";
                                                                        this.DGVTinhCong.Rows[_nhanVien].Cells[15].Value = "0";
                                                                    }
                                                                }
                                                                if ((iGioiHanTC1TuDongKhongQuaDem == 0 || iGioiHanTC2TuDongKhongQuaDem == 0 || iGioiHanTC3TuDongKhongQuaDem == 0 ? false : iGioiHanTC4TuDongKhongQuaDem == 0))
                                                                {
                                                                }
                                                            }
                                                        }
                                                        else
                                                        {
                                                            sTruGioDiTre = dtCaLamViecTuDongKhongQuaDem.Rows[iCaLamViecTuDongKhongQuaDem]["TruGioDiTre"].ToString();
                                                            sBatDauTinhDiTre = dtCaLamViecTuDongKhongQuaDem.Rows[iCaLamViecTuDongKhongQuaDem]["BatDauTinhDiTre"].ToString();
                                                            iChoPhepDiTre = Convert.ToInt32(dtCaLamViecTuDongKhongQuaDem.Rows[iCaLamViecTuDongKhongQuaDem]["ChoPhepDiTre"].ToString());
                                                            value = dGioVaoTuDong - dGioVaoKhaiBaoTuDongKhongQuaDemB;
                                                            second = Convert.ToInt32(value.TotalMinutes);
                                                            sPhutTre = second.ToString();
                                                            if (Convert.ToInt32(sPhutTre) < 0)
                                                            {
                                                                sPhutTre = "0";
                                                            }
                                                            sTruGioVeSom = dtCaLamViecTuDongKhongQuaDem.Rows[iCaLamViecTuDongKhongQuaDem]["TruGioVeSom"].ToString();
                                                            sBatDauTinhVeSom = dtCaLamViecTuDongKhongQuaDem.Rows[iCaLamViecTuDongKhongQuaDem]["BatDauTinhVeSom"].ToString();
                                                            iChoPhepVeSom = Convert.ToInt32(dtCaLamViecTuDongKhongQuaDem.Rows[iCaLamViecTuDongKhongQuaDem]["ChoPhepVeSom"].ToString());
                                                            value = dGioRaKhaiBaoTuDongKhongQuaDemB - dGioRaTuDong;
                                                            second = Convert.ToInt32(value.TotalMinutes);
                                                            sPhutVeSom = second.ToString();
                                                            if (Convert.ToInt32(sPhutVeSom) < 0)
                                                            {
                                                                sPhutVeSom = "0";
                                                            }
                                                            dTongPhutTangCaTuDongKhongQuaDemA = Convert.ToDouble(dtCaLamViecTuDongKhongQuaDem.Rows[iCaLamViecTuDongKhongQuaDem]["TongGioTrongCaLamViec"]) * 60 - (Convert.ToDouble(sPhutTre) + Convert.ToDouble(sPhutVeSom));
                                                            dTongGioTangCaTuDongKhongQuaDemA = Math.Round(dTongPhutTangCaTuDongKhongQuaDemA / 60, this.iLamTronGio);
                                                            if (iTangCaChuNhatMuc == 1)
                                                            {
                                                                if (dTongGioTangCaTuDongKhongQuaDemA > 3)
                                                                {
                                                                    this.DGVTinhCong.Rows[_nhanVien].Cells[12].Value = 3 * this.dTangCaChuNhatHeSo;
                                                                }
                                                                else
                                                                {
                                                                    this.DGVTinhCong.Rows[_nhanVien].Cells[12].Value = dTongGioTangCaTuDongKhongQuaDemA * this.dTangCaChuNhatHeSo;
                                                                }
                                                                this.DGVTinhCong.Rows[_nhanVien].Cells[18].Value = this.sKHDungGio;
                                                            }
                                                            if (iTangCaChuNhatMuc == 2)
                                                            {
                                                                this.DGVTinhCong.Rows[_nhanVien].Cells[13].Value = dTongGioTangCaTuDongKhongQuaDemA * this.dTangCaChuNhatHeSo;
                                                                this.DGVTinhCong.Rows[_nhanVien].Cells[18].Value = this.sKHDungGio;
                                                            }
                                                            if (iTangCaChuNhatMuc == 3)
                                                            {
                                                                this.DGVTinhCong.Rows[_nhanVien].Cells[14].Value = dTongGioTangCaTuDongKhongQuaDemA * this.dTangCaChuNhatHeSo;
                                                                this.DGVTinhCong.Rows[_nhanVien].Cells[18].Value = this.sKHDungGio;
                                                            }
                                                            if (iTangCaChuNhatMuc == 4)
                                                            {
                                                                this.DGVTinhCong.Rows[_nhanVien].Cells[15].Value = dTongGioTangCaTuDongKhongQuaDemA * this.dTangCaChuNhatHeSo;
                                                                this.DGVTinhCong.Rows[_nhanVien].Cells[18].Value = this.sKHDungGio;
                                                            }
                                                        }
                                                    }
                                                    if (!(DateTimeProgress.XuatIDThu((int)dt.AddDays((double)dem).DayOfWeek) == "0"))
                                                    {
                                                        this.DGVTinhCong.Rows[_nhanVien].Cells[19].Value = "NT";
                                                    }
                                                    else
                                                    {
                                                        this.DGVTinhCong.Rows[_nhanVien].Cells[19].Value = "CN";
                                                    }
                                                    this.DGVTinhCong.Rows[_nhanVien].Cells[20].Value = this.sMaChamCong;
                                                    this.DGVTinhCong.Rows[_nhanVien].Cells[21].Value = this.sPhongBanTinhCong;
                                                }
                                            Label15:;
                                            }
                                            else
                                            {
                                                addTuDongKhongQuaDemThoiGianLonNhat = this.DGVTinhCong.Rows.Add();
                                                this.DGVTinhCong.Rows[addTuDongKhongQuaDemThoiGianLonNhat].Cells[0].Value = this.sMaNhanVien;
                                                this.DGVTinhCong.Rows[addTuDongKhongQuaDemThoiGianLonNhat].Cells[1].Value = this.sTenNhanVien;
                                                this.DGVTinhCong.Rows[addTuDongKhongQuaDemThoiGianLonNhat].Cells[2].Value = this.DGVTinhCong.Rows[_nhanVien].Cells[2].Value.ToString();
                                                if (this.iNgonNgu == 0)
                                                {
                                                    DataGridViewCell item4 = this.DGVTinhCong.Rows[addTuDongKhongQuaDemThoiGianLonNhat].Cells[3];
                                                    dateTime = dt.AddDays((double)dem);
                                                    item4.Value = DateTimeProgress.XuatThuTinhCong((int)dateTime.DayOfWeek);
                                                }
                                                if (this.iNgonNgu == 1)
                                                {
                                                    DataGridViewCell dataGridViewCell4 = this.DGVTinhCong.Rows[addTuDongKhongQuaDemThoiGianLonNhat].Cells[3];
                                                    dateTime = dt.AddDays((double)dem);
                                                    dataGridViewCell4.Value = DateTimeProgress.XuatThuEnglish((int)dateTime.DayOfWeek);
                                                }
                                                this.DGVTinhCong.Rows[addTuDongKhongQuaDemThoiGianLonNhat].Cells[4].Value = "***";
                                                this.DGVTinhCong.Rows[addTuDongKhongQuaDemThoiGianLonNhat].Cells[6].Value = string.Format(this.sDinhDangThoiGian, dGioRaTuDong);
                                                this.DGVTinhCong.Rows[addTuDongKhongQuaDemThoiGianLonNhat].Cells[7].Value = "0";
                                                this.DGVTinhCong.Rows[addTuDongKhongQuaDemThoiGianLonNhat].Cells[8].Value = "0";
                                                this.DGVTinhCong.Rows[addTuDongKhongQuaDemThoiGianLonNhat].Cells[9].Value = "0";
                                                this.DGVTinhCong.Rows[addTuDongKhongQuaDemThoiGianLonNhat].Cells[10].Value = "0";
                                                this.DGVTinhCong.Rows[addTuDongKhongQuaDemThoiGianLonNhat].Cells[11].Value = "0";
                                                this.DGVTinhCong.Rows[addTuDongKhongQuaDemThoiGianLonNhat].Cells[12].Value = "0";
                                                this.DGVTinhCong.Rows[addTuDongKhongQuaDemThoiGianLonNhat].Cells[13].Value = "0";
                                                this.DGVTinhCong.Rows[addTuDongKhongQuaDemThoiGianLonNhat].Cells[14].Value = "0";
                                                this.DGVTinhCong.Rows[addTuDongKhongQuaDemThoiGianLonNhat].Cells[15].Value = "0";
                                                this.DGVTinhCong.Rows[addTuDongKhongQuaDemThoiGianLonNhat].Cells[16].Value = "0";
                                                this.DGVTinhCong.Rows[addTuDongKhongQuaDemThoiGianLonNhat].Cells[17].Value = "0";
                                                this.DGVTinhCong.Rows[addTuDongKhongQuaDemThoiGianLonNhat].Cells[18].Value = this.sKHVang;
                                                if (!(DateTimeProgress.XuatIDThu((int)dt.AddDays((double)dem).DayOfWeek) == "0"))
                                                {
                                                    this.DGVTinhCong.Rows[addTuDongKhongQuaDemThoiGianLonNhat].Cells[19].Value = "NT";
                                                }
                                                else
                                                {
                                                    this.DGVTinhCong.Rows[addTuDongKhongQuaDemThoiGianLonNhat].Cells[19].Value = "CN";
                                                }
                                                this.DGVTinhCong.Rows[addTuDongKhongQuaDemThoiGianLonNhat].Cells[20].Value = this.sMaChamCong;
                                                this.DGVTinhCong.Rows[addTuDongKhongQuaDemThoiGianLonNhat].Cells[21].Value = this.sPhongBanTinhCong;
                                            }
                                        }
                                        if (iKiemTraLanCham > 2)
                                        {
                                            if (iKiemTraLanCham % 2 == 0)
                                            {
                                                dGioRaTuDong = Convert.ToDateTime(dtTuDong.Rows[iTuDong]["GioCham"].ToString());
                                                value = dGioRaTuDong - dGioVaoTuDong;
                                                iHieuPhutTuDong = Convert.ToInt32(value.TotalMinutes);
                                                if (Convert.ToInt32(Convert.ToInt32((dGioRaTuDongKhongQuaDemLichTrinhVaoRa - dGioVaoTuDongKhongQuaDemLichTrinhVaoRa).TotalMinutes).ToString()) <= iThoiGianLonNhat)
                                                {
                                                    this.DGVTinhCong.Rows[addTuDong].Cells[6].Value = string.Format(this.sDinhDangThoiGian, dGioRaTuDong);
                                                    dtNhanCaTuDongKhongQuaDem = new System.Data.DataTable();
                                                    this._chiTietLichTrinhChoCalamViecDTO.MaLichTrinhCaLamViec = sLTCCLVNhanVien;
                                                    this._chiTietLichTrinhChoCalamViecDTO.Thu = sThu;
                                                    dtNhanCaTuDongKhongQuaDem = this._chiTietLichTrinhChoCaLamViecBLL.ChiTietLichTrinhChoCaLamViecNhanCa(this._chiTietLichTrinhChoCalamViecDTO);
                                                    iChiTietLichTrinhChoCaLamViecTuDongKhongQuaDem = 0;
                                                    if (iChiTietLichTrinhChoCaLamViecTuDongKhongQuaDem < dtNhanCaTuDongKhongQuaDem.Rows.Count)
                                                    {
                                                        cellChiTietLichTrinhChoCaLamViecTuDongKhongQuaDem = 3;
                                                        while (cellChiTietLichTrinhChoCaLamViecTuDongKhongQuaDem < 13)
                                                        {
                                                            this.sTuDongQuaDemMaCaLamViec = dtNhanCaTuDongKhongQuaDem.Rows[iChiTietLichTrinhChoCaLamViecTuDongKhongQuaDem][cellChiTietLichTrinhChoCaLamViecTuDongKhongQuaDem].ToString();
                                                            dtTuDongQuaDemCa = new System.Data.DataTable();
                                                            this._caLamViecDTO.MaCaLamViec = this.sTuDongQuaDemMaCaLamViec;
                                                            dtTuDongQuaDemCa = this._caLamViecBLL.CaLamViecGetByMaCaLamViec(this._caLamViecDTO);
                                                            iTuDongQuaDemCa = 0;
                                                            while (iTuDongQuaDemCa < dtTuDongQuaDemCa.Rows.Count)
                                                            {
                                                                kiemTraVao = 0;
                                                                kiemTraRa = 0;
                                                                second = dGioVaoTuDong.Second;
                                                                sGiayGioVao = second.ToString();
                                                                second = dGioRaTuDong.Second;
                                                                sGiayGioRa = second.ToString();
                                                                this.sTuDongQuaDemTenCaLamViec = dtTuDongQuaDemCa.Rows[iTuDongQuaDemCa]["CaLamViec"].ToString();
                                                                dBatDauVaoA = Convert.ToDateTime(dtTuDongQuaDemCa.Rows[iTuDongQuaDemCa]["BatDauVao"].ToString());
                                                                sBatDauVaoA = string.Format("{0:T}", dBatDauVaoA).Replace("00 ", string.Concat(sGiayGioVao, " "));
                                                                sBatDauVaoB = string.Concat(sNgayCham, " ", sBatDauVaoA);
                                                                dBatDauVaoB = Convert.ToDateTime(sBatDauVaoB);
                                                                dKetThucVaoA = Convert.ToDateTime(dtTuDongQuaDemCa.Rows[iTuDongQuaDemCa]["KetThucVao"].ToString());
                                                                sKetThucVaoA = string.Format("{0:T}", dKetThucVaoA).Replace("00 ", string.Concat(sGiayGioVao, " "));
                                                                sKetThucVaoB = string.Concat(sNgayCham, " ", sKetThucVaoA);
                                                                dKetThucVaoB = Convert.ToDateTime(sKetThucVaoB);
                                                                dBatDauRaA = Convert.ToDateTime(dtTuDongQuaDemCa.Rows[iTuDongQuaDemCa]["BatDauRa"].ToString());
                                                                sBatDauRaA = string.Format("{0:T}", dBatDauRaA).Replace("00 ", string.Concat(sGiayGioRa, " "));
                                                                sBatDauRaB = string.Concat(sNgayCham, " ", sBatDauRaA);
                                                                dBatDauRaB = Convert.ToDateTime(sBatDauRaB);
                                                                dKetThucRaA = Convert.ToDateTime(dtTuDongQuaDemCa.Rows[iTuDongQuaDemCa]["KetThucRa"].ToString());
                                                                sKetThucRaA = string.Format("{0:T}", dKetThucRaA).Replace("00 ", string.Concat(sGiayGioRa, " "));
                                                                sKetThucRaB = string.Concat(sNgayCham, " ", sKetThucRaA);
                                                                dKetThucRaB = Convert.ToDateTime(sKetThucRaB);
                                                                if ((dGioVaoTuDong < dBatDauVaoB ? false : dGioVaoTuDong <= dKetThucVaoB))
                                                                {
                                                                    kiemTraVao++;
                                                                }
                                                                if ((dGioRaTuDong < dBatDauRaB ? false : dGioRaTuDong <= dKetThucRaB))
                                                                {
                                                                    kiemTraRa++;
                                                                }
                                                                if ((kiemTraVao != 1 ? true : kiemTraRa != 1))
                                                                {
                                                                    iTuDongQuaDemCa++;
                                                                }
                                                                else
                                                                {
                                                                    goto Label18;
                                                                }
                                                            }
                                                            if (!(this.sTuDongQuaDemMaCaLamViec == ""))
                                                            {
                                                                cellChiTietLichTrinhChoCaLamViecTuDongKhongQuaDem++;
                                                            }
                                                            else
                                                            {
                                                                this.DGVTinhCong.Rows[addTuDong].Cells[4].Value = "***";
                                                                this.DGVTinhCong.Rows[addTuDong].Cells[7].Value = "0";
                                                                this.DGVTinhCong.Rows[addTuDong].Cells[8].Value = "0";
                                                                this.DGVTinhCong.Rows[addTuDong].Cells[9].Value = "0";
                                                                this.DGVTinhCong.Rows[addTuDong].Cells[10].Value = "0";
                                                                this.DGVTinhCong.Rows[addTuDong].Cells[11].Value = "0";
                                                                this.DGVTinhCong.Rows[addTuDong].Cells[12].Value = "0";
                                                                this.DGVTinhCong.Rows[addTuDong].Cells[13].Value = "0";
                                                                this.DGVTinhCong.Rows[addTuDong].Cells[14].Value = "0";
                                                                this.DGVTinhCong.Rows[addTuDong].Cells[15].Value = "0";
                                                                this.DGVTinhCong.Rows[addTuDong].Cells[16].Value = "0";
                                                                this.DGVTinhCong.Rows[addTuDong].Cells[17].Value = "0";
                                                                this.DGVTinhCong.Rows[addTuDong].Cells[18].Value = this.sKHVang;
                                                                if (!(DateTimeProgress.XuatIDThu((int)dt.AddDays((double)dem).DayOfWeek) == "0"))
                                                                {
                                                                    this.DGVTinhCong.Rows[addTuDong].Cells[19].Value = "NT";
                                                                }
                                                                else
                                                                {
                                                                    this.DGVTinhCong.Rows[addTuDong].Cells[19].Value = "CN";
                                                                }
                                                                this.DGVTinhCong.Rows[addTuDong].Cells[20].Value = this.sMaChamCong;
                                                                this.DGVTinhCong.Rows[addTuDong].Cells[21].Value = this.sPhongBanTinhCong;
                                                             //   goto Label17;
                                                            }
                                                        }
                                                    Label18:
                                                        this.DGVTinhCong.Rows[addTuDong].Cells[4].Value = this.sTuDongQuaDemTenCaLamViec;
                                                        dtCaLamViecTuDongKhongQuaDem = new System.Data.DataTable();
                                                        this._caLamViecDTO.MaCaLamViec = this.sTuDongQuaDemMaCaLamViec;
                                                        dtCaLamViecTuDongKhongQuaDem = this._caLamViecBLL.CaLamViecGetByMaCaLamViec(this._caLamViecDTO);
                                                        for (iCaLamViecTuDongKhongQuaDem = 0; iCaLamViecTuDongKhongQuaDem < dtCaLamViecTuDongKhongQuaDem.Rows.Count; iCaLamViecTuDongKhongQuaDem++)
                                                        {
                                                            second = dGioVaoTuDong.Second;
                                                            sGiayGioVao = second.ToString();
                                                            second = dGioRaTuDong.Second;
                                                            sGiayGioRa = second.ToString();
                                                            dGioVaoKhaiBaoTuDongKhongQuaDemA = Convert.ToDateTime(dtCaLamViecTuDongKhongQuaDem.Rows[iCaLamViecTuDongKhongQuaDem]["GioVaoLamViec"].ToString());
                                                            sGioVaoKhaiBaoTuDongKhongQuaDemA = string.Format("{0:T}", dGioVaoKhaiBaoTuDongKhongQuaDemA).Replace("00 ", string.Concat(sGiayGioVao, " "));
                                                            sGioVaoKhaiBaoTuDongKhongQuaDemB = string.Concat(sNgayCham, " ", sGioVaoKhaiBaoTuDongKhongQuaDemA);
                                                            dGioVaoKhaiBaoTuDongKhongQuaDemB = Convert.ToDateTime(sGioVaoKhaiBaoTuDongKhongQuaDemB);
                                                            dGioRaKhaiBaoTuDongKhongQuaDemA = Convert.ToDateTime(dtCaLamViecTuDongKhongQuaDem.Rows[iCaLamViecTuDongKhongQuaDem]["GioKetThucLamViec"].ToString());
                                                            sGioRaKhaiBaoTuDongKhongQuaDemA = string.Format("{0:T}", dGioRaKhaiBaoTuDongKhongQuaDemA).Replace("00 ", string.Concat(sGiayGioRa, " "));
                                                            sGioRaKhaiBaoTuDongKhongQuaDemB = string.Concat(sNgayCham, " ", sGioRaKhaiBaoTuDongKhongQuaDemA);
                                                            dGioRaKhaiBaoTuDongKhongQuaDemB = Convert.ToDateTime(sGioRaKhaiBaoTuDongKhongQuaDemB);
                                                            sXemCaNayLaTangCa = dtCaLamViecTuDongKhongQuaDem.Rows[iCaLamViecTuDongKhongQuaDem]["XemCaNayLaTangCa"].ToString();
                                                            iTangCaMuc = Convert.ToInt32(dtCaLamViecTuDongKhongQuaDem.Rows[iCaLamViecTuDongKhongQuaDem]["TangCaMuc"].ToString());
                                                            sXemChuNhatLaTangCa = dtCaLamViecTuDongKhongQuaDem.Rows[iCaLamViecTuDongKhongQuaDem]["XemCuoiTuanLaTangCa"].ToString();
                                                            iTangCaChuNhatMuc = Convert.ToInt32(dtCaLamViecTuDongKhongQuaDem.Rows[iCaLamViecTuDongKhongQuaDem]["TangCaCuoiTuanMuc"].ToString());
                                                            if (sXemCaNayLaTangCa == "True")
                                                            {
                                                                sTruGioDiTre = dtCaLamViecTuDongKhongQuaDem.Rows[iCaLamViecTuDongKhongQuaDem]["TruGioDiTre"].ToString();
                                                                sBatDauTinhDiTre = dtCaLamViecTuDongKhongQuaDem.Rows[iCaLamViecTuDongKhongQuaDem]["BatDauTinhDiTre"].ToString();
                                                                iChoPhepDiTre = Convert.ToInt32(dtCaLamViecTuDongKhongQuaDem.Rows[iCaLamViecTuDongKhongQuaDem]["ChoPhepDiTre"].ToString());
                                                                value = dGioVaoTuDong - dGioVaoKhaiBaoTuDongKhongQuaDemB;
                                                                second = Convert.ToInt32(value.TotalMinutes);
                                                                sPhutTre = second.ToString();
                                                                if (Convert.ToInt32(sPhutTre) < 0)
                                                                {
                                                                    sPhutTre = "0";
                                                                }
                                                                sTruGioVeSom = dtCaLamViecTuDongKhongQuaDem.Rows[iCaLamViecTuDongKhongQuaDem]["TruGioVeSom"].ToString();
                                                                sBatDauTinhVeSom = dtCaLamViecTuDongKhongQuaDem.Rows[iCaLamViecTuDongKhongQuaDem]["BatDauTinhVeSom"].ToString();
                                                                iChoPhepVeSom = Convert.ToInt32(dtCaLamViecTuDongKhongQuaDem.Rows[iCaLamViecTuDongKhongQuaDem]["ChoPhepVeSom"].ToString());
                                                                value = dGioRaKhaiBaoTuDongKhongQuaDemB - dGioRaTuDong;
                                                                second = Convert.ToInt32(value.TotalMinutes);
                                                                sPhutVeSom = second.ToString();
                                                                if (Convert.ToInt32(sPhutVeSom) < 0)
                                                                {
                                                                    sPhutVeSom = "0";
                                                                }
                                                                dTongPhutTangCaTuDongKhongQuaDem = Convert.ToDouble(dtCaLamViecTuDongKhongQuaDem.Rows[iCaLamViecTuDongKhongQuaDem]["TongGioTrongCaLamViec"]) * 60 - (Convert.ToDouble(sPhutTre) + Convert.ToDouble(sPhutVeSom));
                                                                dTongGioTangCaTuDongKhongQuaDem = Math.Round(dTongPhutTangCaTuDongKhongQuaDem / 60, this.iLamTronGio);
                                                                if (iTangCaMuc == 1)
                                                                {
                                                                    if (dTongGioTangCaTuDongKhongQuaDem > 3)
                                                                    {
                                                                        this.DGVTinhCong.Rows[addTuDong].Cells[12].Value = 3 * this.dTangCa1HeSo;
                                                                    }
                                                                    else
                                                                    {
                                                                        this.DGVTinhCong.Rows[addTuDong].Cells[12].Value = dTongGioTangCaTuDongKhongQuaDem * this.dTangCa1HeSo;
                                                                    }
                                                                    this.DGVTinhCong.Rows[addTuDong].Cells[18].Value = this.sKHDungGio;
                                                                }
                                                                if (iTangCaMuc == 2)
                                                                {
                                                                    value = dGioRaTuDong - dGioVaoKhaiBaoTuDongKhongQuaDemB;
                                                                    second = Convert.ToInt32(value.TotalMinutes);
                                                                    dTongGioThucTeTuDongKhongQuaDem = Math.Round(Convert.ToDouble(second.ToString()) / 60, this.iLamTronGio);
                                                                    this.DGVTinhCong.Rows[addTuDong].Cells[13].Value = dTongGioTangCaTuDongKhongQuaDem * this.dTangCa2HeSo;
                                                                    this.DGVTinhCong.Rows[addTuDong].Cells[18].Value = this.sKHDungGio;
                                                                }
                                                                if (iTangCaMuc == 3)
                                                                {
                                                                    value = dGioRaTuDong - dGioVaoKhaiBaoTuDongKhongQuaDemB;
                                                                    second = Convert.ToInt32(value.TotalMinutes);
                                                                    dTongGioThucTeTuDongKhongQuaDem = Math.Round(Convert.ToDouble(second.ToString()) / 60, this.iLamTronGio);
                                                                    this.DGVTinhCong.Rows[addTuDong].Cells[14].Value = dTongGioTangCaTuDongKhongQuaDem * this.dTangCa3HeSo;
                                                                    this.DGVTinhCong.Rows[addTuDong].Cells[18].Value = this.sKHDungGio;
                                                                }
                                                                if (iTangCaMuc == 4)
                                                                {
                                                                    value = dGioRaTuDong - dGioVaoKhaiBaoTuDongKhongQuaDemB;
                                                                    second = Convert.ToInt32(value.TotalMinutes);
                                                                    dTongGioThucTeTuDongKhongQuaDem = Math.Round(Convert.ToDouble(second.ToString()) / 60, this.iLamTronGio);
                                                                    this.DGVTinhCong.Rows[addTuDong].Cells[15].Value = dTongGioTangCaTuDongKhongQuaDem * this.dTangCa4HeSo;
                                                                    this.DGVTinhCong.Rows[addTuDong].Cells[18].Value = this.sKHDungGio;
                                                                }
                                                            }
                                                            else if (!(DateTimeProgress.XuatIDThu((int)dt.AddDays((double)dem).DayOfWeek) == "0"))
                                                            {
                                                                sTruGioDiTre = dtCaLamViecTuDongKhongQuaDem.Rows[iCaLamViecTuDongKhongQuaDem]["TruGioDiTre"].ToString();
                                                                sBatDauTinhDiTre = dtCaLamViecTuDongKhongQuaDem.Rows[iCaLamViecTuDongKhongQuaDem]["BatDauTinhDiTre"].ToString();
                                                                iChoPhepDiTre = Convert.ToInt32(dtCaLamViecTuDongKhongQuaDem.Rows[iCaLamViecTuDongKhongQuaDem]["ChoPhepDiTre"].ToString());
                                                                value = dGioVaoTuDong - dGioVaoKhaiBaoTuDongKhongQuaDemB;
                                                                second = Convert.ToInt32(value.TotalMinutes);
                                                                sPhutTre = second.ToString();
                                                                if (!(sTruGioDiTre == "True"))
                                                                {
                                                                    this.DGVTinhCong.Rows[addTuDong].Cells[9].Value = "0";
                                                                }
                                                                else if (Convert.ToInt32(sPhutTre) >= 0)
                                                                {
                                                                    iPhutTre = Convert.ToInt32(sPhutTre) - iChoPhepDiTre;
                                                                    if (sBatDauTinhDiTre == "True")
                                                                    {
                                                                        if (iPhutTre >= 1)
                                                                        {
                                                                            this.DGVTinhCong.Rows[addTuDong].Cells[9].Value = iPhutTre.ToString();
                                                                        }
                                                                        else
                                                                        {
                                                                            this.DGVTinhCong.Rows[addTuDong].Cells[9].Value = "0";
                                                                        }
                                                                    }
                                                                    else if (iPhutTre >= 1)
                                                                    {
                                                                        this.DGVTinhCong.Rows[addTuDong].Cells[9].Value = sPhutTre;
                                                                    }
                                                                    else
                                                                    {
                                                                        this.DGVTinhCong.Rows[addTuDong].Cells[9].Value = "0";
                                                                    }
                                                                }
                                                                else
                                                                {
                                                                    this.DGVTinhCong.Rows[addTuDong].Cells[9].Value = "0";
                                                                }
                                                                sTruGioVeSom = dtCaLamViecTuDongKhongQuaDem.Rows[iCaLamViecTuDongKhongQuaDem]["TruGioVeSom"].ToString();
                                                                sBatDauTinhVeSom = dtCaLamViecTuDongKhongQuaDem.Rows[iCaLamViecTuDongKhongQuaDem]["BatDauTinhVeSom"].ToString();
                                                                iChoPhepVeSom = Convert.ToInt32(dtCaLamViecTuDongKhongQuaDem.Rows[iCaLamViecTuDongKhongQuaDem]["ChoPhepVeSom"].ToString());
                                                                value = dGioRaKhaiBaoTuDongKhongQuaDemB - dGioRaTuDong;
                                                                second = Convert.ToInt32(value.TotalMinutes);
                                                                sPhutVeSom = second.ToString();
                                                                if (!(sTruGioVeSom == "True"))
                                                                {
                                                                    this.DGVTinhCong.Rows[addTuDong].Cells[10].Value = "0";
                                                                }
                                                                else if (Convert.ToInt32(sPhutVeSom) >= 0)
                                                                {
                                                                    iPhutVeSom = Convert.ToInt32(sPhutVeSom) - iChoPhepVeSom;
                                                                    if (iPhutVeSom < 1)
                                                                    {
                                                                        this.DGVTinhCong.Rows[addTuDong].Cells[10].Value = "0";
                                                                    }
                                                                    else if (!(sBatDauTinhVeSom == "True"))
                                                                    {
                                                                        this.DGVTinhCong.Rows[addTuDong].Cells[10].Value = sPhutVeSom;
                                                                    }
                                                                    else
                                                                    {
                                                                        this.DGVTinhCong.Rows[addTuDong].Cells[10].Value = iPhutVeSom.ToString();
                                                                    }
                                                                }
                                                                else
                                                                {
                                                                    this.DGVTinhCong.Rows[addTuDong].Cells[10].Value = "0";
                                                                }
                                                                value = dGioRaTuDong - dGioRaKhaiBaoTuDongKhongQuaDemB;
                                                                second = Convert.ToInt32(value.TotalMinutes);
                                                                sVeTre = second.ToString();
                                                                if (Convert.ToInt32(sVeTre) <= 0)
                                                                {
                                                                    this.DGVTinhCong.Rows[addTuDong].Cells[11].Value = "0";
                                                                }
                                                                else
                                                                {
                                                                    this.DGVTinhCong.Rows[addTuDong].Cells[11].Value = sVeTre;
                                                                }
                                                                iPhut = Convert.ToSingle(dtCaLamViecTuDongKhongQuaDem.Rows[iCaLamViecTuDongKhongQuaDem]["TongGioTrongCaLamViec"]) * 60f - (float)(Convert.ToInt32(this.DGVTinhCong.Rows[addTuDong].Cells[9].Value.ToString()) + Convert.ToInt32(this.DGVTinhCong.Rows[addTuDong].Cells[10].Value));
                                                                dGio = Math.Round(Convert.ToDouble(iPhut) / 60, this.iLamTronGio);
                                                                this.DGVTinhCong.Rows[addTuDong].Cells[8].Value = dGio.ToString();
                                                                iGio = Convert.ToDouble(dtCaLamViecTuDongKhongQuaDem.Rows[iCaLamViecTuDongKhongQuaDem]["TongGioTrongCaLamViec"].ToString());
                                                                dCongTinh = Convert.ToDouble(dtCaLamViecTuDongKhongQuaDem.Rows[iCaLamViecTuDongKhongQuaDem]["CongTinh"].ToString());
                                                                dCong = Math.Round(dGio * dCongTinh / iGio, this.iLamTronCong);
                                                                this.DGVTinhCong.Rows[addTuDong].Cells[7].Value = dCong.ToString();
                                                                value = dGioRaTuDong - dGioVaoTuDong;
                                                                second = Convert.ToInt32(value.TotalMinutes);
                                                                dTongGioThucTeTuDongKhongQuaDem = Math.Round(Convert.ToDouble(second.ToString()) / 60, this.iLamTronGio);
                                                                this.DGVTinhCong.Rows[addTuDong].Cells[16].Value = dTongGioThucTeTuDongKhongQuaDem.ToString();
                                                                this.DGVTinhCong.Rows[addTuDong].Cells[17].Value = dtCaLamViecTuDongKhongQuaDem.Rows[iCaLamViecTuDongKhongQuaDem]["CongTinh"].ToString();
                                                                this.DGVTinhCong.Rows[addTuDong].Cells[18].Value = this.sKHDungGio;
                                                                sChoPhepTangCaTruocGioLamViecTuDongKhongQuaDem = dtCaLamViecTuDongKhongQuaDem.Rows[iCaLamViecTuDongKhongQuaDem]["TangCaTruocGioLamViec"].ToString();
                                                                iPhutTangCaTruocGioLamViecTuDongKhongQuaDem = Convert.ToInt32(dtCaLamViecTuDongKhongQuaDem.Rows[iCaLamViecTuDongKhongQuaDem]["SoPhutTangCaTruocGioLamViec"].ToString());
                                                                iPhutTangCaTruocGioLamViecDatDen = Convert.ToInt32(dtCaLamViecTuDongKhongQuaDem.Rows[iCaLamViecTuDongKhongQuaDem]["TangCaTruocGioLamViecDatDen"].ToString());
                                                                iPhutTruTangCaTruoc = Convert.ToInt32(dtCaLamViecTuDongKhongQuaDem.Rows[iCaLamViecTuDongKhongQuaDem]["PhutTruTangCaTruoc"].ToString());
                                                                sChoPhepTangCaSauGioLamViecTuDongKhongQuaDem = dtCaLamViecTuDongKhongQuaDem.Rows[iCaLamViecTuDongKhongQuaDem]["TangCaSauGioLamViec"].ToString();
                                                                iPhutTangCaSauGioLamViecTuDongKhongQuaDem = Convert.ToInt32(dtCaLamViecTuDongKhongQuaDem.Rows[iCaLamViecTuDongKhongQuaDem]["SoPhutTangCaSauGioLamViec"].ToString());
                                                                iPhutTangCaSauGioLamViecDatDen = Convert.ToInt32(dtCaLamViecTuDongKhongQuaDem.Rows[iCaLamViecTuDongKhongQuaDem]["TangCaSauGioLamViecDatDen"].ToString());
                                                                iPhutTruTangCaSau = Convert.ToInt32(dtCaLamViecTuDongKhongQuaDem.Rows[iCaLamViecTuDongKhongQuaDem]["PhutTruTangCaSau"].ToString());
                                                                iGioiHanTC1TuDongKhongQuaDem = Convert.ToInt32(dtCaLamViecTuDongKhongQuaDem.Rows[iCaLamViecTuDongKhongQuaDem]["GioiHanTangCa1"].ToString());
                                                                iGioiHanTC2TuDongKhongQuaDem = Convert.ToInt32(dtCaLamViecTuDongKhongQuaDem.Rows[iCaLamViecTuDongKhongQuaDem]["GioiHanTangCa2"].ToString());
                                                                iGioiHanTC3TuDongKhongQuaDem = Convert.ToInt32(dtCaLamViecTuDongKhongQuaDem.Rows[iCaLamViecTuDongKhongQuaDem]["GioiHanTangCa3"].ToString());
                                                                iGioiHanTC4TuDongKhongQuaDem = Convert.ToInt32(dtCaLamViecTuDongKhongQuaDem.Rows[iCaLamViecTuDongKhongQuaDem]["GioiHanTangCa4"].ToString());
                                                                iTongGioTangCaSauTuDongKhongQuaDem = 0;
                                                                iTongGioTangCaTruocTuDongKhongQuaDem = 0;
                                                                if ((sChoPhepTangCaTruocGioLamViecTuDongKhongQuaDem != "False" ? true : !(sChoPhepTangCaSauGioLamViecTuDongKhongQuaDem == "False")))
                                                                {
                                                                    if (sChoPhepTangCaTruocGioLamViecTuDongKhongQuaDem == "True")
                                                                    {
                                                                        value = dGioVaoKhaiBaoTuDongKhongQuaDemB - dGioVaoTuDong;
                                                                        second = Convert.ToInt32(value.TotalMinutes);
                                                                        iThoiGianTruocGioLamTuDongKhongQuaDem = Convert.ToInt32(second.ToString());
                                                                        if (iThoiGianTruocGioLamTuDongKhongQuaDem > 0)
                                                                        {
                                                                            if (iThoiGianTruocGioLamTuDongKhongQuaDem > iPhutTangCaTruocGioLamViecTuDongKhongQuaDem)
                                                                            {
                                                                                if (iThoiGianTruocGioLamTuDongKhongQuaDem > iPhutTangCaTruocGioLamViecDatDen)
                                                                                {
                                                                                    iTongGioTangCaTruocTuDongKhongQuaDem = iThoiGianTruocGioLamTuDongKhongQuaDem - iPhutTruTangCaTruoc;
                                                                                }
                                                                            }
                                                                        }
                                                                    }
                                                                    if (sChoPhepTangCaSauGioLamViecTuDongKhongQuaDem == "True")
                                                                    {
                                                                        value = dGioRaTuDong - dGioRaKhaiBaoTuDongKhongQuaDemB;
                                                                        second = Convert.ToInt32(value.TotalMinutes);
                                                                        iThoiGianSauGioLamViecTuDongKhongQuaDem = Convert.ToInt32(second.ToString());
                                                                        if (iThoiGianSauGioLamViecTuDongKhongQuaDem > 0)
                                                                        {
                                                                            if (iThoiGianSauGioLamViecTuDongKhongQuaDem > iPhutTangCaSauGioLamViecTuDongKhongQuaDem)
                                                                            {
                                                                                if (iThoiGianSauGioLamViecTuDongKhongQuaDem > iPhutTangCaSauGioLamViecDatDen)
                                                                                {
                                                                                    iTongGioTangCaSauTuDongKhongQuaDem = iThoiGianSauGioLamViecTuDongKhongQuaDem - iPhutTruTangCaSau;
                                                                                }
                                                                            }
                                                                        }
                                                                    }
                                                                }
                                                                else
                                                                {
                                                                    this.DGVTinhCong.Rows[addTuDong].Cells[12].Value = "0";
                                                                    this.DGVTinhCong.Rows[addTuDong].Cells[13].Value = "0";
                                                                    this.DGVTinhCong.Rows[addTuDong].Cells[14].Value = "0";
                                                                    this.DGVTinhCong.Rows[addTuDong].Cells[15].Value = "0";
                                                                }
                                                                dTongThoiGianTangCaTuDongKhongQuaDem = Convert.ToDouble(iTongGioTangCaTruocTuDongKhongQuaDem + iTongGioTangCaSauTuDongKhongQuaDem);
                                                                if (dTongThoiGianTangCaTuDongKhongQuaDem <= 0)
                                                                {
                                                                    this.DGVTinhCong.Rows[addTuDong].Cells[12].Value = "0";
                                                                    this.DGVTinhCong.Rows[addTuDong].Cells[13].Value = "0";
                                                                    this.DGVTinhCong.Rows[addTuDong].Cells[14].Value = "0";
                                                                    this.DGVTinhCong.Rows[addTuDong].Cells[15].Value = "0";
                                                                }
                                                                else
                                                                {
                                                                    if (iGioiHanTC1TuDongKhongQuaDem == 0)
                                                                    {
                                                                        this.DGVTinhCong.Rows[addTuDong].Cells[12].Value = Math.Round(dTongThoiGianTangCaTuDongKhongQuaDem * this.dTangCa1HeSo / 60, this.iLamTronGio);
                                                                        this.DGVTinhCong.Rows[addTuDong].Cells[13].Value = "0";
                                                                        this.DGVTinhCong.Rows[addTuDong].Cells[14].Value = "0";
                                                                        this.DGVTinhCong.Rows[addTuDong].Cells[15].Value = "0";
                                                                    }
                                                                    if ((iGioiHanTC1TuDongKhongQuaDem == 0 ? false : iGioiHanTC2TuDongKhongQuaDem == 0))
                                                                    {
                                                                        if (dTongThoiGianTangCaTuDongKhongQuaDem >= Convert.ToDouble(iGioiHanTC1TuDongKhongQuaDem))
                                                                        {
                                                                            this.DGVTinhCong.Rows[addTuDong].Cells[12].Value = Math.Round(Convert.ToDouble(iGioiHanTC1TuDongKhongQuaDem) / 60 * this.dTangCa1HeSo, this.iLamTronGio);
                                                                            if (dTongThoiGianTangCaTuDongKhongQuaDem - Convert.ToDouble(iGioiHanTC1TuDongKhongQuaDem) > 0)
                                                                            {
                                                                                this.DGVTinhCong.Rows[addTuDong].Cells[13].Value = Math.Round((dTongThoiGianTangCaTuDongKhongQuaDem - Convert.ToDouble(iGioiHanTC1TuDongKhongQuaDem)) * this.dTangCa2HeSo / 60, this.iLamTronGio);
                                                                            }
                                                                            this.DGVTinhCong.Rows[addTuDong].Cells[14].Value = "0";
                                                                            this.DGVTinhCong.Rows[addTuDong].Cells[15].Value = "0";
                                                                        }
                                                                        else
                                                                        {
                                                                            this.DGVTinhCong.Rows[addTuDong].Cells[12].Value = Math.Round(dTongThoiGianTangCaTuDongKhongQuaDem * this.dTangCa1HeSo / 60, this.iLamTronGio);
                                                                            this.DGVTinhCong.Rows[addTuDong].Cells[13].Value = "0";
                                                                            this.DGVTinhCong.Rows[addTuDong].Cells[14].Value = "0";
                                                                            this.DGVTinhCong.Rows[addTuDong].Cells[15].Value = "0";
                                                                        }
                                                                    }
                                                                    if ((iGioiHanTC1TuDongKhongQuaDem == 0 || iGioiHanTC2TuDongKhongQuaDem == 0 ? false : iGioiHanTC3TuDongKhongQuaDem == 0))
                                                                    {
                                                                        if (dTongThoiGianTangCaTuDongKhongQuaDem >= Convert.ToDouble(iGioiHanTC1TuDongKhongQuaDem))
                                                                        {
                                                                            this.DGVTinhCong.Rows[addTuDong].Cells[12].Value = Math.Round(Convert.ToDouble(iGioiHanTC1TuDongKhongQuaDem) * this.dTangCa1HeSo / 60, this.iLamTronGio);
                                                                            if (dTongThoiGianTangCaTuDongKhongQuaDem - Convert.ToDouble(iGioiHanTC1TuDongKhongQuaDem) >= Convert.ToDouble(iGioiHanTC2TuDongKhongQuaDem))
                                                                            {
                                                                                this.DGVTinhCong.Rows[addTuDong].Cells[12].Value = Math.Round(Convert.ToDouble(iGioiHanTC1TuDongKhongQuaDem) * this.dTangCa1HeSo / 60, this.iLamTronGio);
                                                                                this.DGVTinhCong.Rows[addTuDong].Cells[13].Value = Math.Round(Convert.ToDouble(iGioiHanTC2TuDongKhongQuaDem) * this.dTangCa2HeSo / 60, this.iLamTronGio);
                                                                                this.DGVTinhCong.Rows[addTuDong].Cells[14].Value = Math.Round((dTongThoiGianTangCaTuDongKhongQuaDem - Convert.ToDouble(iGioiHanTC1TuDongKhongQuaDem) - Convert.ToDouble(iGioiHanTC2TuDongKhongQuaDem)) * this.dTangCa3HeSo / 60, this.iLamTronGio);
                                                                                this.DGVTinhCong.Rows[addTuDong].Cells[15].Value = "0";
                                                                            }
                                                                            else
                                                                            {
                                                                                this.DGVTinhCong.Rows[addTuDong].Cells[13].Value = Math.Round((dTongThoiGianTangCaTuDongKhongQuaDem - Convert.ToDouble(iGioiHanTC1TuDongKhongQuaDem)) * this.dTangCa2HeSo / 60, this.iLamTronGio);
                                                                                this.DGVTinhCong.Rows[addTuDong].Cells[14].Value = "0";
                                                                                this.DGVTinhCong.Rows[addTuDong].Cells[15].Value = "0";
                                                                            }
                                                                        }
                                                                        else
                                                                        {
                                                                            this.DGVTinhCong.Rows[addTuDong].Cells[12].Value = Math.Round(dTongThoiGianTangCaTuDongKhongQuaDem * this.dTangCa1HeSo / 60, this.iLamTronGio);
                                                                            this.DGVTinhCong.Rows[addTuDong].Cells[13].Value = "0";
                                                                            this.DGVTinhCong.Rows[addTuDong].Cells[14].Value = "0";
                                                                            this.DGVTinhCong.Rows[addTuDong].Cells[15].Value = "0";
                                                                        }
                                                                    }
                                                                    if ((iGioiHanTC1TuDongKhongQuaDem == 0 || iGioiHanTC2TuDongKhongQuaDem == 0 || iGioiHanTC3TuDongKhongQuaDem == 0 ? false : iGioiHanTC4TuDongKhongQuaDem == 0))
                                                                    {
                                                                    }
                                                                }
                                                            }
                                                            else if (!(sXemChuNhatLaTangCa == "True"))
                                                            {
                                                                sTruGioDiTre = dtCaLamViecTuDongKhongQuaDem.Rows[iCaLamViecTuDongKhongQuaDem]["TruGioDiTre"].ToString();
                                                                sBatDauTinhDiTre = dtCaLamViecTuDongKhongQuaDem.Rows[iCaLamViecTuDongKhongQuaDem]["BatDauTinhDiTre"].ToString();
                                                                iChoPhepDiTre = Convert.ToInt32(dtCaLamViecTuDongKhongQuaDem.Rows[iCaLamViecTuDongKhongQuaDem]["ChoPhepDiTre"].ToString());
                                                                value = dGioVaoTuDong - dGioVaoKhaiBaoTuDongKhongQuaDemB;
                                                                second = Convert.ToInt32(value.TotalMinutes);
                                                                sPhutTre = second.ToString();
                                                                if (!(sTruGioDiTre == "True"))
                                                                {
                                                                    this.DGVTinhCong.Rows[addTuDong].Cells[9].Value = "0";
                                                                }
                                                                else if (Convert.ToInt32(sPhutTre) >= 0)
                                                                {
                                                                    iPhutTre = Convert.ToInt32(sPhutTre) - iChoPhepDiTre;
                                                                    if (sBatDauTinhDiTre == "True")
                                                                    {
                                                                        if (iPhutTre >= 1)
                                                                        {
                                                                            this.DGVTinhCong.Rows[addTuDong].Cells[9].Value = iPhutTre.ToString();
                                                                        }
                                                                        else
                                                                        {
                                                                            this.DGVTinhCong.Rows[addTuDong].Cells[9].Value = "0";
                                                                        }
                                                                    }
                                                                    else if (iPhutTre >= 1)
                                                                    {
                                                                        this.DGVTinhCong.Rows[addTuDong].Cells[9].Value = sPhutTre;
                                                                    }
                                                                    else
                                                                    {
                                                                        this.DGVTinhCong.Rows[addTuDong].Cells[9].Value = "0";
                                                                    }
                                                                }
                                                                else
                                                                {
                                                                    this.DGVTinhCong.Rows[addTuDong].Cells[9].Value = "0";
                                                                }
                                                                sTruGioVeSom = dtCaLamViecTuDongKhongQuaDem.Rows[iCaLamViecTuDongKhongQuaDem]["TruGioVeSom"].ToString();
                                                                sBatDauTinhVeSom = dtCaLamViecTuDongKhongQuaDem.Rows[iCaLamViecTuDongKhongQuaDem]["BatDauTinhVeSom"].ToString();
                                                                iChoPhepVeSom = Convert.ToInt32(dtCaLamViecTuDongKhongQuaDem.Rows[iCaLamViecTuDongKhongQuaDem]["ChoPhepVeSom"].ToString());
                                                                value = dGioRaKhaiBaoTuDongKhongQuaDemB - dGioRaTuDong;
                                                                second = Convert.ToInt32(value.TotalMinutes);
                                                                sPhutVeSom = second.ToString();
                                                                if (!(sTruGioVeSom == "True"))
                                                                {
                                                                    this.DGVTinhCong.Rows[addTuDong].Cells[10].Value = "0";
                                                                }
                                                                else if (Convert.ToInt32(sPhutVeSom) >= 0)
                                                                {
                                                                    iPhutVeSom = Convert.ToInt32(sPhutVeSom) - iChoPhepVeSom;
                                                                    if (iPhutVeSom < 1)
                                                                    {
                                                                        this.DGVTinhCong.Rows[addTuDong].Cells[10].Value = "0";
                                                                    }
                                                                    else if (!(sBatDauTinhVeSom == "True"))
                                                                    {
                                                                        this.DGVTinhCong.Rows[addTuDong].Cells[10].Value = sPhutVeSom;
                                                                    }
                                                                    else
                                                                    {
                                                                        this.DGVTinhCong.Rows[addTuDong].Cells[10].Value = iPhutVeSom.ToString();
                                                                    }
                                                                }
                                                                else
                                                                {
                                                                    this.DGVTinhCong.Rows[addTuDong].Cells[10].Value = "0";
                                                                }
                                                                value = dGioRaTuDong - dGioRaKhaiBaoTuDongKhongQuaDemB;
                                                                second = Convert.ToInt32(value.TotalMinutes);
                                                                sVeTre = second.ToString();
                                                                if (Convert.ToInt32(sVeTre) <= 0)
                                                                {
                                                                    this.DGVTinhCong.Rows[addTuDong].Cells[11].Value = "0";
                                                                }
                                                                else
                                                                {
                                                                    this.DGVTinhCong.Rows[addTuDong].Cells[11].Value = sVeTre;
                                                                }
                                                                iPhut = Convert.ToSingle(dtCaLamViecTuDongKhongQuaDem.Rows[iCaLamViecTuDongKhongQuaDem]["TongGioTrongCaLamViec"]) * 60f - (float)(Convert.ToInt32(this.DGVTinhCong.Rows[addTuDong].Cells[9].Value.ToString()) + Convert.ToInt32(this.DGVTinhCong.Rows[addTuDong].Cells[10].Value));
                                                                dGio = Math.Round(Convert.ToDouble(iPhut) / 60, this.iLamTronGio);
                                                                this.DGVTinhCong.Rows[addTuDong].Cells[8].Value = dGio * this.dTangCaChuNhatHeSo;
                                                                iGio = Convert.ToDouble(dtCaLamViecTuDongKhongQuaDem.Rows[iCaLamViecTuDongKhongQuaDem]["TongGioTrongCaLamViec"].ToString());
                                                                dCongTinh = Convert.ToDouble(dtCaLamViecTuDongKhongQuaDem.Rows[iCaLamViecTuDongKhongQuaDem]["CongTinh"].ToString());
                                                                dCong = Math.Round(dGio * dCongTinh / iGio, this.iLamTronCong);
                                                                this.DGVTinhCong.Rows[addTuDong].Cells[7].Value = dCong * this.dTangCaChuNhatHeSo;
                                                                value = dGioRaTuDong - dGioVaoTuDong;
                                                                second = Convert.ToInt32(value.TotalMinutes);
                                                                dTongGioThucTeTuDongKhongQuaDem = Math.Round(Convert.ToDouble(second.ToString()) / 60, this.iLamTronGio);
                                                                this.DGVTinhCong.Rows[addTuDong].Cells[16].Value = dTongGioThucTeTuDongKhongQuaDem * this.dTangCaChuNhatHeSo;
                                                                this.DGVTinhCong.Rows[addTuDong].Cells[17].Value = Convert.ToDouble(dtCaLamViecTuDongKhongQuaDem.Rows[iCaLamViecTuDongKhongQuaDem]["CongTinh"].ToString()) * this.dTangCaChuNhatHeSo;
                                                                this.DGVTinhCong.Rows[addTuDong].Cells[18].Value = this.sKHDungGio;
                                                                sChoPhepTangCaTruocGioLamViecTuDongKhongQuaDem = dtCaLamViecTuDongKhongQuaDem.Rows[iCaLamViecTuDongKhongQuaDem]["TangCaTruocGioLamViec"].ToString();
                                                                iPhutTangCaTruocGioLamViecTuDongKhongQuaDem = Convert.ToInt32(dtCaLamViecTuDongKhongQuaDem.Rows[iCaLamViecTuDongKhongQuaDem]["SoPhutTangCaTruocGioLamViec"].ToString());
                                                                iPhutTangCaTruocGioLamViecDatDen = Convert.ToInt32(dtCaLamViecTuDongKhongQuaDem.Rows[iCaLamViecTuDongKhongQuaDem]["TangCaTruocGioLamViecDatDen"].ToString());
                                                                iPhutTruTangCaTruoc = Convert.ToInt32(dtCaLamViecTuDongKhongQuaDem.Rows[iCaLamViecTuDongKhongQuaDem]["PhutTruTangCaTruoc"].ToString());
                                                                sChoPhepTangCaSauGioLamViecTuDongKhongQuaDem = dtCaLamViecTuDongKhongQuaDem.Rows[iCaLamViecTuDongKhongQuaDem]["TangCaSauGioLamViec"].ToString();
                                                                iPhutTangCaSauGioLamViecTuDongKhongQuaDem = Convert.ToInt32(dtCaLamViecTuDongKhongQuaDem.Rows[iCaLamViecTuDongKhongQuaDem]["SoPhutTangCaSauGioLamViec"].ToString());
                                                                iPhutTangCaSauGioLamViecDatDen = Convert.ToInt32(dtCaLamViecTuDongKhongQuaDem.Rows[iCaLamViecTuDongKhongQuaDem]["TangCaSauGioLamViecDatDen"].ToString());
                                                                iPhutTruTangCaSau = Convert.ToInt32(dtCaLamViecTuDongKhongQuaDem.Rows[iCaLamViecTuDongKhongQuaDem]["PhutTruTangCaSau"].ToString());
                                                                iGioiHanTC1TuDongKhongQuaDem = Convert.ToInt32(dtCaLamViecTuDongKhongQuaDem.Rows[iCaLamViecTuDongKhongQuaDem]["GioiHanTangCa1"].ToString());
                                                                iGioiHanTC2TuDongKhongQuaDem = Convert.ToInt32(dtCaLamViecTuDongKhongQuaDem.Rows[iCaLamViecTuDongKhongQuaDem]["GioiHanTangCa2"].ToString());
                                                                iGioiHanTC3TuDongKhongQuaDem = Convert.ToInt32(dtCaLamViecTuDongKhongQuaDem.Rows[iCaLamViecTuDongKhongQuaDem]["GioiHanTangCa3"].ToString());
                                                                iGioiHanTC4TuDongKhongQuaDem = Convert.ToInt32(dtCaLamViecTuDongKhongQuaDem.Rows[iCaLamViecTuDongKhongQuaDem]["GioiHanTangCa4"].ToString());
                                                                iTongGioTangCaSauTuDongKhongQuaDem = 0;
                                                                iTongGioTangCaTruocTuDongKhongQuaDem = 0;
                                                                if ((sChoPhepTangCaTruocGioLamViecTuDongKhongQuaDem != "False" ? true : !(sChoPhepTangCaSauGioLamViecTuDongKhongQuaDem == "False")))
                                                                {
                                                                    if (sChoPhepTangCaTruocGioLamViecTuDongKhongQuaDem == "True")
                                                                    {
                                                                        value = dGioVaoKhaiBaoTuDongKhongQuaDemB - dGioVaoTuDong;
                                                                        second = Convert.ToInt32(value.TotalMinutes);
                                                                        iThoiGianTruocGioLamTuDongKhongQuaDem = Convert.ToInt32(second.ToString());
                                                                        if (iThoiGianTruocGioLamTuDongKhongQuaDem > 0)
                                                                        {
                                                                            if (iThoiGianTruocGioLamTuDongKhongQuaDem > iPhutTangCaTruocGioLamViecTuDongKhongQuaDem)
                                                                            {
                                                                                if (iThoiGianTruocGioLamTuDongKhongQuaDem > iPhutTangCaTruocGioLamViecDatDen)
                                                                                {
                                                                                    iTongGioTangCaTruocTuDongKhongQuaDem = iThoiGianTruocGioLamTuDongKhongQuaDem - iPhutTruTangCaTruoc;
                                                                                }
                                                                            }
                                                                        }
                                                                    }
                                                                    if (sChoPhepTangCaSauGioLamViecTuDongKhongQuaDem == "True")
                                                                    {
                                                                        value = dGioRaTuDong - dGioRaKhaiBaoTuDongKhongQuaDemB;
                                                                        second = Convert.ToInt32(value.TotalMinutes);
                                                                        iThoiGianSauGioLamViecTuDongKhongQuaDem = Convert.ToInt32(second.ToString());
                                                                        if (iThoiGianSauGioLamViecTuDongKhongQuaDem > 0)
                                                                        {
                                                                            if (iThoiGianSauGioLamViecTuDongKhongQuaDem > iPhutTangCaSauGioLamViecTuDongKhongQuaDem)
                                                                            {
                                                                                if (iThoiGianSauGioLamViecTuDongKhongQuaDem > iPhutTangCaSauGioLamViecDatDen)
                                                                                {
                                                                                    iTongGioTangCaSauTuDongKhongQuaDem = iThoiGianSauGioLamViecTuDongKhongQuaDem - iPhutTruTangCaSau;
                                                                                }
                                                                            }
                                                                        }
                                                                    }
                                                                }
                                                                else
                                                                {
                                                                    this.DGVTinhCong.Rows[addTuDong].Cells[12].Value = "0";
                                                                    this.DGVTinhCong.Rows[addTuDong].Cells[13].Value = "0";
                                                                    this.DGVTinhCong.Rows[addTuDong].Cells[14].Value = "0";
                                                                    this.DGVTinhCong.Rows[addTuDong].Cells[15].Value = "0";
                                                                }
                                                                dTongThoiGianTangCaTuDongKhongQuaDem = Convert.ToDouble(iTongGioTangCaTruocTuDongKhongQuaDem + iTongGioTangCaSauTuDongKhongQuaDem);
                                                                if (dTongThoiGianTangCaTuDongKhongQuaDem <= 0)
                                                                {
                                                                    this.DGVTinhCong.Rows[addTuDong].Cells[12].Value = "0";
                                                                    this.DGVTinhCong.Rows[addTuDong].Cells[13].Value = "0";
                                                                    this.DGVTinhCong.Rows[addTuDong].Cells[14].Value = "0";
                                                                    this.DGVTinhCong.Rows[addTuDong].Cells[15].Value = "0";
                                                                }
                                                                else
                                                                {
                                                                    if (iGioiHanTC1TuDongKhongQuaDem == 0)
                                                                    {
                                                                        this.DGVTinhCong.Rows[addTuDong].Cells[12].Value = Math.Round(dTongThoiGianTangCaTuDongKhongQuaDem * this.dTangCa1HeSo / 60, this.iLamTronGio);
                                                                        this.DGVTinhCong.Rows[addTuDong].Cells[13].Value = "0";
                                                                        this.DGVTinhCong.Rows[addTuDong].Cells[14].Value = "0";
                                                                        this.DGVTinhCong.Rows[addTuDong].Cells[15].Value = "0";
                                                                    }
                                                                    if ((iGioiHanTC1TuDongKhongQuaDem == 0 ? false : iGioiHanTC2TuDongKhongQuaDem == 0))
                                                                    {
                                                                        if (dTongThoiGianTangCaTuDongKhongQuaDem >= Convert.ToDouble(iGioiHanTC1TuDongKhongQuaDem))
                                                                        {
                                                                            this.DGVTinhCong.Rows[addTuDong].Cells[12].Value = Math.Round(Convert.ToDouble(iGioiHanTC1TuDongKhongQuaDem) / 60 * this.dTangCa1HeSo, this.iLamTronGio);
                                                                            if (dTongThoiGianTangCaTuDongKhongQuaDem - Convert.ToDouble(iGioiHanTC1TuDongKhongQuaDem) > 0)
                                                                            {
                                                                                this.DGVTinhCong.Rows[addTuDong].Cells[13].Value = Math.Round((dTongThoiGianTangCaTuDongKhongQuaDem - Convert.ToDouble(iGioiHanTC1TuDongKhongQuaDem)) * this.dTangCa2HeSo / 60, this.iLamTronGio);
                                                                            }
                                                                            this.DGVTinhCong.Rows[addTuDong].Cells[14].Value = "0";
                                                                            this.DGVTinhCong.Rows[addTuDong].Cells[15].Value = "0";
                                                                        }
                                                                        else
                                                                        {
                                                                            this.DGVTinhCong.Rows[addTuDong].Cells[12].Value = Math.Round(dTongThoiGianTangCaTuDongKhongQuaDem * this.dTangCa1HeSo / 60, this.iLamTronGio);
                                                                            this.DGVTinhCong.Rows[addTuDong].Cells[13].Value = "0";
                                                                            this.DGVTinhCong.Rows[addTuDong].Cells[14].Value = "0";
                                                                            this.DGVTinhCong.Rows[addTuDong].Cells[15].Value = "0";
                                                                        }
                                                                    }
                                                                    if ((iGioiHanTC1TuDongKhongQuaDem == 0 || iGioiHanTC2TuDongKhongQuaDem == 0 ? false : iGioiHanTC3TuDongKhongQuaDem == 0))
                                                                    {
                                                                        if (dTongThoiGianTangCaTuDongKhongQuaDem >= Convert.ToDouble(iGioiHanTC1TuDongKhongQuaDem))
                                                                        {
                                                                            this.DGVTinhCong.Rows[addTuDong].Cells[12].Value = Math.Round(Convert.ToDouble(iGioiHanTC1TuDongKhongQuaDem) * this.dTangCa1HeSo / 60, this.iLamTronGio);
                                                                            if (dTongThoiGianTangCaTuDongKhongQuaDem - Convert.ToDouble(iGioiHanTC1TuDongKhongQuaDem) >= Convert.ToDouble(iGioiHanTC2TuDongKhongQuaDem))
                                                                            {
                                                                                this.DGVTinhCong.Rows[addTuDong].Cells[12].Value = Math.Round(Convert.ToDouble(iGioiHanTC1TuDongKhongQuaDem) * this.dTangCa1HeSo / 60, this.iLamTronGio);
                                                                                this.DGVTinhCong.Rows[addTuDong].Cells[13].Value = Math.Round(Convert.ToDouble(iGioiHanTC2TuDongKhongQuaDem) * this.dTangCa2HeSo / 60, this.iLamTronGio);
                                                                                this.DGVTinhCong.Rows[addTuDong].Cells[14].Value = Math.Round((dTongThoiGianTangCaTuDongKhongQuaDem - Convert.ToDouble(iGioiHanTC1TuDongKhongQuaDem) - Convert.ToDouble(iGioiHanTC2TuDongKhongQuaDem)) * this.dTangCa3HeSo / 60, this.iLamTronGio);
                                                                                this.DGVTinhCong.Rows[addTuDong].Cells[15].Value = "0";
                                                                            }
                                                                            else
                                                                            {
                                                                                this.DGVTinhCong.Rows[addTuDong].Cells[13].Value = Math.Round((dTongThoiGianTangCaTuDongKhongQuaDem - Convert.ToDouble(iGioiHanTC1TuDongKhongQuaDem)) * this.dTangCa2HeSo / 60, this.iLamTronGio);
                                                                                this.DGVTinhCong.Rows[addTuDong].Cells[14].Value = "0";
                                                                                this.DGVTinhCong.Rows[addTuDong].Cells[15].Value = "0";
                                                                            }
                                                                        }
                                                                        else
                                                                        {
                                                                            this.DGVTinhCong.Rows[addTuDong].Cells[12].Value = Math.Round(dTongThoiGianTangCaTuDongKhongQuaDem * this.dTangCa1HeSo / 60, this.iLamTronGio);
                                                                            this.DGVTinhCong.Rows[addTuDong].Cells[13].Value = "0";
                                                                            this.DGVTinhCong.Rows[addTuDong].Cells[14].Value = "0";
                                                                            this.DGVTinhCong.Rows[addTuDong].Cells[15].Value = "0";
                                                                        }
                                                                    }
                                                                    if ((iGioiHanTC1TuDongKhongQuaDem == 0 || iGioiHanTC2TuDongKhongQuaDem == 0 || iGioiHanTC3TuDongKhongQuaDem == 0 ? false : iGioiHanTC4TuDongKhongQuaDem == 0))
                                                                    {
                                                                    }
                                                                }
                                                            }
                                                            else
                                                            {
                                                                sTruGioDiTre = dtCaLamViecTuDongKhongQuaDem.Rows[iCaLamViecTuDongKhongQuaDem]["TruGioDiTre"].ToString();
                                                                sBatDauTinhDiTre = dtCaLamViecTuDongKhongQuaDem.Rows[iCaLamViecTuDongKhongQuaDem]["BatDauTinhDiTre"].ToString();
                                                                iChoPhepDiTre = Convert.ToInt32(dtCaLamViecTuDongKhongQuaDem.Rows[iCaLamViecTuDongKhongQuaDem]["ChoPhepDiTre"].ToString());
                                                                value = dGioVaoTuDong - dGioVaoKhaiBaoTuDongKhongQuaDemB;
                                                                second = Convert.ToInt32(value.TotalMinutes);
                                                                sPhutTre = second.ToString();
                                                                if (Convert.ToInt32(sPhutTre) < 0)
                                                                {
                                                                    sPhutTre = "0";
                                                                }
                                                                sTruGioVeSom = dtCaLamViecTuDongKhongQuaDem.Rows[iCaLamViecTuDongKhongQuaDem]["TruGioVeSom"].ToString();
                                                                sBatDauTinhVeSom = dtCaLamViecTuDongKhongQuaDem.Rows[iCaLamViecTuDongKhongQuaDem]["BatDauTinhVeSom"].ToString();
                                                                iChoPhepVeSom = Convert.ToInt32(dtCaLamViecTuDongKhongQuaDem.Rows[iCaLamViecTuDongKhongQuaDem]["ChoPhepVeSom"].ToString());
                                                                value = dGioRaKhaiBaoTuDongKhongQuaDemB - dGioRaTuDong;
                                                                second = Convert.ToInt32(value.TotalMinutes);
                                                                sPhutVeSom = second.ToString();
                                                                if (Convert.ToInt32(sPhutVeSom) < 0)
                                                                {
                                                                    sPhutVeSom = "0";
                                                                }
                                                                dTongPhutTangCaTuDongKhongQuaDemA = Convert.ToDouble(dtCaLamViecTuDongKhongQuaDem.Rows[iCaLamViecTuDongKhongQuaDem]["TongGioTrongCaLamViec"]) * 60 - (Convert.ToDouble(sPhutTre) + Convert.ToDouble(sPhutVeSom));
                                                                dTongGioTangCaTuDongKhongQuaDemA = Math.Round(dTongPhutTangCaTuDongKhongQuaDemA / 60, this.iLamTronGio);
                                                                if (iTangCaChuNhatMuc == 1)
                                                                {
                                                                    if (dTongGioTangCaTuDongKhongQuaDemA > 3)
                                                                    {
                                                                        this.DGVTinhCong.Rows[addTuDong].Cells[12].Value = 3 * this.dTangCaChuNhatHeSo;
                                                                    }
                                                                    else
                                                                    {
                                                                        this.DGVTinhCong.Rows[addTuDong].Cells[12].Value = dTongGioTangCaTuDongKhongQuaDemA * this.dTangCaChuNhatHeSo;
                                                                    }
                                                                    this.DGVTinhCong.Rows[addTuDong].Cells[18].Value = this.sKHDungGio;
                                                                }
                                                                if (iTangCaChuNhatMuc == 2)
                                                                {
                                                                    this.DGVTinhCong.Rows[addTuDong].Cells[13].Value = dTongGioTangCaTuDongKhongQuaDemA * this.dTangCaChuNhatHeSo;
                                                                    this.DGVTinhCong.Rows[addTuDong].Cells[18].Value = this.sKHDungGio;
                                                                }
                                                                if (iTangCaChuNhatMuc == 3)
                                                                {
                                                                    this.DGVTinhCong.Rows[addTuDong].Cells[14].Value = dTongGioTangCaTuDongKhongQuaDemA * this.dTangCaChuNhatHeSo;
                                                                    this.DGVTinhCong.Rows[addTuDong].Cells[18].Value = this.sKHDungGio;
                                                                }
                                                                if (iTangCaChuNhatMuc == 4)
                                                                {
                                                                    this.DGVTinhCong.Rows[addTuDong].Cells[15].Value = dTongGioTangCaTuDongKhongQuaDemA * this.dTangCaChuNhatHeSo;
                                                                    this.DGVTinhCong.Rows[addTuDong].Cells[18].Value = this.sKHDungGio;
                                                                }
                                                            }
                                                        }
                                                        if (!(DateTimeProgress.XuatIDThu((int)dt.AddDays((double)dem).DayOfWeek) == "0"))
                                                        {
                                                            this.DGVTinhCong.Rows[addTuDong].Cells[19].Value = "NT";
                                                        }
                                                        else
                                                        {
                                                            this.DGVTinhCong.Rows[addTuDong].Cells[19].Value = "CN";
                                                        }
                                                        this.DGVTinhCong.Rows[addTuDong].Cells[20].Value = this.sMaChamCong;
                                                        this.DGVTinhCong.Rows[addTuDong].Cells[21].Value = this.sPhongBanTinhCong;
                                                    }
                                              //  Label17:
                                                }
                                                else
                                                {
                                                    addTuDongKhongQuaDemThoiGianLonNhat = this.DGVTinhCong.Rows.Add();
                                                    this.DGVTinhCong.Rows[addTuDongKhongQuaDemThoiGianLonNhat].Cells[0].Value = this.sMaNhanVien;
                                                    this.DGVTinhCong.Rows[addTuDongKhongQuaDemThoiGianLonNhat].Cells[1].Value = this.sTenNhanVien;
                                                    this.DGVTinhCong.Rows[addTuDongKhongQuaDemThoiGianLonNhat].Cells[2].Value = this.DGVTinhCong.Rows[_nhanVien].Cells[2].Value.ToString();
                                                    if (this.iNgonNgu == 0)
                                                    {
                                                        DataGridViewCell item5 = this.DGVTinhCong.Rows[addTuDongKhongQuaDemThoiGianLonNhat].Cells[3];
                                                        dateTime = dt.AddDays((double)dem);
                                                        item5.Value = DateTimeProgress.XuatThuTinhCong((int)dateTime.DayOfWeek);
                                                    }
                                                    if (this.iNgonNgu == 1)
                                                    {
                                                        DataGridViewCell dataGridViewCell5 = this.DGVTinhCong.Rows[addTuDongKhongQuaDemThoiGianLonNhat].Cells[3];
                                                        dateTime = dt.AddDays((double)dem);
                                                        dataGridViewCell5.Value = DateTimeProgress.XuatThuEnglish((int)dateTime.DayOfWeek);
                                                    }
                                                    this.DGVTinhCong.Rows[addTuDongKhongQuaDemThoiGianLonNhat].Cells[4].Value = "***";
                                                    this.DGVTinhCong.Rows[addTuDongKhongQuaDemThoiGianLonNhat].Cells[6].Value = string.Format(this.sDinhDangThoiGian, dGioRaTuDong);
                                                    this.DGVTinhCong.Rows[addTuDongKhongQuaDemThoiGianLonNhat].Cells[7].Value = "0";
                                                    this.DGVTinhCong.Rows[addTuDongKhongQuaDemThoiGianLonNhat].Cells[8].Value = "0";
                                                    this.DGVTinhCong.Rows[addTuDongKhongQuaDemThoiGianLonNhat].Cells[9].Value = "0";
                                                    this.DGVTinhCong.Rows[addTuDongKhongQuaDemThoiGianLonNhat].Cells[10].Value = "0";
                                                    this.DGVTinhCong.Rows[addTuDongKhongQuaDemThoiGianLonNhat].Cells[11].Value = "0";
                                                    this.DGVTinhCong.Rows[addTuDongKhongQuaDemThoiGianLonNhat].Cells[12].Value = "0";
                                                    this.DGVTinhCong.Rows[addTuDongKhongQuaDemThoiGianLonNhat].Cells[13].Value = "0";
                                                    this.DGVTinhCong.Rows[addTuDongKhongQuaDemThoiGianLonNhat].Cells[14].Value = "0";
                                                    this.DGVTinhCong.Rows[addTuDongKhongQuaDemThoiGianLonNhat].Cells[15].Value = "0";
                                                    this.DGVTinhCong.Rows[addTuDongKhongQuaDemThoiGianLonNhat].Cells[16].Value = "0";
                                                    this.DGVTinhCong.Rows[addTuDongKhongQuaDemThoiGianLonNhat].Cells[17].Value = "0";
                                                    this.DGVTinhCong.Rows[addTuDongKhongQuaDemThoiGianLonNhat].Cells[18].Value = this.sKHVang;
                                                    if (!(DateTimeProgress.XuatIDThu((int)dt.AddDays((double)dem).DayOfWeek) == "0"))
                                                    {
                                                        this.DGVTinhCong.Rows[addTuDongKhongQuaDemThoiGianLonNhat].Cells[19].Value = "NT";
                                                    }
                                                    else
                                                    {
                                                        this.DGVTinhCong.Rows[addTuDongKhongQuaDemThoiGianLonNhat].Cells[19].Value = "CN";
                                                    }
                                                    this.DGVTinhCong.Rows[addTuDongKhongQuaDemThoiGianLonNhat].Cells[20].Value = this.sMaChamCong;
                                                    this.DGVTinhCong.Rows[addTuDongKhongQuaDemThoiGianLonNhat].Cells[21].Value = this.sPhongBanTinhCong;
                                                }
                                            }
                                            else
                                            {
                                                addTuDong = this.DGVTinhCong.Rows.Add();
                                                dGioVaoTuDong = Convert.ToDateTime(dtTuDong.Rows[iTuDong]["GioCham"].ToString());
                                                this.DGVTinhCong.Rows[addTuDong].Cells[5].Value = string.Format(this.sDinhDangThoiGian, dGioVaoTuDong);
                                                this.DGVTinhCong.Rows[addTuDong].Cells[0].Value = this.sMaNhanVien;
                                                this.DGVTinhCong.Rows[addTuDong].Cells[1].Value = this.sTenNhanVien;
                                                this.DGVTinhCong.Rows[addTuDong].Cells[2].Value = this.DGVTinhCong.Rows[_nhanVien].Cells[2].Value.ToString();
                                                if (this.iNgonNgu == 0)
                                                {
                                                    DataGridViewCell item6 = this.DGVTinhCong.Rows[addTuDong].Cells[3];
                                                    dateTime = dt.AddDays((double)dem);
                                                    item6.Value = DateTimeProgress.XuatThuTinhCong((int)dateTime.DayOfWeek);
                                                }
                                                if (this.iNgonNgu == 1)
                                                {
                                                    DataGridViewCell dataGridViewCell6 = this.DGVTinhCong.Rows[addTuDong].Cells[3];
                                                    dateTime = dt.AddDays((double)dem);
                                                    dataGridViewCell6.Value = DateTimeProgress.XuatThuEnglish((int)dateTime.DayOfWeek);
                                                }
                                                this.DGVTinhCong.Rows[addTuDong].Cells[4].Value = "***";
                                                this.DGVTinhCong.Rows[addTuDong].Cells[7].Value = "0";
                                                this.DGVTinhCong.Rows[addTuDong].Cells[8].Value = "0";
                                                this.DGVTinhCong.Rows[addTuDong].Cells[9].Value = "0";
                                                this.DGVTinhCong.Rows[addTuDong].Cells[10].Value = "0";
                                                this.DGVTinhCong.Rows[addTuDong].Cells[11].Value = "0";
                                                this.DGVTinhCong.Rows[addTuDong].Cells[12].Value = "0";
                                                this.DGVTinhCong.Rows[addTuDong].Cells[13].Value = "0";
                                                this.DGVTinhCong.Rows[addTuDong].Cells[14].Value = "0";
                                                this.DGVTinhCong.Rows[addTuDong].Cells[15].Value = "0";
                                                this.DGVTinhCong.Rows[addTuDong].Cells[16].Value = "0";
                                                this.DGVTinhCong.Rows[addTuDong].Cells[17].Value = "0";
                                                this.DGVTinhCong.Rows[addTuDong].Cells[18].Value = this.sKHVang;
                                                if (!(DateTimeProgress.XuatIDThu((int)dt.AddDays((double)dem).DayOfWeek) == "0"))
                                                {
                                                    this.DGVTinhCong.Rows[addTuDong].Cells[19].Value = "NT";
                                                }
                                                else
                                                {
                                                    this.DGVTinhCong.Rows[addTuDong].Cells[19].Value = "CN";
                                                }
                                                this.DGVTinhCong.Rows[addTuDong].Cells[20].Value = this.sMaChamCong;
                                                this.DGVTinhCong.Rows[addTuDong].Cells[21].Value = this.sPhongBanTinhCong;
                                                if (iKiemTraLanCham == dtTuDong.Rows.Count)
                                                {
                                                    dtNhanCaTuDongKhongQuaDem = new System.Data.DataTable();
                                                    this._chiTietLichTrinhChoCalamViecDTO.MaLichTrinhCaLamViec = sLTCCLVNhanVien;
                                                    this._chiTietLichTrinhChoCalamViecDTO.Thu = sThu;
                                                    dtNhanCaTuDongKhongQuaDem = this._chiTietLichTrinhChoCaLamViecBLL.ChiTietLichTrinhChoCaLamViecNhanCa(this._chiTietLichTrinhChoCalamViecDTO);
                                                    iChiTietLichTrinhChoCaLamViecTuDongKhongQuaDem = 0;
                                                    if (iChiTietLichTrinhChoCaLamViecTuDongKhongQuaDem < dtNhanCaTuDongKhongQuaDem.Rows.Count)
                                                    {
                                                        for (cellChiTietLichTrinhChoCaLamViecTuDongKhongQuaDem = 3; cellChiTietLichTrinhChoCaLamViecTuDongKhongQuaDem < 13; cellChiTietLichTrinhChoCaLamViecTuDongKhongQuaDem++)
                                                        {
                                                            kiemTraVao = 0;
                                                            kiemTraRa = 0;
                                                            this.sTuDongQuaDemMaCaLamViec = dtNhanCaTuDongKhongQuaDem.Rows[iChiTietLichTrinhChoCaLamViecTuDongKhongQuaDem][cellChiTietLichTrinhChoCaLamViecTuDongKhongQuaDem].ToString();
                                                            dtTuDongQuaDemCa = new System.Data.DataTable();
                                                            this._caLamViecDTO.MaCaLamViec = this.sTuDongQuaDemMaCaLamViec;
                                                            dtTuDongQuaDemCa = this._caLamViecBLL.CaLamViecGetByMaCaLamViec(this._caLamViecDTO);
                                                            iTuDongQuaDemCa = 0;
                                                            while (iTuDongQuaDemCa < dtTuDongQuaDemCa.Rows.Count)
                                                            {
                                                                this.sTuDongQuaDemTenCaLamViec = dtTuDongQuaDemCa.Rows[iTuDongQuaDemCa]["CaLamViec"].ToString();
                                                                dBatDauVaoA = Convert.ToDateTime(dtTuDongQuaDemCa.Rows[iTuDongQuaDemCa]["BatDauVao"].ToString());
                                                                sBatDauVaoA = string.Format("{0:T}", dBatDauVaoA);
                                                                sBatDauVaoB = string.Concat(sNgayCham, " ", sBatDauVaoA);
                                                                dBatDauVaoB = Convert.ToDateTime(sBatDauVaoB);
                                                                dKetThucVaoA = Convert.ToDateTime(dtTuDongQuaDemCa.Rows[iTuDongQuaDemCa]["KetThucVao"].ToString());
                                                                sKetThucVaoA = string.Format("{0:T}", dKetThucVaoA);
                                                                sKetThucVaoB = string.Concat(sNgayCham, " ", sKetThucVaoA);
                                                                dKetThucVaoB = Convert.ToDateTime(sKetThucVaoB);
                                                                dBatDauRaA = Convert.ToDateTime(dtTuDongQuaDemCa.Rows[iTuDongQuaDemCa]["BatDauRa"].ToString());
                                                                sBatDauRaA = string.Format("{0:T}", dBatDauRaA);
                                                                sBatDauRaB = string.Concat(sNgayCham, " ", sBatDauRaA);
                                                                dBatDauRaB = Convert.ToDateTime(sBatDauRaB);
                                                                dKetThucRaA = Convert.ToDateTime(dtTuDongQuaDemCa.Rows[iTuDongQuaDemCa]["KetThucRa"].ToString());
                                                                sKetThucRaA = string.Format("{0:T}", dKetThucRaA);
                                                                sKetThucRaB = string.Concat(sNgayCham, " ", sKetThucRaA);
                                                                dKetThucRaB = Convert.ToDateTime(sKetThucRaB);
                                                                if ((dGioVaoTuDong < dBatDauVaoB ? false : dGioVaoTuDong <= dKetThucVaoB))
                                                                {
                                                                    kiemTraVao++;
                                                                }
                                                                if ((dGioRaTuDong < dBatDauRaB ? false : dGioRaTuDong <= dKetThucRaB))
                                                                {
                                                                    kiemTraRa++;
                                                                }
                                                                if ((kiemTraVao != 1 ? true : kiemTraRa != 0))
                                                                {
                                                                    iTuDongQuaDemCa++;
                                                                }
                                                                else
                                                                {
                                                                    goto Label19;
                                                                }
                                                            }
                                                        }
                                                    Label19:
                                                        this.DGVTinhCong.Rows[addTuDong].Cells[4].Value = this.sTuDongQuaDemTenCaLamViec;
                                                        this.DGVTinhCong.Rows[addTuDong].Cells[7].Value = "0";
                                                        this.DGVTinhCong.Rows[addTuDong].Cells[8].Value = "0";
                                                        this.DGVTinhCong.Rows[addTuDong].Cells[9].Value = "0";
                                                        this.DGVTinhCong.Rows[addTuDong].Cells[10].Value = "0";
                                                        this.DGVTinhCong.Rows[addTuDong].Cells[11].Value = "0";
                                                        this.DGVTinhCong.Rows[addTuDong].Cells[12].Value = "0";
                                                        this.DGVTinhCong.Rows[addTuDong].Cells[13].Value = "0";
                                                        this.DGVTinhCong.Rows[addTuDong].Cells[14].Value = "0";
                                                        this.DGVTinhCong.Rows[addTuDong].Cells[15].Value = "0";
                                                        this.DGVTinhCong.Rows[addTuDong].Cells[16].Value = "0";
                                                        this.DGVTinhCong.Rows[addTuDong].Cells[17].Value = "0";
                                                        this.DGVTinhCong.Rows[addTuDong].Cells[18].Value = this.sKHVang;
                                                        if (!(DateTimeProgress.XuatIDThu((int)dt.AddDays((double)dem).DayOfWeek) == "0"))
                                                        {
                                                            this.DGVTinhCong.Rows[addTuDong].Cells[19].Value = "NT";
                                                        }
                                                        else
                                                        {
                                                            this.DGVTinhCong.Rows[addTuDong].Cells[19].Value = "CN";
                                                        }
                                                        this.DGVTinhCong.Rows[addTuDong].Cells[20].Value = this.sMaChamCong;
                                                        this.DGVTinhCong.Rows[addTuDong].Cells[21].Value = this.sPhongBanTinhCong;
                                                    }
                                                }
                                            }
                                        }
                                   // Label10:
                                    }
                                    if (iKiemTraDuLieuTuDong == 0)
                                    {
                                        this.DGVTinhCong.Rows[_nhanVien].Cells[7].Value = "0";
                                        this.DGVTinhCong.Rows[_nhanVien].Cells[8].Value = "0";
                                        this.DGVTinhCong.Rows[_nhanVien].Cells[16].Value = "0";
                                        this.DGVTinhCong.Rows[_nhanVien].Cells[17].Value = "0";
                                        this.DGVTinhCong.Rows[_nhanVien].Cells[18].Value = this.sKHVang;
                                        if (!(DateTimeProgress.XuatIDThu((int)dt.AddDays((double)dem).DayOfWeek) == "0"))
                                        {
                                            this.DGVTinhCong.Rows[_nhanVien].Cells[19].Value = "NT";
                                        }
                                        else
                                        {
                                            this.DGVTinhCong.Rows[_nhanVien].Cells[19].Value = "CN";
                                        }
                                        this.DGVTinhCong.Rows[_nhanVien].Cells[20].Value = this.sMaChamCong;
                                        this.DGVTinhCong.Rows[_nhanVien].Cells[21].Value = this.sPhongBanTinhCong;
                                    }
                                }
                                if (iChonLichTrinh == 3)
                                {
                                    iKiemTraLanChamTuDongKhongQuaDemLichTrinhVaoRa = 0;
                                    iKiemTraLanChamKhoangCachTuDongKhongQuaDemLichTrinhVaoRa = 0;
                                    dGioVaoTuDongKhongQuaDemLichTrinhVaoRa = new DateTime();
                                    dGioRaTuDongKhongQuaDemLichTrinhVaoRa = new DateTime();
                                    DateTime dGioVaoPhanTheoGio = new DateTime();
                                    DateTime dGioRaPhanTheoGio = new DateTime();
                                    DateTime dGioChamPhanTheoGio = new DateTime();
                                    DateTime dPhanTheoGioBatDauVao = new DateTime();
                                    DateTime dPhanTheoGioKetThucVao = new DateTime();
                                    DateTime dPhanTheoGioBatDauRa = new DateTime();
                                    DateTime dPhanTheoGioKetThucRa = new DateTime();
                                    int demPhanTheoGio = 0;
                                    iKiemTraLanCham = 0;
                                    int addPhanTheoGio = 0;
                                    dtPhanTheoGio = new System.Data.DataTable();
                                    this._checkInOutDTO.MaChamCong = Convert.ToInt32(this.sMaChamCong);
                                    this._checkInOutDTO.NgayCham = Convert.ToDateTime(this.DGVTinhCong.Rows[_nhanVien].Cells[2].Value.ToString());
                                    dtPhanTheoGio = this._checkInOutBLL.getCheckInOutByMaChamCongAndNgayCham(this._checkInOutDTO);
                                    for (iPhanTheoGio = 0; iPhanTheoGio < dtPhanTheoGio.Rows.Count; iPhanTheoGio++)
                                    {
                                        addGioNguonTuDongKhongQuaDem = this.DGVDuLieuChamCongNguon.Rows.Add();
                                        iKiemTraLanChamTuDongKhongQuaDemLichTrinhVaoRa++;
                                        if (iKiemTraLanChamTuDongKhongQuaDemLichTrinhVaoRa == 1)
                                        {
                                            dGioVaoTuDongKhongQuaDemLichTrinhVaoRa = Convert.ToDateTime(dtPhanTheoGio.Rows[iPhanTheoGio]["GioCham"].ToString());
                                            if ((dtPhanTheoGio.Rows.Count <= 2 ? true : iKiemTraLanChamKhoangCachTuDongKhongQuaDemLichTrinhVaoRa != 3))
                                            {
                                                this.DGVDuLieuChamCongNguon.Rows[addGioNguonTuDongKhongQuaDem].Cells[0].Value = this.sMaChamCong;
                                                this.DGVDuLieuChamCongNguon.Rows[addGioNguonTuDongKhongQuaDem].Cells[1].Value = string.Format("{0:d}", dGioVaoTuDongKhongQuaDemLichTrinhVaoRa);
                                                this.DGVDuLieuChamCongNguon.Rows[addGioNguonTuDongKhongQuaDem].Cells[2].Value = dGioVaoTuDongKhongQuaDemLichTrinhVaoRa;
                                                this.DGVDuLieuChamCongNguon.Rows[addGioNguonTuDongKhongQuaDem].Cells[3].Value = "Vào";
                                                this.DGVDuLieuChamCongNguon.Rows[addGioNguonTuDongKhongQuaDem].Cells[4].Value = "I";
                                                this.DGVDuLieuChamCongNguon.Rows[addGioNguonTuDongKhongQuaDem].Cells[6].Value = dtPhanTheoGio.Rows[iPhanTheoGio]["MaSoMay"].ToString();
                                            }
                                            else
                                            {
                                                if (Convert.ToInt32(Convert.ToInt32((dGioVaoTuDongKhongQuaDemLichTrinhVaoRa - dGioRaTuDongKhongQuaDemLichTrinhVaoRa).TotalMinutes).ToString()) < iKhoangCachGiuaHaiCapVaoRa)
                                                {
                                                    goto Label21;
                                                }
                                                this.DGVDuLieuChamCongNguon.Rows[addGioNguonTuDongKhongQuaDem].Cells[0].Value = this.sMaChamCong;
                                                this.DGVDuLieuChamCongNguon.Rows[addGioNguonTuDongKhongQuaDem].Cells[1].Value = string.Format("{0:d}", dGioVaoTuDongKhongQuaDemLichTrinhVaoRa);
                                                this.DGVDuLieuChamCongNguon.Rows[addGioNguonTuDongKhongQuaDem].Cells[2].Value = dGioVaoTuDongKhongQuaDemLichTrinhVaoRa;
                                                this.DGVDuLieuChamCongNguon.Rows[addGioNguonTuDongKhongQuaDem].Cells[3].Value = "Vào";
                                                this.DGVDuLieuChamCongNguon.Rows[addGioNguonTuDongKhongQuaDem].Cells[4].Value = "I";
                                                this.DGVDuLieuChamCongNguon.Rows[addGioNguonTuDongKhongQuaDem].Cells[6].Value = dtPhanTheoGio.Rows[iPhanTheoGio]["MaSoMay"].ToString();
                                                iKiemTraLanChamTuDongKhongQuaDemLichTrinhVaoRa = 1;
                                            }
                                        }
                                        if (iKiemTraLanChamTuDongKhongQuaDemLichTrinhVaoRa == 2)
                                        {
                                            dGioRaTuDongKhongQuaDemLichTrinhVaoRa = Convert.ToDateTime(dtPhanTheoGio.Rows[iPhanTheoGio]["GioCham"].ToString());
                                            if (Convert.ToInt32(Convert.ToInt32((dGioRaTuDongKhongQuaDemLichTrinhVaoRa - dGioVaoTuDongKhongQuaDemLichTrinhVaoRa).TotalMinutes).ToString()) < iThoiGianNhoNhat)
                                            {
                                                goto Label22;
                                            }
                                            iKiemTraLanChamTuDongKhongQuaDemLichTrinhVaoRa = 0;
                                            iKiemTraLanChamKhoangCachTuDongKhongQuaDemLichTrinhVaoRa = 3;
                                            this.DGVDuLieuChamCongNguon.Rows[addGioNguonTuDongKhongQuaDem].Cells[0].Value = this.sMaChamCong;
                                            this.DGVDuLieuChamCongNguon.Rows[addGioNguonTuDongKhongQuaDem].Cells[1].Value = string.Format("{0:d}", dGioRaTuDongKhongQuaDemLichTrinhVaoRa);
                                            this.DGVDuLieuChamCongNguon.Rows[addGioNguonTuDongKhongQuaDem].Cells[2].Value = dGioRaTuDongKhongQuaDemLichTrinhVaoRa;
                                            this.DGVDuLieuChamCongNguon.Rows[addGioNguonTuDongKhongQuaDem].Cells[3].Value = "Ra";
                                            this.DGVDuLieuChamCongNguon.Rows[addGioNguonTuDongKhongQuaDem].Cells[4].Value = "O";
                                            this.DGVDuLieuChamCongNguon.Rows[addGioNguonTuDongKhongQuaDem].Cells[6].Value = dtPhanTheoGio.Rows[iPhanTheoGio]["MaSoMay"].ToString();
                                        }
                                        string sPhanTheoGio = this.DGVTinhCong.Rows[_nhanVien].Cells[2].Value.ToString();
                                        dGioChamPhanTheoGio = Convert.ToDateTime(dtPhanTheoGio.Rows[iPhanTheoGio]["GioCham"].ToString());
                                        System.Data.DataTable dtChiTietPhanTheoGio = new System.Data.DataTable();
                                        this._phanTheoGioDTO.MaLichTrinhVaoRa = sLTVRNhanVien;
                                        dtChiTietPhanTheoGio = this._phanTheoGioBLL.PhanTheoGioGetMaLichTrinhVaoRa(this._phanTheoGioDTO);
                                        for (int iChiTietPhanTheoGio = 0; iChiTietPhanTheoGio < dtChiTietPhanTheoGio.Rows.Count; iChiTietPhanTheoGio++)
                                        {
                                            dPhanTheoGioBatDauVao = Convert.ToDateTime(dtChiTietPhanTheoGio.Rows[iChiTietPhanTheoGio]["BatDauVao"].ToString());
                                            string sPhanTheoGioBatDauVao = string.Format("{0:T}", dPhanTheoGioBatDauVao);
                                            string sBatDauVao = string.Concat(sPhanTheoGio, " ", sPhanTheoGioBatDauVao);
                                            DateTime dBatDauVao = Convert.ToDateTime(sBatDauVao);
                                            dPhanTheoGioKetThucVao = Convert.ToDateTime(dtChiTietPhanTheoGio.Rows[iChiTietPhanTheoGio]["KetThucVao"].ToString());
                                            string sPhanTheoGioKetThucVao = string.Format("{0:T}", dPhanTheoGioKetThucVao);
                                            string sKetThucVao = string.Concat(sPhanTheoGio, " ", sPhanTheoGioKetThucVao);
                                            DateTime dKetThucVao = Convert.ToDateTime(sKetThucVao);
                                            dPhanTheoGioBatDauRa = Convert.ToDateTime(dtChiTietPhanTheoGio.Rows[iChiTietPhanTheoGio]["BatDauRa"].ToString());
                                            string sPhanTheoGioBatDauRa = string.Format("{0:T}", dPhanTheoGioBatDauRa);
                                            string sBatDauRa = string.Concat(sPhanTheoGio, " ", sPhanTheoGioBatDauRa);
                                            DateTime dBatDauRa = Convert.ToDateTime(sBatDauRa);
                                            dPhanTheoGioKetThucRa = Convert.ToDateTime(dtChiTietPhanTheoGio.Rows[iChiTietPhanTheoGio]["KetThucRa"].ToString());
                                            string sPhanTheoGioKetThucRa = string.Format("{0:T}", dPhanTheoGioKetThucRa);
                                            string sKetThucRa = string.Concat(sPhanTheoGio, " ", sPhanTheoGioKetThucRa);
                                            DateTime dKetThucRa = Convert.ToDateTime(sKetThucRa);
                                            if ((dGioChamPhanTheoGio < dBatDauVao ? true : !(dGioChamPhanTheoGio <= dKetThucVao)))
                                            {
                                                if ((dGioChamPhanTheoGio < dBatDauRa ? false : dGioChamPhanTheoGio <= dKetThucRa))
                                                {
                                                    if (iKiemTraLanCham == 0)
                                                    {
                                                        dGioRaPhanTheoGio = dGioChamPhanTheoGio;
                                                        this.DGVTinhCong.Rows[_nhanVien].Cells[6].Value = string.Format(this.sDinhDangThoiGian, dGioRaPhanTheoGio);
                                                        this.DGVTinhCong.Rows[_nhanVien].Cells[0].Value = this.sMaNhanVien;
                                                        this.DGVTinhCong.Rows[_nhanVien].Cells[1].Value = this.sTenNhanVien;
                                                        this.DGVTinhCong.Rows[_nhanVien].Cells[2].Value = this.DGVTinhCong.Rows[_nhanVien].Cells[2].Value.ToString();
                                                        this.DGVTinhCong.Rows[_nhanVien].Cells[4].Value = "***";
                                                        this.DGVTinhCong.Rows[_nhanVien].Cells[7].Value = "0";
                                                        this.DGVTinhCong.Rows[_nhanVien].Cells[8].Value = "0";
                                                        this.DGVTinhCong.Rows[_nhanVien].Cells[9].Value = "0";
                                                        this.DGVTinhCong.Rows[_nhanVien].Cells[10].Value = "0";
                                                        this.DGVTinhCong.Rows[_nhanVien].Cells[11].Value = "0";
                                                        this.DGVTinhCong.Rows[_nhanVien].Cells[12].Value = "0";
                                                        this.DGVTinhCong.Rows[_nhanVien].Cells[13].Value = "0";
                                                        this.DGVTinhCong.Rows[_nhanVien].Cells[14].Value = "0";
                                                        this.DGVTinhCong.Rows[_nhanVien].Cells[15].Value = "0";
                                                        this.DGVTinhCong.Rows[_nhanVien].Cells[16].Value = "0";
                                                        this.DGVTinhCong.Rows[_nhanVien].Cells[17].Value = "0";
                                                        this.DGVTinhCong.Rows[_nhanVien].Cells[18].Value = this.sKHVang;
                                                        if (this.iNgonNgu == 0)
                                                        {
                                                            DataGridViewCell item7 = this.DGVTinhCong.Rows[_nhanVien].Cells[3];
                                                            dateTime = dt.AddDays((double)dem);
                                                            item7.Value = DateTimeProgress.XuatThuTinhCong((int)dateTime.DayOfWeek);
                                                        }
                                                        if (this.iNgonNgu == 1)
                                                        {
                                                            DataGridViewCell dataGridViewCell7 = this.DGVTinhCong.Rows[_nhanVien].Cells[3];
                                                            dateTime = dt.AddDays((double)dem);
                                                            dataGridViewCell7.Value = DateTimeProgress.XuatThuEnglish((int)dateTime.DayOfWeek);
                                                        }
                                                        iKiemTraLanCham = 3;
                                                        break;
                                                    }
                                                    else if (iKiemTraLanCham == 1)
                                                    {
                                                        dGioRaPhanTheoGio = dGioChamPhanTheoGio;
                                                        this.DGVTinhCong.Rows[_nhanVien].Cells[6].Value = string.Format(this.sDinhDangThoiGian, dGioRaPhanTheoGio);
                                                        iCaTrongLIchtrinh = 0;
                                                        dtNhanCaPhanTheoGio = new System.Data.DataTable();
                                                        this._chiTietLichTrinhChoCalamViecDTO.MaLichTrinhCaLamViec = sLTCCLVNhanVien;
                                                        this._chiTietLichTrinhChoCalamViecDTO.Thu = sThu;
                                                        dtNhanCaPhanTheoGio = this._chiTietLichTrinhChoCaLamViecBLL.ChiTietLichTrinhChoCaLamViecNhanCa(this._chiTietLichTrinhChoCalamViecDTO);
                                                        iChiTietLichTrinhChoCaLamViecPhanTheoGio = 0;
                                                        if (iChiTietLichTrinhChoCaLamViecPhanTheoGio < dtNhanCaPhanTheoGio.Rows.Count)
                                                        {
                                                            iCaTrongLIchtrinh = 1;
                                                            cellChiTietLichTrinhChoCaLamViecPhanTheoGio = 3;
                                                            while (cellChiTietLichTrinhChoCaLamViecPhanTheoGio < 13)
                                                            {
                                                                kiemTraVao = 0;
                                                                kiemTraRa = 0;
                                                                this.sPhanTheoGioMaCaLamViec = dtNhanCaPhanTheoGio.Rows[iChiTietLichTrinhChoCaLamViecPhanTheoGio][cellChiTietLichTrinhChoCaLamViecPhanTheoGio].ToString();
                                                                dtPhanTheoGioCa1 = new System.Data.DataTable();
                                                                this._caLamViecDTO.MaCaLamViec = this.sPhanTheoGioMaCaLamViec;
                                                                dtPhanTheoGioCa1 = this._caLamViecBLL.CaLamViecGetByMaCaLamViec(this._caLamViecDTO);
                                                                iPhanTheoGioCa1 = 0;
                                                                while (iPhanTheoGioCa1 < dtPhanTheoGioCa1.Rows.Count)
                                                                {
                                                                    second = dGioVaoPhanTheoGio.Second;
                                                                    sGiayGioVao = second.ToString();
                                                                    second = dGioRaPhanTheoGio.Second;
                                                                    sGiayGioRa = second.ToString();
                                                                    this.sPhanTheoGioTenCaLamViec = dtPhanTheoGioCa1.Rows[iPhanTheoGioCa1]["CaLamViec"].ToString();
                                                                    dBatDauVaoPhanTheoGioA = Convert.ToDateTime(dtPhanTheoGioCa1.Rows[iPhanTheoGioCa1]["BatDauVao"].ToString());
                                                                    sBatDauVaoPhanTheoGioA = string.Format("{0:T}", dBatDauVaoPhanTheoGioA).Replace("00 ", string.Concat(sGiayGioVao, " "));
                                                                    sBatDauVaoPhanTheoGioB = string.Concat(sNgayCham, " ", sBatDauVaoPhanTheoGioA);
                                                                    dBatDauVaoPhanTheoGioB = Convert.ToDateTime(sBatDauVaoPhanTheoGioB);
                                                                    dKetThucVaoPhanTheoGioA = Convert.ToDateTime(dtPhanTheoGioCa1.Rows[iPhanTheoGioCa1]["KetThucVao"].ToString());
                                                                    sKetThucVaoPhanTheoGioA = string.Format("{0:T}", dKetThucVaoPhanTheoGioA).Replace("00 ", string.Concat(sGiayGioVao, " "));
                                                                    sKetThucVaoPhanTheoGioB = string.Concat(sNgayCham, " ", sKetThucVaoPhanTheoGioA);
                                                                    dKetThucVaoPhanTheoGioB = Convert.ToDateTime(sKetThucVaoPhanTheoGioB);
                                                                    dBatDauRaPhanTheoGioA = Convert.ToDateTime(dtPhanTheoGioCa1.Rows[iPhanTheoGioCa1]["BatDauRa"].ToString());
                                                                    sBatDauRaPhanTheoGioA = string.Format("{0:T}", dBatDauRaPhanTheoGioA).Replace("00 ", string.Concat(sGiayGioRa, " "));
                                                                    sBatDauRaPhanTheoGioB = string.Concat(sNgayCham, " ", sBatDauRaPhanTheoGioA);
                                                                    dBatDauRaPhanTheoGioB = Convert.ToDateTime(sBatDauRaPhanTheoGioB);
                                                                    dKetThucRaPhanTheoGioA = Convert.ToDateTime(dtPhanTheoGioCa1.Rows[iPhanTheoGioCa1]["KetThucRa"].ToString());
                                                                    sKetThucRaPhanTheoGioA = string.Format("{0:T}", dKetThucRaPhanTheoGioA).Replace("00 ", string.Concat(sGiayGioRa, " "));
                                                                    sKetThucRaPhanTheoGioB = string.Concat(sNgayCham, " ", sKetThucRaPhanTheoGioA);
                                                                    dKetThucRaPhanTheoGioB = Convert.ToDateTime(sKetThucRaPhanTheoGioB);
                                                                    if ((dGioVaoPhanTheoGio < dBatDauVaoPhanTheoGioB ? false : dGioVaoPhanTheoGio <= dKetThucVaoPhanTheoGioB))
                                                                    {
                                                                        kiemTraVao++;
                                                                    }
                                                                    if ((dGioRaPhanTheoGio < dBatDauRaPhanTheoGioB ? false : dGioRaPhanTheoGio <= dKetThucRaPhanTheoGioB))
                                                                    {
                                                                        kiemTraRa++;
                                                                    }
                                                                    if ((kiemTraVao != 1 ? true : kiemTraRa != 1))
                                                                    {
                                                                        iPhanTheoGioCa1++;
                                                                    }
                                                                    else
                                                                    {
                                                                        goto Label26;
                                                                    }
                                                                }
                                                                if (!(this.sPhanTheoGioMaCaLamViec == ""))
                                                                {
                                                                    cellChiTietLichTrinhChoCaLamViecPhanTheoGio++;
                                                                }
                                                                else
                                                                {
                                                                    this.DGVTinhCong.Rows[_nhanVien].Cells[4].Value = "***";
                                                                    this.DGVTinhCong.Rows[_nhanVien].Cells[7].Value = "0";
                                                                    this.DGVTinhCong.Rows[_nhanVien].Cells[8].Value = "0";
                                                                    this.DGVTinhCong.Rows[_nhanVien].Cells[9].Value = "0";
                                                                    this.DGVTinhCong.Rows[_nhanVien].Cells[10].Value = "0";
                                                                    this.DGVTinhCong.Rows[_nhanVien].Cells[11].Value = "0";
                                                                    this.DGVTinhCong.Rows[_nhanVien].Cells[12].Value = "0";
                                                                    this.DGVTinhCong.Rows[_nhanVien].Cells[13].Value = "0";
                                                                    this.DGVTinhCong.Rows[_nhanVien].Cells[14].Value = "0";
                                                                    this.DGVTinhCong.Rows[_nhanVien].Cells[15].Value = "0";
                                                                    this.DGVTinhCong.Rows[_nhanVien].Cells[16].Value = "0";
                                                                    this.DGVTinhCong.Rows[_nhanVien].Cells[17].Value = "0";
                                                                    this.DGVTinhCong.Rows[_nhanVien].Cells[18].Value = this.sKHVang;
                                                                    if (!(DateTimeProgress.XuatIDThu((int)dt.AddDays((double)dem).DayOfWeek) == "0"))
                                                                    {
                                                                        this.DGVTinhCong.Rows[_nhanVien].Cells[19].Value = "NT";
                                                                    }
                                                                    else
                                                                    {
                                                                        this.DGVTinhCong.Rows[_nhanVien].Cells[19].Value = "CN";
                                                                    }
                                                                    this.DGVTinhCong.Rows[_nhanVien].Cells[20].Value = this.sMaChamCong;
                                                                    this.DGVTinhCong.Rows[_nhanVien].Cells[21].Value = this.sPhongBanTinhCong;
                                                                    goto Label25;
                                                                }
                                                            }
                                                        Label26:
                                                            this.DGVTinhCong.Rows[_nhanVien].Cells[4].Value = this.sPhanTheoGioTenCaLamViec;
                                                            dtCaLamViecPhanTheoGio = new System.Data.DataTable();
                                                            this._caLamViecDTO.MaCaLamViec = this.sPhanTheoGioMaCaLamViec;
                                                            dtCaLamViecPhanTheoGio = this._caLamViecBLL.CaLamViecGetByMaCaLamViec(this._caLamViecDTO);
                                                            for (iCaLamViecPhanTheoGio = 0; iCaLamViecPhanTheoGio < dtCaLamViecPhanTheoGio.Rows.Count; iCaLamViecPhanTheoGio++)
                                                            {
                                                                second = dGioVaoPhanTheoGio.Second;
                                                                sGiayGioVao = second.ToString();
                                                                second = dGioRaPhanTheoGio.Second;
                                                                sGiayGioRa = second.ToString();
                                                                dGioVaoKhaiBaoPhanTheoGioA = Convert.ToDateTime(dtCaLamViecPhanTheoGio.Rows[iCaLamViecPhanTheoGio]["GioVaoLamViec"].ToString());
                                                                sGioVaoKhaiBaoPhanTheoGioA = string.Format("{0:T}", dGioVaoKhaiBaoPhanTheoGioA).Replace("00 ", string.Concat(sGiayGioVao, " "));
                                                                sGioVaoKhaiBaoPhanTheoGioB = string.Concat(sNgayCham, " ", sGioVaoKhaiBaoPhanTheoGioA);
                                                                dGioVaoKhaiBaoPhanTheoGioB = Convert.ToDateTime(sGioVaoKhaiBaoPhanTheoGioB);
                                                                dGioRaKhaiBaoPhanTheoGioA = Convert.ToDateTime(dtCaLamViecPhanTheoGio.Rows[iCaLamViecPhanTheoGio]["GioKetThucLamViec"].ToString());
                                                                sGioRaKhaiBaoPhanTheoGioA = string.Format("{0:T}", dGioRaKhaiBaoPhanTheoGioA).Replace("00 ", string.Concat(sGiayGioRa, " "));
                                                                sGioRaKhaiBaoPhanTheoGioB = string.Concat(sNgayCham, " ", sGioRaKhaiBaoPhanTheoGioA);
                                                                dGioRaKhaiBaoPhanTheoGioB = Convert.ToDateTime(sGioRaKhaiBaoPhanTheoGioB);
                                                                sXemCaNayLaTangCa = dtCaLamViecPhanTheoGio.Rows[iCaLamViecPhanTheoGio]["XemCaNayLaTangCa"].ToString();
                                                                iTangCaMuc = Convert.ToInt32(dtCaLamViecPhanTheoGio.Rows[iCaLamViecPhanTheoGio]["TangCaMuc"].ToString());
                                                                sXemChuNhatLaTangCa = dtCaLamViecPhanTheoGio.Rows[iCaLamViecPhanTheoGio]["XemCuoiTuanLaTangCa"].ToString();
                                                                iTangCaChuNhatMuc = Convert.ToInt32(dtCaLamViecPhanTheoGio.Rows[iCaLamViecPhanTheoGio]["TangCaCuoiTuanMuc"].ToString());
                                                                if (sXemCaNayLaTangCa == "True")
                                                                {
                                                                    sTruGioDiTre = dtCaLamViecPhanTheoGio.Rows[iCaLamViecPhanTheoGio]["TruGioDiTre"].ToString();
                                                                    sBatDauTinhDiTre = dtCaLamViecPhanTheoGio.Rows[iCaLamViecPhanTheoGio]["BatDauTinhDiTre"].ToString();
                                                                    iChoPhepDiTre = Convert.ToInt32(dtCaLamViecPhanTheoGio.Rows[iCaLamViecPhanTheoGio]["ChoPhepDiTre"].ToString());
                                                                    value = dGioVaoPhanTheoGio - dGioVaoKhaiBaoPhanTheoGioB;
                                                                    second = Convert.ToInt32(value.TotalMinutes);
                                                                    sPhutTre = second.ToString();
                                                                    if (Convert.ToInt32(sPhutTre) < 0)
                                                                    {
                                                                        sPhutTre = "0";
                                                                    }
                                                                    sTruGioVeSom = dtCaLamViecPhanTheoGio.Rows[iCaLamViecPhanTheoGio]["TruGioVeSom"].ToString();
                                                                    sBatDauTinhVeSom = dtCaLamViecPhanTheoGio.Rows[iCaLamViecPhanTheoGio]["BatDauTinhVeSom"].ToString();
                                                                    iChoPhepVeSom = Convert.ToInt32(dtCaLamViecPhanTheoGio.Rows[iCaLamViecPhanTheoGio]["ChoPhepVeSom"].ToString());
                                                                    value = dGioRaKhaiBaoPhanTheoGioB - dGioRaPhanTheoGio;
                                                                    second = Convert.ToInt32(value.TotalMinutes);
                                                                    sPhutVeSom = second.ToString();
                                                                    if (Convert.ToInt32(sPhutVeSom) < 0)
                                                                    {
                                                                        sPhutVeSom = "0";
                                                                    }
                                                                    dTongPhutTangCaPhanTheoGio = Convert.ToDouble(dtCaLamViecPhanTheoGio.Rows[iCaLamViecPhanTheoGio]["TongGioTrongCaLamViec"]) * 60 - (Convert.ToDouble(sPhutTre) + Convert.ToDouble(sPhutVeSom));
                                                                    dTongGioTangCaPhanTheoGio = Math.Round(dTongPhutTangCaPhanTheoGio / 60, this.iLamTronGio);
                                                                    if (iTangCaMuc == 1)
                                                                    {
                                                                        this.DGVTinhCong.Rows[_nhanVien].Cells[12].Value = dTongGioTangCaPhanTheoGio * this.dTangCa1HeSo;
                                                                        this.DGVTinhCong.Rows[_nhanVien].Cells[18].Value = this.sKHDungGio;
                                                                    }
                                                                    if (iTangCaMuc == 2)
                                                                    {
                                                                        this.DGVTinhCong.Rows[_nhanVien].Cells[13].Value = dTongGioTangCaPhanTheoGio * this.dTangCa2HeSo;
                                                                        this.DGVTinhCong.Rows[_nhanVien].Cells[18].Value = this.sKHDungGio;
                                                                    }
                                                                    if (iTangCaMuc == 3)
                                                                    {
                                                                        this.DGVTinhCong.Rows[_nhanVien].Cells[14].Value = dTongGioTangCaPhanTheoGio * this.dTangCa3HeSo;
                                                                        this.DGVTinhCong.Rows[_nhanVien].Cells[18].Value = this.sKHDungGio;
                                                                    }
                                                                    if (iTangCaMuc == 4)
                                                                    {
                                                                        this.DGVTinhCong.Rows[_nhanVien].Cells[15].Value = dTongGioTangCaPhanTheoGio * this.dTangCa4HeSo;
                                                                        this.DGVTinhCong.Rows[_nhanVien].Cells[18].Value = this.sKHDungGio;
                                                                    }
                                                                }
                                                                else if (!(DateTimeProgress.XuatIDThu((int)dt.AddDays((double)dem).DayOfWeek) == "0"))
                                                                {
                                                                    sTruGioDiTre = dtCaLamViecPhanTheoGio.Rows[iCaLamViecPhanTheoGio]["TruGioDiTre"].ToString();
                                                                    sBatDauTinhDiTre = dtCaLamViecPhanTheoGio.Rows[iCaLamViecPhanTheoGio]["BatDauTinhDiTre"].ToString();
                                                                    iChoPhepDiTre = Convert.ToInt32(dtCaLamViecPhanTheoGio.Rows[iCaLamViecPhanTheoGio]["ChoPhepDiTre"].ToString());
                                                                    value = dGioVaoPhanTheoGio - dGioVaoKhaiBaoPhanTheoGioB;
                                                                    second = Convert.ToInt32(value.TotalMinutes);
                                                                    sPhutTre = second.ToString();
                                                                    if (!(sTruGioDiTre == "True"))
                                                                    {
                                                                        this.DGVTinhCong.Rows[_nhanVien].Cells[9].Value = "0";
                                                                    }
                                                                    else if (Convert.ToInt32(sPhutTre) >= 0)
                                                                    {
                                                                        iPhutTre = Convert.ToInt32(sPhutTre) - iChoPhepDiTre;
                                                                        if (sBatDauTinhDiTre == "True")
                                                                        {
                                                                            if (iPhutTre >= 1)
                                                                            {
                                                                                this.DGVTinhCong.Rows[_nhanVien].Cells[9].Value = iPhutTre.ToString();
                                                                            }
                                                                            else
                                                                            {
                                                                                this.DGVTinhCong.Rows[_nhanVien].Cells[9].Value = "0";
                                                                            }
                                                                        }
                                                                        else if (iPhutTre >= 1)
                                                                        {
                                                                            this.DGVTinhCong.Rows[_nhanVien].Cells[9].Value = sPhutTre;
                                                                        }
                                                                        else
                                                                        {
                                                                            this.DGVTinhCong.Rows[_nhanVien].Cells[9].Value = "0";
                                                                        }
                                                                    }
                                                                    else
                                                                    {
                                                                        this.DGVTinhCong.Rows[_nhanVien].Cells[9].Value = "0";
                                                                    }
                                                                    sTruGioVeSom = dtCaLamViecPhanTheoGio.Rows[iCaLamViecPhanTheoGio]["TruGioVeSom"].ToString();
                                                                    sBatDauTinhVeSom = dtCaLamViecPhanTheoGio.Rows[iCaLamViecPhanTheoGio]["BatDauTinhVeSom"].ToString();
                                                                    iChoPhepVeSom = Convert.ToInt32(dtCaLamViecPhanTheoGio.Rows[iCaLamViecPhanTheoGio]["ChoPhepVeSom"].ToString());
                                                                    value = dGioRaKhaiBaoPhanTheoGioB - dGioRaPhanTheoGio;
                                                                    second = Convert.ToInt32(value.TotalMinutes);
                                                                    sPhutVeSom = second.ToString();
                                                                    if (!(sTruGioVeSom == "True"))
                                                                    {
                                                                        this.DGVTinhCong.Rows[_nhanVien].Cells[10].Value = "0";
                                                                    }
                                                                    else if (Convert.ToInt32(sPhutVeSom) >= 0)
                                                                    {
                                                                        iPhutVeSom = Convert.ToInt32(sPhutVeSom) - iChoPhepVeSom;
                                                                        if (iPhutVeSom < 1)
                                                                        {
                                                                            this.DGVTinhCong.Rows[_nhanVien].Cells[10].Value = "0";
                                                                        }
                                                                        else if (!(sBatDauTinhVeSom == "True"))
                                                                        {
                                                                            this.DGVTinhCong.Rows[_nhanVien].Cells[10].Value = sPhutVeSom;
                                                                        }
                                                                        else
                                                                        {
                                                                            this.DGVTinhCong.Rows[_nhanVien].Cells[10].Value = iPhutVeSom.ToString();
                                                                        }
                                                                    }
                                                                    else
                                                                    {
                                                                        this.DGVTinhCong.Rows[_nhanVien].Cells[10].Value = "0";
                                                                    }
                                                                    value = dGioRaPhanTheoGio - dGioRaKhaiBaoPhanTheoGioB;
                                                                    second = Convert.ToInt32(value.TotalMinutes);
                                                                    sVeTre = second.ToString();
                                                                    if (Convert.ToInt32(sVeTre) <= 0)
                                                                    {
                                                                        this.DGVTinhCong.Rows[_nhanVien].Cells[11].Value = "0";
                                                                    }
                                                                    else
                                                                    {
                                                                        this.DGVTinhCong.Rows[_nhanVien].Cells[11].Value = sVeTre;
                                                                    }
                                                                    iPhut = Convert.ToSingle(dtCaLamViecPhanTheoGio.Rows[iCaLamViecPhanTheoGio]["TongGioTrongCaLamViec"]) * 60f - (float)(Convert.ToInt32(this.DGVTinhCong.Rows[_nhanVien].Cells[9].Value.ToString()) + Convert.ToInt32(this.DGVTinhCong.Rows[_nhanVien].Cells[10].Value));
                                                                    dGio = Math.Round(Convert.ToDouble(iPhut) / 60, this.iLamTronGio);
                                                                    this.DGVTinhCong.Rows[_nhanVien].Cells[8].Value = dGio.ToString();
                                                                    iGio = Convert.ToDouble(dtCaLamViecPhanTheoGio.Rows[iCaLamViecPhanTheoGio]["TongGioTrongCaLamViec"].ToString());
                                                                    dCongTinh = Convert.ToDouble(dtCaLamViecPhanTheoGio.Rows[iCaLamViecPhanTheoGio]["CongTinh"].ToString());
                                                                    dCong = Math.Round(dGio * dCongTinh / iGio, this.iLamTronCong);
                                                                    this.DGVTinhCong.Rows[_nhanVien].Cells[7].Value = dCong.ToString();
                                                                    sTangCaTruocGioLamViec = dtCaLamViecPhanTheoGio.Rows[iCaLamViecPhanTheoGio]["TangCaTruocGioLamViec"].ToString();
                                                                    sTangCaSauGioLamViec = dtCaLamViecPhanTheoGio.Rows[iCaLamViecPhanTheoGio]["TangCaSauGioLamViec"].ToString();
                                                                    if ((sTangCaTruocGioLamViec != "False" ? false : sTangCaSauGioLamViec == "False"))
                                                                    {
                                                                        this.DGVTinhCong.Rows[_nhanVien].Cells[12].Value = "0";
                                                                        this.DGVTinhCong.Rows[_nhanVien].Cells[13].Value = "0";
                                                                        this.DGVTinhCong.Rows[_nhanVien].Cells[14].Value = "0";
                                                                        this.DGVTinhCong.Rows[_nhanVien].Cells[15].Value = "0";
                                                                    }
                                                                    if (sXemCaNayLaTangCa == "True")
                                                                    {
                                                                        if (iTangCaMuc == 1)
                                                                        {
                                                                            this.DGVTinhCong.Rows[_nhanVien].Cells[7].Value = "0";
                                                                            this.DGVTinhCong.Rows[_nhanVien].Cells[8].Value = "0";
                                                                            this.DGVTinhCong.Rows[_nhanVien].Cells[12].Value = dGio.ToString();
                                                                            this.DGVTinhCong.Rows[_nhanVien].Cells[13].Value = "0";
                                                                            this.DGVTinhCong.Rows[_nhanVien].Cells[14].Value = "0";
                                                                            this.DGVTinhCong.Rows[_nhanVien].Cells[15].Value = "0";
                                                                        }
                                                                        if (iTangCaMuc == 2)
                                                                        {
                                                                            this.DGVTinhCong.Rows[_nhanVien].Cells[7].Value = "0";
                                                                            this.DGVTinhCong.Rows[_nhanVien].Cells[8].Value = "0";
                                                                            this.DGVTinhCong.Rows[_nhanVien].Cells[12].Value = "0";
                                                                            this.DGVTinhCong.Rows[_nhanVien].Cells[13].Value = dGio.ToString();
                                                                            this.DGVTinhCong.Rows[_nhanVien].Cells[14].Value = "0";
                                                                            this.DGVTinhCong.Rows[_nhanVien].Cells[15].Value = "0";
                                                                        }
                                                                        if (iTangCaMuc == 3)
                                                                        {
                                                                            this.DGVTinhCong.Rows[_nhanVien].Cells[7].Value = "0";
                                                                            this.DGVTinhCong.Rows[_nhanVien].Cells[8].Value = "0";
                                                                            this.DGVTinhCong.Rows[_nhanVien].Cells[12].Value = "0";
                                                                            this.DGVTinhCong.Rows[_nhanVien].Cells[13].Value = "0";
                                                                            this.DGVTinhCong.Rows[_nhanVien].Cells[14].Value = dGio.ToString();
                                                                            this.DGVTinhCong.Rows[_nhanVien].Cells[15].Value = "0";
                                                                        }
                                                                        if (iTangCaMuc == 4)
                                                                        {
                                                                            this.DGVTinhCong.Rows[_nhanVien].Cells[7].Value = "0";
                                                                            this.DGVTinhCong.Rows[_nhanVien].Cells[8].Value = "0";
                                                                            this.DGVTinhCong.Rows[_nhanVien].Cells[12].Value = "0";
                                                                            this.DGVTinhCong.Rows[_nhanVien].Cells[13].Value = "0";
                                                                            this.DGVTinhCong.Rows[_nhanVien].Cells[14].Value = "0";
                                                                            this.DGVTinhCong.Rows[_nhanVien].Cells[15].Value = dGio.ToString();
                                                                        }
                                                                    }
                                                                    sChoPhepTangCaTruocGioLamViecPhanTheoGio = dtCaLamViecPhanTheoGio.Rows[iCaLamViecPhanTheoGio]["TangCaTruocGioLamViec"].ToString();
                                                                    iPhutTangCaTruocGioLamViecPhanTheoGio = Convert.ToInt32(dtCaLamViecPhanTheoGio.Rows[iCaLamViecPhanTheoGio]["SoPhutTangCaTruocGioLamViec"].ToString());
                                                                    iPhutTangCaTruocGioLamViecDatDen = Convert.ToInt32(dtCaLamViecPhanTheoGio.Rows[iCaLamViecPhanTheoGio]["TangCaTruocGioLamViecDatDen"].ToString());
                                                                    iPhutTruTangCaTruoc = Convert.ToInt32(dtCaLamViecPhanTheoGio.Rows[iCaLamViecPhanTheoGio]["PhutTruTangCaTruoc"].ToString());
                                                                    sChoPhepTangCaSauGioLamViecPhanTheoGio = dtCaLamViecPhanTheoGio.Rows[iCaLamViecPhanTheoGio]["TangCaSauGioLamViec"].ToString();
                                                                    iPhutTangCaSauGioLamViecPhanTheoGio = Convert.ToInt32(dtCaLamViecPhanTheoGio.Rows[iCaLamViecPhanTheoGio]["SoPhutTangCaSauGioLamViec"].ToString());
                                                                    iPhutTangCaSauGioLamViecDatDen = Convert.ToInt32(dtCaLamViecPhanTheoGio.Rows[iCaLamViecPhanTheoGio]["TangCaSauGioLamViecDatDen"].ToString());
                                                                    iPhutTruTangCaSau = Convert.ToInt32(dtCaLamViecPhanTheoGio.Rows[iCaLamViecPhanTheoGio]["PhutTruTangCaSau"].ToString());
                                                                    iGioiHanTC1PhanTheoGio = Convert.ToInt32(dtCaLamViecPhanTheoGio.Rows[iCaLamViecPhanTheoGio]["GioiHanTangCa1"].ToString());
                                                                    iGioiHanTC2PhanTheoGio = Convert.ToInt32(dtCaLamViecPhanTheoGio.Rows[iCaLamViecPhanTheoGio]["GioiHanTangCa2"].ToString());
                                                                    iGioiHanTC3PhanTheoGio = Convert.ToInt32(dtCaLamViecPhanTheoGio.Rows[iCaLamViecPhanTheoGio]["GioiHanTangCa3"].ToString());
                                                                    iGioiHanTC4PhanTheoGio = Convert.ToInt32(dtCaLamViecPhanTheoGio.Rows[iCaLamViecPhanTheoGio]["GioiHanTangCa4"].ToString());
                                                                    iTongGioTangCaSauPhanTheoGio = 0;
                                                                    iTongGioTangCaTruocPhanTheoGio = 0;
                                                                    if ((sChoPhepTangCaTruocGioLamViecPhanTheoGio != "False" ? true : !(sChoPhepTangCaSauGioLamViecPhanTheoGio == "False")))
                                                                    {
                                                                        if (sChoPhepTangCaTruocGioLamViecPhanTheoGio == "True")
                                                                        {
                                                                            value = dGioVaoKhaiBaoPhanTheoGioB - dGioVaoPhanTheoGio;
                                                                            second = Convert.ToInt32(value.TotalMinutes);
                                                                            iThoiGianTruocGioLamPhanTheoGio = Convert.ToInt32(second.ToString());
                                                                            if (iThoiGianTruocGioLamPhanTheoGio > 0)
                                                                            {
                                                                                if (iThoiGianTruocGioLamPhanTheoGio > iPhutTangCaTruocGioLamViecPhanTheoGio)
                                                                                {
                                                                                    if (iThoiGianTruocGioLamPhanTheoGio > iPhutTangCaTruocGioLamViecDatDen)
                                                                                    {
                                                                                        iTongGioTangCaTruocPhanTheoGio = iThoiGianTruocGioLamPhanTheoGio - iPhutTruTangCaTruoc;
                                                                                    }
                                                                                }
                                                                            }
                                                                        }
                                                                        if (sChoPhepTangCaSauGioLamViecPhanTheoGio == "True")
                                                                        {
                                                                            value = dGioRaPhanTheoGio - dGioRaKhaiBaoPhanTheoGioB;
                                                                            second = Convert.ToInt32(value.TotalMinutes);
                                                                            iThoiGianSauGioLamViecPhanTheoGio = Convert.ToInt32(second.ToString());
                                                                            if (iThoiGianSauGioLamViecPhanTheoGio > 0)
                                                                            {
                                                                                if (iThoiGianSauGioLamViecPhanTheoGio > iPhutTangCaSauGioLamViecPhanTheoGio)
                                                                                {
                                                                                    if (iThoiGianSauGioLamViecPhanTheoGio > iPhutTangCaSauGioLamViecDatDen)
                                                                                    {
                                                                                        iTongGioTangCaSauPhanTheoGio = iThoiGianSauGioLamViecPhanTheoGio - iPhutTruTangCaSau;
                                                                                    }
                                                                                }
                                                                            }
                                                                        }
                                                                    }
                                                                    else
                                                                    {
                                                                        this.DGVTinhCong.Rows[_nhanVien].Cells[12].Value = "0";
                                                                        this.DGVTinhCong.Rows[_nhanVien].Cells[13].Value = "0";
                                                                        this.DGVTinhCong.Rows[_nhanVien].Cells[14].Value = "0";
                                                                        this.DGVTinhCong.Rows[_nhanVien].Cells[15].Value = "0";
                                                                    }
                                                                    dTongThoiGianTangCaPhanTheoGio = Convert.ToDouble(iTongGioTangCaTruocPhanTheoGio + iTongGioTangCaSauPhanTheoGio);
                                                                    if (dTongThoiGianTangCaPhanTheoGio <= 0)
                                                                    {
                                                                        this.DGVTinhCong.Rows[_nhanVien].Cells[12].Value = "0";
                                                                        this.DGVTinhCong.Rows[_nhanVien].Cells[13].Value = "0";
                                                                        this.DGVTinhCong.Rows[_nhanVien].Cells[14].Value = "0";
                                                                        this.DGVTinhCong.Rows[_nhanVien].Cells[15].Value = "0";
                                                                    }
                                                                    else
                                                                    {
                                                                        if (iGioiHanTC1PhanTheoGio == 0)
                                                                        {
                                                                            this.DGVTinhCong.Rows[_nhanVien].Cells[12].Value = Math.Round(dTongThoiGianTangCaPhanTheoGio * this.dTangCa1HeSo / 60, this.iLamTronGio);
                                                                            this.DGVTinhCong.Rows[_nhanVien].Cells[13].Value = "0";
                                                                            this.DGVTinhCong.Rows[_nhanVien].Cells[14].Value = "0";
                                                                            this.DGVTinhCong.Rows[_nhanVien].Cells[15].Value = "0";
                                                                        }
                                                                        if ((iGioiHanTC1PhanTheoGio == 0 ? false : iGioiHanTC2PhanTheoGio == 0))
                                                                        {
                                                                            if (dTongThoiGianTangCaPhanTheoGio >= Convert.ToDouble(iGioiHanTC1PhanTheoGio))
                                                                            {
                                                                                this.DGVTinhCong.Rows[_nhanVien].Cells[12].Value = Math.Round(Convert.ToDouble(iGioiHanTC1PhanTheoGio) / 60 * this.dTangCa1HeSo, this.iLamTronGio);
                                                                                if (dTongThoiGianTangCaPhanTheoGio - Convert.ToDouble(iGioiHanTC1PhanTheoGio) > 0)
                                                                                {
                                                                                    this.DGVTinhCong.Rows[_nhanVien].Cells[13].Value = Math.Round((dTongThoiGianTangCaPhanTheoGio - Convert.ToDouble(iGioiHanTC1PhanTheoGio)) * this.dTangCa2HeSo / 60, this.iLamTronGio);
                                                                                }
                                                                                this.DGVTinhCong.Rows[_nhanVien].Cells[14].Value = "0";
                                                                                this.DGVTinhCong.Rows[_nhanVien].Cells[15].Value = "0";
                                                                            }
                                                                            else
                                                                            {
                                                                                this.DGVTinhCong.Rows[_nhanVien].Cells[12].Value = Math.Round(dTongThoiGianTangCaPhanTheoGio * this.dTangCa1HeSo / 60, this.iLamTronGio);
                                                                                this.DGVTinhCong.Rows[_nhanVien].Cells[13].Value = "0";
                                                                                this.DGVTinhCong.Rows[_nhanVien].Cells[14].Value = "0";
                                                                                this.DGVTinhCong.Rows[_nhanVien].Cells[15].Value = "0";
                                                                            }
                                                                        }
                                                                        if ((iGioiHanTC1PhanTheoGio == 0 || iGioiHanTC2PhanTheoGio == 0 ? false : iGioiHanTC3PhanTheoGio == 0))
                                                                        {
                                                                            if (dTongThoiGianTangCaPhanTheoGio >= Convert.ToDouble(iGioiHanTC1PhanTheoGio))
                                                                            {
                                                                                this.DGVTinhCong.Rows[_nhanVien].Cells[12].Value = Math.Round(Convert.ToDouble(iGioiHanTC1PhanTheoGio) * this.dTangCa1HeSo / 60, this.iLamTronGio);
                                                                                if (dTongThoiGianTangCaPhanTheoGio - Convert.ToDouble(iGioiHanTC1PhanTheoGio) >= Convert.ToDouble(iGioiHanTC2PhanTheoGio))
                                                                                {
                                                                                    this.DGVTinhCong.Rows[_nhanVien].Cells[12].Value = Math.Round(Convert.ToDouble(iGioiHanTC1PhanTheoGio) * this.dTangCa1HeSo / 60, this.iLamTronGio);
                                                                                    this.DGVTinhCong.Rows[_nhanVien].Cells[13].Value = Math.Round(Convert.ToDouble(iGioiHanTC2PhanTheoGio) * this.dTangCa2HeSo / 60, this.iLamTronGio);
                                                                                    this.DGVTinhCong.Rows[_nhanVien].Cells[14].Value = Math.Round((dTongThoiGianTangCaPhanTheoGio - Convert.ToDouble(iGioiHanTC1PhanTheoGio) - Convert.ToDouble(iGioiHanTC2PhanTheoGio)) * this.dTangCa3HeSo / 60, this.iLamTronGio);
                                                                                    this.DGVTinhCong.Rows[_nhanVien].Cells[15].Value = "0";
                                                                                }
                                                                                else
                                                                                {
                                                                                    this.DGVTinhCong.Rows[_nhanVien].Cells[13].Value = Math.Round((dTongThoiGianTangCaPhanTheoGio - Convert.ToDouble(iGioiHanTC1PhanTheoGio)) * this.dTangCa2HeSo / 60, this.iLamTronGio);
                                                                                    this.DGVTinhCong.Rows[_nhanVien].Cells[14].Value = "0";
                                                                                    this.DGVTinhCong.Rows[_nhanVien].Cells[15].Value = "0";
                                                                                }
                                                                            }
                                                                            else
                                                                            {
                                                                                this.DGVTinhCong.Rows[_nhanVien].Cells[12].Value = Math.Round(dTongThoiGianTangCaPhanTheoGio * this.dTangCa1HeSo / 60, this.iLamTronGio);
                                                                                this.DGVTinhCong.Rows[_nhanVien].Cells[13].Value = "0";
                                                                                this.DGVTinhCong.Rows[_nhanVien].Cells[14].Value = "0";
                                                                                this.DGVTinhCong.Rows[_nhanVien].Cells[15].Value = "0";
                                                                            }
                                                                        }
                                                                        if ((iGioiHanTC1PhanTheoGio == 0 || iGioiHanTC2PhanTheoGio == 0 || iGioiHanTC3PhanTheoGio == 0 ? false : iGioiHanTC4PhanTheoGio == 0))
                                                                        {
                                                                        }
                                                                    }
                                                                    value = dGioRaPhanTheoGio - dGioVaoPhanTheoGio;
                                                                    second = Convert.ToInt32(value.TotalMinutes);
                                                                    num = Math.Round(Convert.ToDouble(second.ToString()) / 60, this.iLamTronGio);
                                                                    sTongGio = num.ToString();
                                                                    this.DGVTinhCong.Rows[_nhanVien].Cells[16].Value = sTongGio;
                                                                    this.DGVTinhCong.Rows[_nhanVien].Cells[17].Value = dtCaLamViecPhanTheoGio.Rows[iCaLamViecPhanTheoGio]["CongTinh"].ToString();
                                                                    this.DGVTinhCong.Rows[_nhanVien].Cells[18].Value = this.sKHDungGio;
                                                                }
                                                                else if (!(sXemChuNhatLaTangCa == "True"))
                                                                {
                                                                    sTruGioDiTre = dtCaLamViecPhanTheoGio.Rows[iCaLamViecPhanTheoGio]["TruGioDiTre"].ToString();
                                                                    sBatDauTinhDiTre = dtCaLamViecPhanTheoGio.Rows[iCaLamViecPhanTheoGio]["BatDauTinhDiTre"].ToString();
                                                                    iChoPhepDiTre = Convert.ToInt32(dtCaLamViecPhanTheoGio.Rows[iCaLamViecPhanTheoGio]["ChoPhepDiTre"].ToString());
                                                                    value = dGioVaoPhanTheoGio - dGioVaoKhaiBaoPhanTheoGioB;
                                                                    second = Convert.ToInt32(value.TotalMinutes);
                                                                    sPhutTre = second.ToString();
                                                                    if (!(sTruGioDiTre == "True"))
                                                                    {
                                                                        this.DGVTinhCong.Rows[_nhanVien].Cells[9].Value = "0";
                                                                    }
                                                                    else if (Convert.ToInt32(sPhutTre) >= 0)
                                                                    {
                                                                        iPhutTre = Convert.ToInt32(sPhutTre) - iChoPhepDiTre;
                                                                        if (sBatDauTinhDiTre == "True")
                                                                        {
                                                                            if (iPhutTre >= 1)
                                                                            {
                                                                                this.DGVTinhCong.Rows[_nhanVien].Cells[9].Value = iPhutTre.ToString();
                                                                            }
                                                                            else
                                                                            {
                                                                                this.DGVTinhCong.Rows[_nhanVien].Cells[9].Value = "0";
                                                                            }
                                                                        }
                                                                        else if (iPhutTre >= 1)
                                                                        {
                                                                            this.DGVTinhCong.Rows[_nhanVien].Cells[9].Value = sPhutTre;
                                                                        }
                                                                        else
                                                                        {
                                                                            this.DGVTinhCong.Rows[_nhanVien].Cells[9].Value = "0";
                                                                        }
                                                                    }
                                                                    else
                                                                    {
                                                                        this.DGVTinhCong.Rows[_nhanVien].Cells[9].Value = "0";
                                                                    }
                                                                    sTruGioVeSom = dtCaLamViecPhanTheoGio.Rows[iCaLamViecPhanTheoGio]["TruGioVeSom"].ToString();
                                                                    sBatDauTinhVeSom = dtCaLamViecPhanTheoGio.Rows[iCaLamViecPhanTheoGio]["BatDauTinhVeSom"].ToString();
                                                                    iChoPhepVeSom = Convert.ToInt32(dtCaLamViecPhanTheoGio.Rows[iCaLamViecPhanTheoGio]["ChoPhepVeSom"].ToString());
                                                                    value = dGioRaKhaiBaoPhanTheoGioB - dGioRaPhanTheoGio;
                                                                    second = Convert.ToInt32(value.TotalMinutes);
                                                                    sPhutVeSom = second.ToString();
                                                                    if (!(sTruGioVeSom == "True"))
                                                                    {
                                                                        this.DGVTinhCong.Rows[_nhanVien].Cells[10].Value = "0";
                                                                    }
                                                                    else if (Convert.ToInt32(sPhutVeSom) >= 0)
                                                                    {
                                                                        iPhutVeSom = Convert.ToInt32(sPhutVeSom) - iChoPhepVeSom;
                                                                        if (iPhutVeSom < 1)
                                                                        {
                                                                            this.DGVTinhCong.Rows[_nhanVien].Cells[10].Value = "0";
                                                                        }
                                                                        else if (!(sBatDauTinhVeSom == "True"))
                                                                        {
                                                                            this.DGVTinhCong.Rows[_nhanVien].Cells[10].Value = sPhutVeSom;
                                                                        }
                                                                        else
                                                                        {
                                                                            this.DGVTinhCong.Rows[_nhanVien].Cells[10].Value = iPhutVeSom.ToString();
                                                                        }
                                                                    }
                                                                    else
                                                                    {
                                                                        this.DGVTinhCong.Rows[_nhanVien].Cells[10].Value = "0";
                                                                    }
                                                                    value = dGioRaPhanTheoGio - dGioRaKhaiBaoPhanTheoGioB;
                                                                    second = Convert.ToInt32(value.TotalMinutes);
                                                                    sVeTre = second.ToString();
                                                                    if (Convert.ToInt32(sVeTre) <= 0)
                                                                    {
                                                                        this.DGVTinhCong.Rows[_nhanVien].Cells[11].Value = "0";
                                                                    }
                                                                    else
                                                                    {
                                                                        this.DGVTinhCong.Rows[_nhanVien].Cells[11].Value = sVeTre;
                                                                    }
                                                                    iPhut = Convert.ToSingle(dtCaLamViecPhanTheoGio.Rows[iCaLamViecPhanTheoGio]["TongGioTrongCaLamViec"]) * 60f - (float)(Convert.ToInt32(this.DGVTinhCong.Rows[_nhanVien].Cells[9].Value.ToString()) + Convert.ToInt32(this.DGVTinhCong.Rows[_nhanVien].Cells[10].Value));
                                                                    dGio = Math.Round(Convert.ToDouble(iPhut) / 60, this.iLamTronGio);
                                                                    this.DGVTinhCong.Rows[_nhanVien].Cells[8].Value = dGio * this.dTangCaChuNhatHeSo;
                                                                    iGio = Convert.ToDouble(dtCaLamViecPhanTheoGio.Rows[iCaLamViecPhanTheoGio]["TongGioTrongCaLamViec"].ToString());
                                                                    dCongTinh = Convert.ToDouble(dtCaLamViecPhanTheoGio.Rows[iCaLamViecPhanTheoGio]["CongTinh"].ToString());
                                                                    dCong = Math.Round(dGio * dCongTinh / iGio, this.iLamTronCong);
                                                                    this.DGVTinhCong.Rows[_nhanVien].Cells[7].Value = dCong * this.dTangCaChuNhatHeSo;
                                                                    sTangCaTruocGioLamViec = dtCaLamViecPhanTheoGio.Rows[iCaLamViecPhanTheoGio]["TangCaTruocGioLamViec"].ToString();
                                                                    sTangCaSauGioLamViec = dtCaLamViecPhanTheoGio.Rows[iCaLamViecPhanTheoGio]["TangCaSauGioLamViec"].ToString();
                                                                    if ((sTangCaTruocGioLamViec != "False" ? false : sTangCaSauGioLamViec == "False"))
                                                                    {
                                                                        this.DGVTinhCong.Rows[_nhanVien].Cells[12].Value = "0";
                                                                        this.DGVTinhCong.Rows[_nhanVien].Cells[13].Value = "0";
                                                                        this.DGVTinhCong.Rows[_nhanVien].Cells[14].Value = "0";
                                                                        this.DGVTinhCong.Rows[_nhanVien].Cells[15].Value = "0";
                                                                    }
                                                                    if (sXemCaNayLaTangCa == "True")
                                                                    {
                                                                        if (iTangCaMuc == 1)
                                                                        {
                                                                            this.DGVTinhCong.Rows[_nhanVien].Cells[7].Value = "0";
                                                                            this.DGVTinhCong.Rows[_nhanVien].Cells[8].Value = "0";
                                                                            this.DGVTinhCong.Rows[_nhanVien].Cells[12].Value = dGio.ToString();
                                                                            this.DGVTinhCong.Rows[_nhanVien].Cells[13].Value = "0";
                                                                            this.DGVTinhCong.Rows[_nhanVien].Cells[14].Value = "0";
                                                                            this.DGVTinhCong.Rows[_nhanVien].Cells[15].Value = "0";
                                                                        }
                                                                        if (iTangCaMuc == 2)
                                                                        {
                                                                            this.DGVTinhCong.Rows[_nhanVien].Cells[7].Value = "0";
                                                                            this.DGVTinhCong.Rows[_nhanVien].Cells[8].Value = "0";
                                                                            this.DGVTinhCong.Rows[_nhanVien].Cells[12].Value = "0";
                                                                            this.DGVTinhCong.Rows[_nhanVien].Cells[13].Value = dGio.ToString();
                                                                            this.DGVTinhCong.Rows[_nhanVien].Cells[14].Value = "0";
                                                                            this.DGVTinhCong.Rows[_nhanVien].Cells[15].Value = "0";
                                                                        }
                                                                        if (iTangCaMuc == 3)
                                                                        {
                                                                            this.DGVTinhCong.Rows[_nhanVien].Cells[7].Value = "0";
                                                                            this.DGVTinhCong.Rows[_nhanVien].Cells[8].Value = "0";
                                                                            this.DGVTinhCong.Rows[_nhanVien].Cells[12].Value = "0";
                                                                            this.DGVTinhCong.Rows[_nhanVien].Cells[13].Value = "0";
                                                                            this.DGVTinhCong.Rows[_nhanVien].Cells[14].Value = dGio.ToString();
                                                                            this.DGVTinhCong.Rows[_nhanVien].Cells[15].Value = "0";
                                                                        }
                                                                        if (iTangCaMuc == 4)
                                                                        {
                                                                            this.DGVTinhCong.Rows[_nhanVien].Cells[7].Value = "0";
                                                                            this.DGVTinhCong.Rows[_nhanVien].Cells[8].Value = "0";
                                                                            this.DGVTinhCong.Rows[_nhanVien].Cells[12].Value = "0";
                                                                            this.DGVTinhCong.Rows[_nhanVien].Cells[13].Value = "0";
                                                                            this.DGVTinhCong.Rows[_nhanVien].Cells[14].Value = "0";
                                                                            this.DGVTinhCong.Rows[_nhanVien].Cells[15].Value = dGio.ToString();
                                                                        }
                                                                    }
                                                                    sChoPhepTangCaTruocGioLamViecPhanTheoGio = dtCaLamViecPhanTheoGio.Rows[iCaLamViecPhanTheoGio]["TangCaTruocGioLamViec"].ToString();
                                                                    iPhutTangCaTruocGioLamViecPhanTheoGio = Convert.ToInt32(dtCaLamViecPhanTheoGio.Rows[iCaLamViecPhanTheoGio]["SoPhutTangCaTruocGioLamViec"].ToString());
                                                                    iPhutTangCaTruocGioLamViecDatDen = Convert.ToInt32(dtCaLamViecPhanTheoGio.Rows[iCaLamViecPhanTheoGio]["TangCaTruocGioLamViecDatDen"].ToString());
                                                                    iPhutTruTangCaTruoc = Convert.ToInt32(dtCaLamViecPhanTheoGio.Rows[iCaLamViecPhanTheoGio]["PhutTruTangCaTruoc"].ToString());
                                                                    sChoPhepTangCaSauGioLamViecPhanTheoGio = dtCaLamViecPhanTheoGio.Rows[iCaLamViecPhanTheoGio]["TangCaSauGioLamViec"].ToString();
                                                                    iPhutTangCaSauGioLamViecPhanTheoGio = Convert.ToInt32(dtCaLamViecPhanTheoGio.Rows[iCaLamViecPhanTheoGio]["SoPhutTangCaSauGioLamViec"].ToString());
                                                                    iPhutTangCaSauGioLamViecDatDen = Convert.ToInt32(dtCaLamViecPhanTheoGio.Rows[iCaLamViecPhanTheoGio]["TangCaSauGioLamViecDatDen"].ToString());
                                                                    iPhutTruTangCaSau = Convert.ToInt32(dtCaLamViecPhanTheoGio.Rows[iCaLamViecPhanTheoGio]["PhutTruTangCaSau"].ToString());
                                                                    iGioiHanTC1PhanTheoGio = Convert.ToInt32(dtCaLamViecPhanTheoGio.Rows[iCaLamViecPhanTheoGio]["GioiHanTangCa1"].ToString());
                                                                    iGioiHanTC2PhanTheoGio = Convert.ToInt32(dtCaLamViecPhanTheoGio.Rows[iCaLamViecPhanTheoGio]["GioiHanTangCa2"].ToString());
                                                                    iGioiHanTC3PhanTheoGio = Convert.ToInt32(dtCaLamViecPhanTheoGio.Rows[iCaLamViecPhanTheoGio]["GioiHanTangCa3"].ToString());
                                                                    iGioiHanTC4PhanTheoGio = Convert.ToInt32(dtCaLamViecPhanTheoGio.Rows[iCaLamViecPhanTheoGio]["GioiHanTangCa4"].ToString());
                                                                    iTongGioTangCaSauPhanTheoGio = 0;
                                                                    iTongGioTangCaTruocPhanTheoGio = 0;
                                                                    if ((sChoPhepTangCaTruocGioLamViecPhanTheoGio != "False" ? true : !(sChoPhepTangCaSauGioLamViecPhanTheoGio == "False")))
                                                                    {
                                                                        if (sChoPhepTangCaTruocGioLamViecPhanTheoGio == "True")
                                                                        {
                                                                            value = dGioVaoKhaiBaoPhanTheoGioB - dGioVaoPhanTheoGio;
                                                                            second = Convert.ToInt32(value.TotalMinutes);
                                                                            iThoiGianTruocGioLamPhanTheoGio = Convert.ToInt32(second.ToString());
                                                                            if (iThoiGianTruocGioLamPhanTheoGio > 0)
                                                                            {
                                                                                if (iThoiGianTruocGioLamPhanTheoGio > iPhutTangCaTruocGioLamViecPhanTheoGio)
                                                                                {
                                                                                    if (iThoiGianTruocGioLamPhanTheoGio > iPhutTangCaTruocGioLamViecDatDen)
                                                                                    {
                                                                                        iTongGioTangCaTruocPhanTheoGio = iThoiGianTruocGioLamPhanTheoGio - iPhutTruTangCaTruoc;
                                                                                    }
                                                                                }
                                                                            }
                                                                        }
                                                                        if (sChoPhepTangCaSauGioLamViecPhanTheoGio == "True")
                                                                        {
                                                                            value = dGioRaPhanTheoGio - dGioRaKhaiBaoPhanTheoGioB;
                                                                            second = Convert.ToInt32(value.TotalMinutes);
                                                                            iThoiGianSauGioLamViecPhanTheoGio = Convert.ToInt32(second.ToString());
                                                                            if (iThoiGianSauGioLamViecPhanTheoGio > 0)
                                                                            {
                                                                                if (iThoiGianSauGioLamViecPhanTheoGio > iPhutTangCaSauGioLamViecPhanTheoGio)
                                                                                {
                                                                                    if (iThoiGianSauGioLamViecPhanTheoGio > iPhutTangCaSauGioLamViecDatDen)
                                                                                    {
                                                                                        iTongGioTangCaSauPhanTheoGio = iThoiGianSauGioLamViecPhanTheoGio - iPhutTruTangCaSau;
                                                                                    }
                                                                                }
                                                                            }
                                                                        }
                                                                    }
                                                                    else
                                                                    {
                                                                        this.DGVTinhCong.Rows[_nhanVien].Cells[12].Value = "0";
                                                                        this.DGVTinhCong.Rows[_nhanVien].Cells[13].Value = "0";
                                                                        this.DGVTinhCong.Rows[_nhanVien].Cells[14].Value = "0";
                                                                        this.DGVTinhCong.Rows[_nhanVien].Cells[15].Value = "0";
                                                                    }
                                                                    dTongThoiGianTangCaPhanTheoGio = Convert.ToDouble(iTongGioTangCaTruocPhanTheoGio + iTongGioTangCaSauPhanTheoGio);
                                                                    if (dTongThoiGianTangCaPhanTheoGio <= 0)
                                                                    {
                                                                        this.DGVTinhCong.Rows[_nhanVien].Cells[12].Value = "0";
                                                                        this.DGVTinhCong.Rows[_nhanVien].Cells[13].Value = "0";
                                                                        this.DGVTinhCong.Rows[_nhanVien].Cells[14].Value = "0";
                                                                        this.DGVTinhCong.Rows[_nhanVien].Cells[15].Value = "0";
                                                                    }
                                                                    else
                                                                    {
                                                                        if (iGioiHanTC1PhanTheoGio == 0)
                                                                        {
                                                                            this.DGVTinhCong.Rows[_nhanVien].Cells[12].Value = Math.Round(dTongThoiGianTangCaPhanTheoGio * this.dTangCa1HeSo / 60, this.iLamTronGio);
                                                                            this.DGVTinhCong.Rows[_nhanVien].Cells[13].Value = "0";
                                                                            this.DGVTinhCong.Rows[_nhanVien].Cells[14].Value = "0";
                                                                            this.DGVTinhCong.Rows[_nhanVien].Cells[15].Value = "0";
                                                                        }
                                                                        if ((iGioiHanTC1PhanTheoGio == 0 ? false : iGioiHanTC2PhanTheoGio == 0))
                                                                        {
                                                                            if (dTongThoiGianTangCaPhanTheoGio >= Convert.ToDouble(iGioiHanTC1PhanTheoGio))
                                                                            {
                                                                                this.DGVTinhCong.Rows[_nhanVien].Cells[12].Value = Math.Round(Convert.ToDouble(iGioiHanTC1PhanTheoGio) / 60 * this.dTangCa1HeSo, this.iLamTronGio);
                                                                                if (dTongThoiGianTangCaPhanTheoGio - Convert.ToDouble(iGioiHanTC1PhanTheoGio) > 0)
                                                                                {
                                                                                    this.DGVTinhCong.Rows[_nhanVien].Cells[13].Value = Math.Round((dTongThoiGianTangCaPhanTheoGio - Convert.ToDouble(iGioiHanTC1PhanTheoGio)) * this.dTangCa2HeSo / 60, this.iLamTronGio);
                                                                                }
                                                                                this.DGVTinhCong.Rows[_nhanVien].Cells[14].Value = "0";
                                                                                this.DGVTinhCong.Rows[_nhanVien].Cells[15].Value = "0";
                                                                            }
                                                                            else
                                                                            {
                                                                                this.DGVTinhCong.Rows[_nhanVien].Cells[12].Value = Math.Round(dTongThoiGianTangCaPhanTheoGio * this.dTangCa1HeSo / 60, this.iLamTronGio);
                                                                                this.DGVTinhCong.Rows[_nhanVien].Cells[13].Value = "0";
                                                                                this.DGVTinhCong.Rows[_nhanVien].Cells[14].Value = "0";
                                                                                this.DGVTinhCong.Rows[_nhanVien].Cells[15].Value = "0";
                                                                            }
                                                                        }
                                                                        if ((iGioiHanTC1PhanTheoGio == 0 || iGioiHanTC2PhanTheoGio == 0 ? false : iGioiHanTC3PhanTheoGio == 0))
                                                                        {
                                                                            if (dTongThoiGianTangCaPhanTheoGio >= Convert.ToDouble(iGioiHanTC1PhanTheoGio))
                                                                            {
                                                                                this.DGVTinhCong.Rows[_nhanVien].Cells[12].Value = Math.Round(Convert.ToDouble(iGioiHanTC1PhanTheoGio) * this.dTangCa1HeSo / 60, this.iLamTronGio);
                                                                                if (dTongThoiGianTangCaPhanTheoGio - Convert.ToDouble(iGioiHanTC1PhanTheoGio) >= Convert.ToDouble(iGioiHanTC2PhanTheoGio))
                                                                                {
                                                                                    this.DGVTinhCong.Rows[_nhanVien].Cells[12].Value = Math.Round(Convert.ToDouble(iGioiHanTC1PhanTheoGio) * this.dTangCa1HeSo / 60, this.iLamTronGio);
                                                                                    this.DGVTinhCong.Rows[_nhanVien].Cells[13].Value = Math.Round(Convert.ToDouble(iGioiHanTC2PhanTheoGio) * this.dTangCa2HeSo / 60, this.iLamTronGio);
                                                                                    this.DGVTinhCong.Rows[_nhanVien].Cells[14].Value = Math.Round((dTongThoiGianTangCaPhanTheoGio - Convert.ToDouble(iGioiHanTC1PhanTheoGio) - Convert.ToDouble(iGioiHanTC2PhanTheoGio)) * this.dTangCa3HeSo / 60, this.iLamTronGio);
                                                                                    this.DGVTinhCong.Rows[_nhanVien].Cells[15].Value = "0";
                                                                                }
                                                                                else
                                                                                {
                                                                                    this.DGVTinhCong.Rows[_nhanVien].Cells[13].Value = Math.Round((dTongThoiGianTangCaPhanTheoGio - Convert.ToDouble(iGioiHanTC1PhanTheoGio)) * this.dTangCa2HeSo / 60, this.iLamTronGio);
                                                                                    this.DGVTinhCong.Rows[_nhanVien].Cells[14].Value = "0";
                                                                                    this.DGVTinhCong.Rows[_nhanVien].Cells[15].Value = "0";
                                                                                }
                                                                            }
                                                                            else
                                                                            {
                                                                                this.DGVTinhCong.Rows[_nhanVien].Cells[12].Value = Math.Round(dTongThoiGianTangCaPhanTheoGio * this.dTangCa1HeSo / 60, this.iLamTronGio);
                                                                                this.DGVTinhCong.Rows[_nhanVien].Cells[13].Value = "0";
                                                                                this.DGVTinhCong.Rows[_nhanVien].Cells[14].Value = "0";
                                                                                this.DGVTinhCong.Rows[_nhanVien].Cells[15].Value = "0";
                                                                            }
                                                                        }
                                                                        if ((iGioiHanTC1PhanTheoGio == 0 || iGioiHanTC2PhanTheoGio == 0 || iGioiHanTC3PhanTheoGio == 0 ? false : iGioiHanTC4PhanTheoGio == 0))
                                                                        {
                                                                        }
                                                                    }
                                                                    value = dGioRaPhanTheoGio - dGioVaoPhanTheoGio;
                                                                    second = Convert.ToInt32(value.TotalMinutes);
                                                                    num = Math.Round(Convert.ToDouble(second.ToString()) / 60, this.iLamTronGio);
                                                                    sTongGio = num.ToString();
                                                                    this.DGVTinhCong.Rows[_nhanVien].Cells[16].Value = Convert.ToDouble(sTongGio) * this.dTangCaChuNhatHeSo;
                                                                    this.DGVTinhCong.Rows[_nhanVien].Cells[17].Value = Convert.ToDouble(dtCaLamViecPhanTheoGio.Rows[iCaLamViecPhanTheoGio]["CongTinh"].ToString()) * this.dTangCaChuNhatHeSo;
                                                                    this.DGVTinhCong.Rows[_nhanVien].Cells[18].Value = this.sKHDungGio;
                                                                }
                                                                else
                                                                {
                                                                    sTruGioDiTre = dtCaLamViecPhanTheoGio.Rows[iCaLamViecPhanTheoGio]["TruGioDiTre"].ToString();
                                                                    sBatDauTinhDiTre = dtCaLamViecPhanTheoGio.Rows[iCaLamViecPhanTheoGio]["BatDauTinhDiTre"].ToString();
                                                                    iChoPhepDiTre = Convert.ToInt32(dtCaLamViecPhanTheoGio.Rows[iCaLamViecPhanTheoGio]["ChoPhepDiTre"].ToString());
                                                                    value = dGioVaoPhanTheoGio - dGioVaoKhaiBaoPhanTheoGioB;
                                                                    second = Convert.ToInt32(value.TotalMinutes);
                                                                    sPhutTre = second.ToString();
                                                                    if (Convert.ToInt32(sPhutTre) < 0)
                                                                    {
                                                                        sPhutTre = "0";
                                                                    }
                                                                    sTruGioVeSom = dtCaLamViecPhanTheoGio.Rows[iCaLamViecPhanTheoGio]["TruGioVeSom"].ToString();
                                                                    sBatDauTinhVeSom = dtCaLamViecPhanTheoGio.Rows[iCaLamViecPhanTheoGio]["BatDauTinhVeSom"].ToString();
                                                                    iChoPhepVeSom = Convert.ToInt32(dtCaLamViecPhanTheoGio.Rows[iCaLamViecPhanTheoGio]["ChoPhepVeSom"].ToString());
                                                                    value = dGioRaKhaiBaoPhanTheoGioB - dGioRaPhanTheoGio;
                                                                    second = Convert.ToInt32(value.TotalMinutes);
                                                                    sPhutVeSom = second.ToString();
                                                                    if (Convert.ToInt32(sPhutVeSom) < 0)
                                                                    {
                                                                        sPhutVeSom = "0";
                                                                    }
                                                                    dTongPhutTangCaPhanTheoGioA = Convert.ToDouble(dtCaLamViecPhanTheoGio.Rows[iCaLamViecPhanTheoGio]["TongGioTrongCaLamViec"]) * 60 - (Convert.ToDouble(sPhutTre) + Convert.ToDouble(sPhutVeSom));
                                                                    dTongGioTangCaPhanTheoGioA = Math.Round(dTongPhutTangCaPhanTheoGioA / 60, this.iLamTronGio);
                                                                    if (iTangCaChuNhatMuc == 1)
                                                                    {
                                                                        this.DGVTinhCong.Rows[_nhanVien].Cells[12].Value = dTongGioTangCaPhanTheoGioA * this.dTangCaChuNhatHeSo;
                                                                        this.DGVTinhCong.Rows[_nhanVien].Cells[18].Value = this.sKHDungGio;
                                                                    }
                                                                    if (iTangCaChuNhatMuc == 2)
                                                                    {
                                                                        this.DGVTinhCong.Rows[_nhanVien].Cells[13].Value = dTongGioTangCaPhanTheoGioA * this.dTangCaChuNhatHeSo;
                                                                        this.DGVTinhCong.Rows[_nhanVien].Cells[18].Value = this.sKHDungGio;
                                                                    }
                                                                    if (iTangCaChuNhatMuc == 3)
                                                                    {
                                                                        this.DGVTinhCong.Rows[_nhanVien].Cells[14].Value = dTongGioTangCaPhanTheoGioA * this.dTangCaChuNhatHeSo;
                                                                        this.DGVTinhCong.Rows[_nhanVien].Cells[18].Value = this.sKHDungGio;
                                                                    }
                                                                    if (iTangCaChuNhatMuc == 4)
                                                                    {
                                                                        this.DGVTinhCong.Rows[_nhanVien].Cells[15].Value = dTongGioTangCaPhanTheoGioA * this.dTangCaChuNhatHeSo;
                                                                        this.DGVTinhCong.Rows[_nhanVien].Cells[18].Value = this.sKHDungGio;
                                                                    }
                                                                }
                                                                if (!(DateTimeProgress.XuatIDThu((int)dt.AddDays((double)dem).DayOfWeek) == "0"))
                                                                {
                                                                    this.DGVTinhCong.Rows[_nhanVien].Cells[19].Value = "NT";
                                                                }
                                                                else
                                                                {
                                                                    this.DGVTinhCong.Rows[_nhanVien].Cells[19].Value = "CN";
                                                                }
                                                                this.DGVTinhCong.Rows[_nhanVien].Cells[20].Value = this.sMaChamCong;
                                                                this.DGVTinhCong.Rows[_nhanVien].Cells[21].Value = this.sPhongBanTinhCong;
                                                            }
                                                        }
                                                    Label25:
                                                        if (iCaTrongLIchtrinh == 0)
                                                        {
                                                            this.DGVTinhCong.Rows[_nhanVien].Cells[4].Value = "***";
                                                            this.DGVTinhCong.Rows[_nhanVien].Cells[7].Value = "0";
                                                            this.DGVTinhCong.Rows[_nhanVien].Cells[8].Value = "0";
                                                            this.DGVTinhCong.Rows[_nhanVien].Cells[9].Value = "0";
                                                            this.DGVTinhCong.Rows[_nhanVien].Cells[10].Value = "0";
                                                            this.DGVTinhCong.Rows[_nhanVien].Cells[11].Value = "0";
                                                            this.DGVTinhCong.Rows[_nhanVien].Cells[12].Value = "0";
                                                            this.DGVTinhCong.Rows[_nhanVien].Cells[13].Value = "0";
                                                            this.DGVTinhCong.Rows[_nhanVien].Cells[14].Value = "0";
                                                            this.DGVTinhCong.Rows[_nhanVien].Cells[15].Value = "0";
                                                            this.DGVTinhCong.Rows[_nhanVien].Cells[16].Value = "0";
                                                            this.DGVTinhCong.Rows[_nhanVien].Cells[17].Value = "0";
                                                            this.DGVTinhCong.Rows[_nhanVien].Cells[18].Value = this.sKHVang;
                                                            if (!(DateTimeProgress.XuatIDThu((int)dt.AddDays((double)dem).DayOfWeek) == "0"))
                                                            {
                                                                this.DGVTinhCong.Rows[_nhanVien].Cells[19].Value = "NT";
                                                            }
                                                            else
                                                            {
                                                                this.DGVTinhCong.Rows[_nhanVien].Cells[19].Value = "CN";
                                                            }
                                                            this.DGVTinhCong.Rows[_nhanVien].Cells[20].Value = this.sMaChamCong;
                                                            this.DGVTinhCong.Rows[_nhanVien].Cells[21].Value = this.sPhongBanTinhCong;
                                                        }
                                                        break;
                                                    }
                                                    else if (iKiemTraLanCham == 2)
                                                    {
                                                        dGioRaPhanTheoGio = dGioChamPhanTheoGio;
                                                        this.DGVTinhCong.Rows[addPhanTheoGio].Cells[6].Value = string.Format(this.sDinhDangThoiGian, dGioRaPhanTheoGio);
                                                        iCaTrongLIchtrinh = 0;
                                                        dtNhanCaPhanTheoGio = new System.Data.DataTable();
                                                        this._chiTietLichTrinhChoCalamViecDTO.MaLichTrinhCaLamViec = sLTCCLVNhanVien;
                                                        this._chiTietLichTrinhChoCalamViecDTO.Thu = sThu;
                                                        dtNhanCaPhanTheoGio = this._chiTietLichTrinhChoCaLamViecBLL.ChiTietLichTrinhChoCaLamViecNhanCa(this._chiTietLichTrinhChoCalamViecDTO);
                                                        iChiTietLichTrinhChoCaLamViecPhanTheoGio = 0;
                                                        if (iChiTietLichTrinhChoCaLamViecPhanTheoGio < dtNhanCaPhanTheoGio.Rows.Count)
                                                        {
                                                            iCaTrongLIchtrinh = 1;
                                                            cellChiTietLichTrinhChoCaLamViecPhanTheoGio = 3;
                                                            while (cellChiTietLichTrinhChoCaLamViecPhanTheoGio < 13)
                                                            {
                                                                kiemTraVao = 0;
                                                                kiemTraRa = 0;
                                                                this.sPhanTheoGioMaCaLamViec = dtNhanCaPhanTheoGio.Rows[iChiTietLichTrinhChoCaLamViecPhanTheoGio][cellChiTietLichTrinhChoCaLamViecPhanTheoGio].ToString();
                                                                dtPhanTheoGioCa1 = new System.Data.DataTable();
                                                                this._caLamViecDTO.MaCaLamViec = this.sPhanTheoGioMaCaLamViec;
                                                                dtPhanTheoGioCa1 = this._caLamViecBLL.CaLamViecGetByMaCaLamViec(this._caLamViecDTO);
                                                                iPhanTheoGioCa1 = 0;
                                                                while (iPhanTheoGioCa1 < dtPhanTheoGioCa1.Rows.Count)
                                                                {
                                                                    second = dGioVaoPhanTheoGio.Second;
                                                                    sGiayGioVao = second.ToString();
                                                                    second = dGioRaPhanTheoGio.Second;
                                                                    sGiayGioRa = second.ToString();
                                                                    this.sPhanTheoGioTenCaLamViec = dtPhanTheoGioCa1.Rows[iPhanTheoGioCa1]["CaLamViec"].ToString();
                                                                    dBatDauVaoPhanTheoGioA = Convert.ToDateTime(dtPhanTheoGioCa1.Rows[iPhanTheoGioCa1]["BatDauVao"].ToString());
                                                                    sBatDauVaoPhanTheoGioA = string.Format("{0:T}", dBatDauVaoPhanTheoGioA).Replace("00 ", string.Concat(sGiayGioVao, " "));
                                                                    sBatDauVaoPhanTheoGioB = string.Concat(sNgayCham, " ", sBatDauVaoPhanTheoGioA);
                                                                    dBatDauVaoPhanTheoGioB = Convert.ToDateTime(sBatDauVaoPhanTheoGioB);
                                                                    dKetThucVaoPhanTheoGioA = Convert.ToDateTime(dtPhanTheoGioCa1.Rows[iPhanTheoGioCa1]["KetThucVao"].ToString());
                                                                    sKetThucVaoPhanTheoGioA = string.Format("{0:T}", dKetThucVaoPhanTheoGioA).Replace("00 ", string.Concat(sGiayGioVao, " "));
                                                                    sKetThucVaoPhanTheoGioB = string.Concat(sNgayCham, " ", sKetThucVaoPhanTheoGioA);
                                                                    dKetThucVaoPhanTheoGioB = Convert.ToDateTime(sKetThucVaoPhanTheoGioB);
                                                                    dBatDauRaPhanTheoGioA = Convert.ToDateTime(dtPhanTheoGioCa1.Rows[iPhanTheoGioCa1]["BatDauRa"].ToString());
                                                                    sBatDauRaPhanTheoGioA = string.Format("{0:T}", dBatDauRaPhanTheoGioA).Replace("00 ", string.Concat(sGiayGioRa, " "));
                                                                    sBatDauRaPhanTheoGioB = string.Concat(sNgayCham, " ", sBatDauRaPhanTheoGioA);
                                                                    dBatDauRaPhanTheoGioB = Convert.ToDateTime(sBatDauRaPhanTheoGioB);
                                                                    dKetThucRaPhanTheoGioA = Convert.ToDateTime(dtPhanTheoGioCa1.Rows[iPhanTheoGioCa1]["KetThucRa"].ToString());
                                                                    sKetThucRaPhanTheoGioA = string.Format("{0:T}", dKetThucRaPhanTheoGioA).Replace("00 ", string.Concat(sGiayGioRa, " "));
                                                                    sKetThucRaPhanTheoGioB = string.Concat(sNgayCham, " ", sKetThucRaPhanTheoGioA);
                                                                    dKetThucRaPhanTheoGioB = Convert.ToDateTime(sKetThucRaPhanTheoGioB);
                                                                    if ((dGioVaoPhanTheoGio < dBatDauVaoPhanTheoGioB ? false : dGioVaoPhanTheoGio <= dKetThucVaoPhanTheoGioB))
                                                                    {
                                                                        kiemTraVao++;
                                                                    }
                                                                    if ((dGioRaPhanTheoGio < dBatDauRaPhanTheoGioB ? false : dGioRaPhanTheoGio <= dKetThucRaPhanTheoGioB))
                                                                    {
                                                                        kiemTraRa++;
                                                                    }
                                                                    if ((kiemTraVao != 1 ? true : kiemTraRa != 1))
                                                                    {
                                                                        iPhanTheoGioCa1++;
                                                                    }
                                                                    else
                                                                    {
                                                                        goto Label24;
                                                                    }
                                                                }
                                                                if (!(this.sPhanTheoGioMaCaLamViec == ""))
                                                                {
                                                                    cellChiTietLichTrinhChoCaLamViecPhanTheoGio++;
                                                                }
                                                                else
                                                                {
                                                                    this.DGVTinhCong.Rows[addPhanTheoGio].Cells[4].Value = "***";
                                                                    this.DGVTinhCong.Rows[addPhanTheoGio].Cells[7].Value = "0";
                                                                    this.DGVTinhCong.Rows[addPhanTheoGio].Cells[8].Value = "0";
                                                                    this.DGVTinhCong.Rows[addPhanTheoGio].Cells[9].Value = "0";
                                                                    this.DGVTinhCong.Rows[addPhanTheoGio].Cells[10].Value = "0";
                                                                    this.DGVTinhCong.Rows[addPhanTheoGio].Cells[11].Value = "0";
                                                                    this.DGVTinhCong.Rows[addPhanTheoGio].Cells[12].Value = "0";
                                                                    this.DGVTinhCong.Rows[addPhanTheoGio].Cells[13].Value = "0";
                                                                    this.DGVTinhCong.Rows[addPhanTheoGio].Cells[14].Value = "0";
                                                                    this.DGVTinhCong.Rows[addPhanTheoGio].Cells[15].Value = "0";
                                                                    this.DGVTinhCong.Rows[addPhanTheoGio].Cells[16].Value = "0";
                                                                    this.DGVTinhCong.Rows[addPhanTheoGio].Cells[17].Value = "0";
                                                                    this.DGVTinhCong.Rows[addPhanTheoGio].Cells[18].Value = this.sKHVang;
                                                                    if (!(DateTimeProgress.XuatIDThu((int)dt.AddDays((double)dem).DayOfWeek) == "0"))
                                                                    {
                                                                        this.DGVTinhCong.Rows[addPhanTheoGio].Cells[19].Value = "NT";
                                                                    }
                                                                    else
                                                                    {
                                                                        this.DGVTinhCong.Rows[addPhanTheoGio].Cells[19].Value = "CN";
                                                                    }
                                                                    this.DGVTinhCong.Rows[addPhanTheoGio].Cells[20].Value = this.sMaChamCong;
                                                                    this.DGVTinhCong.Rows[addPhanTheoGio].Cells[21].Value = this.sPhongBanTinhCong;
                                                                    goto Label23;
                                                                }
                                                            }
                                                        Label24:
                                                            this.DGVTinhCong.Rows[addPhanTheoGio].Cells[4].Value = this.sPhanTheoGioTenCaLamViec;
                                                            dtCaLamViecPhanTheoGio = new System.Data.DataTable();
                                                            this._caLamViecDTO.MaCaLamViec = this.sPhanTheoGioMaCaLamViec;
                                                            dtCaLamViecPhanTheoGio = this._caLamViecBLL.CaLamViecGetByMaCaLamViec(this._caLamViecDTO);
                                                            for (iCaLamViecPhanTheoGio = 0; iCaLamViecPhanTheoGio < dtCaLamViecPhanTheoGio.Rows.Count; iCaLamViecPhanTheoGio++)
                                                            {
                                                                second = dGioVaoPhanTheoGio.Second;
                                                                sGiayGioVao = second.ToString();
                                                                second = dGioRaPhanTheoGio.Second;
                                                                sGiayGioRa = second.ToString();
                                                                dGioVaoKhaiBaoPhanTheoGioA = Convert.ToDateTime(dtCaLamViecPhanTheoGio.Rows[iCaLamViecPhanTheoGio]["GioVaoLamViec"].ToString());
                                                                sGioVaoKhaiBaoPhanTheoGioA = string.Format("{0:T}", dGioVaoKhaiBaoPhanTheoGioA).Replace("00 ", string.Concat(sGiayGioVao, " "));
                                                                sGioVaoKhaiBaoPhanTheoGioB = string.Concat(sNgayCham, " ", sGioVaoKhaiBaoPhanTheoGioA);
                                                                dGioVaoKhaiBaoPhanTheoGioB = Convert.ToDateTime(sGioVaoKhaiBaoPhanTheoGioB);
                                                                dGioRaKhaiBaoPhanTheoGioA = Convert.ToDateTime(dtCaLamViecPhanTheoGio.Rows[iCaLamViecPhanTheoGio]["GioKetThucLamViec"].ToString());
                                                                sGioRaKhaiBaoPhanTheoGioA = string.Format("{0:T}", dGioRaKhaiBaoPhanTheoGioA).Replace("00 ", string.Concat(sGiayGioRa, " "));
                                                                sGioRaKhaiBaoPhanTheoGioB = string.Concat(sNgayCham, " ", sGioRaKhaiBaoPhanTheoGioA);
                                                                dGioRaKhaiBaoPhanTheoGioB = Convert.ToDateTime(sGioRaKhaiBaoPhanTheoGioB);
                                                                sXemCaNayLaTangCa = dtCaLamViecPhanTheoGio.Rows[iCaLamViecPhanTheoGio]["XemCaNayLaTangCa"].ToString();
                                                                iTangCaMuc = Convert.ToInt32(dtCaLamViecPhanTheoGio.Rows[iCaLamViecPhanTheoGio]["TangCaMuc"].ToString());
                                                                sXemChuNhatLaTangCa = dtCaLamViecPhanTheoGio.Rows[iCaLamViecPhanTheoGio]["XemCuoiTuanLaTangCa"].ToString();
                                                                iTangCaChuNhatMuc = Convert.ToInt32(dtCaLamViecPhanTheoGio.Rows[iCaLamViecPhanTheoGio]["TangCaCuoiTuanMuc"].ToString());
                                                                if (sXemCaNayLaTangCa == "True")
                                                                {
                                                                    sTruGioDiTre = dtCaLamViecPhanTheoGio.Rows[iCaLamViecPhanTheoGio]["TruGioDiTre"].ToString();
                                                                    sBatDauTinhDiTre = dtCaLamViecPhanTheoGio.Rows[iCaLamViecPhanTheoGio]["BatDauTinhDiTre"].ToString();
                                                                    iChoPhepDiTre = Convert.ToInt32(dtCaLamViecPhanTheoGio.Rows[iCaLamViecPhanTheoGio]["ChoPhepDiTre"].ToString());
                                                                    value = dGioVaoPhanTheoGio - dGioVaoKhaiBaoPhanTheoGioB;
                                                                    second = Convert.ToInt32(value.TotalMinutes);
                                                                    sPhutTre = second.ToString();
                                                                    if (Convert.ToInt32(sPhutTre) < 0)
                                                                    {
                                                                        sPhutTre = "0";
                                                                    }
                                                                    sTruGioVeSom = dtCaLamViecPhanTheoGio.Rows[iCaLamViecPhanTheoGio]["TruGioVeSom"].ToString();
                                                                    sBatDauTinhVeSom = dtCaLamViecPhanTheoGio.Rows[iCaLamViecPhanTheoGio]["BatDauTinhVeSom"].ToString();
                                                                    iChoPhepVeSom = Convert.ToInt32(dtCaLamViecPhanTheoGio.Rows[iCaLamViecPhanTheoGio]["ChoPhepVeSom"].ToString());
                                                                    value = dGioRaKhaiBaoPhanTheoGioB - dGioRaPhanTheoGio;
                                                                    second = Convert.ToInt32(value.TotalMinutes);
                                                                    sPhutVeSom = second.ToString();
                                                                    if (Convert.ToInt32(sPhutVeSom) < 0)
                                                                    {
                                                                        sPhutVeSom = "0";
                                                                    }
                                                                    dTongPhutTangCaPhanTheoGio = Convert.ToDouble(dtCaLamViecPhanTheoGio.Rows[iCaLamViecPhanTheoGio]["TongGioTrongCaLamViec"]) * 60 - (Convert.ToDouble(sPhutTre) + Convert.ToDouble(sPhutVeSom));
                                                                    dTongGioTangCaPhanTheoGio = Math.Round(dTongPhutTangCaPhanTheoGio / 60, this.iLamTronGio);
                                                                    if (iTangCaMuc == 1)
                                                                    {
                                                                        this.DGVTinhCong.Rows[addPhanTheoGio].Cells[12].Value = dTongGioTangCaPhanTheoGio * this.dTangCa1HeSo;
                                                                        this.DGVTinhCong.Rows[addPhanTheoGio].Cells[18].Value = this.sKHDungGio;
                                                                    }
                                                                    if (iTangCaMuc == 2)
                                                                    {
                                                                        this.DGVTinhCong.Rows[addPhanTheoGio].Cells[13].Value = dTongGioTangCaPhanTheoGio * this.dTangCa2HeSo;
                                                                        this.DGVTinhCong.Rows[addPhanTheoGio].Cells[18].Value = this.sKHDungGio;
                                                                    }
                                                                    if (iTangCaMuc == 3)
                                                                    {
                                                                        this.DGVTinhCong.Rows[addPhanTheoGio].Cells[14].Value = dTongGioTangCaPhanTheoGio * this.dTangCa3HeSo;
                                                                        this.DGVTinhCong.Rows[addPhanTheoGio].Cells[18].Value = this.sKHDungGio;
                                                                    }
                                                                    if (iTangCaMuc == 4)
                                                                    {
                                                                        this.DGVTinhCong.Rows[addPhanTheoGio].Cells[15].Value = dTongGioTangCaPhanTheoGio * this.dTangCa4HeSo;
                                                                        this.DGVTinhCong.Rows[addPhanTheoGio].Cells[18].Value = this.sKHDungGio;
                                                                    }
                                                                }
                                                                else if (!(DateTimeProgress.XuatIDThu((int)dt.AddDays((double)dem).DayOfWeek) == "0"))
                                                                {
                                                                    sTruGioDiTre = dtCaLamViecPhanTheoGio.Rows[iCaLamViecPhanTheoGio]["TruGioDiTre"].ToString();
                                                                    sBatDauTinhDiTre = dtCaLamViecPhanTheoGio.Rows[iCaLamViecPhanTheoGio]["BatDauTinhDiTre"].ToString();
                                                                    iChoPhepDiTre = Convert.ToInt32(dtCaLamViecPhanTheoGio.Rows[iCaLamViecPhanTheoGio]["ChoPhepDiTre"].ToString());
                                                                    value = dGioVaoPhanTheoGio - dGioVaoKhaiBaoPhanTheoGioB;
                                                                    second = Convert.ToInt32(value.TotalMinutes);
                                                                    sPhutTre = second.ToString();
                                                                    if (!(sTruGioDiTre == "True"))
                                                                    {
                                                                        this.DGVTinhCong.Rows[addPhanTheoGio].Cells[9].Value = "0";
                                                                    }
                                                                    else if (Convert.ToInt32(sPhutTre) >= 0)
                                                                    {
                                                                        iPhutTre = Convert.ToInt32(sPhutTre) - iChoPhepDiTre;
                                                                        if (sBatDauTinhDiTre == "True")
                                                                        {
                                                                            if (iPhutTre >= 1)
                                                                            {
                                                                                this.DGVTinhCong.Rows[addPhanTheoGio].Cells[9].Value = iPhutTre.ToString();
                                                                            }
                                                                            else
                                                                            {
                                                                                this.DGVTinhCong.Rows[addPhanTheoGio].Cells[9].Value = "0";
                                                                            }
                                                                        }
                                                                        else if (iPhutTre >= 1)
                                                                        {
                                                                            this.DGVTinhCong.Rows[addPhanTheoGio].Cells[9].Value = sPhutTre;
                                                                        }
                                                                        else
                                                                        {
                                                                            this.DGVTinhCong.Rows[addPhanTheoGio].Cells[9].Value = "0";
                                                                        }
                                                                    }
                                                                    else
                                                                    {
                                                                        this.DGVTinhCong.Rows[addPhanTheoGio].Cells[9].Value = "0";
                                                                    }
                                                                    sTruGioVeSom = dtCaLamViecPhanTheoGio.Rows[iCaLamViecPhanTheoGio]["TruGioVeSom"].ToString();
                                                                    sBatDauTinhVeSom = dtCaLamViecPhanTheoGio.Rows[iCaLamViecPhanTheoGio]["BatDauTinhVeSom"].ToString();
                                                                    iChoPhepVeSom = Convert.ToInt32(dtCaLamViecPhanTheoGio.Rows[iCaLamViecPhanTheoGio]["ChoPhepVeSom"].ToString());
                                                                    value = dGioRaKhaiBaoPhanTheoGioB - dGioRaPhanTheoGio;
                                                                    second = Convert.ToInt32(value.TotalMinutes);
                                                                    sPhutVeSom = second.ToString();
                                                                    if (!(sTruGioVeSom == "True"))
                                                                    {
                                                                        this.DGVTinhCong.Rows[addPhanTheoGio].Cells[10].Value = "0";
                                                                    }
                                                                    else if (Convert.ToInt32(sPhutVeSom) >= 0)
                                                                    {
                                                                        iPhutVeSom = Convert.ToInt32(sPhutVeSom) - iChoPhepVeSom;
                                                                        if (iPhutVeSom < 1)
                                                                        {
                                                                            this.DGVTinhCong.Rows[addPhanTheoGio].Cells[10].Value = "0";
                                                                        }
                                                                        else if (!(sBatDauTinhVeSom == "True"))
                                                                        {
                                                                            this.DGVTinhCong.Rows[addPhanTheoGio].Cells[10].Value = sPhutVeSom;
                                                                        }
                                                                        else
                                                                        {
                                                                            this.DGVTinhCong.Rows[addPhanTheoGio].Cells[10].Value = iPhutVeSom.ToString();
                                                                        }
                                                                    }
                                                                    else
                                                                    {
                                                                        this.DGVTinhCong.Rows[addPhanTheoGio].Cells[10].Value = "0";
                                                                    }
                                                                    value = dGioRaPhanTheoGio - dGioRaKhaiBaoPhanTheoGioB;
                                                                    second = Convert.ToInt32(value.TotalMinutes);
                                                                    sVeTre = second.ToString();
                                                                    if (Convert.ToInt32(sVeTre) <= 0)
                                                                    {
                                                                        this.DGVTinhCong.Rows[addPhanTheoGio].Cells[11].Value = "0";
                                                                    }
                                                                    else
                                                                    {
                                                                        this.DGVTinhCong.Rows[addPhanTheoGio].Cells[11].Value = sVeTre;
                                                                    }
                                                                    iPhut = Convert.ToSingle(dtCaLamViecPhanTheoGio.Rows[iCaLamViecPhanTheoGio]["TongGioTrongCaLamViec"]) * 60f - (float)(Convert.ToInt32(this.DGVTinhCong.Rows[addPhanTheoGio].Cells[9].Value.ToString()) + Convert.ToInt32(this.DGVTinhCong.Rows[addPhanTheoGio].Cells[10].Value));
                                                                    dGio = Math.Round(Convert.ToDouble(iPhut) / 60, this.iLamTronGio);
                                                                    this.DGVTinhCong.Rows[addPhanTheoGio].Cells[8].Value = dGio.ToString();
                                                                    iGio = Convert.ToDouble(dtCaLamViecPhanTheoGio.Rows[iCaLamViecPhanTheoGio]["TongGioTrongCaLamViec"].ToString());
                                                                    dCongTinh = Convert.ToDouble(dtCaLamViecPhanTheoGio.Rows[iCaLamViecPhanTheoGio]["CongTinh"].ToString());
                                                                    dCong = Math.Round(dGio * dCongTinh / iGio, this.iLamTronCong);
                                                                    this.DGVTinhCong.Rows[addPhanTheoGio].Cells[7].Value = dCong.ToString();
                                                                    sTangCaTruocGioLamViec = dtCaLamViecPhanTheoGio.Rows[iCaLamViecPhanTheoGio]["TangCaTruocGioLamViec"].ToString();
                                                                    sTangCaSauGioLamViec = dtCaLamViecPhanTheoGio.Rows[iCaLamViecPhanTheoGio]["TangCaSauGioLamViec"].ToString();
                                                                    if ((sTangCaTruocGioLamViec != "False" ? false : sTangCaSauGioLamViec == "False"))
                                                                    {
                                                                        this.DGVTinhCong.Rows[addPhanTheoGio].Cells[12].Value = "0";
                                                                        this.DGVTinhCong.Rows[addPhanTheoGio].Cells[13].Value = "0";
                                                                        this.DGVTinhCong.Rows[addPhanTheoGio].Cells[14].Value = "0";
                                                                        this.DGVTinhCong.Rows[addPhanTheoGio].Cells[15].Value = "0";
                                                                    }
                                                                    if (sXemCaNayLaTangCa == "True")
                                                                    {
                                                                        if (iTangCaMuc == 1)
                                                                        {
                                                                            this.DGVTinhCong.Rows[addPhanTheoGio].Cells[7].Value = "0";
                                                                            this.DGVTinhCong.Rows[addPhanTheoGio].Cells[8].Value = "0";
                                                                            this.DGVTinhCong.Rows[addPhanTheoGio].Cells[12].Value = dGio.ToString();
                                                                            this.DGVTinhCong.Rows[addPhanTheoGio].Cells[13].Value = "0";
                                                                            this.DGVTinhCong.Rows[addPhanTheoGio].Cells[14].Value = "0";
                                                                            this.DGVTinhCong.Rows[addPhanTheoGio].Cells[15].Value = "0";
                                                                        }
                                                                        if (iTangCaMuc == 2)
                                                                        {
                                                                            this.DGVTinhCong.Rows[addPhanTheoGio].Cells[7].Value = "0";
                                                                            this.DGVTinhCong.Rows[addPhanTheoGio].Cells[8].Value = "0";
                                                                            this.DGVTinhCong.Rows[addPhanTheoGio].Cells[12].Value = "0";
                                                                            this.DGVTinhCong.Rows[addPhanTheoGio].Cells[13].Value = dGio.ToString();
                                                                            this.DGVTinhCong.Rows[addPhanTheoGio].Cells[14].Value = "0";
                                                                            this.DGVTinhCong.Rows[addPhanTheoGio].Cells[15].Value = "0";
                                                                        }
                                                                        if (iTangCaMuc == 3)
                                                                        {
                                                                            this.DGVTinhCong.Rows[addPhanTheoGio].Cells[7].Value = "0";
                                                                            this.DGVTinhCong.Rows[addPhanTheoGio].Cells[8].Value = "0";
                                                                            this.DGVTinhCong.Rows[addPhanTheoGio].Cells[12].Value = "0";
                                                                            this.DGVTinhCong.Rows[addPhanTheoGio].Cells[13].Value = "0";
                                                                            this.DGVTinhCong.Rows[addPhanTheoGio].Cells[14].Value = dGio.ToString();
                                                                            this.DGVTinhCong.Rows[addPhanTheoGio].Cells[15].Value = "0";
                                                                        }
                                                                        if (iTangCaMuc == 4)
                                                                        {
                                                                            this.DGVTinhCong.Rows[addPhanTheoGio].Cells[7].Value = "0";
                                                                            this.DGVTinhCong.Rows[addPhanTheoGio].Cells[8].Value = "0";
                                                                            this.DGVTinhCong.Rows[addPhanTheoGio].Cells[12].Value = "0";
                                                                            this.DGVTinhCong.Rows[addPhanTheoGio].Cells[13].Value = "0";
                                                                            this.DGVTinhCong.Rows[addPhanTheoGio].Cells[14].Value = "0";
                                                                            this.DGVTinhCong.Rows[addPhanTheoGio].Cells[15].Value = dGio.ToString();
                                                                        }
                                                                    }
                                                                    sChoPhepTangCaTruocGioLamViecPhanTheoGio = dtCaLamViecPhanTheoGio.Rows[iCaLamViecPhanTheoGio]["TangCaTruocGioLamViec"].ToString();
                                                                    iPhutTangCaTruocGioLamViecPhanTheoGio = Convert.ToInt32(dtCaLamViecPhanTheoGio.Rows[iCaLamViecPhanTheoGio]["SoPhutTangCaTruocGioLamViec"].ToString());
                                                                    iPhutTangCaTruocGioLamViecDatDen = Convert.ToInt32(dtCaLamViecPhanTheoGio.Rows[iCaLamViecPhanTheoGio]["TangCaTruocGioLamViecDatDen"].ToString());
                                                                    iPhutTruTangCaTruoc = Convert.ToInt32(dtCaLamViecPhanTheoGio.Rows[iCaLamViecPhanTheoGio]["PhutTruTangCaTruoc"].ToString());
                                                                    sChoPhepTangCaSauGioLamViecPhanTheoGio = dtCaLamViecPhanTheoGio.Rows[iCaLamViecPhanTheoGio]["TangCaSauGioLamViec"].ToString();
                                                                    iPhutTangCaSauGioLamViecPhanTheoGio = Convert.ToInt32(dtCaLamViecPhanTheoGio.Rows[iCaLamViecPhanTheoGio]["SoPhutTangCaSauGioLamViec"].ToString());
                                                                    iPhutTangCaSauGioLamViecDatDen = Convert.ToInt32(dtCaLamViecPhanTheoGio.Rows[iCaLamViecPhanTheoGio]["TangCaSauGioLamViecDatDen"].ToString());
                                                                    iPhutTruTangCaSau = Convert.ToInt32(dtCaLamViecPhanTheoGio.Rows[iCaLamViecPhanTheoGio]["PhutTruTangCaSau"].ToString());
                                                                    iGioiHanTC1PhanTheoGio = Convert.ToInt32(dtCaLamViecPhanTheoGio.Rows[iCaLamViecPhanTheoGio]["GioiHanTangCa1"].ToString());
                                                                    iGioiHanTC2PhanTheoGio = Convert.ToInt32(dtCaLamViecPhanTheoGio.Rows[iCaLamViecPhanTheoGio]["GioiHanTangCa2"].ToString());
                                                                    iGioiHanTC3PhanTheoGio = Convert.ToInt32(dtCaLamViecPhanTheoGio.Rows[iCaLamViecPhanTheoGio]["GioiHanTangCa3"].ToString());
                                                                    iGioiHanTC4PhanTheoGio = Convert.ToInt32(dtCaLamViecPhanTheoGio.Rows[iCaLamViecPhanTheoGio]["GioiHanTangCa4"].ToString());
                                                                    iTongGioTangCaSauPhanTheoGio = 0;
                                                                    iTongGioTangCaTruocPhanTheoGio = 0;
                                                                    if ((sChoPhepTangCaTruocGioLamViecPhanTheoGio != "False" ? true : !(sChoPhepTangCaSauGioLamViecPhanTheoGio == "False")))
                                                                    {
                                                                        if (sChoPhepTangCaTruocGioLamViecPhanTheoGio == "True")
                                                                        {
                                                                            value = dGioVaoKhaiBaoPhanTheoGioB - dGioVaoPhanTheoGio;
                                                                            second = Convert.ToInt32(value.TotalMinutes);
                                                                            iThoiGianTruocGioLamPhanTheoGio = Convert.ToInt32(second.ToString());
                                                                            if (iThoiGianTruocGioLamPhanTheoGio > 0)
                                                                            {
                                                                                if (iThoiGianTruocGioLamPhanTheoGio > iPhutTangCaTruocGioLamViecPhanTheoGio)
                                                                                {
                                                                                    if (iThoiGianTruocGioLamPhanTheoGio > iPhutTangCaTruocGioLamViecDatDen)
                                                                                    {
                                                                                        iTongGioTangCaTruocPhanTheoGio = iThoiGianTruocGioLamPhanTheoGio - iPhutTruTangCaTruoc;
                                                                                    }
                                                                                }
                                                                            }
                                                                        }
                                                                        if (sChoPhepTangCaSauGioLamViecPhanTheoGio == "True")
                                                                        {
                                                                            value = dGioRaPhanTheoGio - dGioRaKhaiBaoPhanTheoGioB;
                                                                            second = Convert.ToInt32(value.TotalMinutes);
                                                                            iThoiGianSauGioLamViecPhanTheoGio = Convert.ToInt32(second.ToString());
                                                                            if (iThoiGianSauGioLamViecPhanTheoGio > 0)
                                                                            {
                                                                                if (iThoiGianSauGioLamViecPhanTheoGio > iPhutTangCaSauGioLamViecPhanTheoGio)
                                                                                {
                                                                                    if (iThoiGianSauGioLamViecPhanTheoGio > iPhutTangCaSauGioLamViecDatDen)
                                                                                    {
                                                                                        iTongGioTangCaSauPhanTheoGio = iThoiGianSauGioLamViecPhanTheoGio - iPhutTruTangCaSau;
                                                                                    }
                                                                                }
                                                                            }
                                                                        }
                                                                    }
                                                                    else
                                                                    {
                                                                        this.DGVTinhCong.Rows[addPhanTheoGio].Cells[12].Value = "0";
                                                                        this.DGVTinhCong.Rows[addPhanTheoGio].Cells[13].Value = "0";
                                                                        this.DGVTinhCong.Rows[addPhanTheoGio].Cells[14].Value = "0";
                                                                        this.DGVTinhCong.Rows[addPhanTheoGio].Cells[15].Value = "0";
                                                                    }
                                                                    dTongThoiGianTangCaPhanTheoGio = Convert.ToDouble(iTongGioTangCaTruocPhanTheoGio + iTongGioTangCaSauPhanTheoGio);
                                                                    if (dTongThoiGianTangCaPhanTheoGio <= 0)
                                                                    {
                                                                        this.DGVTinhCong.Rows[addPhanTheoGio].Cells[12].Value = "0";
                                                                        this.DGVTinhCong.Rows[addPhanTheoGio].Cells[13].Value = "0";
                                                                        this.DGVTinhCong.Rows[addPhanTheoGio].Cells[14].Value = "0";
                                                                        this.DGVTinhCong.Rows[addPhanTheoGio].Cells[15].Value = "0";
                                                                    }
                                                                    else
                                                                    {
                                                                        if (iGioiHanTC1PhanTheoGio == 0)
                                                                        {
                                                                            this.DGVTinhCong.Rows[addPhanTheoGio].Cells[12].Value = Math.Round(dTongThoiGianTangCaPhanTheoGio * this.dTangCa1HeSo / 60, this.iLamTronGio);
                                                                            this.DGVTinhCong.Rows[addPhanTheoGio].Cells[13].Value = "0";
                                                                            this.DGVTinhCong.Rows[addPhanTheoGio].Cells[14].Value = "0";
                                                                            this.DGVTinhCong.Rows[addPhanTheoGio].Cells[15].Value = "0";
                                                                        }
                                                                        if ((iGioiHanTC1PhanTheoGio == 0 ? false : iGioiHanTC2PhanTheoGio == 0))
                                                                        {
                                                                            if (dTongThoiGianTangCaPhanTheoGio >= Convert.ToDouble(iGioiHanTC1PhanTheoGio))
                                                                            {
                                                                                this.DGVTinhCong.Rows[addPhanTheoGio].Cells[12].Value = Math.Round(Convert.ToDouble(iGioiHanTC1PhanTheoGio) / 60 * this.dTangCa1HeSo, this.iLamTronGio);
                                                                                if (dTongThoiGianTangCaPhanTheoGio - Convert.ToDouble(iGioiHanTC1PhanTheoGio) > 0)
                                                                                {
                                                                                    this.DGVTinhCong.Rows[addPhanTheoGio].Cells[13].Value = Math.Round((dTongThoiGianTangCaPhanTheoGio - Convert.ToDouble(iGioiHanTC1PhanTheoGio)) * this.dTangCa2HeSo / 60, this.iLamTronGio);
                                                                                }
                                                                                this.DGVTinhCong.Rows[addPhanTheoGio].Cells[14].Value = "0";
                                                                                this.DGVTinhCong.Rows[addPhanTheoGio].Cells[15].Value = "0";
                                                                            }
                                                                            else
                                                                            {
                                                                                this.DGVTinhCong.Rows[addPhanTheoGio].Cells[12].Value = Math.Round(dTongThoiGianTangCaPhanTheoGio * this.dTangCa1HeSo / 60, this.iLamTronGio);
                                                                                this.DGVTinhCong.Rows[addPhanTheoGio].Cells[13].Value = "0";
                                                                                this.DGVTinhCong.Rows[addPhanTheoGio].Cells[14].Value = "0";
                                                                                this.DGVTinhCong.Rows[addPhanTheoGio].Cells[15].Value = "0";
                                                                            }
                                                                        }
                                                                        if ((iGioiHanTC1PhanTheoGio == 0 || iGioiHanTC2PhanTheoGio == 0 ? false : iGioiHanTC3PhanTheoGio == 0))
                                                                        {
                                                                            if (dTongThoiGianTangCaPhanTheoGio >= Convert.ToDouble(iGioiHanTC1PhanTheoGio))
                                                                            {
                                                                                this.DGVTinhCong.Rows[addPhanTheoGio].Cells[12].Value = Math.Round(Convert.ToDouble(iGioiHanTC1PhanTheoGio) * this.dTangCa1HeSo / 60, this.iLamTronGio);
                                                                                if (dTongThoiGianTangCaPhanTheoGio - Convert.ToDouble(iGioiHanTC1PhanTheoGio) >= Convert.ToDouble(iGioiHanTC2PhanTheoGio))
                                                                                {
                                                                                    this.DGVTinhCong.Rows[addPhanTheoGio].Cells[12].Value = Math.Round(Convert.ToDouble(iGioiHanTC1PhanTheoGio) * this.dTangCa1HeSo / 60, this.iLamTronGio);
                                                                                    this.DGVTinhCong.Rows[addPhanTheoGio].Cells[13].Value = Math.Round(Convert.ToDouble(iGioiHanTC2PhanTheoGio) * this.dTangCa2HeSo / 60, this.iLamTronGio);
                                                                                    this.DGVTinhCong.Rows[addPhanTheoGio].Cells[14].Value = Math.Round((dTongThoiGianTangCaPhanTheoGio - Convert.ToDouble(iGioiHanTC1PhanTheoGio) - Convert.ToDouble(iGioiHanTC2PhanTheoGio)) * this.dTangCa3HeSo / 60, this.iLamTronGio);
                                                                                    this.DGVTinhCong.Rows[addPhanTheoGio].Cells[15].Value = "0";
                                                                                }
                                                                                else
                                                                                {
                                                                                    this.DGVTinhCong.Rows[addPhanTheoGio].Cells[13].Value = Math.Round((dTongThoiGianTangCaPhanTheoGio - Convert.ToDouble(iGioiHanTC1PhanTheoGio)) * this.dTangCa2HeSo / 60, this.iLamTronGio);
                                                                                    this.DGVTinhCong.Rows[addPhanTheoGio].Cells[14].Value = "0";
                                                                                    this.DGVTinhCong.Rows[addPhanTheoGio].Cells[15].Value = "0";
                                                                                }
                                                                            }
                                                                            else
                                                                            {
                                                                                this.DGVTinhCong.Rows[addPhanTheoGio].Cells[12].Value = Math.Round(dTongThoiGianTangCaPhanTheoGio * this.dTangCa1HeSo / 60, this.iLamTronGio);
                                                                                this.DGVTinhCong.Rows[addPhanTheoGio].Cells[13].Value = "0";
                                                                                this.DGVTinhCong.Rows[addPhanTheoGio].Cells[14].Value = "0";
                                                                                this.DGVTinhCong.Rows[addPhanTheoGio].Cells[15].Value = "0";
                                                                            }
                                                                        }
                                                                        if ((iGioiHanTC1PhanTheoGio == 0 || iGioiHanTC2PhanTheoGio == 0 || iGioiHanTC3PhanTheoGio == 0 ? false : iGioiHanTC4PhanTheoGio == 0))
                                                                        {
                                                                        }
                                                                    }
                                                                    value = dGioRaPhanTheoGio - dGioVaoPhanTheoGio;
                                                                    second = Convert.ToInt32(value.TotalMinutes);
                                                                    num = Math.Round(Convert.ToDouble(second.ToString()) / 60, this.iLamTronGio);
                                                                    sTongGio = num.ToString();
                                                                    this.DGVTinhCong.Rows[addPhanTheoGio].Cells[16].Value = sTongGio;
                                                                    this.DGVTinhCong.Rows[addPhanTheoGio].Cells[17].Value = dtCaLamViecPhanTheoGio.Rows[iCaLamViecPhanTheoGio]["CongTinh"].ToString();
                                                                    this.DGVTinhCong.Rows[addPhanTheoGio].Cells[18].Value = this.sKHDungGio;
                                                                }
                                                                else if (!(sXemChuNhatLaTangCa == "True"))
                                                                {
                                                                    sTruGioDiTre = dtCaLamViecPhanTheoGio.Rows[iCaLamViecPhanTheoGio]["TruGioDiTre"].ToString();
                                                                    sBatDauTinhDiTre = dtCaLamViecPhanTheoGio.Rows[iCaLamViecPhanTheoGio]["BatDauTinhDiTre"].ToString();
                                                                    iChoPhepDiTre = Convert.ToInt32(dtCaLamViecPhanTheoGio.Rows[iCaLamViecPhanTheoGio]["ChoPhepDiTre"].ToString());
                                                                    value = dGioVaoPhanTheoGio - dGioVaoKhaiBaoPhanTheoGioB;
                                                                    second = Convert.ToInt32(value.TotalMinutes);
                                                                    sPhutTre = second.ToString();
                                                                    if (!(sTruGioDiTre == "True"))
                                                                    {
                                                                        this.DGVTinhCong.Rows[addPhanTheoGio].Cells[9].Value = "0";
                                                                    }
                                                                    else if (Convert.ToInt32(sPhutTre) >= 0)
                                                                    {
                                                                        iPhutTre = Convert.ToInt32(sPhutTre) - iChoPhepDiTre;
                                                                        if (sBatDauTinhDiTre == "True")
                                                                        {
                                                                            if (iPhutTre >= 1)
                                                                            {
                                                                                this.DGVTinhCong.Rows[addPhanTheoGio].Cells[9].Value = iPhutTre.ToString();
                                                                            }
                                                                            else
                                                                            {
                                                                                this.DGVTinhCong.Rows[addPhanTheoGio].Cells[9].Value = "0";
                                                                            }
                                                                        }
                                                                        else if (iPhutTre >= 1)
                                                                        {
                                                                            this.DGVTinhCong.Rows[addPhanTheoGio].Cells[9].Value = sPhutTre;
                                                                        }
                                                                        else
                                                                        {
                                                                            this.DGVTinhCong.Rows[addPhanTheoGio].Cells[9].Value = "0";
                                                                        }
                                                                    }
                                                                    else
                                                                    {
                                                                        this.DGVTinhCong.Rows[addPhanTheoGio].Cells[9].Value = "0";
                                                                    }
                                                                    sTruGioVeSom = dtCaLamViecPhanTheoGio.Rows[iCaLamViecPhanTheoGio]["TruGioVeSom"].ToString();
                                                                    sBatDauTinhVeSom = dtCaLamViecPhanTheoGio.Rows[iCaLamViecPhanTheoGio]["BatDauTinhVeSom"].ToString();
                                                                    iChoPhepVeSom = Convert.ToInt32(dtCaLamViecPhanTheoGio.Rows[iCaLamViecPhanTheoGio]["ChoPhepVeSom"].ToString());
                                                                    value = dGioRaKhaiBaoPhanTheoGioB - dGioRaPhanTheoGio;
                                                                    second = Convert.ToInt32(value.TotalMinutes);
                                                                    sPhutVeSom = second.ToString();
                                                                    if (!(sTruGioVeSom == "True"))
                                                                    {
                                                                        this.DGVTinhCong.Rows[addPhanTheoGio].Cells[10].Value = "0";
                                                                    }
                                                                    else if (Convert.ToInt32(sPhutVeSom) >= 0)
                                                                    {
                                                                        iPhutVeSom = Convert.ToInt32(sPhutVeSom) - iChoPhepVeSom;
                                                                        if (iPhutVeSom < 1)
                                                                        {
                                                                            this.DGVTinhCong.Rows[addPhanTheoGio].Cells[10].Value = "0";
                                                                        }
                                                                        else if (!(sBatDauTinhVeSom == "True"))
                                                                        {
                                                                            this.DGVTinhCong.Rows[addPhanTheoGio].Cells[10].Value = sPhutVeSom;
                                                                        }
                                                                        else
                                                                        {
                                                                            this.DGVTinhCong.Rows[addPhanTheoGio].Cells[10].Value = iPhutVeSom.ToString();
                                                                        }
                                                                    }
                                                                    else
                                                                    {
                                                                        this.DGVTinhCong.Rows[addPhanTheoGio].Cells[10].Value = "0";
                                                                    }
                                                                    value = dGioRaPhanTheoGio - dGioRaKhaiBaoPhanTheoGioB;
                                                                    second = Convert.ToInt32(value.TotalMinutes);
                                                                    sVeTre = second.ToString();
                                                                    if (Convert.ToInt32(sVeTre) <= 0)
                                                                    {
                                                                        this.DGVTinhCong.Rows[addPhanTheoGio].Cells[11].Value = "0";
                                                                    }
                                                                    else
                                                                    {
                                                                        this.DGVTinhCong.Rows[addPhanTheoGio].Cells[11].Value = sVeTre;
                                                                    }
                                                                    iPhut = Convert.ToSingle(dtCaLamViecPhanTheoGio.Rows[iCaLamViecPhanTheoGio]["TongGioTrongCaLamViec"]) * 60f - (float)(Convert.ToInt32(this.DGVTinhCong.Rows[addPhanTheoGio].Cells[9].Value.ToString()) + Convert.ToInt32(this.DGVTinhCong.Rows[addPhanTheoGio].Cells[10].Value));
                                                                    dGio = Math.Round(Convert.ToDouble(iPhut) / 60, this.iLamTronGio);
                                                                    this.DGVTinhCong.Rows[addPhanTheoGio].Cells[8].Value = dGio * this.dTangCaChuNhatHeSo;
                                                                    iGio = Convert.ToDouble(dtCaLamViecPhanTheoGio.Rows[iCaLamViecPhanTheoGio]["TongGioTrongCaLamViec"].ToString());
                                                                    dCongTinh = Convert.ToDouble(dtCaLamViecPhanTheoGio.Rows[iCaLamViecPhanTheoGio]["CongTinh"].ToString());
                                                                    dCong = Math.Round(dGio * dCongTinh / iGio, this.iLamTronCong);
                                                                    this.DGVTinhCong.Rows[addPhanTheoGio].Cells[7].Value = dCong * this.dTangCaChuNhatHeSo;
                                                                    sTangCaTruocGioLamViec = dtCaLamViecPhanTheoGio.Rows[iCaLamViecPhanTheoGio]["TangCaTruocGioLamViec"].ToString();
                                                                    sTangCaSauGioLamViec = dtCaLamViecPhanTheoGio.Rows[iCaLamViecPhanTheoGio]["TangCaSauGioLamViec"].ToString();
                                                                    if ((sTangCaTruocGioLamViec != "False" ? false : sTangCaSauGioLamViec == "False"))
                                                                    {
                                                                        this.DGVTinhCong.Rows[addPhanTheoGio].Cells[12].Value = "0";
                                                                        this.DGVTinhCong.Rows[addPhanTheoGio].Cells[13].Value = "0";
                                                                        this.DGVTinhCong.Rows[addPhanTheoGio].Cells[14].Value = "0";
                                                                        this.DGVTinhCong.Rows[addPhanTheoGio].Cells[15].Value = "0";
                                                                    }
                                                                    if (sXemCaNayLaTangCa == "True")
                                                                    {
                                                                        if (iTangCaMuc == 1)
                                                                        {
                                                                            this.DGVTinhCong.Rows[addPhanTheoGio].Cells[7].Value = "0";
                                                                            this.DGVTinhCong.Rows[addPhanTheoGio].Cells[8].Value = "0";
                                                                            this.DGVTinhCong.Rows[addPhanTheoGio].Cells[12].Value = dGio.ToString();
                                                                            this.DGVTinhCong.Rows[addPhanTheoGio].Cells[13].Value = "0";
                                                                            this.DGVTinhCong.Rows[addPhanTheoGio].Cells[14].Value = "0";
                                                                            this.DGVTinhCong.Rows[addPhanTheoGio].Cells[15].Value = "0";
                                                                        }
                                                                        if (iTangCaMuc == 2)
                                                                        {
                                                                            this.DGVTinhCong.Rows[addPhanTheoGio].Cells[7].Value = "0";
                                                                            this.DGVTinhCong.Rows[addPhanTheoGio].Cells[8].Value = "0";
                                                                            this.DGVTinhCong.Rows[addPhanTheoGio].Cells[12].Value = "0";
                                                                            this.DGVTinhCong.Rows[addPhanTheoGio].Cells[13].Value = dGio.ToString();
                                                                            this.DGVTinhCong.Rows[addPhanTheoGio].Cells[14].Value = "0";
                                                                            this.DGVTinhCong.Rows[addPhanTheoGio].Cells[15].Value = "0";
                                                                        }
                                                                        if (iTangCaMuc == 3)
                                                                        {
                                                                            this.DGVTinhCong.Rows[addPhanTheoGio].Cells[7].Value = "0";
                                                                            this.DGVTinhCong.Rows[addPhanTheoGio].Cells[8].Value = "0";
                                                                            this.DGVTinhCong.Rows[addPhanTheoGio].Cells[12].Value = "0";
                                                                            this.DGVTinhCong.Rows[addPhanTheoGio].Cells[13].Value = "0";
                                                                            this.DGVTinhCong.Rows[addPhanTheoGio].Cells[14].Value = dGio.ToString();
                                                                            this.DGVTinhCong.Rows[addPhanTheoGio].Cells[15].Value = "0";
                                                                        }
                                                                        if (iTangCaMuc == 4)
                                                                        {
                                                                            this.DGVTinhCong.Rows[addPhanTheoGio].Cells[7].Value = "0";
                                                                            this.DGVTinhCong.Rows[addPhanTheoGio].Cells[8].Value = "0";
                                                                            this.DGVTinhCong.Rows[addPhanTheoGio].Cells[12].Value = "0";
                                                                            this.DGVTinhCong.Rows[addPhanTheoGio].Cells[13].Value = "0";
                                                                            this.DGVTinhCong.Rows[addPhanTheoGio].Cells[14].Value = "0";
                                                                            this.DGVTinhCong.Rows[addPhanTheoGio].Cells[15].Value = dGio.ToString();
                                                                        }
                                                                    }
                                                                    sChoPhepTangCaTruocGioLamViecPhanTheoGio = dtCaLamViecPhanTheoGio.Rows[iCaLamViecPhanTheoGio]["TangCaTruocGioLamViec"].ToString();
                                                                    iPhutTangCaTruocGioLamViecPhanTheoGio = Convert.ToInt32(dtCaLamViecPhanTheoGio.Rows[iCaLamViecPhanTheoGio]["SoPhutTangCaTruocGioLamViec"].ToString());
                                                                    iPhutTangCaTruocGioLamViecDatDen = Convert.ToInt32(dtCaLamViecPhanTheoGio.Rows[iCaLamViecPhanTheoGio]["TangCaTruocGioLamViecDatDen"].ToString());
                                                                    iPhutTruTangCaTruoc = Convert.ToInt32(dtCaLamViecPhanTheoGio.Rows[iCaLamViecPhanTheoGio]["PhutTruTangCaTruoc"].ToString());
                                                                    sChoPhepTangCaSauGioLamViecPhanTheoGio = dtCaLamViecPhanTheoGio.Rows[iCaLamViecPhanTheoGio]["TangCaSauGioLamViec"].ToString();
                                                                    iPhutTangCaSauGioLamViecPhanTheoGio = Convert.ToInt32(dtCaLamViecPhanTheoGio.Rows[iCaLamViecPhanTheoGio]["SoPhutTangCaSauGioLamViec"].ToString());
                                                                    iPhutTangCaSauGioLamViecDatDen = Convert.ToInt32(dtCaLamViecPhanTheoGio.Rows[iCaLamViecPhanTheoGio]["TangCaSauGioLamViecDatDen"].ToString());
                                                                    iPhutTruTangCaSau = Convert.ToInt32(dtCaLamViecPhanTheoGio.Rows[iCaLamViecPhanTheoGio]["PhutTruTangCaSau"].ToString());
                                                                    iGioiHanTC1PhanTheoGio = Convert.ToInt32(dtCaLamViecPhanTheoGio.Rows[iCaLamViecPhanTheoGio]["GioiHanTangCa1"].ToString());
                                                                    iGioiHanTC2PhanTheoGio = Convert.ToInt32(dtCaLamViecPhanTheoGio.Rows[iCaLamViecPhanTheoGio]["GioiHanTangCa2"].ToString());
                                                                    iGioiHanTC3PhanTheoGio = Convert.ToInt32(dtCaLamViecPhanTheoGio.Rows[iCaLamViecPhanTheoGio]["GioiHanTangCa3"].ToString());
                                                                    iGioiHanTC4PhanTheoGio = Convert.ToInt32(dtCaLamViecPhanTheoGio.Rows[iCaLamViecPhanTheoGio]["GioiHanTangCa4"].ToString());
                                                                    iTongGioTangCaSauPhanTheoGio = 0;
                                                                    iTongGioTangCaTruocPhanTheoGio = 0;
                                                                    if ((sChoPhepTangCaTruocGioLamViecPhanTheoGio != "False" ? true : !(sChoPhepTangCaSauGioLamViecPhanTheoGio == "False")))
                                                                    {
                                                                        if (sChoPhepTangCaTruocGioLamViecPhanTheoGio == "True")
                                                                        {
                                                                            value = dGioVaoKhaiBaoPhanTheoGioB - dGioVaoPhanTheoGio;
                                                                            second = Convert.ToInt32(value.TotalMinutes);
                                                                            iThoiGianTruocGioLamPhanTheoGio = Convert.ToInt32(second.ToString());
                                                                            if (iThoiGianTruocGioLamPhanTheoGio > 0)
                                                                            {
                                                                                if (iThoiGianTruocGioLamPhanTheoGio > iPhutTangCaTruocGioLamViecPhanTheoGio)
                                                                                {
                                                                                    if (iThoiGianTruocGioLamPhanTheoGio > iPhutTangCaTruocGioLamViecDatDen)
                                                                                    {
                                                                                        iTongGioTangCaTruocPhanTheoGio = iThoiGianTruocGioLamPhanTheoGio - iPhutTruTangCaTruoc;
                                                                                    }
                                                                                }
                                                                            }
                                                                        }
                                                                        if (sChoPhepTangCaSauGioLamViecPhanTheoGio == "True")
                                                                        {
                                                                            value = dGioRaPhanTheoGio - dGioRaKhaiBaoPhanTheoGioB;
                                                                            second = Convert.ToInt32(value.TotalMinutes);
                                                                            iThoiGianSauGioLamViecPhanTheoGio = Convert.ToInt32(second.ToString());
                                                                            if (iThoiGianSauGioLamViecPhanTheoGio > 0)
                                                                            {
                                                                                if (iThoiGianSauGioLamViecPhanTheoGio > iPhutTangCaSauGioLamViecPhanTheoGio)
                                                                                {
                                                                                    if (iThoiGianSauGioLamViecPhanTheoGio > iPhutTangCaSauGioLamViecDatDen)
                                                                                    {
                                                                                        iTongGioTangCaSauPhanTheoGio = iThoiGianSauGioLamViecPhanTheoGio - iPhutTruTangCaSau;
                                                                                    }
                                                                                }
                                                                            }
                                                                        }
                                                                    }
                                                                    else
                                                                    {
                                                                        this.DGVTinhCong.Rows[addPhanTheoGio].Cells[12].Value = "0";
                                                                        this.DGVTinhCong.Rows[addPhanTheoGio].Cells[13].Value = "0";
                                                                        this.DGVTinhCong.Rows[addPhanTheoGio].Cells[14].Value = "0";
                                                                        this.DGVTinhCong.Rows[addPhanTheoGio].Cells[15].Value = "0";
                                                                    }
                                                                    dTongThoiGianTangCaPhanTheoGio = Convert.ToDouble(iTongGioTangCaTruocPhanTheoGio + iTongGioTangCaSauPhanTheoGio);
                                                                    if (dTongThoiGianTangCaPhanTheoGio <= 0)
                                                                    {
                                                                        this.DGVTinhCong.Rows[addPhanTheoGio].Cells[12].Value = "0";
                                                                        this.DGVTinhCong.Rows[addPhanTheoGio].Cells[13].Value = "0";
                                                                        this.DGVTinhCong.Rows[addPhanTheoGio].Cells[14].Value = "0";
                                                                        this.DGVTinhCong.Rows[addPhanTheoGio].Cells[15].Value = "0";
                                                                    }
                                                                    else
                                                                    {
                                                                        if (iGioiHanTC1PhanTheoGio == 0)
                                                                        {
                                                                            this.DGVTinhCong.Rows[addPhanTheoGio].Cells[12].Value = Math.Round(dTongThoiGianTangCaPhanTheoGio * this.dTangCa1HeSo / 60, this.iLamTronGio);
                                                                            this.DGVTinhCong.Rows[addPhanTheoGio].Cells[13].Value = "0";
                                                                            this.DGVTinhCong.Rows[addPhanTheoGio].Cells[14].Value = "0";
                                                                            this.DGVTinhCong.Rows[addPhanTheoGio].Cells[15].Value = "0";
                                                                        }
                                                                        if ((iGioiHanTC1PhanTheoGio == 0 ? false : iGioiHanTC2PhanTheoGio == 0))
                                                                        {
                                                                            if (dTongThoiGianTangCaPhanTheoGio >= Convert.ToDouble(iGioiHanTC1PhanTheoGio))
                                                                            {
                                                                                this.DGVTinhCong.Rows[addPhanTheoGio].Cells[12].Value = Math.Round(Convert.ToDouble(iGioiHanTC1PhanTheoGio) / 60 * this.dTangCa1HeSo, this.iLamTronGio);
                                                                                if (dTongThoiGianTangCaPhanTheoGio - Convert.ToDouble(iGioiHanTC1PhanTheoGio) > 0)
                                                                                {
                                                                                    this.DGVTinhCong.Rows[addPhanTheoGio].Cells[13].Value = Math.Round((dTongThoiGianTangCaPhanTheoGio - Convert.ToDouble(iGioiHanTC1PhanTheoGio)) * this.dTangCa2HeSo / 60, this.iLamTronGio);
                                                                                }
                                                                                this.DGVTinhCong.Rows[addPhanTheoGio].Cells[14].Value = "0";
                                                                                this.DGVTinhCong.Rows[addPhanTheoGio].Cells[15].Value = "0";
                                                                            }
                                                                            else
                                                                            {
                                                                                this.DGVTinhCong.Rows[addPhanTheoGio].Cells[12].Value = Math.Round(dTongThoiGianTangCaPhanTheoGio * this.dTangCa1HeSo / 60, this.iLamTronGio);
                                                                                this.DGVTinhCong.Rows[addPhanTheoGio].Cells[13].Value = "0";
                                                                                this.DGVTinhCong.Rows[addPhanTheoGio].Cells[14].Value = "0";
                                                                                this.DGVTinhCong.Rows[addPhanTheoGio].Cells[15].Value = "0";
                                                                            }
                                                                        }
                                                                        if ((iGioiHanTC1PhanTheoGio == 0 || iGioiHanTC2PhanTheoGio == 0 ? false : iGioiHanTC3PhanTheoGio == 0))
                                                                        {
                                                                            if (dTongThoiGianTangCaPhanTheoGio >= Convert.ToDouble(iGioiHanTC1PhanTheoGio))
                                                                            {
                                                                                this.DGVTinhCong.Rows[addPhanTheoGio].Cells[12].Value = Math.Round(Convert.ToDouble(iGioiHanTC1PhanTheoGio) * this.dTangCa1HeSo / 60, this.iLamTronGio);
                                                                                if (dTongThoiGianTangCaPhanTheoGio - Convert.ToDouble(iGioiHanTC1PhanTheoGio) >= Convert.ToDouble(iGioiHanTC2PhanTheoGio))
                                                                                {
                                                                                    this.DGVTinhCong.Rows[addPhanTheoGio].Cells[12].Value = Math.Round(Convert.ToDouble(iGioiHanTC1PhanTheoGio) * this.dTangCa1HeSo / 60, this.iLamTronGio);
                                                                                    this.DGVTinhCong.Rows[addPhanTheoGio].Cells[13].Value = Math.Round(Convert.ToDouble(iGioiHanTC2PhanTheoGio) * this.dTangCa2HeSo / 60, this.iLamTronGio);
                                                                                    this.DGVTinhCong.Rows[addPhanTheoGio].Cells[14].Value = Math.Round((dTongThoiGianTangCaPhanTheoGio - Convert.ToDouble(iGioiHanTC1PhanTheoGio) - Convert.ToDouble(iGioiHanTC2PhanTheoGio)) * this.dTangCa3HeSo / 60, this.iLamTronGio);
                                                                                    this.DGVTinhCong.Rows[addPhanTheoGio].Cells[15].Value = "0";
                                                                                }
                                                                                else
                                                                                {
                                                                                    this.DGVTinhCong.Rows[addPhanTheoGio].Cells[13].Value = Math.Round((dTongThoiGianTangCaPhanTheoGio - Convert.ToDouble(iGioiHanTC1PhanTheoGio)) * this.dTangCa2HeSo / 60, this.iLamTronGio);
                                                                                    this.DGVTinhCong.Rows[addPhanTheoGio].Cells[14].Value = "0";
                                                                                    this.DGVTinhCong.Rows[addPhanTheoGio].Cells[15].Value = "0";
                                                                                }
                                                                            }
                                                                            else
                                                                            {
                                                                                this.DGVTinhCong.Rows[addPhanTheoGio].Cells[12].Value = Math.Round(dTongThoiGianTangCaPhanTheoGio * this.dTangCa1HeSo / 60, this.iLamTronGio);
                                                                                this.DGVTinhCong.Rows[addPhanTheoGio].Cells[13].Value = "0";
                                                                                this.DGVTinhCong.Rows[addPhanTheoGio].Cells[14].Value = "0";
                                                                                this.DGVTinhCong.Rows[addPhanTheoGio].Cells[15].Value = "0";
                                                                            }
                                                                        }
                                                                        if ((iGioiHanTC1PhanTheoGio == 0 || iGioiHanTC2PhanTheoGio == 0 || iGioiHanTC3PhanTheoGio == 0 ? false : iGioiHanTC4PhanTheoGio == 0))
                                                                        {
                                                                        }
                                                                    }
                                                                    value = dGioRaPhanTheoGio - dGioVaoPhanTheoGio;
                                                                    second = Convert.ToInt32(value.TotalMinutes);
                                                                    num = Math.Round(Convert.ToDouble(second.ToString()) / 60, this.iLamTronGio);
                                                                    sTongGio = num.ToString();
                                                                    this.DGVTinhCong.Rows[addPhanTheoGio].Cells[16].Value = Convert.ToDouble(sTongGio) * this.dTangCaChuNhatHeSo;
                                                                    this.DGVTinhCong.Rows[addPhanTheoGio].Cells[17].Value = Convert.ToDouble(dtCaLamViecPhanTheoGio.Rows[iCaLamViecPhanTheoGio]["CongTinh"].ToString()) * this.dTangCaChuNhatHeSo;
                                                                    this.DGVTinhCong.Rows[addPhanTheoGio].Cells[18].Value = this.sKHDungGio;
                                                                }
                                                                else
                                                                {
                                                                    sTruGioDiTre = dtCaLamViecPhanTheoGio.Rows[iCaLamViecPhanTheoGio]["TruGioDiTre"].ToString();
                                                                    sBatDauTinhDiTre = dtCaLamViecPhanTheoGio.Rows[iCaLamViecPhanTheoGio]["BatDauTinhDiTre"].ToString();
                                                                    iChoPhepDiTre = Convert.ToInt32(dtCaLamViecPhanTheoGio.Rows[iCaLamViecPhanTheoGio]["ChoPhepDiTre"].ToString());
                                                                    value = dGioVaoPhanTheoGio - dGioVaoKhaiBaoPhanTheoGioB;
                                                                    second = Convert.ToInt32(value.TotalMinutes);
                                                                    sPhutTre = second.ToString();
                                                                    if (Convert.ToInt32(sPhutTre) < 0)
                                                                    {
                                                                        sPhutTre = "0";
                                                                    }
                                                                    sTruGioVeSom = dtCaLamViecPhanTheoGio.Rows[iCaLamViecPhanTheoGio]["TruGioVeSom"].ToString();
                                                                    sBatDauTinhVeSom = dtCaLamViecPhanTheoGio.Rows[iCaLamViecPhanTheoGio]["BatDauTinhVeSom"].ToString();
                                                                    iChoPhepVeSom = Convert.ToInt32(dtCaLamViecPhanTheoGio.Rows[iCaLamViecPhanTheoGio]["ChoPhepVeSom"].ToString());
                                                                    value = dGioRaKhaiBaoPhanTheoGioB - dGioRaPhanTheoGio;
                                                                    second = Convert.ToInt32(value.TotalMinutes);
                                                                    sPhutVeSom = second.ToString();
                                                                    if (Convert.ToInt32(sPhutVeSom) < 0)
                                                                    {
                                                                        sPhutVeSom = "0";
                                                                    }
                                                                    dTongPhutTangCaPhanTheoGioA = Convert.ToDouble(dtCaLamViecPhanTheoGio.Rows[iCaLamViecPhanTheoGio]["TongGioTrongCaLamViec"]) * 60 - (Convert.ToDouble(sPhutTre) + Convert.ToDouble(sPhutVeSom));
                                                                    dTongGioTangCaPhanTheoGioA = Math.Round(dTongPhutTangCaPhanTheoGioA / 60, this.iLamTronGio);
                                                                    if (iTangCaChuNhatMuc == 1)
                                                                    {
                                                                        this.DGVTinhCong.Rows[addPhanTheoGio].Cells[12].Value = dTongGioTangCaPhanTheoGioA * this.dTangCaChuNhatHeSo;
                                                                        this.DGVTinhCong.Rows[addPhanTheoGio].Cells[18].Value = this.sKHDungGio;
                                                                    }
                                                                    if (iTangCaChuNhatMuc == 2)
                                                                    {
                                                                        this.DGVTinhCong.Rows[addPhanTheoGio].Cells[13].Value = dTongGioTangCaPhanTheoGioA * this.dTangCaChuNhatHeSo;
                                                                        this.DGVTinhCong.Rows[addPhanTheoGio].Cells[18].Value = this.sKHDungGio;
                                                                    }
                                                                    if (iTangCaChuNhatMuc == 3)
                                                                    {
                                                                        this.DGVTinhCong.Rows[addPhanTheoGio].Cells[14].Value = dTongGioTangCaPhanTheoGioA * this.dTangCaChuNhatHeSo;
                                                                        this.DGVTinhCong.Rows[addPhanTheoGio].Cells[18].Value = this.sKHDungGio;
                                                                    }
                                                                    if (iTangCaChuNhatMuc == 4)
                                                                    {
                                                                        this.DGVTinhCong.Rows[addPhanTheoGio].Cells[15].Value = dTongGioTangCaPhanTheoGioA * this.dTangCaChuNhatHeSo;
                                                                        this.DGVTinhCong.Rows[addPhanTheoGio].Cells[18].Value = this.sKHDungGio;
                                                                    }
                                                                }
                                                                if (!(DateTimeProgress.XuatIDThu((int)dt.AddDays((double)dem).DayOfWeek) == "0"))
                                                                {
                                                                    this.DGVTinhCong.Rows[addPhanTheoGio].Cells[19].Value = "NT";
                                                                }
                                                                else
                                                                {
                                                                    this.DGVTinhCong.Rows[addPhanTheoGio].Cells[19].Value = "CN";
                                                                }
                                                                this.DGVTinhCong.Rows[addPhanTheoGio].Cells[20].Value = this.sMaChamCong;
                                                                this.DGVTinhCong.Rows[addPhanTheoGio].Cells[21].Value = this.sPhongBanTinhCong;
                                                            }
                                                        }
                                                    Label23:
                                                        if (iCaTrongLIchtrinh == 0)
                                                        {
                                                            this.DGVTinhCong.Rows[addPhanTheoGio].Cells[4].Value = "***";
                                                            this.DGVTinhCong.Rows[addPhanTheoGio].Cells[7].Value = "0";
                                                            this.DGVTinhCong.Rows[addPhanTheoGio].Cells[8].Value = "0";
                                                            this.DGVTinhCong.Rows[addPhanTheoGio].Cells[9].Value = "0";
                                                            this.DGVTinhCong.Rows[addPhanTheoGio].Cells[10].Value = "0";
                                                            this.DGVTinhCong.Rows[addPhanTheoGio].Cells[11].Value = "0";
                                                            this.DGVTinhCong.Rows[addPhanTheoGio].Cells[12].Value = "0";
                                                            this.DGVTinhCong.Rows[addPhanTheoGio].Cells[13].Value = "0";
                                                            this.DGVTinhCong.Rows[addPhanTheoGio].Cells[14].Value = "0";
                                                            this.DGVTinhCong.Rows[addPhanTheoGio].Cells[15].Value = "0";
                                                            this.DGVTinhCong.Rows[addPhanTheoGio].Cells[16].Value = "0";
                                                            this.DGVTinhCong.Rows[addPhanTheoGio].Cells[17].Value = "0";
                                                            this.DGVTinhCong.Rows[addPhanTheoGio].Cells[18].Value = this.sKHVang;
                                                            if (!(DateTimeProgress.XuatIDThu((int)dt.AddDays((double)dem).DayOfWeek) == "0"))
                                                            {
                                                                this.DGVTinhCong.Rows[addPhanTheoGio].Cells[19].Value = "NT";
                                                            }
                                                            else
                                                            {
                                                                this.DGVTinhCong.Rows[addPhanTheoGio].Cells[19].Value = "CN";
                                                            }
                                                            this.DGVTinhCong.Rows[addPhanTheoGio].Cells[20].Value = this.sMaChamCong;
                                                            this.DGVTinhCong.Rows[addPhanTheoGio].Cells[21].Value = this.sPhongBanTinhCong;
                                                        }
                                                        break;
                                                    }
                                                    else if (iKiemTraLanCham == 3)
                                                    {
                                                        int addPhanTheoGioB = this.DGVTinhCong.Rows.Add();
                                                        dGioRaPhanTheoGio = dGioChamPhanTheoGio;
                                                        this.DGVTinhCong.Rows[addPhanTheoGioB].Cells[6].Value = string.Format(this.sDinhDangThoiGian, dGioRaPhanTheoGio);
                                                        this.DGVTinhCong.Rows[addPhanTheoGioB].Cells[0].Value = this.sMaNhanVien;
                                                        this.DGVTinhCong.Rows[addPhanTheoGioB].Cells[1].Value = this.sTenNhanVien;
                                                        this.DGVTinhCong.Rows[addPhanTheoGioB].Cells[2].Value = this.DGVTinhCong.Rows[_nhanVien].Cells[2].Value.ToString();
                                                        this.DGVTinhCong.Rows[addPhanTheoGioB].Cells[4].Value = "***";
                                                        this.DGVTinhCong.Rows[addPhanTheoGioB].Cells[7].Value = "0";
                                                        this.DGVTinhCong.Rows[addPhanTheoGioB].Cells[8].Value = "0";
                                                        this.DGVTinhCong.Rows[addPhanTheoGioB].Cells[9].Value = "0";
                                                        this.DGVTinhCong.Rows[addPhanTheoGioB].Cells[10].Value = "0";
                                                        this.DGVTinhCong.Rows[addPhanTheoGioB].Cells[11].Value = "0";
                                                        this.DGVTinhCong.Rows[addPhanTheoGioB].Cells[12].Value = "0";
                                                        this.DGVTinhCong.Rows[addPhanTheoGioB].Cells[13].Value = "0";
                                                        this.DGVTinhCong.Rows[addPhanTheoGioB].Cells[14].Value = "0";
                                                        this.DGVTinhCong.Rows[addPhanTheoGioB].Cells[15].Value = "0";
                                                        this.DGVTinhCong.Rows[addPhanTheoGioB].Cells[16].Value = "0";
                                                        this.DGVTinhCong.Rows[addPhanTheoGioB].Cells[17].Value = "0";
                                                        this.DGVTinhCong.Rows[addPhanTheoGioB].Cells[18].Value = this.sKHVang;
                                                        if (this.iNgonNgu == 0)
                                                        {
                                                            DataGridViewCell item8 = this.DGVTinhCong.Rows[addPhanTheoGioB].Cells[3];
                                                            dateTime = dt.AddDays((double)dem);
                                                            item8.Value = DateTimeProgress.XuatThuTinhCong((int)dateTime.DayOfWeek);
                                                        }
                                                        if (this.iNgonNgu == 1)
                                                        {
                                                            DataGridViewCell dataGridViewCell8 = this.DGVTinhCong.Rows[addPhanTheoGioB].Cells[3];
                                                            dateTime = dt.AddDays((double)dem);
                                                            dataGridViewCell8.Value = DateTimeProgress.XuatThuEnglish((int)dateTime.DayOfWeek);
                                                        }
                                                        break;
                                                    }
                                                }
                                            }
                                            else if (iKiemTraLanCham == 3)
                                            {
                                                addPhanTheoGio = this.DGVTinhCong.Rows.Add();
                                                dGioVaoPhanTheoGio = dGioChamPhanTheoGio;
                                                this.DGVTinhCong.Rows[addPhanTheoGio].Cells[5].Value = string.Format(this.sDinhDangThoiGian, dGioVaoPhanTheoGio);
                                                this.DGVTinhCong.Rows[addPhanTheoGio].Cells[0].Value = this.sMaNhanVien;
                                                this.DGVTinhCong.Rows[addPhanTheoGio].Cells[1].Value = this.sTenNhanVien;
                                                this.DGVTinhCong.Rows[addPhanTheoGio].Cells[2].Value = this.DGVTinhCong.Rows[_nhanVien].Cells[2].Value.ToString();
                                                this.DGVTinhCong.Rows[addPhanTheoGio].Cells[4].Value = "***";
                                                this.DGVTinhCong.Rows[addPhanTheoGio].Cells[7].Value = "0";
                                                this.DGVTinhCong.Rows[addPhanTheoGio].Cells[8].Value = "0";
                                                this.DGVTinhCong.Rows[addPhanTheoGio].Cells[9].Value = "0";
                                                this.DGVTinhCong.Rows[addPhanTheoGio].Cells[10].Value = "0";
                                                this.DGVTinhCong.Rows[addPhanTheoGio].Cells[11].Value = "0";
                                                this.DGVTinhCong.Rows[addPhanTheoGio].Cells[12].Value = "0";
                                                this.DGVTinhCong.Rows[addPhanTheoGio].Cells[13].Value = "0";
                                                this.DGVTinhCong.Rows[addPhanTheoGio].Cells[14].Value = "0";
                                                this.DGVTinhCong.Rows[addPhanTheoGio].Cells[15].Value = "0";
                                                this.DGVTinhCong.Rows[addPhanTheoGio].Cells[16].Value = "0";
                                                this.DGVTinhCong.Rows[addPhanTheoGio].Cells[17].Value = "0";
                                                this.DGVTinhCong.Rows[addPhanTheoGio].Cells[18].Value = this.sKHVang;
                                                if (this.iNgonNgu == 0)
                                                {
                                                    DataGridViewCell item9 = this.DGVTinhCong.Rows[addPhanTheoGio].Cells[3];
                                                    dateTime = dt.AddDays((double)dem);
                                                    item9.Value = DateTimeProgress.XuatThuTinhCong((int)dateTime.DayOfWeek);
                                                }
                                                if (this.iNgonNgu == 1)
                                                {
                                                    DataGridViewCell dataGridViewCell9 = this.DGVTinhCong.Rows[addPhanTheoGio].Cells[3];
                                                    dateTime = dt.AddDays((double)dem);
                                                    dataGridViewCell9.Value = DateTimeProgress.XuatThuEnglish((int)dateTime.DayOfWeek);
                                                }
                                                if (!(DateTimeProgress.XuatIDThu((int)dt.AddDays((double)dem).DayOfWeek) == "0"))
                                                {
                                                    this.DGVTinhCong.Rows[_nhanVien].Cells[19].Value = "NT";
                                                }
                                                else
                                                {
                                                    this.DGVTinhCong.Rows[_nhanVien].Cells[19].Value = "CN";
                                                }
                                                this.DGVTinhCong.Rows[_nhanVien].Cells[20].Value = this.sMaChamCong;
                                                this.DGVTinhCong.Rows[_nhanVien].Cells[21].Value = this.sPhongBanTinhCong;
                                                iKiemTraLanCham = 2;
                                                break;
                                            }
                                            else if (iKiemTraLanCham == 0)
                                            {
                                                dGioVaoPhanTheoGio = dGioChamPhanTheoGio;
                                                this.DGVTinhCong.Rows[_nhanVien].Cells[5].Value = string.Format(this.sDinhDangThoiGian, dGioVaoPhanTheoGio);
                                                this.DGVTinhCong.Rows[_nhanVien].Cells[0].Value = this.sMaNhanVien;
                                                this.DGVTinhCong.Rows[_nhanVien].Cells[1].Value = this.sTenNhanVien;
                                                this.DGVTinhCong.Rows[_nhanVien].Cells[2].Value = this.DGVTinhCong.Rows[_nhanVien].Cells[2].Value.ToString();
                                                this.DGVTinhCong.Rows[_nhanVien].Cells[4].Value = "***";
                                                this.DGVTinhCong.Rows[_nhanVien].Cells[7].Value = "0";
                                                this.DGVTinhCong.Rows[_nhanVien].Cells[8].Value = "0";
                                                this.DGVTinhCong.Rows[_nhanVien].Cells[9].Value = "0";
                                                this.DGVTinhCong.Rows[_nhanVien].Cells[10].Value = "0";
                                                this.DGVTinhCong.Rows[_nhanVien].Cells[11].Value = "0";
                                                this.DGVTinhCong.Rows[_nhanVien].Cells[12].Value = "0";
                                                this.DGVTinhCong.Rows[_nhanVien].Cells[13].Value = "0";
                                                this.DGVTinhCong.Rows[_nhanVien].Cells[14].Value = "0";
                                                this.DGVTinhCong.Rows[_nhanVien].Cells[15].Value = "0";
                                                this.DGVTinhCong.Rows[_nhanVien].Cells[16].Value = "0";
                                                this.DGVTinhCong.Rows[_nhanVien].Cells[17].Value = "0";
                                                this.DGVTinhCong.Rows[_nhanVien].Cells[18].Value = this.sKHVang;
                                                if (this.iNgonNgu == 0)
                                                {
                                                    DataGridViewCell item10 = this.DGVTinhCong.Rows[_nhanVien].Cells[3];
                                                    dateTime = dt.AddDays((double)dem);
                                                    item10.Value = DateTimeProgress.XuatThuTinhCong((int)dateTime.DayOfWeek);
                                                }
                                                if (this.iNgonNgu == 1)
                                                {
                                                    DataGridViewCell dataGridViewCell10 = this.DGVTinhCong.Rows[_nhanVien].Cells[3];
                                                    dateTime = dt.AddDays((double)dem);
                                                    dataGridViewCell10.Value = DateTimeProgress.XuatThuEnglish((int)dateTime.DayOfWeek);
                                                }
                                                if (!(DateTimeProgress.XuatIDThu((int)dt.AddDays((double)dem).DayOfWeek) == "0"))
                                                {
                                                    this.DGVTinhCong.Rows[_nhanVien].Cells[19].Value = "NT";
                                                }
                                                else
                                                {
                                                    this.DGVTinhCong.Rows[_nhanVien].Cells[19].Value = "CN";
                                                }
                                                this.DGVTinhCong.Rows[_nhanVien].Cells[20].Value = this.sMaChamCong;
                                                this.DGVTinhCong.Rows[_nhanVien].Cells[21].Value = this.sPhongBanTinhCong;
                                                iKiemTraLanCham = 1;
                                                break;
                                            }
                                            else if (iKiemTraLanCham == 1)
                                            {
                                                addPhanTheoGio = this.DGVTinhCong.Rows.Add();
                                                dGioVaoPhanTheoGio = dGioChamPhanTheoGio;
                                                this.DGVTinhCong.Rows[addPhanTheoGio].Cells[5].Value = string.Format(this.sDinhDangThoiGian, dGioVaoPhanTheoGio);
                                                this.DGVTinhCong.Rows[addPhanTheoGio].Cells[0].Value = this.sMaNhanVien;
                                                this.DGVTinhCong.Rows[addPhanTheoGio].Cells[1].Value = this.sTenNhanVien;
                                                this.DGVTinhCong.Rows[addPhanTheoGio].Cells[2].Value = this.DGVTinhCong.Rows[_nhanVien].Cells[2].Value.ToString();
                                                this.DGVTinhCong.Rows[addPhanTheoGio].Cells[4].Value = "***";
                                                this.DGVTinhCong.Rows[addPhanTheoGio].Cells[7].Value = "0";
                                                this.DGVTinhCong.Rows[addPhanTheoGio].Cells[8].Value = "0";
                                                this.DGVTinhCong.Rows[addPhanTheoGio].Cells[9].Value = "0";
                                                this.DGVTinhCong.Rows[addPhanTheoGio].Cells[10].Value = "0";
                                                this.DGVTinhCong.Rows[addPhanTheoGio].Cells[11].Value = "0";
                                                this.DGVTinhCong.Rows[addPhanTheoGio].Cells[12].Value = "0";
                                                this.DGVTinhCong.Rows[addPhanTheoGio].Cells[13].Value = "0";
                                                this.DGVTinhCong.Rows[addPhanTheoGio].Cells[14].Value = "0";
                                                this.DGVTinhCong.Rows[addPhanTheoGio].Cells[15].Value = "0";
                                                this.DGVTinhCong.Rows[addPhanTheoGio].Cells[16].Value = "0";
                                                this.DGVTinhCong.Rows[addPhanTheoGio].Cells[17].Value = "0";
                                                this.DGVTinhCong.Rows[addPhanTheoGio].Cells[18].Value = this.sKHVang;
                                                if (this.iNgonNgu == 0)
                                                {
                                                    DataGridViewCell item11 = this.DGVTinhCong.Rows[addPhanTheoGio].Cells[3];
                                                    dateTime = dt.AddDays((double)dem);
                                                    item11.Value = DateTimeProgress.XuatThuTinhCong((int)dateTime.DayOfWeek);
                                                }
                                                if (this.iNgonNgu == 1)
                                                {
                                                    DataGridViewCell dataGridViewCell11 = this.DGVTinhCong.Rows[addPhanTheoGio].Cells[3];
                                                    dateTime = dt.AddDays((double)dem);
                                                    dataGridViewCell11.Value = DateTimeProgress.XuatThuEnglish((int)dateTime.DayOfWeek);
                                                }
                                                if (!(DateTimeProgress.XuatIDThu((int)dt.AddDays((double)dem).DayOfWeek) == "0"))
                                                {
                                                    this.DGVTinhCong.Rows[_nhanVien].Cells[19].Value = "NT";
                                                }
                                                else
                                                {
                                                    this.DGVTinhCong.Rows[_nhanVien].Cells[19].Value = "CN";
                                                }
                                                this.DGVTinhCong.Rows[_nhanVien].Cells[20].Value = this.sMaChamCong;
                                                this.DGVTinhCong.Rows[_nhanVien].Cells[21].Value = this.sPhongBanTinhCong;
                                                iKiemTraLanCham = 2;
                                                break;
                                            }
                                            else if (iKiemTraLanCham == 2)
                                            {
                                                addPhanTheoGio = this.DGVTinhCong.Rows.Add();
                                                dGioVaoPhanTheoGio = dGioChamPhanTheoGio;
                                                this.DGVTinhCong.Rows[addPhanTheoGio].Cells[5].Value = string.Format(this.sDinhDangThoiGian, dGioVaoPhanTheoGio);
                                                this.DGVTinhCong.Rows[addPhanTheoGio].Cells[0].Value = this.sMaNhanVien;
                                                this.DGVTinhCong.Rows[addPhanTheoGio].Cells[1].Value = this.sTenNhanVien;
                                                this.DGVTinhCong.Rows[addPhanTheoGio].Cells[2].Value = this.DGVTinhCong.Rows[_nhanVien].Cells[2].Value.ToString();
                                                this.DGVTinhCong.Rows[addPhanTheoGio].Cells[4].Value = "***";
                                                this.DGVTinhCong.Rows[addPhanTheoGio].Cells[7].Value = "0";
                                                this.DGVTinhCong.Rows[addPhanTheoGio].Cells[8].Value = "0";
                                                this.DGVTinhCong.Rows[addPhanTheoGio].Cells[9].Value = "0";
                                                this.DGVTinhCong.Rows[addPhanTheoGio].Cells[10].Value = "0";
                                                this.DGVTinhCong.Rows[addPhanTheoGio].Cells[11].Value = "0";
                                                this.DGVTinhCong.Rows[addPhanTheoGio].Cells[12].Value = "0";
                                                this.DGVTinhCong.Rows[addPhanTheoGio].Cells[13].Value = "0";
                                                this.DGVTinhCong.Rows[addPhanTheoGio].Cells[14].Value = "0";
                                                this.DGVTinhCong.Rows[addPhanTheoGio].Cells[15].Value = "0";
                                                this.DGVTinhCong.Rows[addPhanTheoGio].Cells[16].Value = "0";
                                                this.DGVTinhCong.Rows[addPhanTheoGio].Cells[17].Value = "0";
                                                this.DGVTinhCong.Rows[addPhanTheoGio].Cells[18].Value = this.sKHVang;
                                                if (this.iNgonNgu == 0)
                                                {
                                                    DataGridViewCell item12 = this.DGVTinhCong.Rows[addPhanTheoGio].Cells[3];
                                                    dateTime = dt.AddDays((double)dem);
                                                    item12.Value = DateTimeProgress.XuatThuTinhCong((int)dateTime.DayOfWeek);
                                                }
                                                if (this.iNgonNgu == 1)
                                                {
                                                    DataGridViewCell dataGridViewCell12 = this.DGVTinhCong.Rows[addPhanTheoGio].Cells[3];
                                                    dateTime = dt.AddDays((double)dem);
                                                    dataGridViewCell12.Value = DateTimeProgress.XuatThuEnglish((int)dateTime.DayOfWeek);
                                                }
                                                if (!(DateTimeProgress.XuatIDThu((int)dt.AddDays((double)dem).DayOfWeek) == "0"))
                                                {
                                                    this.DGVTinhCong.Rows[_nhanVien].Cells[19].Value = "NT";
                                                }
                                                else
                                                {
                                                    this.DGVTinhCong.Rows[_nhanVien].Cells[19].Value = "CN";
                                                }
                                                this.DGVTinhCong.Rows[_nhanVien].Cells[20].Value = this.sMaChamCong;
                                                this.DGVTinhCong.Rows[_nhanVien].Cells[21].Value = this.sPhongBanTinhCong;
                                                iKiemTraLanCham = 2;
                                                break;
                                            }
                                        }
                                        demPhanTheoGio++;
                                   // Label20:
                                    }
                                    if (demPhanTheoGio == 0)
                                    {
                                        this.DGVTinhCong.Rows[_nhanVien].Cells[7].Value = "0";
                                        this.DGVTinhCong.Rows[_nhanVien].Cells[8].Value = "0";
                                        this.DGVTinhCong.Rows[_nhanVien].Cells[17].Value = "0";
                                        this.DGVTinhCong.Rows[_nhanVien].Cells[18].Value = this.sKHVang;
                                        if (!(DateTimeProgress.XuatIDThu((int)dt.AddDays((double)dem).DayOfWeek) == "0"))
                                        {
                                            this.DGVTinhCong.Rows[_nhanVien].Cells[19].Value = "NT";
                                        }
                                        else
                                        {
                                            this.DGVTinhCong.Rows[_nhanVien].Cells[19].Value = "CN";
                                        }
                                        this.DGVTinhCong.Rows[_nhanVien].Cells[20].Value = this.sMaChamCong;
                                        this.DGVTinhCong.Rows[_nhanVien].Cells[21].Value = this.sPhongBanTinhCong;
                                    }
                                }
                                if (iChonLichTrinh == 4)
                                {
                                    iKiemTraLanChamLichTrinhVaoRa = 0;
                                    iKiemTraLanChamKhoangCachTuDongQuaDemLichTrinhVaoRa = 0;
                                    dGioVaoTuDongQuaDemKiemTraLichTrinhVaoRa = new DateTime();
                                    dGioRaTuDongQuaDemKiemTraLichTrinhVaoRa = new DateTime();
                                    iKiemTraLanChamTuDongQuaDemLichTrinhVaoRa = new DateTime();
                                    int iMaSoMay = 0;
                                    iLanCham = 1;
                                    addTheoIDMay = 0;
                                    iKiemTra = 0;
                                    iKiemTraB = 0;
                                    dGioVaoTheoIDMay = new DateTime();
                                    dGioRaTheoIDMay = new DateTime();
                                    dateGioChamTheoIDMay = new DateTime();
                                    dtTheoIDMay = new System.Data.DataTable();
                                    this._checkInOutDTO.MaChamCong = Convert.ToInt32(this.sMaChamCong);
                                    this._checkInOutDTO.NgayCham = Convert.ToDateTime(this.DGVTinhCong.Rows[_nhanVien].Cells[2].Value.ToString());
                                    dtTheoIDMay = this._checkInOutBLL.getCheckInOutByMaChamCongAndNgayCham(this._checkInOutDTO);
                                    for (iTheoIDMay = 0; iTheoIDMay < dtTheoIDMay.Rows.Count; iTheoIDMay++)
                                    {
                                        addGioNguonTuDongQuaDemQuaDem = this.DGVDuLieuChamCongNguon.Rows.Add();
                                        iKiemTraLanChamLichTrinhVaoRa++;
                                        if (iKiemTraLanChamLichTrinhVaoRa == 1)
                                        {
                                            dGioVaoTuDongQuaDemKiemTraLichTrinhVaoRa = Convert.ToDateTime(dtTheoIDMay.Rows[iTheoIDMay]["GioCham"].ToString());
                                            if ((dtTheoIDMay.Rows.Count <= 2 ? true : iKiemTraLanChamKhoangCachTuDongQuaDemLichTrinhVaoRa != 3))
                                            {
                                                this.DGVDuLieuChamCongNguon.Rows[addGioNguonTuDongQuaDemQuaDem].Cells[0].Value = this.sMaChamCong;
                                                this.DGVDuLieuChamCongNguon.Rows[addGioNguonTuDongQuaDemQuaDem].Cells[1].Value = string.Format("{0:d}", dGioVaoTuDongQuaDemKiemTraLichTrinhVaoRa);
                                                this.DGVDuLieuChamCongNguon.Rows[addGioNguonTuDongQuaDemQuaDem].Cells[2].Value = dGioVaoTuDongQuaDemKiemTraLichTrinhVaoRa;
                                                this.DGVDuLieuChamCongNguon.Rows[addGioNguonTuDongQuaDemQuaDem].Cells[3].Value = "Vào";
                                                this.DGVDuLieuChamCongNguon.Rows[addGioNguonTuDongQuaDemQuaDem].Cells[4].Value = "I";
                                                this.DGVDuLieuChamCongNguon.Rows[addGioNguonTuDongQuaDemQuaDem].Cells[6].Value = dtTheoIDMay.Rows[iTheoIDMay]["MaSoMay"].ToString();
                                            }
                                            else
                                            {
                                                if (Convert.ToInt32(Convert.ToInt32((dGioVaoTuDongQuaDemKiemTraLichTrinhVaoRa - dGioRaTuDongQuaDemKiemTraLichTrinhVaoRa).TotalMinutes).ToString()) < iKhoangCachGiuaHaiCapVaoRa)
                                                {
                                                    goto Label28;
                                                }
                                                this.DGVDuLieuChamCongNguon.Rows[addGioNguonTuDongQuaDemQuaDem].Cells[0].Value = this.sMaChamCong;
                                                this.DGVDuLieuChamCongNguon.Rows[addGioNguonTuDongQuaDemQuaDem].Cells[1].Value = string.Format("{0:d}", dGioVaoTuDongQuaDemKiemTraLichTrinhVaoRa);
                                                this.DGVDuLieuChamCongNguon.Rows[addGioNguonTuDongQuaDemQuaDem].Cells[2].Value = dGioVaoTuDongQuaDemKiemTraLichTrinhVaoRa;
                                                this.DGVDuLieuChamCongNguon.Rows[addGioNguonTuDongQuaDemQuaDem].Cells[3].Value = "Vào";
                                                this.DGVDuLieuChamCongNguon.Rows[addGioNguonTuDongQuaDemQuaDem].Cells[4].Value = "I";
                                                this.DGVDuLieuChamCongNguon.Rows[addGioNguonTuDongQuaDemQuaDem].Cells[6].Value = dtTheoIDMay.Rows[iTheoIDMay]["MaSoMay"].ToString();
                                                iKiemTraLanChamLichTrinhVaoRa = 1;
                                            }
                                        }
                                        if (iKiemTraLanChamLichTrinhVaoRa == 2)
                                        {
                                            dGioRaTuDongQuaDemKiemTraLichTrinhVaoRa = Convert.ToDateTime(dtTheoIDMay.Rows[iTheoIDMay]["GioCham"].ToString());
                                            if (Convert.ToInt32(Convert.ToInt32((dGioRaTuDongQuaDemKiemTraLichTrinhVaoRa - dGioVaoTuDongQuaDemKiemTraLichTrinhVaoRa).TotalMinutes).ToString()) < iThoiGianNhoNhat)
                                            {
                                                goto Label29;
                                            }
                                            iKiemTraLanChamLichTrinhVaoRa = 0;
                                            iKiemTraLanChamKhoangCachTuDongQuaDemLichTrinhVaoRa = 3;
                                            this.DGVDuLieuChamCongNguon.Rows[addGioNguonTuDongQuaDemQuaDem].Cells[0].Value = this.sMaChamCong;
                                            this.DGVDuLieuChamCongNguon.Rows[addGioNguonTuDongQuaDemQuaDem].Cells[1].Value = string.Format("{0:d}", dGioRaTuDongQuaDemKiemTraLichTrinhVaoRa);
                                            this.DGVDuLieuChamCongNguon.Rows[addGioNguonTuDongQuaDemQuaDem].Cells[2].Value = dGioRaTuDongQuaDemKiemTraLichTrinhVaoRa;
                                            this.DGVDuLieuChamCongNguon.Rows[addGioNguonTuDongQuaDemQuaDem].Cells[3].Value = "Ra";
                                            this.DGVDuLieuChamCongNguon.Rows[addGioNguonTuDongQuaDemQuaDem].Cells[4].Value = "O";
                                            this.DGVDuLieuChamCongNguon.Rows[addGioNguonTuDongQuaDemQuaDem].Cells[6].Value = dtTheoIDMay.Rows[iTheoIDMay]["MaSoMay"].ToString();
                                        }
                                        dateGioChamTheoIDMay = Convert.ToDateTime(dtTheoIDMay.Rows[iTheoIDMay]["GioCham"].ToString());
                                        iMaSoMay = Convert.ToInt32(dtTheoIDMay.Rows[iTheoIDMay]["MaSoMay"].ToString());
                                        if (!(iMaSoMay == 1 || iMaSoMay == 3 || iMaSoMay == 5 || iMaSoMay == 7 ? false : iMaSoMay != 9))
                                        {
                                            if (iLanCham != 1)
                                            {
                                                addTheoIDMay = this.DGVTinhCong.Rows.Add();
                                                dGioVaoTheoIDMay = Convert.ToDateTime(dateGioChamTheoIDMay.ToString());
                                                this.DGVTinhCong.Rows[addTheoIDMay].Cells[5].Value = string.Format(this.sDinhDangThoiGian, dGioVaoTheoIDMay);
                                                iKiemTraB = 1;
                                                this.DGVTinhCong.Rows[addTheoIDMay].Cells[0].Value = this.sMaNhanVien;
                                                this.DGVTinhCong.Rows[addTheoIDMay].Cells[1].Value = this.sTenNhanVien;
                                                this.DGVTinhCong.Rows[addTheoIDMay].Cells[2].Value = this.DGVTinhCong.Rows[_nhanVien].Cells[2].Value.ToString();
                                                this.DGVTinhCong.Rows[addTheoIDMay].Cells[4].Value = "***";
                                                this.DGVTinhCong.Rows[addTheoIDMay].Cells[7].Value = "0";
                                                this.DGVTinhCong.Rows[addTheoIDMay].Cells[8].Value = "0";
                                                if (this.iNgonNgu == 0)
                                                {
                                                    DataGridViewCell item13 = this.DGVTinhCong.Rows[addTheoIDMay].Cells[3];
                                                    dateTime = dt.AddDays((double)dem);
                                                    item13.Value = DateTimeProgress.XuatThuTinhCong((int)dateTime.DayOfWeek);
                                                }
                                                if (this.iNgonNgu == 1)
                                                {
                                                    DataGridViewCell dataGridViewCell13 = this.DGVTinhCong.Rows[addTheoIDMay].Cells[3];
                                                    dateTime = dt.AddDays((double)dem);
                                                    dataGridViewCell13.Value = DateTimeProgress.XuatThuEnglish((int)dateTime.DayOfWeek);
                                                }
                                                this.DGVTinhCong.Rows[addTheoIDMay].Cells[17].Value = "0";
                                                this.DGVTinhCong.Rows[addTheoIDMay].Cells[18].Value = this.sKHVang;
                                                if (!(DateTimeProgress.XuatIDThu((int)dt.AddDays((double)dem).DayOfWeek) == "0"))
                                                {
                                                    this.DGVTinhCong.Rows[addTheoIDMay].Cells[19].Value = "NT";
                                                }
                                                else
                                                {
                                                    this.DGVTinhCong.Rows[addTheoIDMay].Cells[19].Value = "CN";
                                                }
                                                this.DGVTinhCong.Rows[addTheoIDMay].Cells[20].Value = this.sMaChamCong;
                                                this.DGVTinhCong.Rows[addTheoIDMay].Cells[21].Value = this.sPhongBanTinhCong;
                                            }
                                            else
                                            {
                                                dGioVaoTheoIDMay = Convert.ToDateTime(dateGioChamTheoIDMay.ToString());
                                                this.DGVTinhCong.Rows[_nhanVien].Cells[4].Value = "***";
                                                this.DGVTinhCong.Rows[_nhanVien].Cells[5].Value = string.Format(this.sDinhDangThoiGian, dGioVaoTheoIDMay);
                                                this.DGVTinhCong.Rows[_nhanVien].Cells[7].Value = "0";
                                                this.DGVTinhCong.Rows[_nhanVien].Cells[8].Value = "0";
                                                this.DGVTinhCong.Rows[_nhanVien].Cells[17].Value = "0";
                                                this.DGVTinhCong.Rows[_nhanVien].Cells[18].Value = this.sKHVang;
                                                if (!(DateTimeProgress.XuatIDThu((int)dt.AddDays((double)dem).DayOfWeek) == "0"))
                                                {
                                                    this.DGVTinhCong.Rows[_nhanVien].Cells[19].Value = "NT";
                                                }
                                                else
                                                {
                                                    this.DGVTinhCong.Rows[_nhanVien].Cells[19].Value = "CN";
                                                }
                                                this.DGVTinhCong.Rows[_nhanVien].Cells[20].Value = this.sMaChamCong;
                                                this.DGVTinhCong.Rows[_nhanVien].Cells[21].Value = this.sPhongBanTinhCong;
                                                iKiemTra = 1;
                                            }
                                        }
                                        else if ((iKiemTra != 1 || iLanCham != 2 ? iLanCham != 1 : false))
                                        {
                                            if (iKiemTraB == 1)
                                            {
                                                goto Label30;
                                            }
                                            if (iKiemTraB == 0)
                                            {
                                                int addTheoIDMayB = this.DGVTinhCong.Rows.Add();
                                                dGioRaTheoIDMay = Convert.ToDateTime(dateGioChamTheoIDMay.ToString());
                                                this.DGVTinhCong.Rows[addTheoIDMayB].Cells[6].Value = string.Format(this.sDinhDangThoiGian, dGioRaTheoIDMay);
                                                this.DGVTinhCong.Rows[addTheoIDMayB].Cells[0].Value = this.sMaNhanVien;
                                                this.DGVTinhCong.Rows[addTheoIDMayB].Cells[1].Value = this.sTenNhanVien;
                                                this.DGVTinhCong.Rows[addTheoIDMayB].Cells[2].Value = this.DGVTinhCong.Rows[_nhanVien].Cells[2].Value.ToString();
                                                this.DGVTinhCong.Rows[addTheoIDMayB].Cells[4].Value = "***";
                                                this.DGVTinhCong.Rows[addTheoIDMayB].Cells[7].Value = "0";
                                                this.DGVTinhCong.Rows[addTheoIDMayB].Cells[8].Value = "0";
                                                if (this.iNgonNgu == 0)
                                                {
                                                    DataGridViewCell item14 = this.DGVTinhCong.Rows[addTheoIDMayB].Cells[3];
                                                    dateTime = dt.AddDays((double)dem);
                                                    item14.Value = DateTimeProgress.XuatThuTinhCong((int)dateTime.DayOfWeek);
                                                }
                                                if (this.iNgonNgu == 1)
                                                {
                                                    DataGridViewCell dataGridViewCell14 = this.DGVTinhCong.Rows[addTheoIDMayB].Cells[3];
                                                    dateTime = dt.AddDays((double)dem);
                                                    dataGridViewCell14.Value = DateTimeProgress.XuatThuEnglish((int)dateTime.DayOfWeek);
                                                }
                                                this.DGVTinhCong.Rows[addTheoIDMayB].Cells[17].Value = "0";
                                                this.DGVTinhCong.Rows[addTheoIDMayB].Cells[18].Value = this.sKHVang;
                                                if (!(DateTimeProgress.XuatIDThu((int)dt.AddDays((double)dem).DayOfWeek) == "0"))
                                                {
                                                    this.DGVTinhCong.Rows[addTheoIDMayB].Cells[19].Value = "NT";
                                                }
                                                else
                                                {
                                                    this.DGVTinhCong.Rows[addTheoIDMayB].Cells[19].Value = "CN";
                                                }
                                                this.DGVTinhCong.Rows[addTheoIDMayB].Cells[20].Value = this.sMaChamCong;
                                                this.DGVTinhCong.Rows[addTheoIDMayB].Cells[21].Value = this.sPhongBanTinhCong;
                                            }
                                        }
                                        else
                                        {
                                            if ((iKiemTra != 0 ? true : iLanCham != 1))
                                            {
                                                dGioRaTheoIDMay = Convert.ToDateTime(dateGioChamTheoIDMay.ToString());
                                                this.DGVTinhCong.Rows[_nhanVien].Cells[6].Value = string.Format(this.sDinhDangThoiGian, dGioRaTheoIDMay);
                                                iLanCham++;
                                                dtNhanCaTheoIDMay = new System.Data.DataTable();
                                                this._chiTietLichTrinhChoCalamViecDTO.MaLichTrinhCaLamViec = sLTCCLVNhanVien;
                                                this._chiTietLichTrinhChoCalamViecDTO.Thu = sThu;
                                                dtNhanCaTheoIDMay = this._chiTietLichTrinhChoCaLamViecBLL.ChiTietLichTrinhChoCaLamViecNhanCa(this._chiTietLichTrinhChoCalamViecDTO);
                                                iChiTietLichTrinhChoCaLamViecTheoIDMay = 0;
                                                if (iChiTietLichTrinhChoCaLamViecTheoIDMay < dtNhanCaTheoIDMay.Rows.Count)
                                                {
                                                    cellChiTietLichTrinhChoCaLamViecTheoIDMay = 3;
                                                    while (cellChiTietLichTrinhChoCaLamViecTheoIDMay < 13)
                                                    {
                                                        kiemTraVao = 0;
                                                        kiemTraRa = 0;
                                                        this.sTheoIDMayMaCaLamViec = dtNhanCaTheoIDMay.Rows[iChiTietLichTrinhChoCaLamViecTheoIDMay][cellChiTietLichTrinhChoCaLamViecTheoIDMay].ToString();
                                                        dtTheoIDMayCa1 = new System.Data.DataTable();
                                                        this._caLamViecDTO.MaCaLamViec = this.sTheoIDMayMaCaLamViec;
                                                        dtTheoIDMayCa1 = this._caLamViecBLL.CaLamViecGetByMaCaLamViec(this._caLamViecDTO);
                                                        iTheoIDMayCa1 = 0;
                                                        while (iTheoIDMayCa1 < dtTheoIDMayCa1.Rows.Count)
                                                        {
                                                            this.sTheoIDMayTenCaLamViec = dtTheoIDMayCa1.Rows[iTheoIDMayCa1]["CaLamViec"].ToString();
                                                            dBatDauVaoTheoIDMayA = Convert.ToDateTime(dtTheoIDMayCa1.Rows[iTheoIDMayCa1]["BatDauVao"].ToString());
                                                            sBatDauVaoTheoIDMayA = string.Format("{0:T}", dBatDauVaoTheoIDMayA);
                                                            sBatDauVaoTheoIDMayB = string.Concat(sNgayCham, " ", sBatDauVaoTheoIDMayA);
                                                            dBatDauVaoTheoIDMayB = Convert.ToDateTime(sBatDauVaoTheoIDMayB);
                                                            dKetThucVaoTheoIDMayA = Convert.ToDateTime(dtTheoIDMayCa1.Rows[iTheoIDMayCa1]["KetThucVao"].ToString());
                                                            sKetThucVaoTheoIDMayA = string.Format("{0:T}", dKetThucVaoTheoIDMayA);
                                                            sKetThucVaoTheoIDMayB = string.Concat(sNgayCham, " ", sKetThucVaoTheoIDMayA);
                                                            dKetThucVaoTheoIDMayB = Convert.ToDateTime(sKetThucVaoTheoIDMayB);
                                                            dBatDauRaTheoIDMayA = Convert.ToDateTime(dtTheoIDMayCa1.Rows[iTheoIDMayCa1]["BatDauRa"].ToString());
                                                            sBatDauRaTheoIDMayA = string.Format("{0:T}", dBatDauRaTheoIDMayA);
                                                            sBatDauRaTheoIDMayB = string.Concat(sNgayCham, " ", sBatDauRaTheoIDMayA);
                                                            dBatDauRaTheoIDMayB = Convert.ToDateTime(sBatDauRaTheoIDMayB);
                                                            if (!(sBatDauRaTheoIDMayB == "12:01:00 AM"))
                                                            {
                                                                dBatDauRaTheoIDMayB = Convert.ToDateTime(dBatDauRaTheoIDMayB);
                                                            }
                                                            else
                                                            {
                                                                dateTime = dBatDauRaTheoIDMayB.AddDays(1);
                                                                dBatDauRaTheoIDMayB = Convert.ToDateTime(dateTime.ToString());
                                                            }
                                                            dKetThucRaTheoIDMayA = Convert.ToDateTime(dtTheoIDMayCa1.Rows[iTheoIDMayCa1]["KetThucRa"].ToString());
                                                            sKetThucRaTheoIDMayA = string.Format("{0:T}", dKetThucRaTheoIDMayA);
                                                            sKetThucRaTheoIDMayB = string.Concat(sNgayCham, " ", sKetThucRaTheoIDMayA);
                                                            dKetThucRaTheoIDMayB = Convert.ToDateTime(sKetThucRaTheoIDMayB);
                                                            if (!(sKetThucRaTheoIDMayA == "12:01:00 AM"))
                                                            {
                                                                dKetThucRaTheoIDMayB = Convert.ToDateTime(dKetThucRaTheoIDMayB);
                                                            }
                                                            else
                                                            {
                                                                dateTime = dKetThucRaTheoIDMayB.AddDays(1);
                                                                dKetThucRaTheoIDMayB = Convert.ToDateTime(dateTime.ToString());
                                                            }
                                                            if ((dGioVaoTheoIDMay < dBatDauVaoTheoIDMayB ? false : dGioVaoTheoIDMay <= dKetThucVaoTheoIDMayB))
                                                            {
                                                                kiemTraVao++;
                                                            }
                                                            if ((dGioRaTheoIDMay < dBatDauRaTheoIDMayB ? false : dGioRaTheoIDMay <= dKetThucRaTheoIDMayB))
                                                            {
                                                                kiemTraRa++;
                                                            }
                                                            if ((kiemTraVao != 1 ? true : kiemTraRa != 1))
                                                            {
                                                                iTheoIDMayCa1++;
                                                            }
                                                            else
                                                            {
                                                                goto Label32;
                                                            }
                                                        }
                                                        if (!(this.sTheoIDMayMaCaLamViec == ""))
                                                        {
                                                            cellChiTietLichTrinhChoCaLamViecTheoIDMay++;
                                                        }
                                                        else
                                                        {
                                                            this.DGVTinhCong.Rows[_nhanVien].Cells[4].Value = "***";
                                                            this.DGVTinhCong.Rows[_nhanVien].Cells[7].Value = "0";
                                                            this.DGVTinhCong.Rows[_nhanVien].Cells[8].Value = "0";
                                                            this.DGVTinhCong.Rows[_nhanVien].Cells[9].Value = "0";
                                                            this.DGVTinhCong.Rows[_nhanVien].Cells[10].Value = "0";
                                                            this.DGVTinhCong.Rows[_nhanVien].Cells[11].Value = "0";
                                                            this.DGVTinhCong.Rows[_nhanVien].Cells[12].Value = "0";
                                                            this.DGVTinhCong.Rows[_nhanVien].Cells[13].Value = "0";
                                                            this.DGVTinhCong.Rows[_nhanVien].Cells[14].Value = "0";
                                                            this.DGVTinhCong.Rows[_nhanVien].Cells[15].Value = "0";
                                                            this.DGVTinhCong.Rows[_nhanVien].Cells[16].Value = "0";
                                                            this.DGVTinhCong.Rows[_nhanVien].Cells[17].Value = "0";
                                                            this.DGVTinhCong.Rows[_nhanVien].Cells[18].Value = this.sKHVang;
                                                            //goto Label31;
                                                        }
                                                    }
                                                Label32:
                                                    this.DGVTinhCong.Rows[_nhanVien].Cells[4].Value = this.sTheoIDMayTenCaLamViec;
                                                    dtCaLamViecTheoIDMay = new System.Data.DataTable();
                                                    this._caLamViecDTO.MaCaLamViec = this.sTheoIDMayMaCaLamViec;
                                                    dtCaLamViecTheoIDMay = this._caLamViecBLL.CaLamViecGetByMaCaLamViec(this._caLamViecDTO);
                                                    for (iCaLamViecTheoIDMay = 0; iCaLamViecTheoIDMay < dtCaLamViecTheoIDMay.Rows.Count; iCaLamViecTheoIDMay++)
                                                    {
                                                        second = dGioVaoTheoIDMay.Second;
                                                        sGiayGioVao = second.ToString();
                                                        second = dGioRaTheoIDMay.Second;
                                                        sGiayGioRa = second.ToString();
                                                        dGioVaoKhaiBaoTheoIDMayA = Convert.ToDateTime(dtCaLamViecTheoIDMay.Rows[iCaLamViecTheoIDMay]["GioVaoLamViec"].ToString());
                                                        sGioVaoKhaiBaoTheoIDMayA = string.Format("{0:T}", dGioVaoKhaiBaoTheoIDMayA).Replace("00 ", string.Concat(sGiayGioVao, " "));
                                                        sGioVaoKhaiBaoTheoIDMayB = string.Concat(sNgayCham, " ", sGioVaoKhaiBaoTheoIDMayA);
                                                        dGioVaoKhaiBaoTheoIDMayB = Convert.ToDateTime(sGioVaoKhaiBaoTheoIDMayB);
                                                        dGioRaKhaiBaoTheoIDMayA = Convert.ToDateTime(dtCaLamViecTheoIDMay.Rows[iCaLamViecTheoIDMay]["GioKetThucLamViec"].ToString());
                                                        sGioRaKhaiBaoTheoIDMayA = string.Format("{0:T}", dGioRaKhaiBaoTheoIDMayA).Replace("00 ", string.Concat(sGiayGioRa, " "));
                                                        sGioRaKhaiBaoTheoIDMayB = string.Concat(sNgayCham, " ", sGioRaKhaiBaoTheoIDMayA);
                                                        dGioRaKhaiBaoTheoIDMayB = Convert.ToDateTime(sGioRaKhaiBaoTheoIDMayB);
                                                        sTruGioDiTre = dtCaLamViecTheoIDMay.Rows[iCaLamViecTheoIDMay]["TruGioDiTre"].ToString();
                                                        sBatDauTinhDiTre = dtCaLamViecTheoIDMay.Rows[iCaLamViecTheoIDMay]["BatDauTinhDiTre"].ToString();
                                                        iChoPhepDiTre = Convert.ToInt32(dtCaLamViecTheoIDMay.Rows[iCaLamViecTheoIDMay]["ChoPhepDiTre"].ToString());
                                                        value = dGioVaoTheoIDMay - dGioVaoKhaiBaoTheoIDMayB;
                                                        second = Convert.ToInt32(value.TotalMinutes);
                                                        sPhutTre = second.ToString();
                                                        if (!(sTruGioDiTre == "True"))
                                                        {
                                                            this.DGVTinhCong.Rows[_nhanVien].Cells[9].Value = "0";
                                                        }
                                                        else if (Convert.ToInt32(sPhutTre) >= 0)
                                                        {
                                                            iPhutTre = Convert.ToInt32(sPhutTre) - iChoPhepDiTre;
                                                            if (sBatDauTinhDiTre == "True")
                                                            {
                                                                if (iPhutTre >= 1)
                                                                {
                                                                    this.DGVTinhCong.Rows[_nhanVien].Cells[9].Value = iPhutTre.ToString();
                                                                }
                                                                else
                                                                {
                                                                    this.DGVTinhCong.Rows[_nhanVien].Cells[9].Value = "0";
                                                                }
                                                            }
                                                            else if (iPhutTre >= 1)
                                                            {
                                                                this.DGVTinhCong.Rows[_nhanVien].Cells[9].Value = sPhutTre;
                                                            }
                                                            else
                                                            {
                                                                this.DGVTinhCong.Rows[_nhanVien].Cells[9].Value = "0";
                                                            }
                                                        }
                                                        else
                                                        {
                                                            this.DGVTinhCong.Rows[_nhanVien].Cells[9].Value = "0";
                                                        }
                                                        sTruGioVeSom = dtCaLamViecTheoIDMay.Rows[iCaLamViecTheoIDMay]["TruGioVeSom"].ToString();
                                                        sBatDauTinhVeSom = dtCaLamViecTheoIDMay.Rows[iCaLamViecTheoIDMay]["BatDauTinhVeSom"].ToString();
                                                        iChoPhepVeSom = Convert.ToInt32(dtCaLamViecTheoIDMay.Rows[iCaLamViecTheoIDMay]["ChoPhepVeSom"].ToString());
                                                        value = dGioRaKhaiBaoTheoIDMayB - dGioRaTheoIDMay;
                                                        second = Convert.ToInt32(value.TotalMinutes);
                                                        sPhutVeSom = second.ToString();
                                                        if (!(sTruGioVeSom == "True"))
                                                        {
                                                            this.DGVTinhCong.Rows[_nhanVien].Cells[10].Value = "0";
                                                        }
                                                        else if (Convert.ToInt32(sPhutVeSom) >= 0)
                                                        {
                                                            iPhutVeSom = Convert.ToInt32(sPhutVeSom) - iChoPhepVeSom;
                                                            if (iPhutVeSom < 1)
                                                            {
                                                                this.DGVTinhCong.Rows[_nhanVien].Cells[10].Value = "0";
                                                            }
                                                            else if (!(sBatDauTinhVeSom == "True"))
                                                            {
                                                                this.DGVTinhCong.Rows[_nhanVien].Cells[10].Value = sPhutVeSom;
                                                            }
                                                            else
                                                            {
                                                                this.DGVTinhCong.Rows[_nhanVien].Cells[10].Value = iPhutVeSom.ToString();
                                                            }
                                                        }
                                                        else
                                                        {
                                                            this.DGVTinhCong.Rows[_nhanVien].Cells[10].Value = "0";
                                                        }
                                                        value = dGioRaTheoIDMay - dGioRaKhaiBaoTheoIDMayB;
                                                        second = Convert.ToInt32(value.TotalMinutes);
                                                        sVeTre = second.ToString();
                                                        if (Convert.ToInt32(sVeTre) <= 0)
                                                        {
                                                            this.DGVTinhCong.Rows[_nhanVien].Cells[11].Value = "0";
                                                        }
                                                        else
                                                        {
                                                            this.DGVTinhCong.Rows[_nhanVien].Cells[11].Value = sVeTre;
                                                        }
                                                        iPhut = Convert.ToSingle(dtCaLamViecTheoIDMay.Rows[iCaLamViecTheoIDMay]["TongGioTrongCaLamViec"]) * 60f - (float)(Convert.ToInt32(this.DGVTinhCong.Rows[_nhanVien].Cells[9].Value.ToString()) + Convert.ToInt32(this.DGVTinhCong.Rows[_nhanVien].Cells[10].Value));
                                                        dGio = Math.Round(Convert.ToDouble(iPhut) / 60, this.iLamTronGio);
                                                        this.DGVTinhCong.Rows[_nhanVien].Cells[8].Value = dGio.ToString();
                                                        iGio = Convert.ToDouble(dtCaLamViecTheoIDMay.Rows[iCaLamViecTheoIDMay]["TongGioTrongCaLamViec"].ToString());
                                                        dCongTinh = Convert.ToDouble(dtCaLamViecTheoIDMay.Rows[iCaLamViecTheoIDMay]["CongTinh"].ToString());
                                                        dCong = Math.Round(dGio * dCongTinh / iGio, this.iLamTronCong);
                                                        this.DGVTinhCong.Rows[_nhanVien].Cells[7].Value = dCong.ToString();
                                                        sTangCaTruocGioLamViec = dtCaLamViecTheoIDMay.Rows[iCaLamViecTheoIDMay]["TangCaTruocGioLamViec"].ToString();
                                                        sTangCaSauGioLamViec = dtCaLamViecTheoIDMay.Rows[iCaLamViecTheoIDMay]["TangCaSauGioLamViec"].ToString();
                                                        if ((sTangCaTruocGioLamViec != "False" ? false : sTangCaSauGioLamViec == "False"))
                                                        {
                                                            this.DGVTinhCong.Rows[_nhanVien].Cells[12].Value = "0";
                                                            this.DGVTinhCong.Rows[_nhanVien].Cells[13].Value = "0";
                                                            this.DGVTinhCong.Rows[_nhanVien].Cells[14].Value = "0";
                                                            this.DGVTinhCong.Rows[_nhanVien].Cells[15].Value = "0";
                                                        }
                                                        sXemCaNayLaTangCa = dtCaLamViecTheoIDMay.Rows[iCaLamViecTheoIDMay]["XemCaNayLaTangCa"].ToString();
                                                        iTangCaMuc = Convert.ToInt32(dtCaLamViecTheoIDMay.Rows[iCaLamViecTheoIDMay]["TangCaMuc"].ToString());
                                                        if (sXemCaNayLaTangCa == "True")
                                                        {
                                                            if (iTangCaMuc == 1)
                                                            {
                                                                this.DGVTinhCong.Rows[_nhanVien].Cells[7].Value = "0";
                                                                this.DGVTinhCong.Rows[_nhanVien].Cells[8].Value = "0";
                                                                this.DGVTinhCong.Rows[_nhanVien].Cells[12].Value = dGio.ToString();
                                                                this.DGVTinhCong.Rows[_nhanVien].Cells[13].Value = "0";
                                                                this.DGVTinhCong.Rows[_nhanVien].Cells[14].Value = "0";
                                                                this.DGVTinhCong.Rows[_nhanVien].Cells[15].Value = "0";
                                                            }
                                                            if (iTangCaMuc == 2)
                                                            {
                                                                this.DGVTinhCong.Rows[_nhanVien].Cells[7].Value = "0";
                                                                this.DGVTinhCong.Rows[_nhanVien].Cells[8].Value = "0";
                                                                this.DGVTinhCong.Rows[_nhanVien].Cells[12].Value = "0";
                                                                this.DGVTinhCong.Rows[_nhanVien].Cells[13].Value = dGio.ToString();
                                                                this.DGVTinhCong.Rows[_nhanVien].Cells[14].Value = "0";
                                                                this.DGVTinhCong.Rows[_nhanVien].Cells[15].Value = "0";
                                                            }
                                                            if (iTangCaMuc == 3)
                                                            {
                                                                this.DGVTinhCong.Rows[_nhanVien].Cells[7].Value = "0";
                                                                this.DGVTinhCong.Rows[_nhanVien].Cells[8].Value = "0";
                                                                this.DGVTinhCong.Rows[_nhanVien].Cells[12].Value = "0";
                                                                this.DGVTinhCong.Rows[_nhanVien].Cells[13].Value = "0";
                                                                this.DGVTinhCong.Rows[_nhanVien].Cells[14].Value = dGio.ToString();
                                                                this.DGVTinhCong.Rows[_nhanVien].Cells[15].Value = "0";
                                                            }
                                                            if (iTangCaMuc == 4)
                                                            {
                                                                this.DGVTinhCong.Rows[_nhanVien].Cells[7].Value = "0";
                                                                this.DGVTinhCong.Rows[_nhanVien].Cells[8].Value = "0";
                                                                this.DGVTinhCong.Rows[_nhanVien].Cells[12].Value = "0";
                                                                this.DGVTinhCong.Rows[_nhanVien].Cells[13].Value = "0";
                                                                this.DGVTinhCong.Rows[_nhanVien].Cells[14].Value = "0";
                                                                this.DGVTinhCong.Rows[_nhanVien].Cells[15].Value = dGio.ToString();
                                                            }
                                                        }
                                                        sChoPhepTangCaTruocGioLamViecTheoIDMay = dtCaLamViecTheoIDMay.Rows[iCaLamViecTheoIDMay]["TangCaTruocGioLamViec"].ToString();
                                                        iPhutTangCaTruocGioLamViecTheoIDMay = Convert.ToInt32(dtCaLamViecTheoIDMay.Rows[iCaLamViecTheoIDMay]["SoPhutTangCaTruocGioLamViec"].ToString());
                                                        iPhutTangCaTruocGioLamViecDatDen = Convert.ToInt32(dtCaLamViecTheoIDMay.Rows[iCaLamViecTheoIDMay]["TangCaTruocGioLamViecDatDen"].ToString());
                                                        iPhutTruTangCaTruoc = Convert.ToInt32(dtCaLamViecTheoIDMay.Rows[iCaLamViecTheoIDMay]["PhutTruTangCaTruoc"].ToString());
                                                        sChoPhepTangCaSauGioLamViecTheoIDMay = dtCaLamViecTheoIDMay.Rows[iCaLamViecTheoIDMay]["TangCaSauGioLamViec"].ToString();
                                                        iPhutTangCaSauGioLamViecTheoIDMay = Convert.ToInt32(dtCaLamViecTheoIDMay.Rows[iCaLamViecTheoIDMay]["SoPhutTangCaSauGioLamViec"].ToString());
                                                        iPhutTangCaSauGioLamViecDatDen = Convert.ToInt32(dtCaLamViecTheoIDMay.Rows[iCaLamViecTheoIDMay]["TangCaSauGioLamViecDatDen"].ToString());
                                                        iPhutTruTangCaSau = Convert.ToInt32(dtCaLamViecTheoIDMay.Rows[iCaLamViecTheoIDMay]["PhutTruTangCaSau"].ToString());
                                                        iGioiHanTC1TheoIDMay = Convert.ToInt32(dtCaLamViecTheoIDMay.Rows[iCaLamViecTheoIDMay]["GioiHanTangCa1"].ToString());
                                                        iGioiHanTC2TheoIDMay = Convert.ToInt32(dtCaLamViecTheoIDMay.Rows[iCaLamViecTheoIDMay]["GioiHanTangCa2"].ToString());
                                                        iGioiHanTC3TheoIDMay = Convert.ToInt32(dtCaLamViecTheoIDMay.Rows[iCaLamViecTheoIDMay]["GioiHanTangCa3"].ToString());
                                                        iGioiHanTC4TheoIDMay = Convert.ToInt32(dtCaLamViecTheoIDMay.Rows[iCaLamViecTheoIDMay]["GioiHanTangCa4"].ToString());
                                                        iTongGioTangCaSauTheoIDMay = 0;
                                                        iTongGioTangCaTruocTheoIDMay = 0;
                                                        if ((sChoPhepTangCaTruocGioLamViecTheoIDMay != "False" ? true : !(sChoPhepTangCaSauGioLamViecTheoIDMay == "False")))
                                                        {
                                                            if (sChoPhepTangCaTruocGioLamViecTheoIDMay == "True")
                                                            {
                                                                value = dGioVaoKhaiBaoTheoIDMayB - dGioVaoTheoIDMay;
                                                                second = Convert.ToInt32(value.TotalMinutes);
                                                                iThoiGianTruocGioLamTheoIDMay = Convert.ToInt32(second.ToString());
                                                                if (iThoiGianTruocGioLamTheoIDMay > 0)
                                                                {
                                                                    if (iThoiGianTruocGioLamTheoIDMay > iPhutTangCaTruocGioLamViecTheoIDMay)
                                                                    {
                                                                        if (iThoiGianTruocGioLamTheoIDMay > iPhutTangCaTruocGioLamViecDatDen)
                                                                        {
                                                                            iTongGioTangCaTruocTheoIDMay = iThoiGianTruocGioLamTheoIDMay - iPhutTruTangCaTruoc;
                                                                        }
                                                                    }
                                                                }
                                                            }
                                                            if (sChoPhepTangCaSauGioLamViecTheoIDMay == "True")
                                                            {
                                                                value = dGioRaTheoIDMay - dGioRaKhaiBaoTheoIDMayB;
                                                                second = Convert.ToInt32(value.TotalMinutes);
                                                                iThoiGianSauGioLamViecTheoIDMay = Convert.ToInt32(second.ToString());
                                                                if (iThoiGianSauGioLamViecTheoIDMay > 0)
                                                                {
                                                                    if (iThoiGianSauGioLamViecTheoIDMay > iPhutTangCaSauGioLamViecTheoIDMay)
                                                                    {
                                                                        if (iThoiGianSauGioLamViecTheoIDMay > iPhutTangCaSauGioLamViecDatDen)
                                                                        {
                                                                            iTongGioTangCaSauTheoIDMay = iThoiGianSauGioLamViecTheoIDMay - iPhutTruTangCaSau;
                                                                        }
                                                                    }
                                                                }
                                                            }
                                                        }
                                                        else
                                                        {
                                                            this.DGVTinhCong.Rows[_nhanVien].Cells[12].Value = "0";
                                                            this.DGVTinhCong.Rows[_nhanVien].Cells[13].Value = "0";
                                                            this.DGVTinhCong.Rows[_nhanVien].Cells[14].Value = "0";
                                                            this.DGVTinhCong.Rows[_nhanVien].Cells[15].Value = "0";
                                                        }
                                                        dTongThoiGianTangCaTheoIDMay = Convert.ToDouble(iTongGioTangCaTruocTheoIDMay + iTongGioTangCaSauTheoIDMay);
                                                        if (dTongThoiGianTangCaTheoIDMay <= 0)
                                                        {
                                                            this.DGVTinhCong.Rows[_nhanVien].Cells[12].Value = "0";
                                                            this.DGVTinhCong.Rows[_nhanVien].Cells[13].Value = "0";
                                                            this.DGVTinhCong.Rows[_nhanVien].Cells[14].Value = "0";
                                                            this.DGVTinhCong.Rows[_nhanVien].Cells[15].Value = "0";
                                                        }
                                                        else
                                                        {
                                                            if (iGioiHanTC1TheoIDMay == 0)
                                                            {
                                                                this.DGVTinhCong.Rows[_nhanVien].Cells[12].Value = Math.Round(dTongThoiGianTangCaTheoIDMay * this.dTangCa1HeSo / 60, this.iLamTronGio);
                                                                this.DGVTinhCong.Rows[_nhanVien].Cells[13].Value = "0";
                                                                this.DGVTinhCong.Rows[_nhanVien].Cells[14].Value = "0";
                                                                this.DGVTinhCong.Rows[_nhanVien].Cells[15].Value = "0";
                                                            }
                                                            if ((iGioiHanTC1TheoIDMay == 0 ? false : iGioiHanTC2TheoIDMay == 0))
                                                            {
                                                                if (dTongThoiGianTangCaTheoIDMay >= Convert.ToDouble(iGioiHanTC1TheoIDMay))
                                                                {
                                                                    this.DGVTinhCong.Rows[_nhanVien].Cells[12].Value = Math.Round(Convert.ToDouble(iGioiHanTC1TheoIDMay) / 60 * this.dTangCa1HeSo, this.iLamTronGio);
                                                                    if (dTongThoiGianTangCaTheoIDMay - Convert.ToDouble(iGioiHanTC1TheoIDMay) > 0)
                                                                    {
                                                                        this.DGVTinhCong.Rows[_nhanVien].Cells[13].Value = Math.Round((dTongThoiGianTangCaTheoIDMay - Convert.ToDouble(iGioiHanTC1TheoIDMay)) * this.dTangCa2HeSo / 60, this.iLamTronGio);
                                                                    }
                                                                    this.DGVTinhCong.Rows[_nhanVien].Cells[14].Value = "0";
                                                                    this.DGVTinhCong.Rows[_nhanVien].Cells[15].Value = "0";
                                                                }
                                                                else
                                                                {
                                                                    this.DGVTinhCong.Rows[_nhanVien].Cells[12].Value = Math.Round(dTongThoiGianTangCaTheoIDMay * this.dTangCa1HeSo / 60, this.iLamTronGio);
                                                                    this.DGVTinhCong.Rows[_nhanVien].Cells[13].Value = "0";
                                                                    this.DGVTinhCong.Rows[_nhanVien].Cells[14].Value = "0";
                                                                    this.DGVTinhCong.Rows[_nhanVien].Cells[15].Value = "0";
                                                                }
                                                            }
                                                            if ((iGioiHanTC1TheoIDMay == 0 || iGioiHanTC2TheoIDMay == 0 ? false : iGioiHanTC3TheoIDMay == 0))
                                                            {
                                                                if (dTongThoiGianTangCaTheoIDMay >= Convert.ToDouble(iGioiHanTC1TheoIDMay))
                                                                {
                                                                    this.DGVTinhCong.Rows[_nhanVien].Cells[12].Value = Math.Round(Convert.ToDouble(iGioiHanTC1TheoIDMay) * this.dTangCa1HeSo / 60, this.iLamTronGio);
                                                                    if (dTongThoiGianTangCaTheoIDMay - Convert.ToDouble(iGioiHanTC1TheoIDMay) >= Convert.ToDouble(iGioiHanTC2TheoIDMay))
                                                                    {
                                                                        this.DGVTinhCong.Rows[_nhanVien].Cells[12].Value = Math.Round(Convert.ToDouble(iGioiHanTC1TheoIDMay) * this.dTangCa1HeSo / 60, this.iLamTronGio);
                                                                        this.DGVTinhCong.Rows[_nhanVien].Cells[13].Value = Math.Round(Convert.ToDouble(iGioiHanTC2TheoIDMay) * this.dTangCa2HeSo / 60, this.iLamTronGio);
                                                                        this.DGVTinhCong.Rows[_nhanVien].Cells[14].Value = Math.Round((dTongThoiGianTangCaTheoIDMay - Convert.ToDouble(iGioiHanTC1TheoIDMay) - Convert.ToDouble(iGioiHanTC2TheoIDMay)) * this.dTangCa3HeSo / 60, this.iLamTronGio);
                                                                        this.DGVTinhCong.Rows[_nhanVien].Cells[15].Value = "0";
                                                                    }
                                                                    else
                                                                    {
                                                                        this.DGVTinhCong.Rows[_nhanVien].Cells[13].Value = Math.Round((dTongThoiGianTangCaTheoIDMay - Convert.ToDouble(iGioiHanTC1TheoIDMay)) * this.dTangCa2HeSo / 60, this.iLamTronGio);
                                                                        this.DGVTinhCong.Rows[_nhanVien].Cells[14].Value = "0";
                                                                        this.DGVTinhCong.Rows[_nhanVien].Cells[15].Value = "0";
                                                                    }
                                                                }
                                                                else
                                                                {
                                                                    this.DGVTinhCong.Rows[_nhanVien].Cells[12].Value = Math.Round(dTongThoiGianTangCaTheoIDMay * this.dTangCa1HeSo / 60, this.iLamTronGio);
                                                                    this.DGVTinhCong.Rows[_nhanVien].Cells[13].Value = "0";
                                                                    this.DGVTinhCong.Rows[_nhanVien].Cells[14].Value = "0";
                                                                    this.DGVTinhCong.Rows[_nhanVien].Cells[15].Value = "0";
                                                                }
                                                            }
                                                            if ((iGioiHanTC1TheoIDMay == 0 || iGioiHanTC2TheoIDMay == 0 || iGioiHanTC3TheoIDMay == 0 ? false : iGioiHanTC4TheoIDMay == 0))
                                                            {
                                                            }
                                                        }
                                                        value = dGioRaTheoIDMay - dGioVaoTheoIDMay;
                                                        second = Convert.ToInt32(value.TotalMinutes);
                                                        num = Math.Round(Convert.ToDouble(second.ToString()) / 60, this.iLamTronGio);
                                                        sTongGio = num.ToString();
                                                        this.DGVTinhCong.Rows[_nhanVien].Cells[16].Value = sTongGio;
                                                        this.DGVTinhCong.Rows[_nhanVien].Cells[17].Value = dtCaLamViecTheoIDMay.Rows[iCaLamViecTheoIDMay]["CongTinh"].ToString();
                                                        this.DGVTinhCong.Rows[_nhanVien].Cells[18].Value = this.sKHDungGio;
                                                        if (!(DateTimeProgress.XuatIDThu((int)dt.AddDays((double)dem).DayOfWeek) == "0"))
                                                        {
                                                            this.DGVTinhCong.Rows[_nhanVien].Cells[19].Value = "NT";
                                                        }
                                                        else
                                                        {
                                                            this.DGVTinhCong.Rows[_nhanVien].Cells[19].Value = "CN";
                                                        }
                                                        this.DGVTinhCong.Rows[_nhanVien].Cells[20].Value = this.sMaChamCong;
                                                        this.DGVTinhCong.Rows[_nhanVien].Cells[21].Value = this.sPhongBanTinhCong;
                                                    }
                                                }
                                           // Label31:
                                            }
                                            else if (_nhanVien == 0)
                                            {
                                                dGioRaTheoIDMay = Convert.ToDateTime(dateGioChamTheoIDMay.ToString());
                                                this.DGVTinhCong.Rows[_nhanVien].Cells[6].Value = string.Format(this.sDinhDangThoiGian, dGioRaTheoIDMay);
                                                iLanCham++;
                                            }
                                            else if ((this.DGVTinhCong.Rows[_nhanVien - 1].Cells[5].Value == null ? true : this.DGVTinhCong.Rows[_nhanVien - 1].Cells[6].Value != null))
                                            {
                                                dGioRaTheoIDMay = Convert.ToDateTime(dateGioChamTheoIDMay.ToString());
                                                this.DGVTinhCong.Rows[_nhanVien].Cells[6].Value = string.Format(this.sDinhDangThoiGian, dGioRaTheoIDMay);
                                                iLanCham++;
                                                dtNhanCaTheoIDMay = new System.Data.DataTable();
                                                this._chiTietLichTrinhChoCalamViecDTO.MaLichTrinhCaLamViec = sLTCCLVNhanVien;
                                                this._chiTietLichTrinhChoCalamViecDTO.Thu = sThu;
                                                dtNhanCaTheoIDMay = this._chiTietLichTrinhChoCaLamViecBLL.ChiTietLichTrinhChoCaLamViecNhanCa(this._chiTietLichTrinhChoCalamViecDTO);
                                                iChiTietLichTrinhChoCaLamViecTheoIDMay = 0;
                                                if (iChiTietLichTrinhChoCaLamViecTheoIDMay < dtNhanCaTheoIDMay.Rows.Count)
                                                {
                                                    cellChiTietLichTrinhChoCaLamViecTheoIDMay = 3;
                                                    while (cellChiTietLichTrinhChoCaLamViecTheoIDMay < 13)
                                                    {
                                                        kiemTraVao = 0;
                                                        kiemTraRa = 0;
                                                        this.sTheoIDMayMaCaLamViec = dtNhanCaTheoIDMay.Rows[iChiTietLichTrinhChoCaLamViecTheoIDMay][cellChiTietLichTrinhChoCaLamViecTheoIDMay].ToString();
                                                        dtTheoIDMayCa1 = new System.Data.DataTable();
                                                        this._caLamViecDTO.MaCaLamViec = this.sTheoIDMayMaCaLamViec;
                                                        dtTheoIDMayCa1 = this._caLamViecBLL.CaLamViecGetByMaCaLamViec(this._caLamViecDTO);
                                                        iTheoIDMayCa1 = 0;
                                                        while (iTheoIDMayCa1 < dtTheoIDMayCa1.Rows.Count)
                                                        {
                                                            this.sTheoIDMayTenCaLamViec = dtTheoIDMayCa1.Rows[iTheoIDMayCa1]["CaLamViec"].ToString();
                                                            dBatDauVaoTheoIDMayA = Convert.ToDateTime(dtTheoIDMayCa1.Rows[iTheoIDMayCa1]["BatDauVao"].ToString());
                                                            sBatDauVaoTheoIDMayA = string.Format("{0:T}", dBatDauVaoTheoIDMayA);
                                                            sBatDauVaoTheoIDMayB = string.Concat(sNgayCham, " ", sBatDauVaoTheoIDMayA);
                                                            dBatDauVaoTheoIDMayB = Convert.ToDateTime(sBatDauVaoTheoIDMayB);
                                                            dKetThucVaoTheoIDMayA = Convert.ToDateTime(dtTheoIDMayCa1.Rows[iTheoIDMayCa1]["KetThucVao"].ToString());
                                                            sKetThucVaoTheoIDMayA = string.Format("{0:T}", dKetThucVaoTheoIDMayA);
                                                            sKetThucVaoTheoIDMayB = string.Concat(sNgayCham, " ", sKetThucVaoTheoIDMayA);
                                                            dKetThucVaoTheoIDMayB = Convert.ToDateTime(sKetThucVaoTheoIDMayB);
                                                            dBatDauRaTheoIDMayA = Convert.ToDateTime(dtTheoIDMayCa1.Rows[iTheoIDMayCa1]["BatDauRa"].ToString());
                                                            sBatDauRaTheoIDMayA = string.Format("{0:T}", dBatDauRaTheoIDMayA);
                                                            sBatDauRaTheoIDMayB = string.Concat(sNgayCham, " ", sBatDauRaTheoIDMayA);
                                                            dBatDauRaTheoIDMayB = Convert.ToDateTime(sBatDauRaTheoIDMayB);
                                                            if (!(sBatDauRaTheoIDMayB == "12:01:00 AM"))
                                                            {
                                                                dBatDauRaTheoIDMayB = Convert.ToDateTime(dBatDauRaTheoIDMayB);
                                                            }
                                                            else
                                                            {
                                                                dateTime = dBatDauRaTheoIDMayB.AddDays(1);
                                                                dBatDauRaTheoIDMayB = Convert.ToDateTime(dateTime.ToString());
                                                            }
                                                            dKetThucRaTheoIDMayA = Convert.ToDateTime(dtTheoIDMayCa1.Rows[iTheoIDMayCa1]["KetThucRa"].ToString());
                                                            sKetThucRaTheoIDMayA = string.Format("{0:T}", dKetThucRaTheoIDMayA);
                                                            sKetThucRaTheoIDMayB = string.Concat(sNgayCham, " ", sKetThucRaTheoIDMayA);
                                                            dKetThucRaTheoIDMayB = Convert.ToDateTime(sKetThucRaTheoIDMayB);
                                                            if (!(sKetThucRaTheoIDMayA == "12:01:00 AM"))
                                                            {
                                                                dKetThucRaTheoIDMayB = Convert.ToDateTime(dKetThucRaTheoIDMayB);
                                                            }
                                                            else
                                                            {
                                                                dateTime = dKetThucRaTheoIDMayB.AddDays(1);
                                                                dKetThucRaTheoIDMayB = Convert.ToDateTime(dateTime.ToString());
                                                            }
                                                            if ((dGioVaoTheoIDMay < dBatDauVaoTheoIDMayB ? false : dGioVaoTheoIDMay <= dKetThucVaoTheoIDMayB))
                                                            {
                                                                kiemTraVao++;
                                                            }
                                                            if ((dGioRaTheoIDMay < dBatDauRaTheoIDMayB ? false : dGioRaTheoIDMay <= dKetThucRaTheoIDMayB))
                                                            {
                                                                kiemTraRa++;
                                                            }
                                                            if ((kiemTraVao != 1 ? true : kiemTraRa != 1))
                                                            {
                                                                iTheoIDMayCa1++;
                                                            }
                                                            else
                                                            {
                                                                goto Label34;
                                                            }
                                                        }
                                                        if (!(this.sTheoIDMayMaCaLamViec == ""))
                                                        {
                                                            cellChiTietLichTrinhChoCaLamViecTheoIDMay++;
                                                        }
                                                        else
                                                        {
                                                            this.DGVTinhCong.Rows[_nhanVien].Cells[4].Value = "***";
                                                            this.DGVTinhCong.Rows[_nhanVien].Cells[7].Value = "0";
                                                            this.DGVTinhCong.Rows[_nhanVien].Cells[8].Value = "0";
                                                            this.DGVTinhCong.Rows[_nhanVien].Cells[9].Value = "0";
                                                            this.DGVTinhCong.Rows[_nhanVien].Cells[10].Value = "0";
                                                            this.DGVTinhCong.Rows[_nhanVien].Cells[11].Value = "0";
                                                            this.DGVTinhCong.Rows[_nhanVien].Cells[12].Value = "0";
                                                            this.DGVTinhCong.Rows[_nhanVien].Cells[13].Value = "0";
                                                            this.DGVTinhCong.Rows[_nhanVien].Cells[14].Value = "0";
                                                            this.DGVTinhCong.Rows[_nhanVien].Cells[15].Value = "0";
                                                            this.DGVTinhCong.Rows[_nhanVien].Cells[16].Value = "0";
                                                            this.DGVTinhCong.Rows[_nhanVien].Cells[17].Value = "0";
                                                            this.DGVTinhCong.Rows[_nhanVien].Cells[18].Value = this.sKHVang;
                                                            goto Label33;
                                                        }
                                                    }
                                                Label34:
                                                    this.DGVTinhCong.Rows[_nhanVien].Cells[4].Value = this.sTheoIDMayTenCaLamViec;
                                                    dtCaLamViecTheoIDMay = new System.Data.DataTable();
                                                    this._caLamViecDTO.MaCaLamViec = this.sTheoIDMayMaCaLamViec;
                                                    dtCaLamViecTheoIDMay = this._caLamViecBLL.CaLamViecGetByMaCaLamViec(this._caLamViecDTO);
                                                    for (iCaLamViecTheoIDMay = 0; iCaLamViecTheoIDMay < dtCaLamViecTheoIDMay.Rows.Count; iCaLamViecTheoIDMay++)
                                                    {
                                                        second = dGioVaoTheoIDMay.Second;
                                                        sGiayGioVao = second.ToString();
                                                        second = dGioRaTheoIDMay.Second;
                                                        sGiayGioRa = second.ToString();
                                                        dGioVaoKhaiBaoTheoIDMayA = Convert.ToDateTime(dtCaLamViecTheoIDMay.Rows[iCaLamViecTheoIDMay]["GioVaoLamViec"].ToString());
                                                        sGioVaoKhaiBaoTheoIDMayA = string.Format("{0:T}", dGioVaoKhaiBaoTheoIDMayA).Replace("00 ", string.Concat(sGiayGioVao, " "));
                                                        sGioVaoKhaiBaoTheoIDMayB = string.Concat(sNgayCham, " ", sGioVaoKhaiBaoTheoIDMayA);
                                                        dGioVaoKhaiBaoTheoIDMayB = Convert.ToDateTime(sGioVaoKhaiBaoTheoIDMayB);
                                                        dGioRaKhaiBaoTheoIDMayA = Convert.ToDateTime(dtCaLamViecTheoIDMay.Rows[iCaLamViecTheoIDMay]["GioKetThucLamViec"].ToString());
                                                        sGioRaKhaiBaoTheoIDMayA = string.Format("{0:T}", dGioRaKhaiBaoTheoIDMayA).Replace("00 ", string.Concat(sGiayGioRa, " "));
                                                        sGioRaKhaiBaoTheoIDMayB = string.Concat(sNgayCham, " ", sGioRaKhaiBaoTheoIDMayA);
                                                        dGioRaKhaiBaoTheoIDMayB = Convert.ToDateTime(sGioRaKhaiBaoTheoIDMayB);
                                                        sTruGioDiTre = dtCaLamViecTheoIDMay.Rows[iCaLamViecTheoIDMay]["TruGioDiTre"].ToString();
                                                        sBatDauTinhDiTre = dtCaLamViecTheoIDMay.Rows[iCaLamViecTheoIDMay]["BatDauTinhDiTre"].ToString();
                                                        iChoPhepDiTre = Convert.ToInt32(dtCaLamViecTheoIDMay.Rows[iCaLamViecTheoIDMay]["ChoPhepDiTre"].ToString());
                                                        value = dGioVaoTheoIDMay - dGioVaoKhaiBaoTheoIDMayB;
                                                        second = Convert.ToInt32(value.TotalMinutes);
                                                        sPhutTre = second.ToString();
                                                        if (!(sTruGioDiTre == "True"))
                                                        {
                                                            this.DGVTinhCong.Rows[_nhanVien].Cells[9].Value = "0";
                                                        }
                                                        else if (Convert.ToInt32(sPhutTre) >= 0)
                                                        {
                                                            iPhutTre = Convert.ToInt32(sPhutTre) - iChoPhepDiTre;
                                                            if (sBatDauTinhDiTre == "True")
                                                            {
                                                                if (iPhutTre >= 1)
                                                                {
                                                                    this.DGVTinhCong.Rows[_nhanVien].Cells[9].Value = iPhutTre.ToString();
                                                                }
                                                                else
                                                                {
                                                                    this.DGVTinhCong.Rows[_nhanVien].Cells[9].Value = "0";
                                                                }
                                                            }
                                                            else if (iPhutTre >= 1)
                                                            {
                                                                this.DGVTinhCong.Rows[_nhanVien].Cells[9].Value = sPhutTre;
                                                            }
                                                            else
                                                            {
                                                                this.DGVTinhCong.Rows[_nhanVien].Cells[9].Value = "0";
                                                            }
                                                        }
                                                        else
                                                        {
                                                            this.DGVTinhCong.Rows[_nhanVien].Cells[9].Value = "0";
                                                        }
                                                        sTruGioVeSom = dtCaLamViecTheoIDMay.Rows[iCaLamViecTheoIDMay]["TruGioVeSom"].ToString();
                                                        sBatDauTinhVeSom = dtCaLamViecTheoIDMay.Rows[iCaLamViecTheoIDMay]["BatDauTinhVeSom"].ToString();
                                                        iChoPhepVeSom = Convert.ToInt32(dtCaLamViecTheoIDMay.Rows[iCaLamViecTheoIDMay]["ChoPhepVeSom"].ToString());
                                                        value = dGioRaKhaiBaoTheoIDMayB - dGioRaTheoIDMay;
                                                        second = Convert.ToInt32(value.TotalMinutes);
                                                        sPhutVeSom = second.ToString();
                                                        if (!(sTruGioVeSom == "True"))
                                                        {
                                                            this.DGVTinhCong.Rows[_nhanVien].Cells[10].Value = "0";
                                                        }
                                                        else if (Convert.ToInt32(sPhutVeSom) >= 0)
                                                        {
                                                            iPhutVeSom = Convert.ToInt32(sPhutVeSom) - iChoPhepVeSom;
                                                            if (iPhutVeSom < 1)
                                                            {
                                                                this.DGVTinhCong.Rows[_nhanVien].Cells[10].Value = "0";
                                                            }
                                                            else if (!(sBatDauTinhVeSom == "True"))
                                                            {
                                                                this.DGVTinhCong.Rows[_nhanVien].Cells[10].Value = sPhutVeSom;
                                                            }
                                                            else
                                                            {
                                                                this.DGVTinhCong.Rows[_nhanVien].Cells[10].Value = iPhutVeSom.ToString();
                                                            }
                                                        }
                                                        else
                                                        {
                                                            this.DGVTinhCong.Rows[_nhanVien].Cells[10].Value = "0";
                                                        }
                                                        value = dGioRaTheoIDMay - dGioRaKhaiBaoTheoIDMayB;
                                                        second = Convert.ToInt32(value.TotalMinutes);
                                                        sVeTre = second.ToString();
                                                        if (Convert.ToInt32(sVeTre) <= 0)
                                                        {
                                                            this.DGVTinhCong.Rows[_nhanVien].Cells[11].Value = "0";
                                                        }
                                                        else
                                                        {
                                                            this.DGVTinhCong.Rows[_nhanVien].Cells[11].Value = sVeTre;
                                                        }
                                                        iPhut = Convert.ToSingle(dtCaLamViecTheoIDMay.Rows[iCaLamViecTheoIDMay]["TongGioTrongCaLamViec"]) * 60f - (float)(Convert.ToInt32(this.DGVTinhCong.Rows[_nhanVien].Cells[9].Value.ToString()) + Convert.ToInt32(this.DGVTinhCong.Rows[_nhanVien].Cells[10].Value));
                                                        dGio = Math.Round(Convert.ToDouble(iPhut) / 60, this.iLamTronGio);
                                                        this.DGVTinhCong.Rows[_nhanVien].Cells[8].Value = dGio.ToString();
                                                        iGio = Convert.ToDouble(dtCaLamViecTheoIDMay.Rows[iCaLamViecTheoIDMay]["TongGioTrongCaLamViec"].ToString());
                                                        dCongTinh = Convert.ToDouble(dtCaLamViecTheoIDMay.Rows[iCaLamViecTheoIDMay]["CongTinh"].ToString());
                                                        dCong = Math.Round(dGio * dCongTinh / iGio, this.iLamTronCong);
                                                        this.DGVTinhCong.Rows[_nhanVien].Cells[7].Value = dCong.ToString();
                                                        sTangCaTruocGioLamViec = dtCaLamViecTheoIDMay.Rows[iCaLamViecTheoIDMay]["TangCaTruocGioLamViec"].ToString();
                                                        sTangCaSauGioLamViec = dtCaLamViecTheoIDMay.Rows[iCaLamViecTheoIDMay]["TangCaSauGioLamViec"].ToString();
                                                        if ((sTangCaTruocGioLamViec != "False" ? false : sTangCaSauGioLamViec == "False"))
                                                        {
                                                            this.DGVTinhCong.Rows[_nhanVien].Cells[12].Value = "0";
                                                            this.DGVTinhCong.Rows[_nhanVien].Cells[13].Value = "0";
                                                            this.DGVTinhCong.Rows[_nhanVien].Cells[14].Value = "0";
                                                            this.DGVTinhCong.Rows[_nhanVien].Cells[15].Value = "0";
                                                        }
                                                        sXemCaNayLaTangCa = dtCaLamViecTheoIDMay.Rows[iCaLamViecTheoIDMay]["XemCaNayLaTangCa"].ToString();
                                                        iTangCaMuc = Convert.ToInt32(dtCaLamViecTheoIDMay.Rows[iCaLamViecTheoIDMay]["TangCaMuc"].ToString());
                                                        if (sXemCaNayLaTangCa == "True")
                                                        {
                                                            if (iTangCaMuc == 1)
                                                            {
                                                                this.DGVTinhCong.Rows[_nhanVien].Cells[7].Value = "0";
                                                                this.DGVTinhCong.Rows[_nhanVien].Cells[8].Value = "0";
                                                                this.DGVTinhCong.Rows[_nhanVien].Cells[12].Value = dGio.ToString();
                                                                this.DGVTinhCong.Rows[_nhanVien].Cells[13].Value = "0";
                                                                this.DGVTinhCong.Rows[_nhanVien].Cells[14].Value = "0";
                                                                this.DGVTinhCong.Rows[_nhanVien].Cells[15].Value = "0";
                                                            }
                                                            if (iTangCaMuc == 2)
                                                            {
                                                                this.DGVTinhCong.Rows[_nhanVien].Cells[7].Value = "0";
                                                                this.DGVTinhCong.Rows[_nhanVien].Cells[8].Value = "0";
                                                                this.DGVTinhCong.Rows[_nhanVien].Cells[12].Value = "0";
                                                                this.DGVTinhCong.Rows[_nhanVien].Cells[13].Value = dGio.ToString();
                                                                this.DGVTinhCong.Rows[_nhanVien].Cells[14].Value = "0";
                                                                this.DGVTinhCong.Rows[_nhanVien].Cells[15].Value = "0";
                                                            }
                                                            if (iTangCaMuc == 3)
                                                            {
                                                                this.DGVTinhCong.Rows[_nhanVien].Cells[7].Value = "0";
                                                                this.DGVTinhCong.Rows[_nhanVien].Cells[8].Value = "0";
                                                                this.DGVTinhCong.Rows[_nhanVien].Cells[12].Value = "0";
                                                                this.DGVTinhCong.Rows[_nhanVien].Cells[13].Value = "0";
                                                                this.DGVTinhCong.Rows[_nhanVien].Cells[14].Value = dGio.ToString();
                                                                this.DGVTinhCong.Rows[_nhanVien].Cells[15].Value = "0";
                                                            }
                                                            if (iTangCaMuc == 4)
                                                            {
                                                                this.DGVTinhCong.Rows[_nhanVien].Cells[7].Value = "0";
                                                                this.DGVTinhCong.Rows[_nhanVien].Cells[8].Value = "0";
                                                                this.DGVTinhCong.Rows[_nhanVien].Cells[12].Value = "0";
                                                                this.DGVTinhCong.Rows[_nhanVien].Cells[13].Value = "0";
                                                                this.DGVTinhCong.Rows[_nhanVien].Cells[14].Value = "0";
                                                                this.DGVTinhCong.Rows[_nhanVien].Cells[15].Value = dGio.ToString();
                                                            }
                                                        }
                                                        sChoPhepTangCaTruocGioLamViecTheoIDMay = dtCaLamViecTheoIDMay.Rows[iCaLamViecTheoIDMay]["TangCaTruocGioLamViec"].ToString();
                                                        iPhutTangCaTruocGioLamViecTheoIDMay = Convert.ToInt32(dtCaLamViecTheoIDMay.Rows[iCaLamViecTheoIDMay]["SoPhutTangCaTruocGioLamViec"].ToString());
                                                        iPhutTangCaTruocGioLamViecDatDen = Convert.ToInt32(dtCaLamViecTheoIDMay.Rows[iCaLamViecTheoIDMay]["TangCaTruocGioLamViecDatDen"].ToString());
                                                        iPhutTruTangCaTruoc = Convert.ToInt32(dtCaLamViecTheoIDMay.Rows[iCaLamViecTheoIDMay]["PhutTruTangCaTruoc"].ToString());
                                                        sChoPhepTangCaSauGioLamViecTheoIDMay = dtCaLamViecTheoIDMay.Rows[iCaLamViecTheoIDMay]["TangCaSauGioLamViec"].ToString();
                                                        iPhutTangCaSauGioLamViecTheoIDMay = Convert.ToInt32(dtCaLamViecTheoIDMay.Rows[iCaLamViecTheoIDMay]["SoPhutTangCaSauGioLamViec"].ToString());
                                                        iPhutTangCaSauGioLamViecDatDen = Convert.ToInt32(dtCaLamViecTheoIDMay.Rows[iCaLamViecTheoIDMay]["TangCaSauGioLamViecDatDen"].ToString());
                                                        iPhutTruTangCaSau = Convert.ToInt32(dtCaLamViecTheoIDMay.Rows[iCaLamViecTheoIDMay]["PhutTruTangCaSau"].ToString());
                                                        iGioiHanTC1TheoIDMay = Convert.ToInt32(dtCaLamViecTheoIDMay.Rows[iCaLamViecTheoIDMay]["GioiHanTangCa1"].ToString());
                                                        iGioiHanTC2TheoIDMay = Convert.ToInt32(dtCaLamViecTheoIDMay.Rows[iCaLamViecTheoIDMay]["GioiHanTangCa2"].ToString());
                                                        iGioiHanTC3TheoIDMay = Convert.ToInt32(dtCaLamViecTheoIDMay.Rows[iCaLamViecTheoIDMay]["GioiHanTangCa3"].ToString());
                                                        iGioiHanTC4TheoIDMay = Convert.ToInt32(dtCaLamViecTheoIDMay.Rows[iCaLamViecTheoIDMay]["GioiHanTangCa4"].ToString());
                                                        iTongGioTangCaSauTheoIDMay = 0;
                                                        iTongGioTangCaTruocTheoIDMay = 0;
                                                        if ((sChoPhepTangCaTruocGioLamViecTheoIDMay != "False" ? true : !(sChoPhepTangCaSauGioLamViecTheoIDMay == "False")))
                                                        {
                                                            if (sChoPhepTangCaTruocGioLamViecTheoIDMay == "True")
                                                            {
                                                                value = dGioVaoKhaiBaoTheoIDMayB - dGioVaoTheoIDMay;
                                                                second = Convert.ToInt32(value.TotalMinutes);
                                                                iThoiGianTruocGioLamTheoIDMay = Convert.ToInt32(second.ToString());
                                                                if (iThoiGianTruocGioLamTheoIDMay > 0)
                                                                {
                                                                    if (iThoiGianTruocGioLamTheoIDMay > iPhutTangCaTruocGioLamViecTheoIDMay)
                                                                    {
                                                                        if (iThoiGianTruocGioLamTheoIDMay > iPhutTangCaTruocGioLamViecDatDen)
                                                                        {
                                                                            iTongGioTangCaTruocTheoIDMay = iThoiGianTruocGioLamTheoIDMay - iPhutTruTangCaTruoc;
                                                                        }
                                                                    }
                                                                }
                                                            }
                                                            if (sChoPhepTangCaSauGioLamViecTheoIDMay == "True")
                                                            {
                                                                value = dGioRaTheoIDMay - dGioRaKhaiBaoTheoIDMayB;
                                                                second = Convert.ToInt32(value.TotalMinutes);
                                                                iThoiGianSauGioLamViecTheoIDMay = Convert.ToInt32(second.ToString());
                                                                if (iThoiGianSauGioLamViecTheoIDMay > 0)
                                                                {
                                                                    if (iThoiGianSauGioLamViecTheoIDMay > iPhutTangCaSauGioLamViecTheoIDMay)
                                                                    {
                                                                        if (iThoiGianSauGioLamViecTheoIDMay > iPhutTangCaSauGioLamViecDatDen)
                                                                        {
                                                                            iTongGioTangCaSauTheoIDMay = iThoiGianSauGioLamViecTheoIDMay - iPhutTruTangCaSau;
                                                                        }
                                                                    }
                                                                }
                                                            }
                                                        }
                                                        else
                                                        {
                                                            this.DGVTinhCong.Rows[_nhanVien].Cells[12].Value = "0";
                                                            this.DGVTinhCong.Rows[_nhanVien].Cells[13].Value = "0";
                                                            this.DGVTinhCong.Rows[_nhanVien].Cells[14].Value = "0";
                                                            this.DGVTinhCong.Rows[_nhanVien].Cells[15].Value = "0";
                                                        }
                                                        dTongThoiGianTangCaTheoIDMay = Convert.ToDouble(iTongGioTangCaTruocTheoIDMay + iTongGioTangCaSauTheoIDMay);
                                                        if (dTongThoiGianTangCaTheoIDMay <= 0)
                                                        {
                                                            this.DGVTinhCong.Rows[_nhanVien].Cells[12].Value = "0";
                                                            this.DGVTinhCong.Rows[_nhanVien].Cells[13].Value = "0";
                                                            this.DGVTinhCong.Rows[_nhanVien].Cells[14].Value = "0";
                                                            this.DGVTinhCong.Rows[_nhanVien].Cells[15].Value = "0";
                                                        }
                                                        else
                                                        {
                                                            if (iGioiHanTC1TheoIDMay == 0)
                                                            {
                                                                this.DGVTinhCong.Rows[_nhanVien].Cells[12].Value = Math.Round(dTongThoiGianTangCaTheoIDMay * this.dTangCa1HeSo / 60, this.iLamTronGio);
                                                                this.DGVTinhCong.Rows[_nhanVien].Cells[13].Value = "0";
                                                                this.DGVTinhCong.Rows[_nhanVien].Cells[14].Value = "0";
                                                                this.DGVTinhCong.Rows[_nhanVien].Cells[15].Value = "0";
                                                            }
                                                            if ((iGioiHanTC1TheoIDMay == 0 ? false : iGioiHanTC2TheoIDMay == 0))
                                                            {
                                                                if (dTongThoiGianTangCaTheoIDMay >= Convert.ToDouble(iGioiHanTC1TheoIDMay))
                                                                {
                                                                    this.DGVTinhCong.Rows[_nhanVien].Cells[12].Value = Math.Round(Convert.ToDouble(iGioiHanTC1TheoIDMay) / 60 * this.dTangCa1HeSo, this.iLamTronGio);
                                                                    if (dTongThoiGianTangCaTheoIDMay - Convert.ToDouble(iGioiHanTC1TheoIDMay) > 0)
                                                                    {
                                                                        this.DGVTinhCong.Rows[_nhanVien].Cells[13].Value = Math.Round((dTongThoiGianTangCaTheoIDMay - Convert.ToDouble(iGioiHanTC1TheoIDMay)) * this.dTangCa2HeSo / 60, this.iLamTronGio);
                                                                    }
                                                                    this.DGVTinhCong.Rows[_nhanVien].Cells[14].Value = "0";
                                                                    this.DGVTinhCong.Rows[_nhanVien].Cells[15].Value = "0";
                                                                }
                                                                else
                                                                {
                                                                    this.DGVTinhCong.Rows[_nhanVien].Cells[12].Value = Math.Round(dTongThoiGianTangCaTheoIDMay * this.dTangCa1HeSo / 60, this.iLamTronGio);
                                                                    this.DGVTinhCong.Rows[_nhanVien].Cells[13].Value = "0";
                                                                    this.DGVTinhCong.Rows[_nhanVien].Cells[14].Value = "0";
                                                                    this.DGVTinhCong.Rows[_nhanVien].Cells[15].Value = "0";
                                                                }
                                                            }
                                                            if ((iGioiHanTC1TheoIDMay == 0 || iGioiHanTC2TheoIDMay == 0 ? false : iGioiHanTC3TheoIDMay == 0))
                                                            {
                                                                if (dTongThoiGianTangCaTheoIDMay >= Convert.ToDouble(iGioiHanTC1TheoIDMay))
                                                                {
                                                                    this.DGVTinhCong.Rows[_nhanVien].Cells[12].Value = Math.Round(Convert.ToDouble(iGioiHanTC1TheoIDMay) * this.dTangCa1HeSo / 60, this.iLamTronGio);
                                                                    if (dTongThoiGianTangCaTheoIDMay - Convert.ToDouble(iGioiHanTC1TheoIDMay) >= Convert.ToDouble(iGioiHanTC2TheoIDMay))
                                                                    {
                                                                        this.DGVTinhCong.Rows[_nhanVien].Cells[12].Value = Math.Round(Convert.ToDouble(iGioiHanTC1TheoIDMay) * this.dTangCa1HeSo / 60, this.iLamTronGio);
                                                                        this.DGVTinhCong.Rows[_nhanVien].Cells[13].Value = Math.Round(Convert.ToDouble(iGioiHanTC2TheoIDMay) * this.dTangCa2HeSo / 60, this.iLamTronGio);
                                                                        this.DGVTinhCong.Rows[_nhanVien].Cells[14].Value = Math.Round((dTongThoiGianTangCaTheoIDMay - Convert.ToDouble(iGioiHanTC1TheoIDMay) - Convert.ToDouble(iGioiHanTC2TheoIDMay)) * this.dTangCa3HeSo / 60, this.iLamTronGio);
                                                                        this.DGVTinhCong.Rows[_nhanVien].Cells[15].Value = "0";
                                                                    }
                                                                    else
                                                                    {
                                                                        this.DGVTinhCong.Rows[_nhanVien].Cells[13].Value = Math.Round((dTongThoiGianTangCaTheoIDMay - Convert.ToDouble(iGioiHanTC1TheoIDMay)) * this.dTangCa2HeSo / 60, this.iLamTronGio);
                                                                        this.DGVTinhCong.Rows[_nhanVien].Cells[14].Value = "0";
                                                                        this.DGVTinhCong.Rows[_nhanVien].Cells[15].Value = "0";
                                                                    }
                                                                }
                                                                else
                                                                {
                                                                    this.DGVTinhCong.Rows[_nhanVien].Cells[12].Value = Math.Round(dTongThoiGianTangCaTheoIDMay * this.dTangCa1HeSo / 60, this.iLamTronGio);
                                                                    this.DGVTinhCong.Rows[_nhanVien].Cells[13].Value = "0";
                                                                    this.DGVTinhCong.Rows[_nhanVien].Cells[14].Value = "0";
                                                                    this.DGVTinhCong.Rows[_nhanVien].Cells[15].Value = "0";
                                                                }
                                                            }
                                                            if ((iGioiHanTC1TheoIDMay == 0 || iGioiHanTC2TheoIDMay == 0 || iGioiHanTC3TheoIDMay == 0 ? false : iGioiHanTC4TheoIDMay == 0))
                                                            {
                                                            }
                                                        }
                                                        value = dGioRaTheoIDMay - dGioVaoTheoIDMay;
                                                        second = Convert.ToInt32(value.TotalMinutes);
                                                        num = Math.Round(Convert.ToDouble(second.ToString()) / 60, this.iLamTronGio);
                                                        sTongGio = num.ToString();
                                                        this.DGVTinhCong.Rows[_nhanVien].Cells[16].Value = sTongGio;
                                                        this.DGVTinhCong.Rows[_nhanVien].Cells[17].Value = dtCaLamViecTheoIDMay.Rows[iCaLamViecTheoIDMay]["CongTinh"].ToString();
                                                        this.DGVTinhCong.Rows[_nhanVien].Cells[18].Value = this.sKHDungGio;
                                                        if (!(DateTimeProgress.XuatIDThu((int)dt.AddDays((double)dem).DayOfWeek) == "0"))
                                                        {
                                                            this.DGVTinhCong.Rows[_nhanVien].Cells[19].Value = "NT";
                                                        }
                                                        else
                                                        {
                                                            this.DGVTinhCong.Rows[_nhanVien].Cells[19].Value = "CN";
                                                        }
                                                        this.DGVTinhCong.Rows[_nhanVien].Cells[20].Value = this.sMaChamCong;
                                                        this.DGVTinhCong.Rows[_nhanVien].Cells[21].Value = this.sPhongBanTinhCong;
                                                    }
                                                }
                                            Label33:;
                                            }
                                            else
                                            {
                                                dGioNgayHomTruoc = new DateTime();
                                                dateTime = dt.AddDays((double)(dem - 1));
                                                DateTime dNgayTruocTheoIDMay = Convert.ToDateTime(dateTime.ToString());
                                                System.Data.DataTable dtNgayTruocTheoIDMay = new System.Data.DataTable();
                                                this._checkInOutDTO.MaChamCong = Convert.ToInt32(this.sMaChamCong);
                                                this._checkInOutDTO.NgayCham = dNgayTruocTheoIDMay;
                                                dtNgayTruocTheoIDMay = this._checkInOutBLL.getCheckInOutByMaChamCongAndNgayCham(this._checkInOutDTO);
                                                for (int iNgayTruocTheoIDMay = 0; iNgayTruocTheoIDMay < dtNgayTruocTheoIDMay.Rows.Count; iNgayTruocTheoIDMay++)
                                                {
                                                    dGioNgayHomTruoc = Convert.ToDateTime(dtNgayTruocTheoIDMay.Rows[iNgayTruocTheoIDMay]["GioCham"].ToString());
                                                }
                                                dGioRaTheoIDMay = Convert.ToDateTime(dateGioChamTheoIDMay.ToString());
                                                this.DGVTinhCong.Rows[_nhanVien - 1].Cells[6].Value = string.Format(this.sDinhDangThoiGian, dGioRaTheoIDMay);
                                                System.Data.DataTable dtNhanCaQuaDemTheoIDMay = new System.Data.DataTable();
                                                this._chiTietLichTrinhChoCalamViecDTO.MaLichTrinhCaLamViec = sLTCCLVNhanVien;
                                                this._chiTietLichTrinhChoCalamViecDTO.Thu = sThu;
                                                dtNhanCaQuaDemTheoIDMay = this._chiTietLichTrinhChoCaLamViecBLL.ChiTietLichTrinhChoCaLamViecNhanCa(this._chiTietLichTrinhChoCalamViecDTO);
                                                int iChiTietLichTrinhChoCaLamViecQuaDemTheoIDMay = 0;
                                                if (iChiTietLichTrinhChoCaLamViecQuaDemTheoIDMay < dtNhanCaQuaDemTheoIDMay.Rows.Count)
                                                {
                                                    int cellChiTietLichTrinhChoCaLamViecQuaDemTheoIDMay = 3;
                                                    while (cellChiTietLichTrinhChoCaLamViecQuaDemTheoIDMay < 13)
                                                    {
                                                        kiemTraVao = 0;
                                                        kiemTraRa = 0;
                                                        this.sTheoIDMayMaCaLamViec = dtNhanCaQuaDemTheoIDMay.Rows[iChiTietLichTrinhChoCaLamViecQuaDemTheoIDMay][cellChiTietLichTrinhChoCaLamViecQuaDemTheoIDMay].ToString();
                                                        dtTheoIDMayCa1 = new System.Data.DataTable();
                                                        this._caLamViecDTO.MaCaLamViec = this.sTheoIDMayMaCaLamViec;
                                                        dtTheoIDMayCa1 = this._caLamViecBLL.CaLamViecGetByMaCaLamViec(this._caLamViecDTO);
                                                        iTheoIDMayCa1 = 0;
                                                        while (iTheoIDMayCa1 < dtTheoIDMayCa1.Rows.Count)
                                                        {
                                                            this.sTheoIDMayTenCaLamViec = dtTheoIDMayCa1.Rows[iTheoIDMayCa1]["CaLamViec"].ToString();
                                                            dBatDauVaoTheoIDMayA = Convert.ToDateTime(dtTheoIDMayCa1.Rows[iTheoIDMayCa1]["BatDauVao"].ToString());
                                                            sBatDauVaoTheoIDMayA = string.Format("{0:T}", dBatDauVaoTheoIDMayA);
                                                            sBatDauVaoTheoIDMayB = string.Concat(sNgayCham, " ", sBatDauVaoTheoIDMayA);
                                                            dateTime = Convert.ToDateTime(sBatDauVaoTheoIDMayB);
                                                            dBatDauVaoTheoIDMayB = dateTime.AddDays(-1);
                                                            dKetThucVaoTheoIDMayA = Convert.ToDateTime(dtTheoIDMayCa1.Rows[iTheoIDMayCa1]["KetThucVao"].ToString());
                                                            sKetThucVaoTheoIDMayA = string.Format("{0:T}", dKetThucVaoTheoIDMayA);
                                                            sKetThucVaoTheoIDMayB = string.Concat(sNgayCham, " ", sKetThucVaoTheoIDMayA);
                                                            dateTime = Convert.ToDateTime(sKetThucVaoTheoIDMayB);
                                                            dKetThucVaoTheoIDMayB = dateTime.AddDays(-1);
                                                            dBatDauRaTheoIDMayA = Convert.ToDateTime(dtTheoIDMayCa1.Rows[iTheoIDMayCa1]["BatDauRa"].ToString());
                                                            sBatDauRaTheoIDMayA = string.Format("{0:T}", dBatDauRaTheoIDMayA);
                                                            sBatDauRaTheoIDMayB = string.Concat(sNgayCham, " ", sBatDauRaTheoIDMayA);
                                                            dateTime = Convert.ToDateTime(sBatDauRaTheoIDMayB);
                                                            dBatDauRaTheoIDMayB = dateTime.AddDays(-1);
                                                            if (!(sBatDauRaTheoIDMayA == "12:01:00 AM"))
                                                            {
                                                                dBatDauRaTheoIDMayB = Convert.ToDateTime(sBatDauRaTheoIDMayB);
                                                            }
                                                            else
                                                            {
                                                                dateTime = dBatDauRaTheoIDMayB.AddDays(1);
                                                                dBatDauRaTheoIDMayB = Convert.ToDateTime(dateTime.ToString());
                                                            }
                                                            dKetThucRaTheoIDMayA = Convert.ToDateTime(dtTheoIDMayCa1.Rows[iTheoIDMayCa1]["KetThucRa"].ToString());
                                                            sKetThucRaTheoIDMayA = string.Format("{0:T}", dKetThucRaTheoIDMayA);
                                                            sKetThucRaTheoIDMayB = string.Concat(sNgayCham, " ", sKetThucRaTheoIDMayA);
                                                            dateTime = Convert.ToDateTime(sKetThucRaTheoIDMayB);
                                                            dKetThucRaTheoIDMayB = dateTime.AddDays(-1);
                                                            if (!(sBatDauRaTheoIDMayA == "12:01:00 AM"))
                                                            {
                                                                dKetThucRaTheoIDMayB = Convert.ToDateTime(sKetThucRaTheoIDMayB);
                                                            }
                                                            else
                                                            {
                                                                dateTime = dKetThucRaTheoIDMayB.AddDays(1);
                                                                dKetThucRaTheoIDMayB = Convert.ToDateTime(dateTime.ToString());
                                                            }
                                                            if ((dGioNgayHomTruoc < dBatDauVaoTheoIDMayB ? false : dGioNgayHomTruoc <= dKetThucVaoTheoIDMayB))
                                                            {
                                                                kiemTraVao++;
                                                            }
                                                            if ((dGioRaTheoIDMay < dBatDauRaTheoIDMayB ? false : dGioRaTheoIDMay <= dKetThucRaTheoIDMayB))
                                                            {
                                                                kiemTraRa++;
                                                            }
                                                            if ((kiemTraVao != 1 ? true : kiemTraRa != 1))
                                                            {
                                                                iTheoIDMayCa1++;
                                                            }
                                                            else
                                                            {
                                                                goto Label36;
                                                            }
                                                        }
                                                        if (!(this.sTheoIDMayMaCaLamViec == ""))
                                                        {
                                                            cellChiTietLichTrinhChoCaLamViecQuaDemTheoIDMay++;
                                                        }
                                                        else
                                                        {
                                                            this.DGVTinhCong.Rows[_nhanVien - 1].Cells[4].Value = "***";
                                                            this.DGVTinhCong.Rows[_nhanVien - 1].Cells[7].Value = "0";
                                                            this.DGVTinhCong.Rows[_nhanVien - 1].Cells[8].Value = "0";
                                                            this.DGVTinhCong.Rows[_nhanVien - 1].Cells[9].Value = "0";
                                                            this.DGVTinhCong.Rows[_nhanVien - 1].Cells[10].Value = "0";
                                                            this.DGVTinhCong.Rows[_nhanVien - 1].Cells[11].Value = "0";
                                                            this.DGVTinhCong.Rows[_nhanVien - 1].Cells[12].Value = "0";
                                                            this.DGVTinhCong.Rows[_nhanVien - 1].Cells[13].Value = "0";
                                                            this.DGVTinhCong.Rows[_nhanVien - 1].Cells[14].Value = "0";
                                                            this.DGVTinhCong.Rows[_nhanVien - 1].Cells[15].Value = "0";
                                                            this.DGVTinhCong.Rows[_nhanVien - 1].Cells[16].Value = "0";
                                                            this.DGVTinhCong.Rows[_nhanVien - 1].Cells[17].Value = "0";
                                                            this.DGVTinhCong.Rows[_nhanVien - 1].Cells[18].Value = this.sKHVang;
                                                            if (!(DateTimeProgress.XuatThuQuaDem((int)dt.AddDays((double)dem).DayOfWeek) == "1"))
                                                            {
                                                                this.DGVTinhCong.Rows[_nhanVien - 1].Cells[19].Value = "NT";
                                                            }
                                                            else
                                                            {
                                                                this.DGVTinhCong.Rows[_nhanVien - 1].Cells[19].Value = "CN";
                                                            }
                                                            this.DGVTinhCong.Rows[_nhanVien - 1].Cells[20].Value = this.sMaChamCong;
                                                            this.DGVTinhCong.Rows[_nhanVien - 1].Cells[21].Value = this.sPhongBanTinhCong;
                                                            goto Label35;
                                                        }
                                                    }
                                                Label36:
                                                    this.DGVTinhCong.Rows[_nhanVien - 1].Cells[4].Value = this.sTheoIDMayTenCaLamViec;
                                                    System.Data.DataTable dtThongSoCaLamViecTheoIDMay = new System.Data.DataTable();
                                                    this._caLamViecDTO.MaCaLamViec = this.sTheoIDMayMaCaLamViec;
                                                    dtThongSoCaLamViecTheoIDMay = this._caLamViecBLL.CaLamViecGetByMaCaLamViec(this._caLamViecDTO);
                                                    for (int iThongSoCaLamViecTheoIDMay = 0; iThongSoCaLamViecTheoIDMay < dtThongSoCaLamViecTheoIDMay.Rows.Count; iThongSoCaLamViecTheoIDMay++)
                                                    {
                                                        value = dGioRaTheoIDMay - dGioNgayHomTruoc;
                                                        int iTongPhutTheoIDMay = Convert.ToInt32(value.TotalMinutes);
                                                        double dTongGioTheoIDMay = Math.Round(Convert.ToDouble(iTongPhutTheoIDMay) / 60, this.iLamTronGio);
                                                        this.DGVTinhCong.Rows[_nhanVien - 1].Cells[16].Value = dTongGioTheoIDMay.ToString();
                                                        this.DGVTinhCong.Rows[_nhanVien - 1].Cells[17].Value = dtThongSoCaLamViecTheoIDMay.Rows[iThongSoCaLamViecTheoIDMay]["CongTinh"].ToString();
                                                        second = dGioNgayHomTruoc.Second;
                                                        sGiayGioVao = second.ToString();
                                                        second = dGioRaTheoIDMay.Second;
                                                        sGiayGioRa = second.ToString();
                                                        dGioVaoKhaiBaoTheoIDMayA = Convert.ToDateTime(dtThongSoCaLamViecTheoIDMay.Rows[iThongSoCaLamViecTheoIDMay]["GioVaoLamViec"].ToString());
                                                        sGioVaoKhaiBaoTheoIDMayA = string.Format("{0:T}", dGioVaoKhaiBaoTheoIDMayA).Replace("00 ", string.Concat(sGiayGioVao, " "));
                                                        sGioVaoKhaiBaoTheoIDMayB = string.Concat(sNgayCham, " ", sGioVaoKhaiBaoTheoIDMayA);
                                                        dGioRaKhaiBaoTheoIDMayA = Convert.ToDateTime(dtThongSoCaLamViecTheoIDMay.Rows[iThongSoCaLamViecTheoIDMay]["GioKetThucLamViec"].ToString());
                                                        sGioRaKhaiBaoTheoIDMayA = string.Format("{0:T}", dGioRaKhaiBaoTheoIDMayA).Replace("00 ", string.Concat(sGiayGioRa, " "));
                                                        sGioRaKhaiBaoTheoIDMayB = string.Concat(sNgayCham, " ", sGioRaKhaiBaoTheoIDMayA);
                                                        sCatChuoi = sGioRaKhaiBaoTheoIDMayB.Substring(sGioRaKhaiBaoTheoIDMayB.Length - 2);
                                                        sTruGioDiTre = dtThongSoCaLamViecTheoIDMay.Rows[iThongSoCaLamViecTheoIDMay]["TruGioDiTre"].ToString();
                                                        sBatDauTinhDiTre = dtThongSoCaLamViecTheoIDMay.Rows[iThongSoCaLamViecTheoIDMay]["BatDauTinhDiTre"].ToString();
                                                        if (!(sTruGioDiTre == "True"))
                                                        {
                                                            this.DGVTinhCong.Rows[_nhanVien - 1].Cells[9].Value = "0";
                                                        }
                                                        else
                                                        {
                                                            int iChoPhepTreTheoIDMay = Convert.ToInt32(dtThongSoCaLamViecTheoIDMay.Rows[iThongSoCaLamViecTheoIDMay]["ChoPhepDiTre"].ToString());
                                                            if (!(sBatDauTinhDiTre == "True"))
                                                            {
                                                                dateTime = Convert.ToDateTime(sGioVaoKhaiBaoTheoIDMayB);
                                                                value = dGioNgayHomTruoc - dateTime.AddDays(-1);
                                                                iPhutTreTheoIDMay = Convert.ToInt32(value.TotalMinutes) - iChoPhepTreTheoIDMay;
                                                                if (iPhutTreTheoIDMay <= 0)
                                                                {
                                                                    this.DGVTinhCong.Rows[_nhanVien - 1].Cells[9].Value = "0";
                                                                }
                                                                else
                                                                {
                                                                    DataGridViewCell str2 = this.DGVTinhCong.Rows[_nhanVien - 1].Cells[9];
                                                                    dateTime = Convert.ToDateTime(sGioVaoKhaiBaoTheoIDMayB);
                                                                    value = dGioNgayHomTruoc - dateTime.AddDays(-1);
                                                                    second = Convert.ToInt32(value.TotalMinutes);
                                                                    str2.Value = second.ToString();
                                                                }
                                                            }
                                                            else
                                                            {
                                                                dateTime = Convert.ToDateTime(sGioVaoKhaiBaoTheoIDMayB);
                                                                value = dGioNgayHomTruoc - dateTime.AddDays(-1);
                                                                iPhutTreTheoIDMay = Convert.ToInt32(value.TotalMinutes) - iChoPhepTreTheoIDMay;
                                                                if (iPhutTreTheoIDMay <= 0)
                                                                {
                                                                    this.DGVTinhCong.Rows[_nhanVien - 1].Cells[9].Value = "0";
                                                                }
                                                                else
                                                                {
                                                                    this.DGVTinhCong.Rows[_nhanVien - 1].Cells[9].Value = iPhutTreTheoIDMay.ToString();
                                                                }
                                                            }
                                                        }
                                                        sTruGioVeSom = dtThongSoCaLamViecTheoIDMay.Rows[iThongSoCaLamViecTheoIDMay]["TruGioVeSom"].ToString();
                                                        sBatDauTinhVeSom = dtThongSoCaLamViecTheoIDMay.Rows[iThongSoCaLamViecTheoIDMay]["BatDauTinhVeSom"].ToString();
                                                        if (!(sTruGioVeSom == "True"))
                                                        {
                                                            this.DGVTinhCong.Rows[_nhanVien - 1].Cells[10].Value = "0";
                                                        }
                                                        else
                                                        {
                                                            int iChoPhepVeSomTheoIDMay = Convert.ToInt32(dtThongSoCaLamViecTheoIDMay.Rows[iThongSoCaLamViecTheoIDMay]["ChoPhepVeSom"].ToString());
                                                            if (!(sBatDauTinhVeSom == "True"))
                                                            {
                                                                value = Convert.ToDateTime(sGioRaKhaiBaoTheoIDMayB) - dGioRaTheoIDMay;
                                                                iPhutVeSomTheoIDMay = Convert.ToInt32(value.TotalMinutes) - iChoPhepVeSomTheoIDMay;
                                                                if (iPhutVeSomTheoIDMay <= 0)
                                                                {
                                                                    this.DGVTinhCong.Rows[_nhanVien - 1].Cells[10].Value = "0";
                                                                }
                                                                else
                                                                {
                                                                    DataGridViewCell str3 = this.DGVTinhCong.Rows[_nhanVien - 1].Cells[10];
                                                                    value = Convert.ToDateTime(sGioRaKhaiBaoTheoIDMayB) - dGioRaTheoIDMay;
                                                                    second = Convert.ToInt32(value.TotalMinutes);
                                                                    str3.Value = second.ToString();
                                                                }
                                                            }
                                                            else if (!(sCatChuoi == "PM"))
                                                            {
                                                                value = Convert.ToDateTime(sGioRaKhaiBaoTheoIDMayB) - dGioRaTheoIDMay;
                                                                iPhutVeSomTheoIDMay = Convert.ToInt32(value.TotalMinutes) - iChoPhepVeSomTheoIDMay;
                                                                if (iPhutVeSomTheoIDMay <= 0)
                                                                {
                                                                    this.DGVTinhCong.Rows[_nhanVien - 1].Cells[10].Value = "0";
                                                                }
                                                                else
                                                                {
                                                                    this.DGVTinhCong.Rows[_nhanVien - 1].Cells[10].Value = iPhutVeSomTheoIDMay.ToString();
                                                                }
                                                            }
                                                            else
                                                            {
                                                                dateTime = Convert.ToDateTime(sGioRaKhaiBaoTheoIDMayB);
                                                                value = dateTime.AddDays(-1) - dGioRaTheoIDMay;
                                                                iPhutVeSomTheoIDMay = Convert.ToInt32(value.TotalMinutes) - iChoPhepVeSomTheoIDMay;
                                                                if (iPhutVeSomTheoIDMay <= 0)
                                                                {
                                                                    this.DGVTinhCong.Rows[_nhanVien - 1].Cells[10].Value = "0";
                                                                }
                                                                else
                                                                {
                                                                    this.DGVTinhCong.Rows[_nhanVien - 1].Cells[10].Value = iPhutVeSomTheoIDMay.ToString();
                                                                }
                                                            }
                                                        }
                                                        if (!(sCatChuoi == "PM"))
                                                        {
                                                            value = dGioRaTheoIDMay - Convert.ToDateTime(sGioRaKhaiBaoTheoIDMayB);
                                                            iPhutVeTre = Convert.ToInt32(value.TotalMinutes);
                                                            if (iPhutVeTre <= 0)
                                                            {
                                                                this.DGVTinhCong.Rows[_nhanVien - 1].Cells[11].Value = "0";
                                                            }
                                                            else
                                                            {
                                                                this.DGVTinhCong.Rows[_nhanVien - 1].Cells[11].Value = iPhutVeTre;
                                                            }
                                                        }
                                                        else
                                                        {
                                                            dateTime = Convert.ToDateTime(sGioRaKhaiBaoTheoIDMayB);
                                                            value = dGioRaTheoIDMay - dateTime.AddDays(-1);
                                                            iPhutVeTre = Convert.ToInt32(value.TotalMinutes);
                                                            if (iPhutVeTre <= 0)
                                                            {
                                                                this.DGVTinhCong.Rows[_nhanVien - 1].Cells[11].Value = "0";
                                                            }
                                                            else
                                                            {
                                                                this.DGVTinhCong.Rows[_nhanVien - 1].Cells[11].Value = iPhutVeTre;
                                                            }
                                                        }
                                                        double dTongGioTrongCaTheoIDMay = Convert.ToDouble(dtThongSoCaLamViecTheoIDMay.Rows[iThongSoCaLamViecTheoIDMay]["TongGioTrongCaLamViec"].ToString());
                                                        double dTongCongTrongCaTheoIDMay = Convert.ToDouble(dtThongSoCaLamViecTheoIDMay.Rows[iThongSoCaLamViecTheoIDMay]["CongTinh"].ToString());
                                                        double dTongPhutTreSomTheoIDMay = Convert.ToDouble(this.DGVTinhCong.Rows[_nhanVien - 1].Cells[9].Value.ToString()) + Convert.ToDouble(this.DGVTinhCong.Rows[_nhanVien - 1].Cells[10].Value.ToString());
                                                        dSoPhutLamDuocTrongCa = dTongGioTrongCaTheoIDMay * 60 - dTongPhutTreSomTheoIDMay;
                                                        this.DGVTinhCong.Rows[_nhanVien - 1].Cells[8].Value = Math.Round(dSoPhutLamDuocTrongCa / 60, this.iLamTronGio);
                                                        this.DGVTinhCong.Rows[_nhanVien - 1].Cells[7].Value = Math.Round(Convert.ToDouble(this.DGVTinhCong.Rows[_nhanVien - 1].Cells[8].Value.ToString()) * dTongCongTrongCaTheoIDMay / dTongGioTrongCaTheoIDMay, this.iLamTronCong);
                                                        sChoPhepTangCaTruocGioLamViecTheoIDMay = dtThongSoCaLamViecTheoIDMay.Rows[iThongSoCaLamViecTheoIDMay]["TangCaTruocGioLamViec"].ToString();
                                                        iPhutTangCaTruocGioLamViecTheoIDMay = Convert.ToInt32(dtThongSoCaLamViecTheoIDMay.Rows[iThongSoCaLamViecTheoIDMay]["SoPhutTangCaTruocGioLamViec"].ToString());
                                                        iPhutTangCaTruocGioLamViecDatDen = Convert.ToInt32(dtThongSoCaLamViecTheoIDMay.Rows[iThongSoCaLamViecTheoIDMay]["TangCaTruocGioLamViecDatDen"].ToString());
                                                        iPhutTruTangCaTruoc = Convert.ToInt32(dtThongSoCaLamViecTheoIDMay.Rows[iThongSoCaLamViecTheoIDMay]["PhutTruTangCaTruoc"].ToString());
                                                        sChoPhepTangCaSauGioLamViecTheoIDMay = dtThongSoCaLamViecTheoIDMay.Rows[iThongSoCaLamViecTheoIDMay]["TangCaSauGioLamViec"].ToString();
                                                        iPhutTangCaSauGioLamViecTheoIDMay = Convert.ToInt32(dtThongSoCaLamViecTheoIDMay.Rows[iThongSoCaLamViecTheoIDMay]["SoPhutTangCaSauGioLamViec"].ToString());
                                                        iPhutTangCaSauGioLamViecDatDen = Convert.ToInt32(dtThongSoCaLamViecTheoIDMay.Rows[iThongSoCaLamViecTheoIDMay]["TangCaSauGioLamViecDatDen"].ToString());
                                                        iPhutTruTangCaSau = Convert.ToInt32(dtThongSoCaLamViecTheoIDMay.Rows[iThongSoCaLamViecTheoIDMay]["PhutTruTangCaSau"].ToString());
                                                        iGioiHanTC1TheoIDMay = Convert.ToInt32(dtThongSoCaLamViecTheoIDMay.Rows[iThongSoCaLamViecTheoIDMay]["GioiHanTangCa1"].ToString());
                                                        iGioiHanTC2TheoIDMay = Convert.ToInt32(dtThongSoCaLamViecTheoIDMay.Rows[iThongSoCaLamViecTheoIDMay]["GioiHanTangCa2"].ToString());
                                                        iGioiHanTC3TheoIDMay = Convert.ToInt32(dtThongSoCaLamViecTheoIDMay.Rows[iThongSoCaLamViecTheoIDMay]["GioiHanTangCa3"].ToString());
                                                        iGioiHanTC4TheoIDMay = Convert.ToInt32(dtThongSoCaLamViecTheoIDMay.Rows[iThongSoCaLamViecTheoIDMay]["GioiHanTangCa4"].ToString());
                                                        iTongGioTangCaSauTheoIDMay = 0;
                                                        iTongGioTangCaTruocTheoIDMay = 0;
                                                        if ((sChoPhepTangCaTruocGioLamViecTheoIDMay != "False" ? true : !(sChoPhepTangCaSauGioLamViecTheoIDMay == "False")))
                                                        {
                                                            if (sChoPhepTangCaTruocGioLamViecTheoIDMay == "True")
                                                            {
                                                                dateTime = Convert.ToDateTime(sGioVaoKhaiBaoTheoIDMayB);
                                                                value = dateTime.AddDays(-1) - dGioNgayHomTruoc;
                                                                second = Convert.ToInt32(value.TotalMinutes);
                                                                iThoiGianTruocGioLamTheoIDMay = Convert.ToInt32(second.ToString());
                                                                if (iThoiGianTruocGioLamTheoIDMay > 0)
                                                                {
                                                                    if (iThoiGianTruocGioLamTheoIDMay > iPhutTangCaTruocGioLamViecTheoIDMay)
                                                                    {
                                                                        if (iThoiGianTruocGioLamTheoIDMay > iPhutTangCaTruocGioLamViecDatDen)
                                                                        {
                                                                            iTongGioTangCaTruocTheoIDMay = iThoiGianTruocGioLamTheoIDMay - iPhutTruTangCaTruoc;
                                                                        }
                                                                    }
                                                                }
                                                            }
                                                            if (sChoPhepTangCaSauGioLamViecTheoIDMay == "True")
                                                            {
                                                                if (!(sCatChuoi == "PM"))
                                                                {
                                                                    value = dGioRaTheoIDMay - Convert.ToDateTime(sGioRaKhaiBaoTheoIDMayB);
                                                                    second = Convert.ToInt32(value.TotalMinutes);
                                                                    iThoiGianSauGioLamViecTheoIDMay = Convert.ToInt32(second.ToString());
                                                                    if (iThoiGianSauGioLamViecTheoIDMay > 0)
                                                                    {
                                                                        if (iThoiGianSauGioLamViecTheoIDMay > iPhutTangCaSauGioLamViecTheoIDMay)
                                                                        {
                                                                            if (iThoiGianSauGioLamViecTheoIDMay > iPhutTangCaSauGioLamViecDatDen)
                                                                            {
                                                                                iTongGioTangCaSauTheoIDMay = iThoiGianSauGioLamViecTheoIDMay - iPhutTruTangCaSau;
                                                                            }
                                                                        }
                                                                    }
                                                                }
                                                                else
                                                                {
                                                                    dateTime = Convert.ToDateTime(sGioRaKhaiBaoTheoIDMayB);
                                                                    value = dGioRaTheoIDMay - dateTime.AddDays(-1);
                                                                    second = Convert.ToInt32(value.TotalMinutes);
                                                                    iThoiGianSauGioLamViecTheoIDMay = Convert.ToInt32(second.ToString());
                                                                    if (iThoiGianSauGioLamViecTheoIDMay > 0)
                                                                    {
                                                                        if (iThoiGianSauGioLamViecTheoIDMay > iPhutTangCaSauGioLamViecTheoIDMay)
                                                                        {
                                                                            if (iThoiGianSauGioLamViecTheoIDMay > iPhutTangCaSauGioLamViecDatDen)
                                                                            {
                                                                                iTongGioTangCaSauTheoIDMay = iThoiGianSauGioLamViecTheoIDMay - iPhutTruTangCaSau;
                                                                            }
                                                                        }
                                                                    }
                                                                }
                                                            }
                                                        }
                                                        else
                                                        {
                                                            this.DGVTinhCong.Rows[_nhanVien - 1].Cells[12].Value = "0";
                                                            this.DGVTinhCong.Rows[_nhanVien - 1].Cells[13].Value = "0";
                                                            this.DGVTinhCong.Rows[_nhanVien - 1].Cells[14].Value = "0";
                                                            this.DGVTinhCong.Rows[_nhanVien - 1].Cells[15].Value = "0";
                                                        }
                                                        dTongThoiGianTangCaTheoIDMay = Convert.ToDouble(iTongGioTangCaTruocTheoIDMay + iTongGioTangCaSauTheoIDMay);
                                                        if (dTongThoiGianTangCaTheoIDMay <= 0)
                                                        {
                                                            this.DGVTinhCong.Rows[_nhanVien - 1].Cells[12].Value = "0";
                                                            this.DGVTinhCong.Rows[_nhanVien - 1].Cells[13].Value = "0";
                                                            this.DGVTinhCong.Rows[_nhanVien - 1].Cells[14].Value = "0";
                                                            this.DGVTinhCong.Rows[_nhanVien - 1].Cells[15].Value = "0";
                                                        }
                                                        else
                                                        {
                                                            if (iGioiHanTC1TheoIDMay == 0)
                                                            {
                                                                this.DGVTinhCong.Rows[_nhanVien - 1].Cells[12].Value = Math.Round(dTongThoiGianTangCaTheoIDMay * this.dTangCa1HeSo / 60, this.iLamTronGio);
                                                                this.DGVTinhCong.Rows[_nhanVien - 1].Cells[13].Value = "0";
                                                                this.DGVTinhCong.Rows[_nhanVien - 1].Cells[14].Value = "0";
                                                                this.DGVTinhCong.Rows[_nhanVien - 1].Cells[15].Value = "0";
                                                            }
                                                            if ((iGioiHanTC1TheoIDMay == 0 ? false : iGioiHanTC2TheoIDMay == 0))
                                                            {
                                                                if (dTongThoiGianTangCaTheoIDMay >= Convert.ToDouble(iGioiHanTC1TheoIDMay))
                                                                {
                                                                    this.DGVTinhCong.Rows[_nhanVien - 1].Cells[12].Value = Math.Round(Convert.ToDouble(iGioiHanTC1TheoIDMay) / 60 * this.dTangCa1HeSo, this.iLamTronGio);
                                                                    if (dTongThoiGianTangCaTheoIDMay - Convert.ToDouble(iGioiHanTC1TheoIDMay) > 0)
                                                                    {
                                                                        this.DGVTinhCong.Rows[_nhanVien - 1].Cells[13].Value = Math.Round((dTongThoiGianTangCaTheoIDMay - Convert.ToDouble(iGioiHanTC1TheoIDMay)) * this.dTangCa2HeSo / 60, this.iLamTronGio);
                                                                    }
                                                                    this.DGVTinhCong.Rows[_nhanVien - 1].Cells[14].Value = "0";
                                                                    this.DGVTinhCong.Rows[_nhanVien - 1].Cells[15].Value = "0";
                                                                }
                                                                else
                                                                {
                                                                    this.DGVTinhCong.Rows[_nhanVien - 1].Cells[12].Value = Math.Round(dTongThoiGianTangCaTheoIDMay * this.dTangCa1HeSo / 60, this.iLamTronGio);
                                                                    this.DGVTinhCong.Rows[_nhanVien - 1].Cells[13].Value = "0";
                                                                    this.DGVTinhCong.Rows[_nhanVien - 1].Cells[14].Value = "0";
                                                                    this.DGVTinhCong.Rows[_nhanVien - 1].Cells[15].Value = "0";
                                                                }
                                                            }
                                                            if ((iGioiHanTC1TheoIDMay == 0 || iGioiHanTC2TheoIDMay == 0 ? false : iGioiHanTC3TheoIDMay == 0))
                                                            {
                                                                if (dTongThoiGianTangCaTheoIDMay >= Convert.ToDouble(iGioiHanTC1TheoIDMay))
                                                                {
                                                                    this.DGVTinhCong.Rows[_nhanVien - 1].Cells[12].Value = Math.Round(Convert.ToDouble(iGioiHanTC1TheoIDMay) * this.dTangCa1HeSo / 60, this.iLamTronGio);
                                                                    if (dTongThoiGianTangCaTheoIDMay - Convert.ToDouble(iGioiHanTC1TheoIDMay) >= Convert.ToDouble(iGioiHanTC2TheoIDMay))
                                                                    {
                                                                        this.DGVTinhCong.Rows[_nhanVien - 1].Cells[12].Value = Math.Round(Convert.ToDouble(iGioiHanTC1TheoIDMay) * this.dTangCa1HeSo / 60, this.iLamTronGio);
                                                                        this.DGVTinhCong.Rows[_nhanVien - 1].Cells[13].Value = Math.Round(Convert.ToDouble(iGioiHanTC2TheoIDMay) * this.dTangCa2HeSo / 60, this.iLamTronGio);
                                                                        this.DGVTinhCong.Rows[_nhanVien - 1].Cells[14].Value = Math.Round((dTongThoiGianTangCaTheoIDMay - Convert.ToDouble(iGioiHanTC1TheoIDMay) - Convert.ToDouble(iGioiHanTC2TheoIDMay)) * this.dTangCa3HeSo / 60, this.iLamTronGio);
                                                                        this.DGVTinhCong.Rows[_nhanVien - 1].Cells[15].Value = "0";
                                                                    }
                                                                    else
                                                                    {
                                                                        this.DGVTinhCong.Rows[_nhanVien - 1].Cells[13].Value = Math.Round((dTongThoiGianTangCaTheoIDMay - Convert.ToDouble(iGioiHanTC1TheoIDMay)) * this.dTangCa2HeSo / 60, this.iLamTronGio);
                                                                        this.DGVTinhCong.Rows[_nhanVien - 1].Cells[14].Value = "0";
                                                                        this.DGVTinhCong.Rows[_nhanVien - 1].Cells[15].Value = "0";
                                                                    }
                                                                }
                                                                else
                                                                {
                                                                    this.DGVTinhCong.Rows[_nhanVien - 1].Cells[12].Value = Math.Round(dTongThoiGianTangCaTheoIDMay * this.dTangCa1HeSo / 60, this.iLamTronGio);
                                                                    this.DGVTinhCong.Rows[_nhanVien - 1].Cells[13].Value = "0";
                                                                    this.DGVTinhCong.Rows[_nhanVien - 1].Cells[14].Value = "0";
                                                                    this.DGVTinhCong.Rows[_nhanVien - 1].Cells[15].Value = "0";
                                                                }
                                                            }
                                                            if ((iGioiHanTC1TheoIDMay == 0 || iGioiHanTC2TheoIDMay == 0 || iGioiHanTC3TheoIDMay == 0 ? false : iGioiHanTC4TheoIDMay == 0))
                                                            {
                                                            }
                                                        }
                                                        this.DGVTinhCong.Rows[_nhanVien - 1].Cells[18].Value = this.sKHDungGio;
                                                        if (!(DateTimeProgress.XuatThuQuaDem((int)dt.AddDays((double)dem).DayOfWeek) == "1"))
                                                        {
                                                            this.DGVTinhCong.Rows[_nhanVien - 1].Cells[19].Value = "NT";
                                                        }
                                                        else
                                                        {
                                                            this.DGVTinhCong.Rows[_nhanVien - 1].Cells[19].Value = "CN";
                                                        }
                                                        this.DGVTinhCong.Rows[_nhanVien - 1].Cells[20].Value = this.sMaChamCong;
                                                        this.DGVTinhCong.Rows[_nhanVien - 1].Cells[21].Value = this.sPhongBanTinhCong;
                                                    }
                                                }
                                            Label35:;
                                            }
                                            //                                            goto Label27;
                                            break;
                                        }
                                        iLanCham++;
                                   // Label27:;
                                        break;
                                    }
                                    if (iLanCham == 1)
                                    {
                                        this.DGVTinhCong.Rows[_nhanVien].Cells[0].Value = this.sMaNhanVien;
                                        this.DGVTinhCong.Rows[_nhanVien].Cells[1].Value = this.sTenNhanVien;
                                        this.DGVTinhCong.Rows[_nhanVien].Cells[2].Value = this.DGVTinhCong.Rows[_nhanVien].Cells[2].Value.ToString();
                                        if (this.iNgonNgu == 0)
                                        {
                                            DataGridViewCell item15 = this.DGVTinhCong.Rows[_nhanVien].Cells[3];
                                            dateTime = dt.AddDays((double)dem);
                                            item15.Value = DateTimeProgress.XuatThuTinhCong((int)dateTime.DayOfWeek);
                                        }
                                        if (this.iNgonNgu == 1)
                                        {
                                            DataGridViewCell dataGridViewCell15 = this.DGVTinhCong.Rows[_nhanVien].Cells[3];
                                            dateTime = dt.AddDays((double)dem);
                                            dataGridViewCell15.Value = DateTimeProgress.XuatThuEnglish((int)dateTime.DayOfWeek);
                                        }
                                        this.DGVTinhCong.Rows[_nhanVien].Cells[7].Value = "0";
                                        this.DGVTinhCong.Rows[_nhanVien].Cells[8].Value = "0";
                                        this.DGVTinhCong.Rows[_nhanVien].Cells[17].Value = "0";
                                        this.DGVTinhCong.Rows[_nhanVien].Cells[18].Value = this.sKHVang;
                                        if (!(DateTimeProgress.XuatIDThu((int)dt.AddDays((double)dem).DayOfWeek) == "0"))
                                        {
                                            this.DGVTinhCong.Rows[_nhanVien].Cells[19].Value = "NT";
                                        }
                                        else
                                        {
                                            this.DGVTinhCong.Rows[_nhanVien].Cells[19].Value = "CN";
                                        }
                                        this.DGVTinhCong.Rows[_nhanVien].Cells[20].Value = this.sMaChamCong;
                                        this.DGVTinhCong.Rows[_nhanVien].Cells[21].Value = this.sPhongBanTinhCong;
                                    }
                                }
                                if (iChonLichTrinh == 5)
                                {
                                    int iKiemTraVaoDuLieuChamCongNguonFilo = 0;
                                    int iKiemTraRaDuLieuChamCongNguonFilo = 0;
                                    DateTime dGioVaoFilo = new DateTime();
                                    DateTime dGioRaFilo = new DateTime();
                                    int iLanChamFilo = 0;
                                    System.Data.DataTable dtGioChamFilo = new System.Data.DataTable();
                                    this._checkInOutDTO.MaChamCong = Convert.ToInt32(this.sMaChamCong);
                                    this._checkInOutDTO.NgayCham = Convert.ToDateTime(this.DGVTinhCong.Rows[_nhanVien].Cells[2].Value.ToString());
                                    dtGioChamFilo = this._checkInOutBLL.getCheckInOutByMaChamCongAndNgayCham(this._checkInOutDTO);
                                    for (int iGioChamFilo = 0; iGioChamFilo < dtGioChamFilo.Rows.Count; iGioChamFilo++)
                                    {
                                        int addDuLieuChamCongNguonFilo = this.DGVDuLieuChamCongNguon.Rows.Add();
                                        this.DGVDuLieuChamCongNguon.Rows[addDuLieuChamCongNguonFilo].Cells[0].Value = this.sMaNhanVien;
                                        this.DGVDuLieuChamCongNguon.Rows[addDuLieuChamCongNguonFilo].Cells[1].Value = sNgayCham;
                                        string sKyHieuCuFilo = dtGioChamFilo.Rows[iGioChamFilo]["KieuCham"].ToString();
                                        if (sKyHieuCuFilo == "0")
                                        {
                                            this.DGVDuLieuChamCongNguon.Rows[addDuLieuChamCongNguonFilo].Cells[5].Value = "I";
                                        }
                                        if (sKyHieuCuFilo == "1")
                                        {
                                            this.DGVDuLieuChamCongNguon.Rows[addDuLieuChamCongNguonFilo].Cells[5].Value = "O";
                                        }
                                        iLanChamFilo++;
                                        if ((iLanChamFilo != 1 ? false : dtGioChamFilo.Rows.Count == 1))
                                        {
                                            dGioVaoFilo = Convert.ToDateTime(dtGioChamFilo.Rows[iGioChamFilo]["GioCham"].ToString());
                                            this.DGVTinhCong.Rows[_nhanVien].Cells[5].Value = string.Format(this.sDinhDangThoiGian, dGioVaoFilo);
                                            dtNhanCaFilo = new System.Data.DataTable();
                                            this._chiTietLichTrinhChoCalamViecDTO.MaLichTrinhCaLamViec = sLTCCLVNhanVien;
                                            this._chiTietLichTrinhChoCalamViecDTO.Thu = sThu;
                                            dtNhanCaFilo = this._chiTietLichTrinhChoCaLamViecBLL.ChiTietLichTrinhChoCaLamViecNhanCa(this._chiTietLichTrinhChoCalamViecDTO);
                                            iChiTietLichTrinhChoCaLamViecFilo = 0;
                                            if (iChiTietLichTrinhChoCaLamViecFilo < dtNhanCaFilo.Rows.Count)
                                            {
                                                cellChiTietLichTrinhChoCaLamViecFilo = 3;
                                                while (cellChiTietLichTrinhChoCaLamViecFilo < 13)
                                                {
                                                    kiemTraVao = 0;
                                                    kiemTraRa = 0;
                                                    this.sFiloMaCaLamViec = dtNhanCaFilo.Rows[iChiTietLichTrinhChoCaLamViecFilo][cellChiTietLichTrinhChoCaLamViecFilo].ToString();
                                                    dtFiloCa1 = new System.Data.DataTable();
                                                    this._caLamViecDTO.MaCaLamViec = this.sFiloMaCaLamViec;
                                                    dtFiloCa1 = this._caLamViecBLL.CaLamViecGetByMaCaLamViec(this._caLamViecDTO);
                                                    iFiloCa1 = 0;
                                                    while (iFiloCa1 < dtFiloCa1.Rows.Count)
                                                    {
                                                        second = dGioVaoFilo.Second;
                                                        sGiayGioVao = second.ToString();
                                                        second = dGioRaFilo.Second;
                                                        sGiayGioRa = second.ToString();
                                                        this.sFiloTenCaLamViec = dtFiloCa1.Rows[iFiloCa1]["CaLamViec"].ToString();
                                                        dBatDauVaoFiloA = Convert.ToDateTime(dtFiloCa1.Rows[iFiloCa1]["BatDauVao"].ToString());
                                                        sBatDauVaoFiloA = string.Format("{0:T}", dBatDauVaoFiloA).Replace("00 ", string.Concat(sGiayGioVao, " "));
                                                        sBatDauVaoFiloB = string.Concat(sNgayCham, " ", sBatDauVaoFiloA);
                                                        dBatDauVaoFiloB = Convert.ToDateTime(sBatDauVaoFiloB);
                                                        dKetThucVaoFiloA = Convert.ToDateTime(dtFiloCa1.Rows[iFiloCa1]["KetThucVao"].ToString());
                                                        sKetThucVaoFiloA = string.Format("{0:T}", dKetThucVaoFiloA).Replace("00 ", string.Concat(sGiayGioVao, " "));
                                                        sKetThucVaoFiloB = string.Concat(sNgayCham, " ", sKetThucVaoFiloA);
                                                        dKetThucVaoFiloB = Convert.ToDateTime(sKetThucVaoFiloB);
                                                        dBatDauRaFiloA = Convert.ToDateTime(dtFiloCa1.Rows[iFiloCa1]["BatDauRa"].ToString());
                                                        sBatDauRaFiloA = string.Format("{0:T}", dBatDauRaFiloA).Replace("00 ", string.Concat(sGiayGioRa, " "));
                                                        sBatDauRaFiloB = string.Concat(sNgayCham, " ", sBatDauRaFiloA);
                                                        dBatDauRaFiloB = Convert.ToDateTime(sBatDauRaFiloB);
                                                        dKetThucRaFiloA = Convert.ToDateTime(dtFiloCa1.Rows[iFiloCa1]["KetThucRa"].ToString());
                                                        sKetThucRaFiloA = string.Format("{0:T}", dKetThucRaFiloA).Replace("00 ", string.Concat(sGiayGioRa, " "));
                                                        sKetThucRaFiloB = string.Concat(sNgayCham, " ", sKetThucRaFiloA);
                                                        dKetThucRaFiloB = Convert.ToDateTime(sKetThucRaFiloB);
                                                        if ((dGioVaoFilo < dBatDauVaoFiloB ? false : dGioVaoFilo <= dKetThucVaoFiloB))
                                                        {
                                                            kiemTraVao++;
                                                        }
                                                        if ((dGioRaFilo < dBatDauRaFiloB ? false : dGioRaFilo <= dKetThucRaFiloB))
                                                        {
                                                            kiemTraRa++;
                                                        }
                                                        if ((kiemTraVao != 1 ? true : kiemTraRa != 0))
                                                        {
                                                            iFiloCa1++;
                                                        }
                                                        else
                                                        {
                                                            goto Label38;
                                                        }
                                                    }
                                                    if (!(this.sFiloMaCaLamViec == ""))
                                                    {
                                                        cellChiTietLichTrinhChoCaLamViecFilo++;
                                                    }
                                                    else
                                                    {
                                                        this.DGVTinhCong.Rows[_nhanVien].Cells[4].Value = "***";
                                                        this.DGVTinhCong.Rows[_nhanVien].Cells[7].Value = "0";
                                                        this.DGVTinhCong.Rows[_nhanVien].Cells[8].Value = "0";
                                                        this.DGVTinhCong.Rows[_nhanVien].Cells[9].Value = "0";
                                                        this.DGVTinhCong.Rows[_nhanVien].Cells[10].Value = "0";
                                                        this.DGVTinhCong.Rows[_nhanVien].Cells[11].Value = "0";
                                                        this.DGVTinhCong.Rows[_nhanVien].Cells[12].Value = "0";
                                                        this.DGVTinhCong.Rows[_nhanVien].Cells[13].Value = "0";
                                                        this.DGVTinhCong.Rows[_nhanVien].Cells[14].Value = "0";
                                                        this.DGVTinhCong.Rows[_nhanVien].Cells[15].Value = "0";
                                                        this.DGVTinhCong.Rows[_nhanVien].Cells[16].Value = "0";
                                                        this.DGVTinhCong.Rows[_nhanVien].Cells[17].Value = "0";
                                                        this.DGVTinhCong.Rows[_nhanVien].Cells[18].Value = this.sKHVang;
                                                        if (!(DateTimeProgress.XuatIDThu((int)dt.AddDays((double)dem).DayOfWeek) == "0"))
                                                        {
                                                            this.DGVTinhCong.Rows[_nhanVien].Cells[19].Value = "NT";
                                                        }
                                                        else
                                                        {
                                                            this.DGVTinhCong.Rows[_nhanVien].Cells[19].Value = "CN";
                                                        }
                                                        this.DGVTinhCong.Rows[_nhanVien].Cells[20].Value = this.sMaChamCong;
                                                        this.DGVTinhCong.Rows[_nhanVien].Cells[21].Value = this.sPhongBanTinhCong;
                                                        goto Label37;
                                                    }
                                                }
                                            Label38:
                                                this.DGVTinhCong.Rows[_nhanVien].Cells[4].Value = this.sFiloTenCaLamViec;
                                                System.Data.DataTable dtCaLamViecFiloChamMotLan = new System.Data.DataTable();
                                                this._caLamViecDTO.MaCaLamViec = this.sFiloMaCaLamViec;
                                                dtCaLamViecFiloChamMotLan = this._caLamViecBLL.CaLamViecGetByMaCaLamViec(this._caLamViecDTO);
                                                for (int iCaLamViecFiLoChamMotLan = 0; iCaLamViecFiLoChamMotLan < dtCaLamViecFiloChamMotLan.Rows.Count; iCaLamViecFiLoChamMotLan++)
                                                {
                                                    second = dGioVaoFilo.Second;
                                                    sGiayGioVao = second.ToString();
                                                    dGioVaoKhaiBaoFiLoA = Convert.ToDateTime(dtCaLamViecFiloChamMotLan.Rows[iCaLamViecFiLoChamMotLan]["GioVaoLamViec"].ToString());
                                                    sGioVaoKhaiBaoFiloA = string.Format("{0:T}", dGioVaoKhaiBaoFiLoA).Replace("00 ", string.Concat(sGiayGioVao, " "));
                                                    sGioVaoKhaiBaoFiloB = string.Concat(sNgayCham, " ", sGioVaoKhaiBaoFiloA);
                                                    dGioVaoKhaiBaoFiloB = Convert.ToDateTime(sGioVaoKhaiBaoFiloB);
                                                    if (Convert.ToInt32(dtCaLamViecFiloChamMotLan.Rows[iCaLamViecFiLoChamMotLan]["KhongCoGioRa"].ToString()) != 0)
                                                    {
                                                        sTruGioDiTre = dtCaLamViecFiloChamMotLan.Rows[iCaLamViecFiLoChamMotLan]["TruGioDiTre"].ToString();
                                                        sBatDauTinhDiTre = dtCaLamViecFiloChamMotLan.Rows[iCaLamViecFiLoChamMotLan]["BatDauTinhDiTre"].ToString();
                                                        iChoPhepDiTre = Convert.ToInt32(dtCaLamViecFiloChamMotLan.Rows[iCaLamViecFiLoChamMotLan]["ChoPhepDiTre"].ToString());
                                                        value = dGioVaoFilo - dGioVaoKhaiBaoFiloB;
                                                        second = Convert.ToInt32(value.TotalMinutes);
                                                        sPhutTre = second.ToString();
                                                        if (!(sTruGioDiTre == "True"))
                                                        {
                                                            this.DGVTinhCong.Rows[_nhanVien].Cells[9].Value = "0";
                                                        }
                                                        else if (Convert.ToInt32(sPhutTre) >= 0)
                                                        {
                                                            iPhutTre = Convert.ToInt32(sPhutTre) - iChoPhepDiTre;
                                                            if (sBatDauTinhDiTre == "True")
                                                            {
                                                                if (iPhutTre >= 1)
                                                                {
                                                                    this.DGVTinhCong.Rows[_nhanVien].Cells[9].Value = iPhutTre.ToString();
                                                                }
                                                                else
                                                                {
                                                                    this.DGVTinhCong.Rows[_nhanVien].Cells[9].Value = "0";
                                                                }
                                                            }
                                                            else if (iPhutTre >= 1)
                                                            {
                                                                this.DGVTinhCong.Rows[_nhanVien].Cells[9].Value = sPhutTre;
                                                            }
                                                            else
                                                            {
                                                                this.DGVTinhCong.Rows[_nhanVien].Cells[9].Value = "0";
                                                            }
                                                        }
                                                        else
                                                        {
                                                            this.DGVTinhCong.Rows[_nhanVien].Cells[9].Value = "0";
                                                        }
                                                        double dGioChamMotLan = Math.Round((Convert.ToDouble(dtCaLamViecFiloChamMotLan.Rows[iCaLamViecFiLoChamMotLan]["TongGioTrongCaLamViec"].ToString()) * 60 - Convert.ToDouble(this.DGVTinhCong.Rows[_nhanVien].Cells[9].Value.ToString())) / 60, this.iLamTronGio);
                                                        this.DGVTinhCong.Rows[_nhanVien].Cells[8].Value = dGioChamMotLan.ToString();
                                                        double dCongChamMotLan = Math.Round(dGioChamMotLan * Convert.ToDouble(dtCaLamViecFiloChamMotLan.Rows[iCaLamViecFiLoChamMotLan]["CongTinh"].ToString()) / Convert.ToDouble(dtCaLamViecFiloChamMotLan.Rows[iCaLamViecFiLoChamMotLan]["TongGioTrongCaLamViec"].ToString()), this.iLamTronCong);
                                                        this.DGVTinhCong.Rows[_nhanVien].Cells[7].Value = dCongChamMotLan.ToString();
                                                    }
                                                    else
                                                    {
                                                        this.DGVTinhCong.Rows[_nhanVien].Cells[7].Value = "0";
                                                        this.DGVTinhCong.Rows[_nhanVien].Cells[8].Value = "0";
                                                        this.DGVTinhCong.Rows[_nhanVien].Cells[9].Value = "0";
                                                        this.DGVTinhCong.Rows[_nhanVien].Cells[16].Value = "0";
                                                        this.DGVTinhCong.Rows[_nhanVien].Cells[17].Value = "0";
                                                    }
                                                    this.DGVTinhCong.Rows[_nhanVien].Cells[10].Value = "0";
                                                    this.DGVTinhCong.Rows[_nhanVien].Cells[11].Value = "0";
                                                    this.DGVTinhCong.Rows[_nhanVien].Cells[12].Value = "0";
                                                    this.DGVTinhCong.Rows[_nhanVien].Cells[13].Value = "0";
                                                    this.DGVTinhCong.Rows[_nhanVien].Cells[14].Value = "0";
                                                    this.DGVTinhCong.Rows[_nhanVien].Cells[15].Value = "0";
                                                    this.DGVTinhCong.Rows[_nhanVien].Cells[16].Value = "0";
                                                    this.DGVTinhCong.Rows[_nhanVien].Cells[17].Value = dtCaLamViecFiloChamMotLan.Rows[iCaLamViecFiLoChamMotLan]["CongTinh"].ToString();
                                                    this.DGVTinhCong.Rows[_nhanVien].Cells[18].Value = this.sKHThieuGioRa;
                                                    if (!(DateTimeProgress.XuatIDThu((int)dt.AddDays((double)dem).DayOfWeek) == "0"))
                                                    {
                                                        this.DGVTinhCong.Rows[_nhanVien].Cells[19].Value = "NT";
                                                    }
                                                    else
                                                    {
                                                        this.DGVTinhCong.Rows[_nhanVien].Cells[19].Value = "CN";
                                                    }
                                                    this.DGVTinhCong.Rows[_nhanVien].Cells[20].Value = this.sMaChamCong;
                                                    this.DGVTinhCong.Rows[_nhanVien].Cells[21].Value = this.sPhongBanTinhCong;
                                                }
                                            }
                                        Label37:
                                            iKiemTraVaoDuLieuChamCongNguonFilo = 1;
                                            this.DGVDuLieuChamCongNguon.Rows[addDuLieuChamCongNguonFilo].Cells[2].Value = dtGioChamFilo.Rows[iGioChamFilo]["GioCham"].ToString();
                                            this.DGVDuLieuChamCongNguon.Rows[addDuLieuChamCongNguonFilo].Cells[3].Value = "Vào";
                                            this.DGVDuLieuChamCongNguon.Rows[addDuLieuChamCongNguonFilo].Cells[4].Value = "I";
                                            this.DGVDuLieuChamCongNguon.Rows[addDuLieuChamCongNguonFilo].Cells[6].Value = dtGioChamFilo.Rows[iGioChamFilo]["MaSoMay"].ToString();
                                        }
                                        if ((iLanChamFilo != 1 ? false : dtGioChamFilo.Rows.Count > 1))
                                        {
                                            dGioVaoFilo = Convert.ToDateTime(dtGioChamFilo.Rows[iGioChamFilo]["GioCham"].ToString());
                                            this.DGVTinhCong.Rows[_nhanVien].Cells[5].Value = string.Format(this.sDinhDangThoiGian, dGioVaoFilo);
                                            iKiemTraVaoDuLieuChamCongNguonFilo = 1;
                                            this.DGVDuLieuChamCongNguon.Rows[addDuLieuChamCongNguonFilo].Cells[2].Value = dtGioChamFilo.Rows[iGioChamFilo]["GioCham"].ToString();
                                            this.DGVDuLieuChamCongNguon.Rows[addDuLieuChamCongNguonFilo].Cells[3].Value = "Vào";
                                            this.DGVDuLieuChamCongNguon.Rows[addDuLieuChamCongNguonFilo].Cells[4].Value = "I";
                                            this.DGVDuLieuChamCongNguon.Rows[addDuLieuChamCongNguonFilo].Cells[6].Value = dtGioChamFilo.Rows[iGioChamFilo]["MaSoMay"].ToString();
                                        }
                                        if ((iLanChamFilo != dtGioChamFilo.Rows.Count ? false : dtGioChamFilo.Rows.Count > 1))
                                        {
                                            dGioRaFilo = Convert.ToDateTime(dtGioChamFilo.Rows[iGioChamFilo]["GioCham"].ToString());
                                            this.DGVTinhCong.Rows[_nhanVien].Cells[6].Value = string.Format(this.sDinhDangThoiGian, dGioRaFilo);
                                            iCaTrongLIchtrinh = 0;
                                            dtNhanCaFilo = new System.Data.DataTable();
                                            this._chiTietLichTrinhChoCalamViecDTO.MaLichTrinhCaLamViec = sLTCCLVNhanVien;
                                            this._chiTietLichTrinhChoCalamViecDTO.Thu = sThu;
                                            dtNhanCaFilo = this._chiTietLichTrinhChoCaLamViecBLL.ChiTietLichTrinhChoCaLamViecNhanCa(this._chiTietLichTrinhChoCalamViecDTO);
                                            iChiTietLichTrinhChoCaLamViecFilo = 0;
                                            if (iChiTietLichTrinhChoCaLamViecFilo < dtNhanCaFilo.Rows.Count)
                                            {
                                                iCaTrongLIchtrinh = 1;
                                                cellChiTietLichTrinhChoCaLamViecFilo = 3;
                                                while (cellChiTietLichTrinhChoCaLamViecFilo < 13)
                                                {
                                                    kiemTraVao = 0;
                                                    kiemTraRa = 0;
                                                    this.sFiloMaCaLamViec = dtNhanCaFilo.Rows[iChiTietLichTrinhChoCaLamViecFilo][cellChiTietLichTrinhChoCaLamViecFilo].ToString();
                                                    dtFiloCa1 = new System.Data.DataTable();
                                                    this._caLamViecDTO.MaCaLamViec = this.sFiloMaCaLamViec;
                                                    dtFiloCa1 = this._caLamViecBLL.CaLamViecGetByMaCaLamViec(this._caLamViecDTO);
                                                    iFiloCa1 = 0;
                                                    while (iFiloCa1 < dtFiloCa1.Rows.Count)
                                                    {
                                                        second = dGioVaoFilo.Second;
                                                        sGiayGioVao = second.ToString();
                                                        second = dGioRaFilo.Second;
                                                        sGiayGioRa = second.ToString();
                                                        this.sFiloTenCaLamViec = dtFiloCa1.Rows[iFiloCa1]["CaLamViec"].ToString();
                                                        dBatDauVaoFiloA = Convert.ToDateTime(dtFiloCa1.Rows[iFiloCa1]["BatDauVao"].ToString());
                                                        sBatDauVaoFiloA = string.Format("{0:T}", dBatDauVaoFiloA).Replace("00 ", string.Concat(sGiayGioVao, " "));
                                                        sBatDauVaoFiloB = string.Concat(sNgayCham, " ", sBatDauVaoFiloA);
                                                        dBatDauVaoFiloB = Convert.ToDateTime(sBatDauVaoFiloB);
                                                        dKetThucVaoFiloA = Convert.ToDateTime(dtFiloCa1.Rows[iFiloCa1]["KetThucVao"].ToString());
                                                        sKetThucVaoFiloA = string.Format("{0:T}", dKetThucVaoFiloA).Replace("00 ", string.Concat(sGiayGioVao, " "));
                                                        sKetThucVaoFiloB = string.Concat(sNgayCham, " ", sKetThucVaoFiloA);
                                                        dKetThucVaoFiloB = Convert.ToDateTime(sKetThucVaoFiloB);
                                                        dBatDauRaFiloA = Convert.ToDateTime(dtFiloCa1.Rows[iFiloCa1]["BatDauRa"].ToString());
                                                        sBatDauRaFiloA = string.Format("{0:T}", dBatDauRaFiloA).Replace("00 ", string.Concat(sGiayGioRa, " "));
                                                        sBatDauRaFiloB = string.Concat(sNgayCham, " ", sBatDauRaFiloA);
                                                        dBatDauRaFiloB = Convert.ToDateTime(sBatDauRaFiloB);
                                                        dKetThucRaFiloA = Convert.ToDateTime(dtFiloCa1.Rows[iFiloCa1]["KetThucRa"].ToString());
                                                        sKetThucRaFiloA = string.Format("{0:T}", dKetThucRaFiloA).Replace("00 ", string.Concat(sGiayGioRa, " "));
                                                        sKetThucRaFiloB = string.Concat(sNgayCham, " ", sKetThucRaFiloA);
                                                        dKetThucRaFiloB = Convert.ToDateTime(sKetThucRaFiloB);
                                                        if ((dGioVaoFilo < dBatDauVaoFiloB ? false : dGioVaoFilo <= dKetThucVaoFiloB))
                                                        {
                                                            kiemTraVao++;
                                                        }
                                                        if ((dGioRaFilo < dBatDauRaFiloB ? false : dGioRaFilo <= dKetThucRaFiloB))
                                                        {
                                                            kiemTraRa++;
                                                        }
                                                        if ((kiemTraVao != 1 ? true : kiemTraRa != 1))
                                                        {
                                                            iFiloCa1++;
                                                        }
                                                        else
                                                        {
                                                            goto Label40;
                                                        }
                                                    }
                                                    if (!(this.sFiloMaCaLamViec == ""))
                                                    {
                                                        cellChiTietLichTrinhChoCaLamViecFilo++;
                                                    }
                                                    else
                                                    {
                                                        this.DGVTinhCong.Rows[_nhanVien].Cells[4].Value = "***";
                                                        this.DGVTinhCong.Rows[_nhanVien].Cells[7].Value = "0";
                                                        this.DGVTinhCong.Rows[_nhanVien].Cells[8].Value = "0";
                                                        this.DGVTinhCong.Rows[_nhanVien].Cells[9].Value = "0";
                                                        this.DGVTinhCong.Rows[_nhanVien].Cells[10].Value = "0";
                                                        this.DGVTinhCong.Rows[_nhanVien].Cells[11].Value = "0";
                                                        this.DGVTinhCong.Rows[_nhanVien].Cells[12].Value = "0";
                                                        this.DGVTinhCong.Rows[_nhanVien].Cells[13].Value = "0";
                                                        this.DGVTinhCong.Rows[_nhanVien].Cells[14].Value = "0";
                                                        this.DGVTinhCong.Rows[_nhanVien].Cells[15].Value = "0";
                                                        this.DGVTinhCong.Rows[_nhanVien].Cells[16].Value = "0";
                                                        this.DGVTinhCong.Rows[_nhanVien].Cells[17].Value = "0";
                                                        this.DGVTinhCong.Rows[_nhanVien].Cells[18].Value = this.sKHVang;
                                                        if (!(DateTimeProgress.XuatIDThu((int)dt.AddDays((double)dem).DayOfWeek) == "0"))
                                                        {
                                                            this.DGVTinhCong.Rows[_nhanVien].Cells[19].Value = "NT";
                                                        }
                                                        else
                                                        {
                                                            this.DGVTinhCong.Rows[_nhanVien].Cells[19].Value = "CN";
                                                        }
                                                        this.DGVTinhCong.Rows[_nhanVien].Cells[20].Value = this.sMaChamCong;
                                                        this.DGVTinhCong.Rows[_nhanVien].Cells[21].Value = this.sPhongBanTinhCong;
                                                        goto Label39;
                                                    }
                                                }
                                            Label40:
                                                this.DGVTinhCong.Rows[_nhanVien].Cells[4].Value = this.sFiloTenCaLamViec;
                                                System.Data.DataTable dtCaLamViecFilo = new System.Data.DataTable();
                                                this._caLamViecDTO.MaCaLamViec = this.sFiloMaCaLamViec;
                                                dtCaLamViecFilo = this._caLamViecBLL.CaLamViecGetByMaCaLamViec(this._caLamViecDTO);
                                                for (int iCaLamViecFilo = 0; iCaLamViecFilo < dtCaLamViecFilo.Rows.Count; iCaLamViecFilo++)
                                                {
                                                    second = dGioVaoFilo.Second;
                                                    sGiayGioVao = second.ToString();
                                                    second = dGioRaFilo.Second;
                                                    sGiayGioRa = second.ToString();
                                                    dGioVaoKhaiBaoFiLoA = Convert.ToDateTime(dtCaLamViecFilo.Rows[iCaLamViecFilo]["GioVaoLamViec"].ToString());
                                                    sGioVaoKhaiBaoFiloA = string.Format("{0:T}", dGioVaoKhaiBaoFiLoA).Replace("00 ", string.Concat(sGiayGioVao, " "));
                                                    sGioVaoKhaiBaoFiloB = string.Concat(sNgayCham, " ", sGioVaoKhaiBaoFiloA);
                                                    dGioVaoKhaiBaoFiloB = Convert.ToDateTime(sGioVaoKhaiBaoFiloB);
                                                    DateTime dGioRaKhaiBaoFiLoA = Convert.ToDateTime(dtCaLamViecFilo.Rows[iCaLamViecFilo]["GioKetThucLamViec"].ToString());
                                                    string sGioRaKhaiBaoFiLoA = string.Format("{0:T}", dGioRaKhaiBaoFiLoA).Replace("00 ", string.Concat(sGiayGioRa, " "));
                                                    string sGioRaKhaiBaoFiLoB = string.Concat(sNgayCham, " ", sGioRaKhaiBaoFiLoA);
                                                    DateTime dGioRaKhaiBaoFiLoB = Convert.ToDateTime(sGioRaKhaiBaoFiLoB);
                                                    sXemCaNayLaTangCa = dtCaLamViecFilo.Rows[iCaLamViecFilo]["XemCaNayLaTangCa"].ToString();
                                                    iTangCaMuc = Convert.ToInt32(dtCaLamViecFilo.Rows[iCaLamViecFilo]["TangCaMuc"].ToString());
                                                    sXemChuNhatLaTangCa = dtCaLamViecFilo.Rows[iCaLamViecFilo]["XemCuoiTuanLaTangCa"].ToString();
                                                    iTangCaChuNhatMuc = Convert.ToInt32(dtCaLamViecFilo.Rows[iCaLamViecFilo]["TangCaCuoiTuanMuc"].ToString());
                                                    if (sXemCaNayLaTangCa == "True")
                                                    {
                                                        sTruGioDiTre = dtCaLamViecFilo.Rows[iCaLamViecFilo]["TruGioDiTre"].ToString();
                                                        sBatDauTinhDiTre = dtCaLamViecFilo.Rows[iCaLamViecFilo]["BatDauTinhDiTre"].ToString();
                                                        iChoPhepDiTre = Convert.ToInt32(dtCaLamViecFilo.Rows[iCaLamViecFilo]["ChoPhepDiTre"].ToString());
                                                        value = dGioVaoFilo - dGioVaoKhaiBaoFiloB;
                                                        second = Convert.ToInt32(value.TotalMinutes);
                                                        sPhutTre = second.ToString();
                                                        if (Convert.ToInt32(sPhutTre) < 0)
                                                        {
                                                            sPhutTre = "0";
                                                        }
                                                        sTruGioVeSom = dtCaLamViecFilo.Rows[iCaLamViecFilo]["TruGioVeSom"].ToString();
                                                        sBatDauTinhVeSom = dtCaLamViecFilo.Rows[iCaLamViecFilo]["BatDauTinhVeSom"].ToString();
                                                        iChoPhepVeSom = Convert.ToInt32(dtCaLamViecFilo.Rows[iCaLamViecFilo]["ChoPhepVeSom"].ToString());
                                                        value = dGioRaKhaiBaoFiLoB - dGioRaFilo;
                                                        second = Convert.ToInt32(value.TotalMinutes);
                                                        sPhutVeSom = second.ToString();
                                                        if (Convert.ToInt32(sPhutVeSom) < 0)
                                                        {
                                                            sPhutVeSom = "0";
                                                        }
                                                        double dTongPhutTangCaFilo = Convert.ToDouble(dtCaLamViecFilo.Rows[iCaLamViecFilo]["TongGioTrongCaLamViec"]) * 60 - (Convert.ToDouble(sPhutTre) + Convert.ToDouble(sPhutVeSom));
                                                        double dTongGioTangCaFilo = Math.Round(dTongPhutTangCaFilo / 60, this.iLamTronGio);
                                                        if (iTangCaMuc == 1)
                                                        {
                                                            this.DGVTinhCong.Rows[_nhanVien].Cells[12].Value = dTongGioTangCaFilo * this.dTangCa1HeSo;
                                                            this.DGVTinhCong.Rows[_nhanVien].Cells[18].Value = this.sKHDungGio;
                                                        }
                                                        if (iTangCaMuc == 2)
                                                        {
                                                            this.DGVTinhCong.Rows[_nhanVien].Cells[13].Value = dTongGioTangCaFilo * this.dTangCa2HeSo;
                                                            this.DGVTinhCong.Rows[_nhanVien].Cells[18].Value = this.sKHDungGio;
                                                        }
                                                        if (iTangCaMuc == 3)
                                                        {
                                                            this.DGVTinhCong.Rows[_nhanVien].Cells[14].Value = dTongGioTangCaFilo * this.dTangCa3HeSo;
                                                            this.DGVTinhCong.Rows[_nhanVien].Cells[18].Value = this.sKHDungGio;
                                                        }
                                                        if (iTangCaMuc == 4)
                                                        {
                                                            this.DGVTinhCong.Rows[_nhanVien].Cells[15].Value = dTongGioTangCaFilo * this.dTangCa4HeSo;
                                                            this.DGVTinhCong.Rows[_nhanVien].Cells[18].Value = this.sKHDungGio;
                                                        }
                                                    }
                                                    else if (!(DateTimeProgress.XuatIDThu((int)dt.AddDays((double)dem).DayOfWeek) == "0"))
                                                    {
                                                        sTruGioDiTre = dtCaLamViecFilo.Rows[iCaLamViecFilo]["TruGioDiTre"].ToString();
                                                        sBatDauTinhDiTre = dtCaLamViecFilo.Rows[iCaLamViecFilo]["BatDauTinhDiTre"].ToString();
                                                        iChoPhepDiTre = Convert.ToInt32(dtCaLamViecFilo.Rows[iCaLamViecFilo]["ChoPhepDiTre"].ToString());
                                                        value = dGioVaoFilo - dGioVaoKhaiBaoFiloB;
                                                        second = Convert.ToInt32(value.TotalMinutes);
                                                        sPhutTre = second.ToString();
                                                        if (!(sTruGioDiTre == "True"))
                                                        {
                                                            this.DGVTinhCong.Rows[_nhanVien].Cells[9].Value = "0";
                                                        }
                                                        else if (Convert.ToInt32(sPhutTre) >= 0)
                                                        {
                                                            iPhutTre = Convert.ToInt32(sPhutTre) - iChoPhepDiTre;
                                                            if (sBatDauTinhDiTre == "True")
                                                            {
                                                                if (iPhutTre >= 1)
                                                                {
                                                                    this.DGVTinhCong.Rows[_nhanVien].Cells[9].Value = iPhutTre.ToString();
                                                                }
                                                                else
                                                                {
                                                                    this.DGVTinhCong.Rows[_nhanVien].Cells[9].Value = "0";
                                                                }
                                                            }
                                                            else if (iPhutTre >= 1)
                                                            {
                                                                this.DGVTinhCong.Rows[_nhanVien].Cells[9].Value = sPhutTre;
                                                            }
                                                            else
                                                            {
                                                                this.DGVTinhCong.Rows[_nhanVien].Cells[9].Value = "0";
                                                            }
                                                        }
                                                        else
                                                        {
                                                            this.DGVTinhCong.Rows[_nhanVien].Cells[9].Value = "0";
                                                        }
                                                        sTruGioVeSom = dtCaLamViecFilo.Rows[iCaLamViecFilo]["TruGioVeSom"].ToString();
                                                        sBatDauTinhVeSom = dtCaLamViecFilo.Rows[iCaLamViecFilo]["BatDauTinhVeSom"].ToString();
                                                        iChoPhepVeSom = Convert.ToInt32(dtCaLamViecFilo.Rows[iCaLamViecFilo]["ChoPhepVeSom"].ToString());
                                                        value = dGioRaKhaiBaoFiLoB - dGioRaFilo;
                                                        second = Convert.ToInt32(value.TotalMinutes);
                                                        sPhutVeSom = second.ToString();
                                                        if (!(sTruGioVeSom == "True"))
                                                        {
                                                            this.DGVTinhCong.Rows[_nhanVien].Cells[10].Value = "0";
                                                        }
                                                        else if (Convert.ToInt32(sPhutVeSom) >= 0)
                                                        {
                                                            iPhutVeSom = Convert.ToInt32(sPhutVeSom) - iChoPhepVeSom;
                                                            if (iPhutVeSom < 1)
                                                            {
                                                                this.DGVTinhCong.Rows[_nhanVien].Cells[10].Value = "0";
                                                            }
                                                            else if (!(sBatDauTinhVeSom == "True"))
                                                            {
                                                                this.DGVTinhCong.Rows[_nhanVien].Cells[10].Value = sPhutVeSom;
                                                            }
                                                            else
                                                            {
                                                                this.DGVTinhCong.Rows[_nhanVien].Cells[10].Value = iPhutVeSom.ToString();
                                                            }
                                                        }
                                                        else
                                                        {
                                                            this.DGVTinhCong.Rows[_nhanVien].Cells[10].Value = "0";
                                                        }
                                                        value = dGioRaFilo - dGioRaKhaiBaoFiLoB;
                                                        second = Convert.ToInt32(value.TotalMinutes);
                                                        sVeTre = second.ToString();
                                                        if (Convert.ToInt32(sVeTre) <= 0)
                                                        {
                                                            this.DGVTinhCong.Rows[_nhanVien].Cells[11].Value = "0";
                                                        }
                                                        else
                                                        {
                                                            this.DGVTinhCong.Rows[_nhanVien].Cells[11].Value = sVeTre;
                                                        }
                                                        iPhut = Convert.ToSingle(dtCaLamViecFilo.Rows[iCaLamViecFilo]["TongGioTrongCaLamViec"]) * 60f - (float)(Convert.ToInt32(this.DGVTinhCong.Rows[_nhanVien].Cells[9].Value.ToString()) + Convert.ToInt32(this.DGVTinhCong.Rows[_nhanVien].Cells[10].Value));
                                                        dGio = Math.Round(Convert.ToDouble(iPhut) / 60, this.iLamTronGio);
                                                        this.DGVTinhCong.Rows[_nhanVien].Cells[8].Value = dGio.ToString();
                                                        iGio = Convert.ToDouble(dtCaLamViecFilo.Rows[iCaLamViecFilo]["TongGioTrongCaLamViec"].ToString());
                                                        dCongTinh = Convert.ToDouble(dtCaLamViecFilo.Rows[iCaLamViecFilo]["CongTinh"].ToString());
                                                        dCong = Math.Round(dGio * dCongTinh / iGio, this.iLamTronCong);
                                                        this.DGVTinhCong.Rows[_nhanVien].Cells[7].Value = dCong.ToString();
                                                        sTangCaTruocGioLamViec = dtCaLamViecFilo.Rows[iCaLamViecFilo]["TangCaTruocGioLamViec"].ToString();
                                                        sTangCaSauGioLamViec = dtCaLamViecFilo.Rows[iCaLamViecFilo]["TangCaSauGioLamViec"].ToString();
                                                        if ((sTangCaTruocGioLamViec != "False" ? false : sTangCaSauGioLamViec == "False"))
                                                        {
                                                            this.DGVTinhCong.Rows[_nhanVien].Cells[12].Value = "0";
                                                            this.DGVTinhCong.Rows[_nhanVien].Cells[13].Value = "0";
                                                            this.DGVTinhCong.Rows[_nhanVien].Cells[14].Value = "0";
                                                            this.DGVTinhCong.Rows[_nhanVien].Cells[15].Value = "0";
                                                        }
                                                        if (sXemCaNayLaTangCa == "True")
                                                        {
                                                            if (iTangCaMuc == 1)
                                                            {
                                                                this.DGVTinhCong.Rows[_nhanVien].Cells[7].Value = "0";
                                                                this.DGVTinhCong.Rows[_nhanVien].Cells[8].Value = "0";
                                                                this.DGVTinhCong.Rows[_nhanVien].Cells[12].Value = dGio.ToString();
                                                                this.DGVTinhCong.Rows[_nhanVien].Cells[13].Value = "0";
                                                                this.DGVTinhCong.Rows[_nhanVien].Cells[14].Value = "0";
                                                                this.DGVTinhCong.Rows[_nhanVien].Cells[15].Value = "0";
                                                            }
                                                            if (iTangCaMuc == 2)
                                                            {
                                                                this.DGVTinhCong.Rows[_nhanVien].Cells[7].Value = "0";
                                                                this.DGVTinhCong.Rows[_nhanVien].Cells[8].Value = "0";
                                                                this.DGVTinhCong.Rows[_nhanVien].Cells[12].Value = "0";
                                                                this.DGVTinhCong.Rows[_nhanVien].Cells[13].Value = dGio.ToString();
                                                                this.DGVTinhCong.Rows[_nhanVien].Cells[14].Value = "0";
                                                                this.DGVTinhCong.Rows[_nhanVien].Cells[15].Value = "0";
                                                            }
                                                            if (iTangCaMuc == 3)
                                                            {
                                                                this.DGVTinhCong.Rows[_nhanVien].Cells[7].Value = "0";
                                                                this.DGVTinhCong.Rows[_nhanVien].Cells[8].Value = "0";
                                                                this.DGVTinhCong.Rows[_nhanVien].Cells[12].Value = "0";
                                                                this.DGVTinhCong.Rows[_nhanVien].Cells[13].Value = "0";
                                                                this.DGVTinhCong.Rows[_nhanVien].Cells[14].Value = dGio.ToString();
                                                                this.DGVTinhCong.Rows[_nhanVien].Cells[15].Value = "0";
                                                            }
                                                            if (iTangCaMuc == 4)
                                                            {
                                                                this.DGVTinhCong.Rows[_nhanVien].Cells[7].Value = "0";
                                                                this.DGVTinhCong.Rows[_nhanVien].Cells[8].Value = "0";
                                                                this.DGVTinhCong.Rows[_nhanVien].Cells[12].Value = "0";
                                                                this.DGVTinhCong.Rows[_nhanVien].Cells[13].Value = "0";
                                                                this.DGVTinhCong.Rows[_nhanVien].Cells[14].Value = "0";
                                                                this.DGVTinhCong.Rows[_nhanVien].Cells[15].Value = dGio.ToString();
                                                            }
                                                        }
                                                        sChoPhepTangCaTruocGioLamViecFiLo = dtCaLamViecFilo.Rows[iCaLamViecFilo]["TangCaTruocGioLamViec"].ToString();
                                                        iPhutTangCaTruocGioLamViecFiLo = Convert.ToInt32(dtCaLamViecFilo.Rows[iCaLamViecFilo]["SoPhutTangCaTruocGioLamViec"].ToString());
                                                        iPhutTangCaTruocGioLamViecDatDen = Convert.ToInt32(dtCaLamViecFilo.Rows[iCaLamViecFilo]["TangCaTruocGioLamViecDatDen"].ToString());
                                                        iPhutTruTangCaTruoc = Convert.ToInt32(dtCaLamViecFilo.Rows[iCaLamViecFilo]["PhutTruTangCaTruoc"].ToString());
                                                        sChoPhepTangCaSauGioLamViecFiLo = dtCaLamViecFilo.Rows[iCaLamViecFilo]["TangCaSauGioLamViec"].ToString();
                                                        iPhutTangCaSauGioLamViecFiLo = Convert.ToInt32(dtCaLamViecFilo.Rows[iCaLamViecFilo]["SoPhutTangCaSauGioLamViec"].ToString());
                                                        iPhutTangCaSauGioLamViecDatDen = Convert.ToInt32(dtCaLamViecFilo.Rows[iCaLamViecFilo]["TangCaSauGioLamViecDatDen"].ToString());
                                                        iPhutTruTangCaSau = Convert.ToInt32(dtCaLamViecFilo.Rows[iCaLamViecFilo]["PhutTruTangCaSau"].ToString());
                                                        iGioiHanTC1FiLo = Convert.ToInt32(dtCaLamViecFilo.Rows[iCaLamViecFilo]["GioiHanTangCa1"].ToString());
                                                        iGioiHanTC2FiLo = Convert.ToInt32(dtCaLamViecFilo.Rows[iCaLamViecFilo]["GioiHanTangCa2"].ToString());
                                                        iGioiHanTC3FiLo = Convert.ToInt32(dtCaLamViecFilo.Rows[iCaLamViecFilo]["GioiHanTangCa3"].ToString());
                                                        iGioiHanTC4FiLo = Convert.ToInt32(dtCaLamViecFilo.Rows[iCaLamViecFilo]["GioiHanTangCa4"].ToString());
                                                        iTongGioTangCaSauFiLo = 0;
                                                        iTongGioTangCaTruocFiLo = 0;
                                                        if ((sChoPhepTangCaTruocGioLamViecFiLo != "False" ? true : !(sChoPhepTangCaSauGioLamViecFiLo == "False")))
                                                        {
                                                            if (sChoPhepTangCaTruocGioLamViecFiLo == "True")
                                                            {
                                                                value = dGioVaoKhaiBaoFiloB - dGioVaoFilo;
                                                                second = Convert.ToInt32(value.TotalMinutes);
                                                                iThoiGianTruocGioLamFiLo = Convert.ToInt32(second.ToString());
                                                                if (iThoiGianTruocGioLamFiLo > 0)
                                                                {
                                                                    if (iThoiGianTruocGioLamFiLo > iPhutTangCaTruocGioLamViecFiLo)
                                                                    {
                                                                        if (iThoiGianTruocGioLamFiLo > iPhutTangCaTruocGioLamViecDatDen)
                                                                        {
                                                                            iTongGioTangCaTruocFiLo = iThoiGianTruocGioLamFiLo - iPhutTruTangCaTruoc;
                                                                        }
                                                                    }
                                                                }
                                                            }
                                                            if (sChoPhepTangCaSauGioLamViecFiLo == "True")
                                                            {
                                                                value = dGioRaFilo - dGioRaKhaiBaoFiLoB;
                                                                second = Convert.ToInt32(value.TotalMinutes);
                                                                iThoiGianSauGioLamViecFiLo = Convert.ToInt32(second.ToString());
                                                                if (iThoiGianSauGioLamViecFiLo > 0)
                                                                {
                                                                    if (iThoiGianSauGioLamViecFiLo > iPhutTangCaSauGioLamViecFiLo)
                                                                    {
                                                                        if (iThoiGianSauGioLamViecFiLo > iPhutTangCaSauGioLamViecDatDen)
                                                                        {
                                                                            iTongGioTangCaSauFiLo = iThoiGianSauGioLamViecFiLo - iPhutTruTangCaSau;
                                                                        }
                                                                    }
                                                                }
                                                            }
                                                        }
                                                        else
                                                        {
                                                            this.DGVTinhCong.Rows[_nhanVien].Cells[12].Value = "0";
                                                            this.DGVTinhCong.Rows[_nhanVien].Cells[13].Value = "0";
                                                            this.DGVTinhCong.Rows[_nhanVien].Cells[14].Value = "0";
                                                            this.DGVTinhCong.Rows[_nhanVien].Cells[15].Value = "0";
                                                        }
                                                        dTongThoiGianTangCaFiLo = Convert.ToDouble(iTongGioTangCaTruocFiLo + iTongGioTangCaSauFiLo);
                                                        if (dTongThoiGianTangCaFiLo <= 0)
                                                        {
                                                            this.DGVTinhCong.Rows[_nhanVien].Cells[12].Value = "0";
                                                            this.DGVTinhCong.Rows[_nhanVien].Cells[13].Value = "0";
                                                            this.DGVTinhCong.Rows[_nhanVien].Cells[14].Value = "0";
                                                            this.DGVTinhCong.Rows[_nhanVien].Cells[15].Value = "0";
                                                        }
                                                        else
                                                        {
                                                            if (iGioiHanTC1FiLo == 0)
                                                            {
                                                                this.DGVTinhCong.Rows[_nhanVien].Cells[12].Value = Math.Round(dTongThoiGianTangCaFiLo * this.dTangCa1HeSo / 60, this.iLamTronGio);
                                                                this.DGVTinhCong.Rows[_nhanVien].Cells[13].Value = "0";
                                                                this.DGVTinhCong.Rows[_nhanVien].Cells[14].Value = "0";
                                                                this.DGVTinhCong.Rows[_nhanVien].Cells[15].Value = "0";
                                                            }
                                                            if ((iGioiHanTC1FiLo == 0 ? false : iGioiHanTC2FiLo == 0))
                                                            {
                                                                if (dTongThoiGianTangCaFiLo >= Convert.ToDouble(iGioiHanTC1FiLo))
                                                                {
                                                                    this.DGVTinhCong.Rows[_nhanVien].Cells[12].Value = Math.Round(Convert.ToDouble(iGioiHanTC1FiLo) / 60 * this.dTangCa1HeSo, this.iLamTronGio);
                                                                    if (dTongThoiGianTangCaFiLo - Convert.ToDouble(iGioiHanTC1FiLo) > 0)
                                                                    {
                                                                        this.DGVTinhCong.Rows[_nhanVien].Cells[13].Value = Math.Round((dTongThoiGianTangCaFiLo - Convert.ToDouble(iGioiHanTC1FiLo)) * this.dTangCa2HeSo / 60, this.iLamTronGio);
                                                                    }
                                                                    this.DGVTinhCong.Rows[_nhanVien].Cells[14].Value = "0";
                                                                    this.DGVTinhCong.Rows[_nhanVien].Cells[15].Value = "0";
                                                                }
                                                                else
                                                                {
                                                                    this.DGVTinhCong.Rows[_nhanVien].Cells[12].Value = Math.Round(dTongThoiGianTangCaFiLo * this.dTangCa1HeSo / 60, this.iLamTronGio);
                                                                    this.DGVTinhCong.Rows[_nhanVien].Cells[13].Value = "0";
                                                                    this.DGVTinhCong.Rows[_nhanVien].Cells[14].Value = "0";
                                                                    this.DGVTinhCong.Rows[_nhanVien].Cells[15].Value = "0";
                                                                }
                                                            }
                                                            if ((iGioiHanTC1FiLo == 0 || iGioiHanTC2FiLo == 0 ? false : iGioiHanTC3FiLo == 0))
                                                            {
                                                                if (dTongThoiGianTangCaFiLo >= Convert.ToDouble(iGioiHanTC1FiLo))
                                                                {
                                                                    this.DGVTinhCong.Rows[_nhanVien].Cells[12].Value = Math.Round(Convert.ToDouble(iGioiHanTC1FiLo) * this.dTangCa1HeSo / 60, this.iLamTronGio);
                                                                    if (dTongThoiGianTangCaFiLo - Convert.ToDouble(iGioiHanTC1FiLo) >= Convert.ToDouble(iGioiHanTC2FiLo))
                                                                    {
                                                                        this.DGVTinhCong.Rows[_nhanVien].Cells[12].Value = Math.Round(Convert.ToDouble(iGioiHanTC1FiLo) * this.dTangCa1HeSo / 60, this.iLamTronGio);
                                                                        this.DGVTinhCong.Rows[_nhanVien].Cells[13].Value = Math.Round(Convert.ToDouble(iGioiHanTC2FiLo) * this.dTangCa2HeSo / 60, this.iLamTronGio);
                                                                        this.DGVTinhCong.Rows[_nhanVien].Cells[14].Value = Math.Round((dTongThoiGianTangCaFiLo - Convert.ToDouble(iGioiHanTC1FiLo) - Convert.ToDouble(iGioiHanTC2FiLo)) * this.dTangCa3HeSo / 60, this.iLamTronGio);
                                                                        this.DGVTinhCong.Rows[_nhanVien].Cells[15].Value = "0";
                                                                    }
                                                                    else
                                                                    {
                                                                        this.DGVTinhCong.Rows[_nhanVien].Cells[13].Value = Math.Round((dTongThoiGianTangCaFiLo - Convert.ToDouble(iGioiHanTC1FiLo)) * this.dTangCa2HeSo / 60, this.iLamTronGio);
                                                                        this.DGVTinhCong.Rows[_nhanVien].Cells[14].Value = "0";
                                                                        this.DGVTinhCong.Rows[_nhanVien].Cells[15].Value = "0";
                                                                    }
                                                                }
                                                                else
                                                                {
                                                                    this.DGVTinhCong.Rows[_nhanVien].Cells[12].Value = Math.Round(dTongThoiGianTangCaFiLo * this.dTangCa1HeSo / 60, this.iLamTronGio);
                                                                    this.DGVTinhCong.Rows[_nhanVien].Cells[13].Value = "0";
                                                                    this.DGVTinhCong.Rows[_nhanVien].Cells[14].Value = "0";
                                                                    this.DGVTinhCong.Rows[_nhanVien].Cells[15].Value = "0";
                                                                }
                                                            }
                                                            if ((iGioiHanTC1FiLo == 0 || iGioiHanTC2FiLo == 0 || iGioiHanTC3FiLo == 0 ? false : iGioiHanTC4FiLo == 0))
                                                            {
                                                            }
                                                        }
                                                        value = dGioRaFilo - dGioVaoFilo;
                                                        second = Convert.ToInt32(value.TotalMinutes);
                                                        num = Math.Round(Convert.ToDouble(second.ToString()) / 60, this.iLamTronGio);
                                                        sTongGio = num.ToString();
                                                        this.DGVTinhCong.Rows[_nhanVien].Cells[16].Value = sTongGio;
                                                        this.DGVTinhCong.Rows[_nhanVien].Cells[17].Value = dtCaLamViecFilo.Rows[iCaLamViecFilo]["CongTinh"].ToString();
                                                        this.DGVTinhCong.Rows[_nhanVien].Cells[18].Value = this.sKHDungGio;
                                                    }
                                                    else if (!(sXemChuNhatLaTangCa == "True"))
                                                    {
                                                        sTruGioDiTre = dtCaLamViecFilo.Rows[iCaLamViecFilo]["TruGioDiTre"].ToString();
                                                        sBatDauTinhDiTre = dtCaLamViecFilo.Rows[iCaLamViecFilo]["BatDauTinhDiTre"].ToString();
                                                        iChoPhepDiTre = Convert.ToInt32(dtCaLamViecFilo.Rows[iCaLamViecFilo]["ChoPhepDiTre"].ToString());
                                                        value = dGioVaoFilo - dGioVaoKhaiBaoFiloB;
                                                        second = Convert.ToInt32(value.TotalMinutes);
                                                        sPhutTre = second.ToString();
                                                        if (!(sTruGioDiTre == "True"))
                                                        {
                                                            this.DGVTinhCong.Rows[_nhanVien].Cells[9].Value = "0";
                                                        }
                                                        else if (Convert.ToInt32(sPhutTre) >= 0)
                                                        {
                                                            iPhutTre = Convert.ToInt32(sPhutTre) - iChoPhepDiTre;
                                                            if (sBatDauTinhDiTre == "True")
                                                            {
                                                                if (iPhutTre >= 1)
                                                                {
                                                                    this.DGVTinhCong.Rows[_nhanVien].Cells[9].Value = iPhutTre.ToString();
                                                                }
                                                                else
                                                                {
                                                                    this.DGVTinhCong.Rows[_nhanVien].Cells[9].Value = "0";
                                                                }
                                                            }
                                                            else if (iPhutTre >= 1)
                                                            {
                                                                this.DGVTinhCong.Rows[_nhanVien].Cells[9].Value = sPhutTre;
                                                            }
                                                            else
                                                            {
                                                                this.DGVTinhCong.Rows[_nhanVien].Cells[9].Value = "0";
                                                            }
                                                        }
                                                        else
                                                        {
                                                            this.DGVTinhCong.Rows[_nhanVien].Cells[9].Value = "0";
                                                        }
                                                        sTruGioVeSom = dtCaLamViecFilo.Rows[iCaLamViecFilo]["TruGioVeSom"].ToString();
                                                        sBatDauTinhVeSom = dtCaLamViecFilo.Rows[iCaLamViecFilo]["BatDauTinhVeSom"].ToString();
                                                        iChoPhepVeSom = Convert.ToInt32(dtCaLamViecFilo.Rows[iCaLamViecFilo]["ChoPhepVeSom"].ToString());
                                                        value = dGioRaKhaiBaoFiLoB - dGioRaFilo;
                                                        second = Convert.ToInt32(value.TotalMinutes);
                                                        sPhutVeSom = second.ToString();
                                                        if (!(sTruGioVeSom == "True"))
                                                        {
                                                            this.DGVTinhCong.Rows[_nhanVien].Cells[10].Value = "0";
                                                        }
                                                        else if (Convert.ToInt32(sPhutVeSom) >= 0)
                                                        {
                                                            iPhutVeSom = Convert.ToInt32(sPhutVeSom) - iChoPhepVeSom;
                                                            if (iPhutVeSom < 1)
                                                            {
                                                                this.DGVTinhCong.Rows[_nhanVien].Cells[10].Value = "0";
                                                            }
                                                            else if (!(sBatDauTinhVeSom == "True"))
                                                            {
                                                                this.DGVTinhCong.Rows[_nhanVien].Cells[10].Value = sPhutVeSom;
                                                            }
                                                            else
                                                            {
                                                                this.DGVTinhCong.Rows[_nhanVien].Cells[10].Value = iPhutVeSom.ToString();
                                                            }
                                                        }
                                                        else
                                                        {
                                                            this.DGVTinhCong.Rows[_nhanVien].Cells[10].Value = "0";
                                                        }
                                                        value = dGioRaFilo - dGioRaKhaiBaoFiLoB;
                                                        second = Convert.ToInt32(value.TotalMinutes);
                                                        sVeTre = second.ToString();
                                                        if (Convert.ToInt32(sVeTre) <= 0)
                                                        {
                                                            this.DGVTinhCong.Rows[_nhanVien].Cells[11].Value = "0";
                                                        }
                                                        else
                                                        {
                                                            this.DGVTinhCong.Rows[_nhanVien].Cells[11].Value = sVeTre;
                                                        }
                                                        iPhut = Convert.ToSingle(dtCaLamViecFilo.Rows[iCaLamViecFilo]["TongGioTrongCaLamViec"]) * 60f - (float)(Convert.ToInt32(this.DGVTinhCong.Rows[_nhanVien].Cells[9].Value.ToString()) + Convert.ToInt32(this.DGVTinhCong.Rows[_nhanVien].Cells[10].Value));
                                                        dGio = Math.Round(Convert.ToDouble(iPhut) / 60, this.iLamTronGio);
                                                        this.DGVTinhCong.Rows[_nhanVien].Cells[8].Value = dGio * this.dTangCaChuNhatHeSo;
                                                        iGio = Convert.ToDouble(dtCaLamViecFilo.Rows[iCaLamViecFilo]["TongGioTrongCaLamViec"].ToString());
                                                        dCongTinh = Convert.ToDouble(dtCaLamViecFilo.Rows[iCaLamViecFilo]["CongTinh"].ToString());
                                                        dCong = Math.Round(dGio * dCongTinh / iGio, this.iLamTronCong);
                                                        this.DGVTinhCong.Rows[_nhanVien].Cells[7].Value = dCong * this.dTangCaChuNhatHeSo;
                                                        sTangCaTruocGioLamViec = dtCaLamViecFilo.Rows[iCaLamViecFilo]["TangCaTruocGioLamViec"].ToString();
                                                        sTangCaSauGioLamViec = dtCaLamViecFilo.Rows[iCaLamViecFilo]["TangCaSauGioLamViec"].ToString();
                                                        if ((sTangCaTruocGioLamViec != "False" ? false : sTangCaSauGioLamViec == "False"))
                                                        {
                                                            this.DGVTinhCong.Rows[_nhanVien].Cells[12].Value = "0";
                                                            this.DGVTinhCong.Rows[_nhanVien].Cells[13].Value = "0";
                                                            this.DGVTinhCong.Rows[_nhanVien].Cells[14].Value = "0";
                                                            this.DGVTinhCong.Rows[_nhanVien].Cells[15].Value = "0";
                                                        }
                                                        if (sXemCaNayLaTangCa == "True")
                                                        {
                                                            if (iTangCaMuc == 1)
                                                            {
                                                                this.DGVTinhCong.Rows[_nhanVien].Cells[7].Value = "0";
                                                                this.DGVTinhCong.Rows[_nhanVien].Cells[8].Value = "0";
                                                                this.DGVTinhCong.Rows[_nhanVien].Cells[12].Value = dGio.ToString();
                                                                this.DGVTinhCong.Rows[_nhanVien].Cells[13].Value = "0";
                                                                this.DGVTinhCong.Rows[_nhanVien].Cells[14].Value = "0";
                                                                this.DGVTinhCong.Rows[_nhanVien].Cells[15].Value = "0";
                                                            }
                                                            if (iTangCaMuc == 2)
                                                            {
                                                                this.DGVTinhCong.Rows[_nhanVien].Cells[7].Value = "0";
                                                                this.DGVTinhCong.Rows[_nhanVien].Cells[8].Value = "0";
                                                                this.DGVTinhCong.Rows[_nhanVien].Cells[12].Value = "0";
                                                                this.DGVTinhCong.Rows[_nhanVien].Cells[13].Value = dGio.ToString();
                                                                this.DGVTinhCong.Rows[_nhanVien].Cells[14].Value = "0";
                                                                this.DGVTinhCong.Rows[_nhanVien].Cells[15].Value = "0";
                                                            }
                                                            if (iTangCaMuc == 3)
                                                            {
                                                                this.DGVTinhCong.Rows[_nhanVien].Cells[7].Value = "0";
                                                                this.DGVTinhCong.Rows[_nhanVien].Cells[8].Value = "0";
                                                                this.DGVTinhCong.Rows[_nhanVien].Cells[12].Value = "0";
                                                                this.DGVTinhCong.Rows[_nhanVien].Cells[13].Value = "0";
                                                                this.DGVTinhCong.Rows[_nhanVien].Cells[14].Value = dGio.ToString();
                                                                this.DGVTinhCong.Rows[_nhanVien].Cells[15].Value = "0";
                                                            }
                                                            if (iTangCaMuc == 4)
                                                            {
                                                                this.DGVTinhCong.Rows[_nhanVien].Cells[7].Value = "0";
                                                                this.DGVTinhCong.Rows[_nhanVien].Cells[8].Value = "0";
                                                                this.DGVTinhCong.Rows[_nhanVien].Cells[12].Value = "0";
                                                                this.DGVTinhCong.Rows[_nhanVien].Cells[13].Value = "0";
                                                                this.DGVTinhCong.Rows[_nhanVien].Cells[14].Value = "0";
                                                                this.DGVTinhCong.Rows[_nhanVien].Cells[15].Value = dGio.ToString();
                                                            }
                                                        }
                                                        sChoPhepTangCaTruocGioLamViecFiLo = dtCaLamViecFilo.Rows[iCaLamViecFilo]["TangCaTruocGioLamViec"].ToString();
                                                        iPhutTangCaTruocGioLamViecFiLo = Convert.ToInt32(dtCaLamViecFilo.Rows[iCaLamViecFilo]["SoPhutTangCaTruocGioLamViec"].ToString());
                                                        iPhutTangCaTruocGioLamViecDatDen = Convert.ToInt32(dtCaLamViecFilo.Rows[iCaLamViecFilo]["TangCaTruocGioLamViecDatDen"].ToString());
                                                        iPhutTruTangCaTruoc = Convert.ToInt32(dtCaLamViecFilo.Rows[iCaLamViecFilo]["PhutTruTangCaTruoc"].ToString());
                                                        sChoPhepTangCaSauGioLamViecFiLo = dtCaLamViecFilo.Rows[iCaLamViecFilo]["TangCaSauGioLamViec"].ToString();
                                                        iPhutTangCaSauGioLamViecFiLo = Convert.ToInt32(dtCaLamViecFilo.Rows[iCaLamViecFilo]["SoPhutTangCaSauGioLamViec"].ToString());
                                                        iPhutTangCaSauGioLamViecDatDen = Convert.ToInt32(dtCaLamViecFilo.Rows[iCaLamViecFilo]["TangCaSauGioLamViecDatDen"].ToString());
                                                        iPhutTruTangCaSau = Convert.ToInt32(dtCaLamViecFilo.Rows[iCaLamViecFilo]["PhutTruTangCaSau"].ToString());
                                                        iGioiHanTC1FiLo = Convert.ToInt32(dtCaLamViecFilo.Rows[iCaLamViecFilo]["GioiHanTangCa1"].ToString());
                                                        iGioiHanTC2FiLo = Convert.ToInt32(dtCaLamViecFilo.Rows[iCaLamViecFilo]["GioiHanTangCa2"].ToString());
                                                        iGioiHanTC3FiLo = Convert.ToInt32(dtCaLamViecFilo.Rows[iCaLamViecFilo]["GioiHanTangCa3"].ToString());
                                                        iGioiHanTC4FiLo = Convert.ToInt32(dtCaLamViecFilo.Rows[iCaLamViecFilo]["GioiHanTangCa4"].ToString());
                                                        iTongGioTangCaSauFiLo = 0;
                                                        iTongGioTangCaTruocFiLo = 0;
                                                        if ((sChoPhepTangCaTruocGioLamViecFiLo != "False" ? true : !(sChoPhepTangCaSauGioLamViecFiLo == "False")))
                                                        {
                                                            if (sChoPhepTangCaTruocGioLamViecFiLo == "True")
                                                            {
                                                                value = dGioVaoKhaiBaoFiloB - dGioVaoFilo;
                                                                second = Convert.ToInt32(value.TotalMinutes);
                                                                iThoiGianTruocGioLamFiLo = Convert.ToInt32(second.ToString());
                                                                if (iThoiGianTruocGioLamFiLo > 0)
                                                                {
                                                                    if (iThoiGianTruocGioLamFiLo > iPhutTangCaTruocGioLamViecFiLo)
                                                                    {
                                                                        if (iThoiGianTruocGioLamFiLo > iPhutTangCaTruocGioLamViecDatDen)
                                                                        {
                                                                            iTongGioTangCaTruocFiLo = iThoiGianTruocGioLamFiLo - iPhutTruTangCaTruoc;
                                                                        }
                                                                    }
                                                                }
                                                            }
                                                            if (sChoPhepTangCaSauGioLamViecFiLo == "True")
                                                            {
                                                                value = dGioRaFilo - dGioRaKhaiBaoFiLoB;
                                                                second = Convert.ToInt32(value.TotalMinutes);
                                                                iThoiGianSauGioLamViecFiLo = Convert.ToInt32(second.ToString());
                                                                if (iThoiGianSauGioLamViecFiLo > 0)
                                                                {
                                                                    if (iThoiGianSauGioLamViecFiLo > iPhutTangCaSauGioLamViecFiLo)
                                                                    {
                                                                        if (iThoiGianSauGioLamViecFiLo > iPhutTangCaSauGioLamViecDatDen)
                                                                        {
                                                                            iTongGioTangCaSauFiLo = iThoiGianSauGioLamViecFiLo - iPhutTruTangCaSau;
                                                                        }
                                                                    }
                                                                }
                                                            }
                                                        }
                                                        else
                                                        {
                                                            this.DGVTinhCong.Rows[_nhanVien].Cells[12].Value = "0";
                                                            this.DGVTinhCong.Rows[_nhanVien].Cells[13].Value = "0";
                                                            this.DGVTinhCong.Rows[_nhanVien].Cells[14].Value = "0";
                                                            this.DGVTinhCong.Rows[_nhanVien].Cells[15].Value = "0";
                                                        }
                                                        dTongThoiGianTangCaFiLo = Convert.ToDouble(iTongGioTangCaTruocFiLo + iTongGioTangCaSauFiLo);
                                                        if (dTongThoiGianTangCaFiLo <= 0)
                                                        {
                                                            this.DGVTinhCong.Rows[_nhanVien].Cells[12].Value = "0";
                                                            this.DGVTinhCong.Rows[_nhanVien].Cells[13].Value = "0";
                                                            this.DGVTinhCong.Rows[_nhanVien].Cells[14].Value = "0";
                                                            this.DGVTinhCong.Rows[_nhanVien].Cells[15].Value = "0";
                                                        }
                                                        else
                                                        {
                                                            if (iGioiHanTC1FiLo == 0)
                                                            {
                                                                this.DGVTinhCong.Rows[_nhanVien].Cells[12].Value = Math.Round(dTongThoiGianTangCaFiLo * this.dTangCa1HeSo / 60, this.iLamTronGio);
                                                                this.DGVTinhCong.Rows[_nhanVien].Cells[13].Value = "0";
                                                                this.DGVTinhCong.Rows[_nhanVien].Cells[14].Value = "0";
                                                                this.DGVTinhCong.Rows[_nhanVien].Cells[15].Value = "0";
                                                            }
                                                            if ((iGioiHanTC1FiLo == 0 ? false : iGioiHanTC2FiLo == 0))
                                                            {
                                                                if (dTongThoiGianTangCaFiLo >= Convert.ToDouble(iGioiHanTC1FiLo))
                                                                {
                                                                    this.DGVTinhCong.Rows[_nhanVien].Cells[12].Value = Math.Round(Convert.ToDouble(iGioiHanTC1FiLo) / 60 * this.dTangCa1HeSo, this.iLamTronGio);
                                                                    if (dTongThoiGianTangCaFiLo - Convert.ToDouble(iGioiHanTC1FiLo) > 0)
                                                                    {
                                                                        this.DGVTinhCong.Rows[_nhanVien].Cells[13].Value = Math.Round((dTongThoiGianTangCaFiLo - Convert.ToDouble(iGioiHanTC1FiLo)) * this.dTangCa2HeSo / 60, this.iLamTronGio);
                                                                    }
                                                                    this.DGVTinhCong.Rows[_nhanVien].Cells[14].Value = "0";
                                                                    this.DGVTinhCong.Rows[_nhanVien].Cells[15].Value = "0";
                                                                }
                                                                else
                                                                {
                                                                    this.DGVTinhCong.Rows[_nhanVien].Cells[12].Value = Math.Round(dTongThoiGianTangCaFiLo * this.dTangCa1HeSo / 60, this.iLamTronGio);
                                                                    this.DGVTinhCong.Rows[_nhanVien].Cells[13].Value = "0";
                                                                    this.DGVTinhCong.Rows[_nhanVien].Cells[14].Value = "0";
                                                                    this.DGVTinhCong.Rows[_nhanVien].Cells[15].Value = "0";
                                                                }
                                                            }
                                                            if ((iGioiHanTC1FiLo == 0 || iGioiHanTC2FiLo == 0 ? false : iGioiHanTC3FiLo == 0))
                                                            {
                                                                if (dTongThoiGianTangCaFiLo >= Convert.ToDouble(iGioiHanTC1FiLo))
                                                                {
                                                                    this.DGVTinhCong.Rows[_nhanVien].Cells[12].Value = Math.Round(Convert.ToDouble(iGioiHanTC1FiLo) * this.dTangCa1HeSo / 60, this.iLamTronGio);
                                                                    if (dTongThoiGianTangCaFiLo - Convert.ToDouble(iGioiHanTC1FiLo) >= Convert.ToDouble(iGioiHanTC2FiLo))
                                                                    {
                                                                        this.DGVTinhCong.Rows[_nhanVien].Cells[12].Value = Math.Round(Convert.ToDouble(iGioiHanTC1FiLo) * this.dTangCa1HeSo / 60, this.iLamTronGio);
                                                                        this.DGVTinhCong.Rows[_nhanVien].Cells[13].Value = Math.Round(Convert.ToDouble(iGioiHanTC2FiLo) * this.dTangCa2HeSo / 60, this.iLamTronGio);
                                                                        this.DGVTinhCong.Rows[_nhanVien].Cells[14].Value = Math.Round((dTongThoiGianTangCaFiLo - Convert.ToDouble(iGioiHanTC1FiLo) - Convert.ToDouble(iGioiHanTC2FiLo)) * this.dTangCa3HeSo / 60, this.iLamTronGio);
                                                                        this.DGVTinhCong.Rows[_nhanVien].Cells[15].Value = "0";
                                                                    }
                                                                    else
                                                                    {
                                                                        this.DGVTinhCong.Rows[_nhanVien].Cells[13].Value = Math.Round((dTongThoiGianTangCaFiLo - Convert.ToDouble(iGioiHanTC1FiLo)) * this.dTangCa2HeSo / 60, this.iLamTronGio);
                                                                        this.DGVTinhCong.Rows[_nhanVien].Cells[14].Value = "0";
                                                                        this.DGVTinhCong.Rows[_nhanVien].Cells[15].Value = "0";
                                                                    }
                                                                }
                                                                else
                                                                {
                                                                    this.DGVTinhCong.Rows[_nhanVien].Cells[12].Value = Math.Round(dTongThoiGianTangCaFiLo * this.dTangCa1HeSo / 60, this.iLamTronGio);
                                                                    this.DGVTinhCong.Rows[_nhanVien].Cells[13].Value = "0";
                                                                    this.DGVTinhCong.Rows[_nhanVien].Cells[14].Value = "0";
                                                                    this.DGVTinhCong.Rows[_nhanVien].Cells[15].Value = "0";
                                                                }
                                                            }
                                                            if ((iGioiHanTC1FiLo == 0 || iGioiHanTC2FiLo == 0 || iGioiHanTC3FiLo == 0 ? false : iGioiHanTC4FiLo == 0))
                                                            {
                                                            }
                                                        }
                                                        value = dGioRaFilo - dGioVaoFilo;
                                                        second = Convert.ToInt32(value.TotalMinutes);
                                                        num = Math.Round(Convert.ToDouble(second.ToString()) / 60, this.iLamTronGio);
                                                        sTongGio = num.ToString();
                                                        this.DGVTinhCong.Rows[_nhanVien].Cells[16].Value = Convert.ToDouble(sTongGio) * this.dTangCaChuNhatHeSo;
                                                        this.DGVTinhCong.Rows[_nhanVien].Cells[17].Value = Convert.ToDouble(dtCaLamViecFilo.Rows[iCaLamViecFilo]["CongTinh"].ToString()) * this.dTangCaChuNhatHeSo;
                                                        this.DGVTinhCong.Rows[_nhanVien].Cells[18].Value = this.sKHDungGio;
                                                    }
                                                    else
                                                    {
                                                        sTruGioDiTre = dtCaLamViecFilo.Rows[iCaLamViecFilo]["TruGioDiTre"].ToString();
                                                        sBatDauTinhDiTre = dtCaLamViecFilo.Rows[iCaLamViecFilo]["BatDauTinhDiTre"].ToString();
                                                        iChoPhepDiTre = Convert.ToInt32(dtCaLamViecFilo.Rows[iCaLamViecFilo]["ChoPhepDiTre"].ToString());
                                                        value = dGioVaoFilo - dGioVaoKhaiBaoFiloB;
                                                        second = Convert.ToInt32(value.TotalMinutes);
                                                        sPhutTre = second.ToString();
                                                        if (Convert.ToInt32(sPhutTre) < 0)
                                                        {
                                                            sPhutTre = "0";
                                                        }
                                                        sTruGioVeSom = dtCaLamViecFilo.Rows[iCaLamViecFilo]["TruGioVeSom"].ToString();
                                                        sBatDauTinhVeSom = dtCaLamViecFilo.Rows[iCaLamViecFilo]["BatDauTinhVeSom"].ToString();
                                                        iChoPhepVeSom = Convert.ToInt32(dtCaLamViecFilo.Rows[iCaLamViecFilo]["ChoPhepVeSom"].ToString());
                                                        value = dGioRaKhaiBaoFiLoB - dGioRaFilo;
                                                        second = Convert.ToInt32(value.TotalMinutes);
                                                        sPhutVeSom = second.ToString();
                                                        if (Convert.ToInt32(sPhutVeSom) < 0)
                                                        {
                                                            sPhutVeSom = "0";
                                                        }
                                                        double dTongPhutTangCaFiloA = Convert.ToDouble(dtCaLamViecFilo.Rows[iCaLamViecFilo]["TongGioTrongCaLamViec"]) * 60 - (Convert.ToDouble(sPhutTre) + Convert.ToDouble(sPhutVeSom));
                                                        double dTongGioTangCaFiloA = Math.Round(dTongPhutTangCaFiloA / 60, this.iLamTronGio);
                                                        if (iTangCaChuNhatMuc == 1)
                                                        {
                                                            this.DGVTinhCong.Rows[_nhanVien].Cells[12].Value = dTongGioTangCaFiloA * this.dTangCaChuNhatHeSo;
                                                            this.DGVTinhCong.Rows[_nhanVien].Cells[18].Value = this.sKHDungGio;
                                                        }
                                                        if (iTangCaChuNhatMuc == 2)
                                                        {
                                                            this.DGVTinhCong.Rows[_nhanVien].Cells[13].Value = dTongGioTangCaFiloA * this.dTangCaChuNhatHeSo;
                                                            this.DGVTinhCong.Rows[_nhanVien].Cells[18].Value = this.sKHDungGio;
                                                        }
                                                        if (iTangCaChuNhatMuc == 3)
                                                        {
                                                            this.DGVTinhCong.Rows[_nhanVien].Cells[14].Value = dTongGioTangCaFiloA * this.dTangCaChuNhatHeSo;
                                                            this.DGVTinhCong.Rows[_nhanVien].Cells[18].Value = this.sKHDungGio;
                                                        }
                                                        if (iTangCaChuNhatMuc == 4)
                                                        {
                                                            this.DGVTinhCong.Rows[_nhanVien].Cells[15].Value = dTongGioTangCaFiloA * this.dTangCaChuNhatHeSo;
                                                            this.DGVTinhCong.Rows[_nhanVien].Cells[18].Value = this.sKHDungGio;
                                                        }
                                                    }
                                                    if (!(DateTimeProgress.XuatIDThu((int)dt.AddDays((double)dem).DayOfWeek) == "0"))
                                                    {
                                                        this.DGVTinhCong.Rows[_nhanVien].Cells[19].Value = "NT";
                                                    }
                                                    else
                                                    {
                                                        this.DGVTinhCong.Rows[_nhanVien].Cells[19].Value = "CN";
                                                    }
                                                    this.DGVTinhCong.Rows[_nhanVien].Cells[20].Value = this.sMaChamCong;
                                                    this.DGVTinhCong.Rows[_nhanVien].Cells[21].Value = this.sPhongBanTinhCong;
                                                }
                                            }
                                        Label39:
                                            if (iCaTrongLIchtrinh == 0)
                                            {
                                                this.DGVTinhCong.Rows[_nhanVien].Cells[4].Value = "***";
                                                this.DGVTinhCong.Rows[_nhanVien].Cells[7].Value = "0";
                                                this.DGVTinhCong.Rows[_nhanVien].Cells[8].Value = "0";
                                                this.DGVTinhCong.Rows[_nhanVien].Cells[9].Value = "0";
                                                this.DGVTinhCong.Rows[_nhanVien].Cells[10].Value = "0";
                                                this.DGVTinhCong.Rows[_nhanVien].Cells[11].Value = "0";
                                                this.DGVTinhCong.Rows[_nhanVien].Cells[12].Value = "0";
                                                this.DGVTinhCong.Rows[_nhanVien].Cells[13].Value = "0";
                                                this.DGVTinhCong.Rows[_nhanVien].Cells[14].Value = "0";
                                                this.DGVTinhCong.Rows[_nhanVien].Cells[15].Value = "0";
                                                this.DGVTinhCong.Rows[_nhanVien].Cells[16].Value = "0";
                                                this.DGVTinhCong.Rows[_nhanVien].Cells[17].Value = "0";
                                                this.DGVTinhCong.Rows[_nhanVien].Cells[18].Value = this.sKHVang;
                                                if (!(DateTimeProgress.XuatIDThu((int)dt.AddDays((double)dem).DayOfWeek) == "0"))
                                                {
                                                    this.DGVTinhCong.Rows[_nhanVien].Cells[19].Value = "NT";
                                                }
                                                else
                                                {
                                                    this.DGVTinhCong.Rows[_nhanVien].Cells[19].Value = "CN";
                                                }
                                                this.DGVTinhCong.Rows[_nhanVien].Cells[20].Value = this.sMaChamCong;
                                                this.DGVTinhCong.Rows[_nhanVien].Cells[21].Value = this.sPhongBanTinhCong;
                                            }
                                            iKiemTraRaDuLieuChamCongNguonFilo = 1;
                                            this.DGVDuLieuChamCongNguon.Rows[addDuLieuChamCongNguonFilo].Cells[2].Value = dtGioChamFilo.Rows[iGioChamFilo]["GioCham"].ToString();
                                            this.DGVDuLieuChamCongNguon.Rows[addDuLieuChamCongNguonFilo].Cells[3].Value = "Ra";
                                            this.DGVDuLieuChamCongNguon.Rows[addDuLieuChamCongNguonFilo].Cells[4].Value = "O";
                                            this.DGVDuLieuChamCongNguon.Rows[addDuLieuChamCongNguonFilo].Cells[6].Value = dtGioChamFilo.Rows[iGioChamFilo]["MaSoMay"].ToString();
                                        }
                                        if ((iKiemTraVaoDuLieuChamCongNguonFilo != 1 || iKiemTraRaDuLieuChamCongNguonFilo != 0 ? false : iLanChamFilo > 1))
                                        {
                                            this.DGVDuLieuChamCongNguon.Rows[addDuLieuChamCongNguonFilo].Cells[2].Value = dtGioChamFilo.Rows[iGioChamFilo]["GioCham"].ToString();
                                            this.DGVDuLieuChamCongNguon.Rows[addDuLieuChamCongNguonFilo].Cells[3].Value = "Lặp lại";
                                            this.DGVDuLieuChamCongNguon.Rows[addDuLieuChamCongNguonFilo].Cells[4].Value = "*";
                                            this.DGVDuLieuChamCongNguon.Rows[addDuLieuChamCongNguonFilo].Cells[6].Value = dtGioChamFilo.Rows[iGioChamFilo]["MaSoMay"].ToString();
                                            for (int iMauDongFilo = 0; iMauDongFilo < 7; iMauDongFilo++)
                                            {
                                                this.DGVDuLieuChamCongNguon.Rows[addDuLieuChamCongNguonFilo].Cells[iMauDongFilo].Style.BackColor = Color.Red;
                                            }
                                        }
                                        this.DGVDuLieuChamCongNguon.Rows[addDuLieuChamCongNguonFilo].Cells[6].Value = dtGioChamFilo.Rows[iGioChamFilo]["MaSoMay"].ToString();
                                    }
                                    if (iLanChamFilo == 0)
                                    {
                                        this.DGVTinhCong.Rows[_nhanVien].Cells[7].Value = "0";
                                        this.DGVTinhCong.Rows[_nhanVien].Cells[8].Value = "0";
                                        this.DGVTinhCong.Rows[_nhanVien].Cells[17].Value = "0";
                                        this.DGVTinhCong.Rows[_nhanVien].Cells[18].Value = this.sKHVang;
                                        if (!(DateTimeProgress.XuatIDThu((int)dt.AddDays((double)dem).DayOfWeek) == "0"))
                                        {
                                            this.DGVTinhCong.Rows[_nhanVien].Cells[19].Value = "NT";
                                        }
                                        else
                                        {
                                            this.DGVTinhCong.Rows[_nhanVien].Cells[19].Value = "CN";
                                        }
                                        this.DGVTinhCong.Rows[_nhanVien].Cells[20].Value = this.sMaChamCong;
                                        this.DGVTinhCong.Rows[_nhanVien].Cells[21].Value = this.sPhongBanTinhCong;
                                    }
                                }
                                if (iChonLichTrinh == 6)
                                {
                                    iKiemTraLanChamTinhTheoGioLichTrinhVaoRa = 0;
                                    int iKiemTraLanChamKhoangCachTinhTheoGioLichTrinhVaoRa = 0;
                                    int demTinhTheoGio = 0;
                                    int addTinhTheoGio = 1;
                                    int iDemLanChamCongTinhTheoGio = 0;
                                    DateTime dGioVaoTinhTheoGio = new DateTime();
                                    DateTime dGioRaTinhTheoGio = new DateTime();
                                    dGioRaTinhTheoGioLichTrinhVaoRa = new DateTime();
                                    dGioVaoTinhTheoGioLichTrinhVaoRa = new DateTime();
                                    dtTinhTheoGio = new System.Data.DataTable();
                                    this._checkInOutDTO.MaChamCong = Convert.ToInt32(this.sMaChamCong);
                                    this._checkInOutDTO.NgayCham = Convert.ToDateTime(this.DGVTinhCong.Rows[_nhanVien].Cells[2].Value.ToString());
                                    dtTinhTheoGio = this._checkInOutBLL.getCheckInOutByMaChamCongAndNgayCham(this._checkInOutDTO);
                                    for (iTinhTheoGio = 0; iTinhTheoGio < dtTinhTheoGio.Rows.Count; iTinhTheoGio++)
                                    {
                                        addGioNguonTinhTheoGio = this.DGVDuLieuChamCongNguon.Rows.Add();
                                        iKiemTraLanChamTinhTheoGioLichTrinhVaoRa++;
                                        if (iKiemTraLanChamTinhTheoGioLichTrinhVaoRa == 1)
                                        {
                                            dGioVaoTinhTheoGioLichTrinhVaoRa = Convert.ToDateTime(dtTinhTheoGio.Rows[iTinhTheoGio]["GioCham"].ToString());
                                            if ((dtTinhTheoGio.Rows.Count <= 2 ? true : iKiemTraLanChamKhoangCachTinhTheoGioLichTrinhVaoRa != 3))
                                            {
                                                this.DGVDuLieuChamCongNguon.Rows[addGioNguonTinhTheoGio].Cells[0].Value = this.sMaChamCong;
                                                this.DGVDuLieuChamCongNguon.Rows[addGioNguonTinhTheoGio].Cells[1].Value = string.Format("{0:d}", dGioVaoTinhTheoGioLichTrinhVaoRa);
                                                this.DGVDuLieuChamCongNguon.Rows[addGioNguonTinhTheoGio].Cells[2].Value = dGioVaoTinhTheoGioLichTrinhVaoRa;
                                                this.DGVDuLieuChamCongNguon.Rows[addGioNguonTinhTheoGio].Cells[3].Value = "Vào";
                                                this.DGVDuLieuChamCongNguon.Rows[addGioNguonTinhTheoGio].Cells[4].Value = "I";
                                                this.DGVDuLieuChamCongNguon.Rows[addGioNguonTinhTheoGio].Cells[6].Value = dtTinhTheoGio.Rows[iTinhTheoGio]["MaSoMay"].ToString();
                                            }
                                            else
                                            {
                                                if (Convert.ToInt32(Convert.ToInt32((dGioVaoTinhTheoGioLichTrinhVaoRa - dGioRaTinhTheoGioLichTrinhVaoRa).TotalMinutes).ToString()) < iKhoangCachGiuaHaiCapVaoRa)
                                                {
                                                    goto Label42;
                                                }
                                                this.DGVDuLieuChamCongNguon.Rows[addGioNguonTinhTheoGio].Cells[0].Value = this.sMaChamCong;
                                                this.DGVDuLieuChamCongNguon.Rows[addGioNguonTinhTheoGio].Cells[1].Value = string.Format("{0:d}", dGioVaoTinhTheoGioLichTrinhVaoRa);
                                                this.DGVDuLieuChamCongNguon.Rows[addGioNguonTinhTheoGio].Cells[2].Value = dGioVaoTinhTheoGioLichTrinhVaoRa;
                                                this.DGVDuLieuChamCongNguon.Rows[addGioNguonTinhTheoGio].Cells[3].Value = "Vào";
                                                this.DGVDuLieuChamCongNguon.Rows[addGioNguonTinhTheoGio].Cells[4].Value = "I";
                                                this.DGVDuLieuChamCongNguon.Rows[addGioNguonTinhTheoGio].Cells[6].Value = dtTinhTheoGio.Rows[iTinhTheoGio]["MaSoMay"].ToString();
                                                iKiemTraLanChamTinhTheoGioLichTrinhVaoRa = 1;
                                            }
                                        }
                                        if (iKiemTraLanChamTinhTheoGioLichTrinhVaoRa == 2)
                                        {
                                            dGioRaTinhTheoGioLichTrinhVaoRa = Convert.ToDateTime(dtTinhTheoGio.Rows[iTinhTheoGio]["GioCham"].ToString());
                                            if (Convert.ToInt32(Convert.ToInt32((dGioRaTinhTheoGioLichTrinhVaoRa - dGioVaoTinhTheoGioLichTrinhVaoRa).TotalMinutes).ToString()) < iThoiGianNhoNhat)
                                            {
                                                goto Label43;
                                            }
                                            iKiemTraLanChamTinhTheoGioLichTrinhVaoRa = 0;
                                            iKiemTraLanChamKhoangCachTinhTheoGioLichTrinhVaoRa = 3;
                                            this.DGVDuLieuChamCongNguon.Rows[addGioNguonTinhTheoGio].Cells[0].Value = this.sMaChamCong;
                                            this.DGVDuLieuChamCongNguon.Rows[addGioNguonTinhTheoGio].Cells[1].Value = string.Format("{0:d}", dGioRaTinhTheoGioLichTrinhVaoRa);
                                            this.DGVDuLieuChamCongNguon.Rows[addGioNguonTinhTheoGio].Cells[2].Value = dGioRaTinhTheoGioLichTrinhVaoRa;
                                            this.DGVDuLieuChamCongNguon.Rows[addGioNguonTinhTheoGio].Cells[3].Value = "Ra";
                                            this.DGVDuLieuChamCongNguon.Rows[addGioNguonTinhTheoGio].Cells[4].Value = "O";
                                            this.DGVDuLieuChamCongNguon.Rows[addGioNguonTinhTheoGio].Cells[6].Value = dtTinhTheoGio.Rows[iTinhTheoGio]["MaSoMay"].ToString();
                                        }
                                        iDemLanChamCongTinhTheoGio++;
                                        if (iDemLanChamCongTinhTheoGio == 1)
                                        {
                                            dGioVaoTinhTheoGio = Convert.ToDateTime(dtTinhTheoGio.Rows[iTinhTheoGio]["GioCham"].ToString());
                                            this.DGVTinhCong.Rows[_nhanVien].Cells[5].Value = string.Format(this.sDinhDangThoiGian, dGioVaoTinhTheoGio);
                                            if (dtTinhTheoGio.Rows.Count != 1)
                                            {
                                                this.DGVTinhCong.Rows[_nhanVien].Cells[0].Value = this.sMaNhanVien;
                                                this.DGVTinhCong.Rows[_nhanVien].Cells[1].Value = this.sTenNhanVien;
                                                this.DGVTinhCong.Rows[_nhanVien].Cells[2].Value = this.DGVTinhCong.Rows[_nhanVien].Cells[2].Value.ToString();
                                                if (this.iNgonNgu == 0)
                                                {
                                                    DataGridViewCell item16 = this.DGVTinhCong.Rows[_nhanVien].Cells[3];
                                                    dateTime = dt.AddDays((double)dem);
                                                    item16.Value = DateTimeProgress.XuatThuTinhCong((int)dateTime.DayOfWeek);
                                                }
                                                if (this.iNgonNgu == 1)
                                                {
                                                    DataGridViewCell dataGridViewCell16 = this.DGVTinhCong.Rows[_nhanVien].Cells[3];
                                                    dateTime = dt.AddDays((double)dem);
                                                    dataGridViewCell16.Value = DateTimeProgress.XuatThuEnglish((int)dateTime.DayOfWeek);
                                                }
                                                this.DGVTinhCong.Rows[_nhanVien].Cells[4].Value = "***";
                                                this.DGVTinhCong.Rows[_nhanVien].Cells[7].Value = "0";
                                                this.DGVTinhCong.Rows[_nhanVien].Cells[8].Value = "0";
                                                this.DGVTinhCong.Rows[_nhanVien].Cells[9].Value = "0";
                                                this.DGVTinhCong.Rows[_nhanVien].Cells[10].Value = "0";
                                                this.DGVTinhCong.Rows[_nhanVien].Cells[11].Value = "0";
                                                this.DGVTinhCong.Rows[_nhanVien].Cells[12].Value = "0";
                                                this.DGVTinhCong.Rows[_nhanVien].Cells[13].Value = "0";
                                                this.DGVTinhCong.Rows[_nhanVien].Cells[14].Value = "0";
                                                this.DGVTinhCong.Rows[_nhanVien].Cells[15].Value = "0";
                                                this.DGVTinhCong.Rows[_nhanVien].Cells[16].Value = "0";
                                                this.DGVTinhCong.Rows[_nhanVien].Cells[17].Value = "0";
                                                this.DGVTinhCong.Rows[_nhanVien].Cells[18].Value = this.sKHVang;
                                                if (!(DateTimeProgress.XuatIDThu((int)dt.AddDays((double)dem).DayOfWeek) == "0"))
                                                {
                                                    this.DGVTinhCong.Rows[_nhanVien].Cells[19].Value = "NT";
                                                }
                                                else
                                                {
                                                    this.DGVTinhCong.Rows[_nhanVien].Cells[19].Value = "CN";
                                                }
                                                this.DGVTinhCong.Rows[_nhanVien].Cells[20].Value = this.sMaChamCong;
                                                this.DGVTinhCong.Rows[_nhanVien].Cells[21].Value = this.sPhongBanTinhCong;
                                            }
                                            else
                                            {
                                                this.DGVTinhCong.Rows[_nhanVien].Cells[0].Value = this.sMaNhanVien;
                                                this.DGVTinhCong.Rows[_nhanVien].Cells[1].Value = this.sTenNhanVien;
                                                this.DGVTinhCong.Rows[_nhanVien].Cells[2].Value = this.DGVTinhCong.Rows[_nhanVien].Cells[2].Value.ToString();
                                                if (this.iNgonNgu == 0)
                                                {
                                                    DataGridViewCell item17 = this.DGVTinhCong.Rows[_nhanVien].Cells[3];
                                                    dateTime = dt.AddDays((double)dem);
                                                    item17.Value = DateTimeProgress.XuatThuTinhCong((int)dateTime.DayOfWeek);
                                                }
                                                if (this.iNgonNgu == 1)
                                                {
                                                    DataGridViewCell dataGridViewCell17 = this.DGVTinhCong.Rows[_nhanVien].Cells[3];
                                                    dateTime = dt.AddDays((double)dem);
                                                    dataGridViewCell17.Value = DateTimeProgress.XuatThuEnglish((int)dateTime.DayOfWeek);
                                                }
                                                this.DGVTinhCong.Rows[_nhanVien].Cells[4].Value = "***";
                                                this.DGVTinhCong.Rows[_nhanVien].Cells[7].Value = "0";
                                                this.DGVTinhCong.Rows[_nhanVien].Cells[8].Value = "0";
                                                this.DGVTinhCong.Rows[_nhanVien].Cells[9].Value = "0";
                                                this.DGVTinhCong.Rows[_nhanVien].Cells[10].Value = "0";
                                                this.DGVTinhCong.Rows[_nhanVien].Cells[11].Value = "0";
                                                this.DGVTinhCong.Rows[_nhanVien].Cells[12].Value = "0";
                                                this.DGVTinhCong.Rows[_nhanVien].Cells[13].Value = "0";
                                                this.DGVTinhCong.Rows[_nhanVien].Cells[14].Value = "0";
                                                this.DGVTinhCong.Rows[_nhanVien].Cells[15].Value = "0";
                                                this.DGVTinhCong.Rows[_nhanVien].Cells[16].Value = "0";
                                                this.DGVTinhCong.Rows[_nhanVien].Cells[17].Value = "0";
                                                this.DGVTinhCong.Rows[_nhanVien].Cells[18].Value = this.sKHVang;
                                                if (!(DateTimeProgress.XuatIDThu((int)dt.AddDays((double)dem).DayOfWeek) == "0"))
                                                {
                                                    this.DGVTinhCong.Rows[_nhanVien].Cells[19].Value = "NT";
                                                }
                                                else
                                                {
                                                    this.DGVTinhCong.Rows[_nhanVien].Cells[19].Value = "CN";
                                                }
                                                this.DGVTinhCong.Rows[_nhanVien].Cells[20].Value = this.sMaChamCong;
                                                this.DGVTinhCong.Rows[_nhanVien].Cells[21].Value = this.sPhongBanTinhCong;
                                            }
                                        }
                                        if (iDemLanChamCongTinhTheoGio == 2)
                                        {
                                            dGioRaTinhTheoGio = Convert.ToDateTime(dtTinhTheoGio.Rows[iTinhTheoGio]["GioCham"].ToString());
                                            if (Convert.ToInt32(Convert.ToInt32((dGioRaTinhTheoGioLichTrinhVaoRa - dGioVaoTinhTheoGioLichTrinhVaoRa).TotalMinutes).ToString()) <= iThoiGianLonNhat)
                                            {
                                                this.DGVTinhCong.Rows[_nhanVien].Cells[6].Value = string.Format(this.sDinhDangThoiGian, dGioRaTinhTheoGio);
                                                iCaTrongLIchtrinh = 0;
                                                dtNhanCaTinhTheoGio = new System.Data.DataTable();
                                                this._chiTietLichTrinhChoCalamViecDTO.MaLichTrinhCaLamViec = sLTCCLVNhanVien;
                                                this._chiTietLichTrinhChoCalamViecDTO.Thu = sThu;
                                                dtNhanCaTinhTheoGio = this._chiTietLichTrinhChoCaLamViecBLL.ChiTietLichTrinhChoCaLamViecNhanCa(this._chiTietLichTrinhChoCalamViecDTO);
                                                iChiTietLichTrinhChoCaLamViecTinhTheoGio = 0;
                                                if (iChiTietLichTrinhChoCaLamViecTinhTheoGio < dtNhanCaTinhTheoGio.Rows.Count)
                                                {
                                                    iCaTrongLIchtrinh = 1;
                                                    cellChiTietLichTrinhChoCaLamViecTinhTheoGio = 3;
                                                    while (cellChiTietLichTrinhChoCaLamViecTinhTheoGio < 13)
                                                    {
                                                        kiemTraVao = 0;
                                                        kiemTraRa = 0;
                                                        this.sTinhTheoGioMaCaLamViec = dtNhanCaTinhTheoGio.Rows[iChiTietLichTrinhChoCaLamViecTinhTheoGio][cellChiTietLichTrinhChoCaLamViecTinhTheoGio].ToString();
                                                        dtTinhTheoGioCa1 = new System.Data.DataTable();
                                                        this._caLamViecDTO.MaCaLamViec = this.sTinhTheoGioMaCaLamViec;
                                                        dtTinhTheoGioCa1 = this._caLamViecBLL.CaLamViecGetByMaCaLamViec(this._caLamViecDTO);
                                                        iTinhTheoGioCa1 = 0;
                                                        while (iTinhTheoGioCa1 < dtTinhTheoGioCa1.Rows.Count)
                                                        {
                                                            second = dGioVaoTinhTheoGio.Second;
                                                            sGiayGioVao = second.ToString();
                                                            second = dGioRaTinhTheoGio.Second;
                                                            sGiayGioRa = second.ToString();
                                                            this.sTinhTheoGioTenCaLamViec = dtTinhTheoGioCa1.Rows[iTinhTheoGioCa1]["CaLamViec"].ToString();
                                                            dBatDauVaoTinhTheoGioA = Convert.ToDateTime(dtTinhTheoGioCa1.Rows[iTinhTheoGioCa1]["BatDauVao"].ToString());
                                                            sBatDauVaoTinhTheoGioA = string.Format("{0:T}", dBatDauVaoTinhTheoGioA).Replace("00 ", string.Concat(sGiayGioVao, " "));
                                                            sBatDauVaoTinhTheoGioB = string.Concat(sNgayCham, " ", sBatDauVaoTinhTheoGioA);
                                                            dBatDauVaoTinhTheoGioB = Convert.ToDateTime(sBatDauVaoTinhTheoGioB);
                                                            dKetThucVaoTinhTheoGioA = Convert.ToDateTime(dtTinhTheoGioCa1.Rows[iTinhTheoGioCa1]["KetThucVao"].ToString());
                                                            sKetThucVaoTinhTheoGioA = string.Format("{0:T}", dKetThucVaoTinhTheoGioA).Replace("00 ", string.Concat(sGiayGioVao, " "));
                                                            sKetThucVaoTinhTheoGioB = string.Concat(sNgayCham, " ", sKetThucVaoTinhTheoGioA);
                                                            dKetThucVaoTinhTheoGioB = Convert.ToDateTime(sKetThucVaoTinhTheoGioB);
                                                            dBatDauRaTinhTheoGioA = Convert.ToDateTime(dtTinhTheoGioCa1.Rows[iTinhTheoGioCa1]["BatDauRa"].ToString());
                                                            sBatDauRaTinhTheoGioA = string.Format("{0:T}", dBatDauRaTinhTheoGioA).Replace("00 ", string.Concat(sGiayGioRa, " "));
                                                            sBatDauRaTinhTheoGioB = string.Concat(sNgayCham, " ", sBatDauRaTinhTheoGioA);
                                                            dBatDauRaTinhTheoGioB = Convert.ToDateTime(sBatDauRaTinhTheoGioB);
                                                            dKetThucRaTinhTheoGioA = Convert.ToDateTime(dtTinhTheoGioCa1.Rows[iTinhTheoGioCa1]["KetThucRa"].ToString());
                                                            sKetThucRaTinhTheoGioA = string.Format("{0:T}", dKetThucRaTinhTheoGioA).Replace("00 ", string.Concat(sGiayGioRa, " "));
                                                            sKetThucRaTinhTheoGioB = string.Concat(sNgayCham, " ", sKetThucRaTinhTheoGioA);
                                                            dKetThucRaTinhTheoGioB = Convert.ToDateTime(sKetThucRaTinhTheoGioB);
                                                            if ((dGioVaoTinhTheoGio < dBatDauVaoTinhTheoGioB ? false : dGioVaoTinhTheoGio <= dKetThucRaTinhTheoGioB))
                                                            {
                                                                kiemTraVao++;
                                                            }
                                                            if ((dGioRaTinhTheoGio < dBatDauVaoTinhTheoGioB ? false : dGioRaTinhTheoGio <= dKetThucRaTinhTheoGioB))
                                                            {
                                                                kiemTraRa++;
                                                            }
                                                            if ((kiemTraVao != 1 ? true : kiemTraRa != 1))
                                                            {
                                                                iTinhTheoGioCa1++;
                                                            }
                                                            else
                                                            {
                                                                goto Label45;
                                                            }
                                                        }
                                                        if (!(this.sTinhTheoGioMaCaLamViec == ""))
                                                        {
                                                            cellChiTietLichTrinhChoCaLamViecTinhTheoGio++;
                                                        }
                                                        else
                                                        {
                                                            this.DGVTinhCong.Rows[_nhanVien].Cells[4].Value = "***";
                                                            this.DGVTinhCong.Rows[_nhanVien].Cells[7].Value = "0";
                                                            this.DGVTinhCong.Rows[_nhanVien].Cells[8].Value = "0";
                                                            this.DGVTinhCong.Rows[_nhanVien].Cells[9].Value = "0";
                                                            this.DGVTinhCong.Rows[_nhanVien].Cells[10].Value = "0";
                                                            this.DGVTinhCong.Rows[_nhanVien].Cells[11].Value = "0";
                                                            this.DGVTinhCong.Rows[_nhanVien].Cells[12].Value = "0";
                                                            this.DGVTinhCong.Rows[_nhanVien].Cells[13].Value = "0";
                                                            this.DGVTinhCong.Rows[_nhanVien].Cells[14].Value = "0";
                                                            this.DGVTinhCong.Rows[_nhanVien].Cells[15].Value = "0";
                                                            this.DGVTinhCong.Rows[_nhanVien].Cells[16].Value = "0";
                                                            this.DGVTinhCong.Rows[_nhanVien].Cells[17].Value = "0";
                                                            this.DGVTinhCong.Rows[_nhanVien].Cells[18].Value = this.sKHVang;
                                                            if (!(DateTimeProgress.XuatIDThu((int)dt.AddDays((double)dem).DayOfWeek) == "0"))
                                                            {
                                                                this.DGVTinhCong.Rows[_nhanVien].Cells[19].Value = "NT";
                                                            }
                                                            else
                                                            {
                                                                this.DGVTinhCong.Rows[_nhanVien].Cells[19].Value = "CN";
                                                            }
                                                            this.DGVTinhCong.Rows[_nhanVien].Cells[20].Value = this.sMaChamCong;
                                                            this.DGVTinhCong.Rows[_nhanVien].Cells[21].Value = this.sPhongBanTinhCong;
                                                            goto Label44;
                                                        }
                                                    }
                                                Label45:
                                                    this.DGVTinhCong.Rows[_nhanVien].Cells[4].Value = this.sTinhTheoGioTenCaLamViec;
                                                    dtCaLamViecTinhTheoGio = new System.Data.DataTable();
                                                    this._caLamViecDTO.MaCaLamViec = this.sTinhTheoGioMaCaLamViec;
                                                    dtCaLamViecTinhTheoGio = this._caLamViecBLL.CaLamViecGetByMaCaLamViec(this._caLamViecDTO);
                                                    for (iCaLamViecTinhTheoGio = 0; iCaLamViecTinhTheoGio < dtCaLamViecTinhTheoGio.Rows.Count; iCaLamViecTinhTheoGio++)
                                                    {
                                                        second = dGioVaoTinhTheoGio.Second;
                                                        sGiayGioVao = second.ToString();
                                                        second = dGioRaTinhTheoGio.Second;
                                                        sGiayGioRa = second.ToString();
                                                        dGioVaoKhaiBaoTinhTheoGioA = Convert.ToDateTime(dtCaLamViecTinhTheoGio.Rows[iCaLamViecTinhTheoGio]["GioVaoLamViec"].ToString());
                                                        sGioVaoKhaiBaoTinhTheoGioA = string.Format("{0:T}", dGioVaoKhaiBaoTinhTheoGioA).Replace("00 ", string.Concat(sGiayGioVao, " "));
                                                        sGioVaoKhaiBaoTinhTheoGioB = string.Concat(sNgayCham, " ", sGioVaoKhaiBaoTinhTheoGioA);
                                                        dGioVaoKhaiBaoTinhTheoGioB = Convert.ToDateTime(sGioVaoKhaiBaoTinhTheoGioB);
                                                        dGioRaKhaiBaoTinhTheoGioA = Convert.ToDateTime(dtCaLamViecTinhTheoGio.Rows[iCaLamViecTinhTheoGio]["GioKetThucLamViec"].ToString());
                                                        sGioRaKhaiBaoTinhTheoGioA = string.Format("{0:T}", dGioRaKhaiBaoTinhTheoGioA).Replace("00 ", string.Concat(sGiayGioRa, " "));
                                                        sGioRaKhaiBaoTinhTheoGioB = string.Concat(sNgayCham, " ", sGioRaKhaiBaoTinhTheoGioA);
                                                        dGioRaKhaiBaoTinhTheoGioB = Convert.ToDateTime(sGioRaKhaiBaoTinhTheoGioB);
                                                        sTruGioDiTre = dtCaLamViecTinhTheoGio.Rows[iCaLamViecTinhTheoGio]["TruGioDiTre"].ToString();
                                                        sBatDauTinhDiTre = dtCaLamViecTinhTheoGio.Rows[iCaLamViecTinhTheoGio]["BatDauTinhDiTre"].ToString();
                                                        iChoPhepDiTre = Convert.ToInt32(dtCaLamViecTinhTheoGio.Rows[iCaLamViecTinhTheoGio]["ChoPhepDiTre"].ToString());
                                                        value = dGioVaoTinhTheoGio - dGioVaoKhaiBaoTinhTheoGioB;
                                                        second = Convert.ToInt32(value.TotalMinutes);
                                                        sPhutTre = second.ToString();
                                                        if (!(sTruGioDiTre == "True"))
                                                        {
                                                            this.DGVTinhCong.Rows[_nhanVien].Cells[9].Value = "0";
                                                        }
                                                        else if (Convert.ToInt32(sPhutTre) >= 0)
                                                        {
                                                            iPhutTre = Convert.ToInt32(sPhutTre) - iChoPhepDiTre;
                                                            if (sBatDauTinhDiTre == "True")
                                                            {
                                                                if (iPhutTre >= 1)
                                                                {
                                                                    this.DGVTinhCong.Rows[_nhanVien].Cells[9].Value = iPhutTre.ToString();
                                                                }
                                                                else
                                                                {
                                                                    this.DGVTinhCong.Rows[_nhanVien].Cells[9].Value = "0";
                                                                }
                                                            }
                                                            else if (iPhutTre >= 1)
                                                            {
                                                                this.DGVTinhCong.Rows[_nhanVien].Cells[9].Value = sPhutTre;
                                                            }
                                                            else
                                                            {
                                                                this.DGVTinhCong.Rows[_nhanVien].Cells[9].Value = "0";
                                                            }
                                                        }
                                                        else
                                                        {
                                                            this.DGVTinhCong.Rows[_nhanVien].Cells[9].Value = "0";
                                                        }
                                                        sTruGioVeSom = dtCaLamViecTinhTheoGio.Rows[iCaLamViecTinhTheoGio]["TruGioVeSom"].ToString();
                                                        sBatDauTinhVeSom = dtCaLamViecTinhTheoGio.Rows[iCaLamViecTinhTheoGio]["BatDauTinhVeSom"].ToString();
                                                        iChoPhepVeSom = Convert.ToInt32(dtCaLamViecTinhTheoGio.Rows[iCaLamViecTinhTheoGio]["ChoPhepVeSom"].ToString());
                                                        value = dGioRaKhaiBaoTinhTheoGioB - dGioRaTinhTheoGio;
                                                        second = Convert.ToInt32(value.TotalMinutes);
                                                        sPhutVeSom = second.ToString();
                                                        if (!(sTruGioVeSom == "True"))
                                                        {
                                                            this.DGVTinhCong.Rows[_nhanVien].Cells[10].Value = "0";
                                                        }
                                                        else if (Convert.ToInt32(sPhutVeSom) >= 0)
                                                        {
                                                            iPhutVeSom = Convert.ToInt32(sPhutVeSom) - iChoPhepVeSom;
                                                            if (iPhutVeSom < 1)
                                                            {
                                                                this.DGVTinhCong.Rows[_nhanVien].Cells[10].Value = "0";
                                                            }
                                                            else if (!(sBatDauTinhVeSom == "True"))
                                                            {
                                                                this.DGVTinhCong.Rows[_nhanVien].Cells[10].Value = sPhutVeSom;
                                                            }
                                                            else
                                                            {
                                                                this.DGVTinhCong.Rows[_nhanVien].Cells[10].Value = iPhutVeSom.ToString();
                                                            }
                                                        }
                                                        else
                                                        {
                                                            this.DGVTinhCong.Rows[_nhanVien].Cells[10].Value = "0";
                                                        }
                                                        value = dGioRaTinhTheoGio - dGioRaKhaiBaoTinhTheoGioB;
                                                        second = Convert.ToInt32(value.TotalMinutes);
                                                        sVeTre = second.ToString();
                                                        if (Convert.ToInt32(sVeTre) <= 0)
                                                        {
                                                            this.DGVTinhCong.Rows[_nhanVien].Cells[11].Value = "0";
                                                        }
                                                        else
                                                        {
                                                            this.DGVTinhCong.Rows[_nhanVien].Cells[11].Value = sVeTre;
                                                        }
                                                        iPhut = Convert.ToSingle(dtCaLamViecTinhTheoGio.Rows[iCaLamViecTinhTheoGio]["TongGioTrongCaLamViec"]) * 60f - (float)(Convert.ToInt32(this.DGVTinhCong.Rows[_nhanVien].Cells[9].Value.ToString()) + Convert.ToInt32(this.DGVTinhCong.Rows[_nhanVien].Cells[10].Value));
                                                        dGio = Math.Round(Convert.ToDouble(iPhut) / 60, this.iLamTronGio);
                                                        this.DGVTinhCong.Rows[_nhanVien].Cells[8].Value = dGio.ToString();
                                                        iGio = Convert.ToDouble(dtCaLamViecTinhTheoGio.Rows[iCaLamViecTinhTheoGio]["TongGioTrongCaLamViec"].ToString());
                                                        dCongTinh = Convert.ToDouble(dtCaLamViecTinhTheoGio.Rows[iCaLamViecTinhTheoGio]["CongTinh"].ToString());
                                                        dCong = Math.Round(dGio * dCongTinh / iGio, this.iLamTronCong);
                                                        this.DGVTinhCong.Rows[_nhanVien].Cells[7].Value = dCong.ToString();
                                                        sTangCaTruocGioLamViec = dtCaLamViecTinhTheoGio.Rows[iCaLamViecTinhTheoGio]["TangCaTruocGioLamViec"].ToString();
                                                        sTangCaSauGioLamViec = dtCaLamViecTinhTheoGio.Rows[iCaLamViecTinhTheoGio]["TangCaSauGioLamViec"].ToString();
                                                        if ((sTangCaTruocGioLamViec != "False" ? false : sTangCaSauGioLamViec == "False"))
                                                        {
                                                            this.DGVTinhCong.Rows[_nhanVien].Cells[12].Value = "0";
                                                            this.DGVTinhCong.Rows[_nhanVien].Cells[13].Value = "0";
                                                            this.DGVTinhCong.Rows[_nhanVien].Cells[14].Value = "0";
                                                            this.DGVTinhCong.Rows[_nhanVien].Cells[15].Value = "0";
                                                        }
                                                        sXemCaNayLaTangCa = dtCaLamViecTinhTheoGio.Rows[iCaLamViecTinhTheoGio]["XemCaNayLaTangCa"].ToString();
                                                        iTangCaMuc = Convert.ToInt32(dtCaLamViecTinhTheoGio.Rows[iCaLamViecTinhTheoGio]["TangCaMuc"].ToString());
                                                        if (sXemCaNayLaTangCa == "True")
                                                        {
                                                            if (iTangCaMuc == 1)
                                                            {
                                                                this.DGVTinhCong.Rows[_nhanVien].Cells[7].Value = "0";
                                                                this.DGVTinhCong.Rows[_nhanVien].Cells[8].Value = "0";
                                                                this.DGVTinhCong.Rows[_nhanVien].Cells[12].Value = dGio.ToString();
                                                                this.DGVTinhCong.Rows[_nhanVien].Cells[13].Value = "0";
                                                                this.DGVTinhCong.Rows[_nhanVien].Cells[14].Value = "0";
                                                                this.DGVTinhCong.Rows[_nhanVien].Cells[15].Value = "0";
                                                            }
                                                            if (iTangCaMuc == 2)
                                                            {
                                                                this.DGVTinhCong.Rows[_nhanVien].Cells[7].Value = "0";
                                                                this.DGVTinhCong.Rows[_nhanVien].Cells[8].Value = "0";
                                                                this.DGVTinhCong.Rows[_nhanVien].Cells[12].Value = "0";
                                                                this.DGVTinhCong.Rows[_nhanVien].Cells[13].Value = dGio.ToString();
                                                                this.DGVTinhCong.Rows[_nhanVien].Cells[14].Value = "0";
                                                                this.DGVTinhCong.Rows[_nhanVien].Cells[15].Value = "0";
                                                            }
                                                            if (iTangCaMuc == 3)
                                                            {
                                                                this.DGVTinhCong.Rows[_nhanVien].Cells[7].Value = "0";
                                                                this.DGVTinhCong.Rows[_nhanVien].Cells[8].Value = "0";
                                                                this.DGVTinhCong.Rows[_nhanVien].Cells[12].Value = "0";
                                                                this.DGVTinhCong.Rows[_nhanVien].Cells[13].Value = "0";
                                                                this.DGVTinhCong.Rows[_nhanVien].Cells[14].Value = dGio.ToString();
                                                                this.DGVTinhCong.Rows[_nhanVien].Cells[15].Value = "0";
                                                            }
                                                            if (iTangCaMuc == 4)
                                                            {
                                                                this.DGVTinhCong.Rows[_nhanVien].Cells[7].Value = "0";
                                                                this.DGVTinhCong.Rows[_nhanVien].Cells[8].Value = "0";
                                                                this.DGVTinhCong.Rows[_nhanVien].Cells[12].Value = "0";
                                                                this.DGVTinhCong.Rows[_nhanVien].Cells[13].Value = "0";
                                                                this.DGVTinhCong.Rows[_nhanVien].Cells[14].Value = "0";
                                                                this.DGVTinhCong.Rows[_nhanVien].Cells[15].Value = dGio.ToString();
                                                            }
                                                        }
                                                        sChoPhepTangCaTruocGioLamViecTinhTheoGio = dtCaLamViecTinhTheoGio.Rows[iCaLamViecTinhTheoGio]["TangCaTruocGioLamViec"].ToString();
                                                        iPhutTangCaTruocGioLamViecTinhTheoGio = Convert.ToInt32(dtCaLamViecTinhTheoGio.Rows[iCaLamViecTinhTheoGio]["SoPhutTangCaTruocGioLamViec"].ToString());
                                                        iPhutTangCaTruocGioLamViecDatDen = Convert.ToInt32(dtCaLamViecTinhTheoGio.Rows[iCaLamViecTinhTheoGio]["TangCaTruocGioLamViecDatDen"].ToString());
                                                        iPhutTruTangCaTruoc = Convert.ToInt32(dtCaLamViecTinhTheoGio.Rows[iCaLamViecTinhTheoGio]["PhutTruTangCaTruoc"].ToString());
                                                        sChoPhepTangCaSauGioLamViecTinhTheoGio = dtCaLamViecTinhTheoGio.Rows[iCaLamViecTinhTheoGio]["TangCaSauGioLamViec"].ToString();
                                                        iPhutTangCaSauGioLamViecTinhTheoGio = Convert.ToInt32(dtCaLamViecTinhTheoGio.Rows[iCaLamViecTinhTheoGio]["SoPhutTangCaSauGioLamViec"].ToString());
                                                        iPhutTangCaSauGioLamViecDatDen = Convert.ToInt32(dtCaLamViecTinhTheoGio.Rows[iCaLamViecTinhTheoGio]["TangCaSauGioLamViecDatDen"].ToString());
                                                        iPhutTruTangCaSau = Convert.ToInt32(dtCaLamViecTinhTheoGio.Rows[iCaLamViecTinhTheoGio]["PhutTruTangCaSau"].ToString());
                                                        iGioiHanTC1TinhTheoGio = Convert.ToInt32(dtCaLamViecTinhTheoGio.Rows[iCaLamViecTinhTheoGio]["GioiHanTangCa1"].ToString());
                                                        iGioiHanTC2TinhTheoGio = Convert.ToInt32(dtCaLamViecTinhTheoGio.Rows[iCaLamViecTinhTheoGio]["GioiHanTangCa2"].ToString());
                                                        iGioiHanTC3TinhTheoGio = Convert.ToInt32(dtCaLamViecTinhTheoGio.Rows[iCaLamViecTinhTheoGio]["GioiHanTangCa3"].ToString());
                                                        iGioiHanTC4TinhTheoGio = Convert.ToInt32(dtCaLamViecTinhTheoGio.Rows[iCaLamViecTinhTheoGio]["GioiHanTangCa4"].ToString());
                                                        iTongGioTangCaSauTinhTheoGio = 0;
                                                        iTongGioTangCaTruocTinhTheoGio = 0;
                                                        if ((sChoPhepTangCaTruocGioLamViecTinhTheoGio != "False" ? true : !(sChoPhepTangCaSauGioLamViecTinhTheoGio == "False")))
                                                        {
                                                            if (sChoPhepTangCaTruocGioLamViecTinhTheoGio == "True")
                                                            {
                                                                value = dGioVaoKhaiBaoTinhTheoGioB - dGioVaoTinhTheoGio;
                                                                second = Convert.ToInt32(value.TotalMinutes);
                                                                iThoiGianTruocGioLamTinhTheoGio = Convert.ToInt32(second.ToString());
                                                                if (iThoiGianTruocGioLamTinhTheoGio > 0)
                                                                {
                                                                    if (iThoiGianTruocGioLamTinhTheoGio > iPhutTangCaTruocGioLamViecTinhTheoGio)
                                                                    {
                                                                        if (iThoiGianTruocGioLamTinhTheoGio > iPhutTangCaTruocGioLamViecDatDen)
                                                                        {
                                                                            iTongGioTangCaTruocTinhTheoGio = iThoiGianTruocGioLamTinhTheoGio - iPhutTruTangCaTruoc;
                                                                        }
                                                                    }
                                                                }
                                                            }
                                                            if (sChoPhepTangCaSauGioLamViecTinhTheoGio == "True")
                                                            {
                                                                value = dGioRaTinhTheoGio - dGioRaKhaiBaoTinhTheoGioB;
                                                                second = Convert.ToInt32(value.TotalMinutes);
                                                                iThoiGianSauGioLamViecTinhTheoGio = Convert.ToInt32(second.ToString());
                                                                if (iThoiGianSauGioLamViecTinhTheoGio > 0)
                                                                {
                                                                    if (iThoiGianSauGioLamViecTinhTheoGio > iPhutTangCaSauGioLamViecTinhTheoGio)
                                                                    {
                                                                        if (iThoiGianSauGioLamViecTinhTheoGio > iPhutTangCaSauGioLamViecDatDen)
                                                                        {
                                                                            iTongGioTangCaSauTinhTheoGio = iThoiGianSauGioLamViecTinhTheoGio - iPhutTruTangCaSau;
                                                                        }
                                                                    }
                                                                }
                                                            }
                                                        }
                                                        else
                                                        {
                                                            this.DGVTinhCong.Rows[_nhanVien].Cells[12].Value = "0";
                                                            this.DGVTinhCong.Rows[_nhanVien].Cells[13].Value = "0";
                                                            this.DGVTinhCong.Rows[_nhanVien].Cells[14].Value = "0";
                                                            this.DGVTinhCong.Rows[_nhanVien].Cells[15].Value = "0";
                                                        }
                                                        dTongThoiGianTangCaTinhTheoGio = Convert.ToDouble(iTongGioTangCaTruocTinhTheoGio + iTongGioTangCaSauTinhTheoGio);
                                                        if (dTongThoiGianTangCaTinhTheoGio <= 0)
                                                        {
                                                            this.DGVTinhCong.Rows[_nhanVien].Cells[12].Value = "0";
                                                            this.DGVTinhCong.Rows[_nhanVien].Cells[13].Value = "0";
                                                            this.DGVTinhCong.Rows[_nhanVien].Cells[14].Value = "0";
                                                            this.DGVTinhCong.Rows[_nhanVien].Cells[15].Value = "0";
                                                        }
                                                        else
                                                        {
                                                            if (iGioiHanTC1TinhTheoGio == 0)
                                                            {
                                                                this.DGVTinhCong.Rows[_nhanVien].Cells[12].Value = Math.Round(dTongThoiGianTangCaTinhTheoGio * this.dTangCa1HeSo / 60, this.iLamTronGio);
                                                                this.DGVTinhCong.Rows[_nhanVien].Cells[13].Value = "0";
                                                                this.DGVTinhCong.Rows[_nhanVien].Cells[14].Value = "0";
                                                                this.DGVTinhCong.Rows[_nhanVien].Cells[15].Value = "0";
                                                            }
                                                            if ((iGioiHanTC1TinhTheoGio == 0 ? false : iGioiHanTC2TinhTheoGio == 0))
                                                            {
                                                                if (dTongThoiGianTangCaTinhTheoGio >= Convert.ToDouble(iGioiHanTC1TinhTheoGio))
                                                                {
                                                                    this.DGVTinhCong.Rows[_nhanVien].Cells[12].Value = Math.Round(Convert.ToDouble(iGioiHanTC1TinhTheoGio) / 60 * this.dTangCa1HeSo, this.iLamTronGio);
                                                                    if (dTongThoiGianTangCaTinhTheoGio - Convert.ToDouble(iGioiHanTC1TinhTheoGio) > 0)
                                                                    {
                                                                        this.DGVTinhCong.Rows[_nhanVien].Cells[13].Value = Math.Round((dTongThoiGianTangCaTinhTheoGio - Convert.ToDouble(iGioiHanTC1TinhTheoGio)) * this.dTangCa2HeSo / 60, this.iLamTronGio);
                                                                    }
                                                                    this.DGVTinhCong.Rows[_nhanVien].Cells[14].Value = "0";
                                                                    this.DGVTinhCong.Rows[_nhanVien].Cells[15].Value = "0";
                                                                }
                                                                else
                                                                {
                                                                    this.DGVTinhCong.Rows[_nhanVien].Cells[12].Value = Math.Round(dTongThoiGianTangCaTinhTheoGio * this.dTangCa1HeSo / 60, this.iLamTronGio);
                                                                    this.DGVTinhCong.Rows[_nhanVien].Cells[13].Value = "0";
                                                                    this.DGVTinhCong.Rows[_nhanVien].Cells[14].Value = "0";
                                                                    this.DGVTinhCong.Rows[_nhanVien].Cells[15].Value = "0";
                                                                }
                                                            }
                                                            if ((iGioiHanTC1TinhTheoGio == 0 || iGioiHanTC2TinhTheoGio == 0 ? false : iGioiHanTC3TinhTheoGio == 0))
                                                            {
                                                                if (dTongThoiGianTangCaTinhTheoGio >= Convert.ToDouble(iGioiHanTC1TinhTheoGio))
                                                                {
                                                                    this.DGVTinhCong.Rows[_nhanVien].Cells[12].Value = Math.Round(Convert.ToDouble(iGioiHanTC1TinhTheoGio) * this.dTangCa1HeSo / 60, this.iLamTronGio);
                                                                    if (dTongThoiGianTangCaTinhTheoGio - Convert.ToDouble(iGioiHanTC1TinhTheoGio) >= Convert.ToDouble(iGioiHanTC2TinhTheoGio))
                                                                    {
                                                                        this.DGVTinhCong.Rows[_nhanVien].Cells[12].Value = Math.Round(Convert.ToDouble(iGioiHanTC1TinhTheoGio) * this.dTangCa1HeSo / 60, this.iLamTronGio);
                                                                        this.DGVTinhCong.Rows[_nhanVien].Cells[13].Value = Math.Round(Convert.ToDouble(iGioiHanTC2TinhTheoGio) * this.dTangCa2HeSo / 60, this.iLamTronGio);
                                                                        this.DGVTinhCong.Rows[_nhanVien].Cells[14].Value = Math.Round((dTongThoiGianTangCaTinhTheoGio - Convert.ToDouble(iGioiHanTC1TinhTheoGio) - Convert.ToDouble(iGioiHanTC2TinhTheoGio)) * this.dTangCa3HeSo / 60, this.iLamTronGio);
                                                                        this.DGVTinhCong.Rows[_nhanVien].Cells[15].Value = "0";
                                                                    }
                                                                    else
                                                                    {
                                                                        this.DGVTinhCong.Rows[_nhanVien].Cells[13].Value = Math.Round((dTongThoiGianTangCaTinhTheoGio - Convert.ToDouble(iGioiHanTC1TinhTheoGio)) * this.dTangCa2HeSo / 60, this.iLamTronGio);
                                                                        this.DGVTinhCong.Rows[_nhanVien].Cells[14].Value = "0";
                                                                        this.DGVTinhCong.Rows[_nhanVien].Cells[15].Value = "0";
                                                                    }
                                                                }
                                                                else
                                                                {
                                                                    this.DGVTinhCong.Rows[_nhanVien].Cells[12].Value = Math.Round(dTongThoiGianTangCaTinhTheoGio * this.dTangCa1HeSo / 60, this.iLamTronGio);
                                                                    this.DGVTinhCong.Rows[_nhanVien].Cells[13].Value = "0";
                                                                    this.DGVTinhCong.Rows[_nhanVien].Cells[14].Value = "0";
                                                                    this.DGVTinhCong.Rows[_nhanVien].Cells[15].Value = "0";
                                                                }
                                                            }
                                                            if ((iGioiHanTC1TinhTheoGio == 0 || iGioiHanTC2TinhTheoGio == 0 || iGioiHanTC3TinhTheoGio == 0 ? false : iGioiHanTC4TinhTheoGio == 0))
                                                            {
                                                            }
                                                        }
                                                        value = dGioRaTinhTheoGio - dGioVaoTinhTheoGio;
                                                        second = Convert.ToInt32(value.TotalMinutes);
                                                        num = Math.Round(Convert.ToDouble(second.ToString()) / 60, this.iLamTronGio);
                                                        sTongGio = num.ToString();
                                                        this.DGVTinhCong.Rows[_nhanVien].Cells[16].Value = sTongGio;
                                                        this.DGVTinhCong.Rows[_nhanVien].Cells[17].Value = dtCaLamViecTinhTheoGio.Rows[iCaLamViecTinhTheoGio]["CongTinh"].ToString();
                                                        this.DGVTinhCong.Rows[_nhanVien].Cells[18].Value = this.sKHDungGio;
                                                        if (!(DateTimeProgress.XuatIDThu((int)dt.AddDays((double)dem).DayOfWeek) == "0"))
                                                        {
                                                            this.DGVTinhCong.Rows[_nhanVien].Cells[19].Value = "NT";
                                                        }
                                                        else
                                                        {
                                                            this.DGVTinhCong.Rows[_nhanVien].Cells[19].Value = "CN";
                                                        }
                                                        this.DGVTinhCong.Rows[_nhanVien].Cells[20].Value = this.sMaChamCong;
                                                        this.DGVTinhCong.Rows[_nhanVien].Cells[21].Value = this.sPhongBanTinhCong;
                                                    }
                                                }
                                            Label44:
                                                if (iCaTrongLIchtrinh == 0)
                                                {
                                                    this.DGVTinhCong.Rows[_nhanVien].Cells[4].Value = "***";
                                                    this.DGVTinhCong.Rows[_nhanVien].Cells[7].Value = "0";
                                                    this.DGVTinhCong.Rows[_nhanVien].Cells[8].Value = "0";
                                                    this.DGVTinhCong.Rows[_nhanVien].Cells[9].Value = "0";
                                                    this.DGVTinhCong.Rows[_nhanVien].Cells[10].Value = "0";
                                                    this.DGVTinhCong.Rows[_nhanVien].Cells[11].Value = "0";
                                                    this.DGVTinhCong.Rows[_nhanVien].Cells[12].Value = "0";
                                                    this.DGVTinhCong.Rows[_nhanVien].Cells[13].Value = "0";
                                                    this.DGVTinhCong.Rows[_nhanVien].Cells[14].Value = "0";
                                                    this.DGVTinhCong.Rows[_nhanVien].Cells[15].Value = "0";
                                                    this.DGVTinhCong.Rows[_nhanVien].Cells[16].Value = "0";
                                                    this.DGVTinhCong.Rows[_nhanVien].Cells[17].Value = "0";
                                                    this.DGVTinhCong.Rows[_nhanVien].Cells[18].Value = this.sKHVang;
                                                    if (!(DateTimeProgress.XuatIDThu((int)dt.AddDays((double)dem).DayOfWeek) == "0"))
                                                    {
                                                        this.DGVTinhCong.Rows[_nhanVien].Cells[19].Value = "NT";
                                                    }
                                                    else
                                                    {
                                                        this.DGVTinhCong.Rows[_nhanVien].Cells[19].Value = "CN";
                                                    }
                                                    this.DGVTinhCong.Rows[_nhanVien].Cells[20].Value = this.sMaChamCong;
                                                    this.DGVTinhCong.Rows[_nhanVien].Cells[21].Value = this.sPhongBanTinhCong;
                                                }
                                            }
                                            else
                                            {
                                                addTinhTheoGioThoiGianLonNhat = this.DGVTinhCong.Rows.Add();
                                                this.DGVTinhCong.Rows[addTinhTheoGioThoiGianLonNhat].Cells[0].Value = this.sMaNhanVien;
                                                this.DGVTinhCong.Rows[addTinhTheoGioThoiGianLonNhat].Cells[1].Value = this.sTenNhanVien;
                                                this.DGVTinhCong.Rows[addTinhTheoGioThoiGianLonNhat].Cells[2].Value = this.DGVTinhCong.Rows[_nhanVien].Cells[2].Value.ToString();
                                                if (this.iNgonNgu == 0)
                                                {
                                                    DataGridViewCell item18 = this.DGVTinhCong.Rows[addTinhTheoGioThoiGianLonNhat].Cells[3];
                                                    dateTime = dt.AddDays((double)dem);
                                                    item18.Value = DateTimeProgress.XuatThuTinhCong((int)dateTime.DayOfWeek);
                                                }
                                                if (this.iNgonNgu == 1)
                                                {
                                                    DataGridViewCell dataGridViewCell18 = this.DGVTinhCong.Rows[addTinhTheoGioThoiGianLonNhat].Cells[3];
                                                    dateTime = dt.AddDays((double)dem);
                                                    dataGridViewCell18.Value = DateTimeProgress.XuatThuEnglish((int)dateTime.DayOfWeek);
                                                }
                                                this.DGVTinhCong.Rows[addTinhTheoGioThoiGianLonNhat].Cells[4].Value = "***";
                                                this.DGVTinhCong.Rows[addTinhTheoGioThoiGianLonNhat].Cells[6].Value = string.Format(this.sDinhDangThoiGian, dGioRaTinhTheoGio);
                                                this.DGVTinhCong.Rows[addTinhTheoGioThoiGianLonNhat].Cells[7].Value = "0";
                                                this.DGVTinhCong.Rows[addTinhTheoGioThoiGianLonNhat].Cells[8].Value = "0";
                                                this.DGVTinhCong.Rows[addTinhTheoGioThoiGianLonNhat].Cells[9].Value = "0";
                                                this.DGVTinhCong.Rows[addTinhTheoGioThoiGianLonNhat].Cells[10].Value = "0";
                                                this.DGVTinhCong.Rows[addTinhTheoGioThoiGianLonNhat].Cells[11].Value = "0";
                                                this.DGVTinhCong.Rows[addTinhTheoGioThoiGianLonNhat].Cells[12].Value = "0";
                                                this.DGVTinhCong.Rows[addTinhTheoGioThoiGianLonNhat].Cells[13].Value = "0";
                                                this.DGVTinhCong.Rows[addTinhTheoGioThoiGianLonNhat].Cells[14].Value = "0";
                                                this.DGVTinhCong.Rows[addTinhTheoGioThoiGianLonNhat].Cells[15].Value = "0";
                                                this.DGVTinhCong.Rows[addTinhTheoGioThoiGianLonNhat].Cells[16].Value = "0";
                                                this.DGVTinhCong.Rows[addTinhTheoGioThoiGianLonNhat].Cells[17].Value = "0";
                                                this.DGVTinhCong.Rows[addTinhTheoGioThoiGianLonNhat].Cells[18].Value = this.sKHVang;
                                                if (!(DateTimeProgress.XuatIDThu((int)dt.AddDays((double)dem).DayOfWeek) == "0"))
                                                {
                                                    this.DGVTinhCong.Rows[addTinhTheoGioThoiGianLonNhat].Cells[19].Value = "NT";
                                                }
                                                else
                                                {
                                                    this.DGVTinhCong.Rows[addTinhTheoGioThoiGianLonNhat].Cells[19].Value = "CN";
                                                }
                                                this.DGVTinhCong.Rows[addTinhTheoGioThoiGianLonNhat].Cells[20].Value = this.sMaChamCong;
                                                this.DGVTinhCong.Rows[addTinhTheoGioThoiGianLonNhat].Cells[21].Value = this.sPhongBanTinhCong;
                                            }
                                        }
                                        if (iDemLanChamCongTinhTheoGio > 2)
                                        {
                                            if (iDemLanChamCongTinhTheoGio % 2 != 0)
                                            {
                                                addTinhTheoGio = this.DGVTinhCong.Rows.Add();
                                                dGioVaoTinhTheoGio = Convert.ToDateTime(dtTinhTheoGio.Rows[iTinhTheoGio]["GioCham"].ToString());
                                                this.DGVTinhCong.Rows[addTinhTheoGio].Cells[5].Value = string.Format(this.sDinhDangThoiGian, dGioVaoTinhTheoGio);
                                                this.DGVTinhCong.Rows[addTinhTheoGio].Cells[0].Value = this.sMaNhanVien;
                                                this.DGVTinhCong.Rows[addTinhTheoGio].Cells[1].Value = this.sTenNhanVien;
                                                this.DGVTinhCong.Rows[addTinhTheoGio].Cells[2].Value = this.DGVTinhCong.Rows[_nhanVien].Cells[2].Value.ToString();
                                                if (this.iNgonNgu == 0)
                                                {
                                                    DataGridViewCell item19 = this.DGVTinhCong.Rows[addTinhTheoGio].Cells[3];
                                                    dateTime = dt.AddDays((double)dem);
                                                    item19.Value = DateTimeProgress.XuatThuTinhCong((int)dateTime.DayOfWeek);
                                                }
                                                if (this.iNgonNgu == 1)
                                                {
                                                    DataGridViewCell dataGridViewCell19 = this.DGVTinhCong.Rows[addTinhTheoGio].Cells[3];
                                                    dateTime = dt.AddDays((double)dem);
                                                    dataGridViewCell19.Value = DateTimeProgress.XuatThuEnglish((int)dateTime.DayOfWeek);
                                                }
                                                this.DGVTinhCong.Rows[addTinhTheoGio].Cells[4].Value = "***";
                                                this.DGVTinhCong.Rows[addTinhTheoGio].Cells[7].Value = "0";
                                                this.DGVTinhCong.Rows[addTinhTheoGio].Cells[8].Value = "0";
                                                this.DGVTinhCong.Rows[addTinhTheoGio].Cells[9].Value = "0";
                                                this.DGVTinhCong.Rows[addTinhTheoGio].Cells[10].Value = "0";
                                                this.DGVTinhCong.Rows[addTinhTheoGio].Cells[11].Value = "0";
                                                this.DGVTinhCong.Rows[addTinhTheoGio].Cells[12].Value = "0";
                                                this.DGVTinhCong.Rows[addTinhTheoGio].Cells[13].Value = "0";
                                                this.DGVTinhCong.Rows[addTinhTheoGio].Cells[14].Value = "0";
                                                this.DGVTinhCong.Rows[addTinhTheoGio].Cells[15].Value = "0";
                                                this.DGVTinhCong.Rows[addTinhTheoGio].Cells[16].Value = "0";
                                                this.DGVTinhCong.Rows[addTinhTheoGio].Cells[17].Value = "0";
                                                this.DGVTinhCong.Rows[addTinhTheoGio].Cells[18].Value = this.sKHVang;
                                                if (!(DateTimeProgress.XuatIDThu((int)dt.AddDays((double)dem).DayOfWeek) == "0"))
                                                {
                                                    this.DGVTinhCong.Rows[addTinhTheoGio].Cells[19].Value = "NT";
                                                }
                                                else
                                                {
                                                    this.DGVTinhCong.Rows[addTinhTheoGio].Cells[19].Value = "CN";
                                                }
                                                this.DGVTinhCong.Rows[addTinhTheoGio].Cells[20].Value = this.sMaChamCong;
                                                this.DGVTinhCong.Rows[addTinhTheoGio].Cells[21].Value = this.sPhongBanTinhCong;
                                            }
                                            if (iDemLanChamCongTinhTheoGio % 2 == 0)
                                            {
                                                dGioRaTinhTheoGio = Convert.ToDateTime(dtTinhTheoGio.Rows[iTinhTheoGio]["GioCham"].ToString());
                                                if (Convert.ToInt32(Convert.ToInt32((dGioRaTinhTheoGioLichTrinhVaoRa - dGioVaoTinhTheoGioLichTrinhVaoRa).TotalMinutes).ToString()) <= iThoiGianLonNhat)
                                                {
                                                    this.DGVTinhCong.Rows[addTinhTheoGio].Cells[6].Value = string.Format(this.sDinhDangThoiGian, dGioRaTinhTheoGio);
                                                    iCaTrongLIchtrinh = 0;
                                                    dtNhanCaTinhTheoGio = new System.Data.DataTable();
                                                    this._chiTietLichTrinhChoCalamViecDTO.MaLichTrinhCaLamViec = sLTCCLVNhanVien;
                                                    this._chiTietLichTrinhChoCalamViecDTO.Thu = sThu;
                                                    dtNhanCaTinhTheoGio = this._chiTietLichTrinhChoCaLamViecBLL.ChiTietLichTrinhChoCaLamViecNhanCa(this._chiTietLichTrinhChoCalamViecDTO);
                                                    iChiTietLichTrinhChoCaLamViecTinhTheoGio = 0;
                                                    if (iChiTietLichTrinhChoCaLamViecTinhTheoGio < dtNhanCaTinhTheoGio.Rows.Count)
                                                    {
                                                        iCaTrongLIchtrinh = 1;
                                                        cellChiTietLichTrinhChoCaLamViecTinhTheoGio = 3;
                                                        while (cellChiTietLichTrinhChoCaLamViecTinhTheoGio < 13)
                                                        {
                                                            kiemTraVao = 0;
                                                            kiemTraRa = 0;
                                                            this.sTinhTheoGioMaCaLamViec = dtNhanCaTinhTheoGio.Rows[iChiTietLichTrinhChoCaLamViecTinhTheoGio][cellChiTietLichTrinhChoCaLamViecTinhTheoGio].ToString();
                                                            dtTinhTheoGioCa1 = new System.Data.DataTable();
                                                            this._caLamViecDTO.MaCaLamViec = this.sTinhTheoGioMaCaLamViec;
                                                            dtTinhTheoGioCa1 = this._caLamViecBLL.CaLamViecGetByMaCaLamViec(this._caLamViecDTO);
                                                            iTinhTheoGioCa1 = 0;
                                                            while (iTinhTheoGioCa1 < dtTinhTheoGioCa1.Rows.Count)
                                                            {
                                                                second = dGioVaoTinhTheoGio.Second;
                                                                sGiayGioVao = second.ToString();
                                                                second = dGioRaTinhTheoGio.Second;
                                                                sGiayGioRa = second.ToString();
                                                                this.sTinhTheoGioTenCaLamViec = dtTinhTheoGioCa1.Rows[iTinhTheoGioCa1]["CaLamViec"].ToString();
                                                                dBatDauVaoTinhTheoGioA = Convert.ToDateTime(dtTinhTheoGioCa1.Rows[iTinhTheoGioCa1]["BatDauVao"].ToString());
                                                                sBatDauVaoTinhTheoGioA = string.Format("{0:T}", dBatDauVaoTinhTheoGioA).Replace("00 ", string.Concat(sGiayGioVao, " "));
                                                                sBatDauVaoTinhTheoGioB = string.Concat(sNgayCham, " ", sBatDauVaoTinhTheoGioA);
                                                                dBatDauVaoTinhTheoGioB = Convert.ToDateTime(sBatDauVaoTinhTheoGioB);
                                                                dKetThucVaoTinhTheoGioA = Convert.ToDateTime(dtTinhTheoGioCa1.Rows[iTinhTheoGioCa1]["KetThucVao"].ToString());
                                                                sKetThucVaoTinhTheoGioA = string.Format("{0:T}", dKetThucVaoTinhTheoGioA).Replace("00 ", string.Concat(sGiayGioVao, " "));
                                                                sKetThucVaoTinhTheoGioB = string.Concat(sNgayCham, " ", sKetThucVaoTinhTheoGioA);
                                                                dKetThucVaoTinhTheoGioB = Convert.ToDateTime(sKetThucVaoTinhTheoGioB);
                                                                dBatDauRaTinhTheoGioA = Convert.ToDateTime(dtTinhTheoGioCa1.Rows[iTinhTheoGioCa1]["BatDauRa"].ToString());
                                                                sBatDauRaTinhTheoGioA = string.Format("{0:T}", dBatDauRaTinhTheoGioA).Replace("00 ", string.Concat(sGiayGioRa, " "));
                                                                sBatDauRaTinhTheoGioB = string.Concat(sNgayCham, " ", sBatDauRaTinhTheoGioA);
                                                                dBatDauRaTinhTheoGioB = Convert.ToDateTime(sBatDauRaTinhTheoGioB);
                                                                dKetThucRaTinhTheoGioA = Convert.ToDateTime(dtTinhTheoGioCa1.Rows[iTinhTheoGioCa1]["KetThucRa"].ToString());
                                                                sKetThucRaTinhTheoGioA = string.Format("{0:T}", dKetThucRaTinhTheoGioA).Replace("00 ", string.Concat(sGiayGioRa, " "));
                                                                sKetThucRaTinhTheoGioB = string.Concat(sNgayCham, " ", sKetThucRaTinhTheoGioA);
                                                                dKetThucRaTinhTheoGioB = Convert.ToDateTime(sKetThucRaTinhTheoGioB);
                                                                if ((dGioVaoTinhTheoGio < dBatDauVaoTinhTheoGioB ? false : dGioVaoTinhTheoGio <= dKetThucRaTinhTheoGioB))
                                                                {
                                                                    kiemTraVao++;
                                                                }
                                                                if ((dGioRaTinhTheoGio < dBatDauVaoTinhTheoGioB ? false : dGioRaTinhTheoGio <= dKetThucRaTinhTheoGioB))
                                                                {
                                                                    kiemTraRa++;
                                                                }
                                                                if ((kiemTraVao != 1 ? true : kiemTraRa != 1))
                                                                {
                                                                    iTinhTheoGioCa1++;
                                                                }
                                                                else
                                                                {
                                                                    goto Label47;
                                                                }
                                                            }
                                                            if (!(this.sTinhTheoGioMaCaLamViec == ""))
                                                            {
                                                                cellChiTietLichTrinhChoCaLamViecTinhTheoGio++;
                                                            }
                                                            else
                                                            {
                                                                this.DGVTinhCong.Rows[addTinhTheoGio].Cells[4].Value = "***";
                                                                this.DGVTinhCong.Rows[addTinhTheoGio].Cells[7].Value = "0";
                                                                this.DGVTinhCong.Rows[addTinhTheoGio].Cells[8].Value = "0";
                                                                this.DGVTinhCong.Rows[addTinhTheoGio].Cells[9].Value = "0";
                                                                this.DGVTinhCong.Rows[addTinhTheoGio].Cells[10].Value = "0";
                                                                this.DGVTinhCong.Rows[addTinhTheoGio].Cells[11].Value = "0";
                                                                this.DGVTinhCong.Rows[addTinhTheoGio].Cells[12].Value = "0";
                                                                this.DGVTinhCong.Rows[addTinhTheoGio].Cells[13].Value = "0";
                                                                this.DGVTinhCong.Rows[addTinhTheoGio].Cells[14].Value = "0";
                                                                this.DGVTinhCong.Rows[addTinhTheoGio].Cells[15].Value = "0";
                                                                this.DGVTinhCong.Rows[addTinhTheoGio].Cells[16].Value = "0";
                                                                this.DGVTinhCong.Rows[addTinhTheoGio].Cells[17].Value = "0";
                                                                this.DGVTinhCong.Rows[addTinhTheoGio].Cells[18].Value = this.sKHVang;
                                                                if (!(DateTimeProgress.XuatIDThu((int)dt.AddDays((double)dem).DayOfWeek) == "0"))
                                                                {
                                                                    this.DGVTinhCong.Rows[addTinhTheoGio].Cells[19].Value = "NT";
                                                                }
                                                                else
                                                                {
                                                                    this.DGVTinhCong.Rows[addTinhTheoGio].Cells[19].Value = "CN";
                                                                }
                                                                this.DGVTinhCong.Rows[addTinhTheoGio].Cells[20].Value = this.sMaChamCong;
                                                                this.DGVTinhCong.Rows[addTinhTheoGio].Cells[21].Value = this.sPhongBanTinhCong;
                                                                goto Label46;
                                                            }
                                                        }
                                                    Label47:
                                                        this.DGVTinhCong.Rows[addTinhTheoGio].Cells[4].Value = this.sTinhTheoGioTenCaLamViec;
                                                        dtCaLamViecTinhTheoGio = new System.Data.DataTable();
                                                        this._caLamViecDTO.MaCaLamViec = this.sTinhTheoGioMaCaLamViec;
                                                        dtCaLamViecTinhTheoGio = this._caLamViecBLL.CaLamViecGetByMaCaLamViec(this._caLamViecDTO);
                                                        for (iCaLamViecTinhTheoGio = 0; iCaLamViecTinhTheoGio < dtCaLamViecTinhTheoGio.Rows.Count; iCaLamViecTinhTheoGio++)
                                                        {
                                                            second = dGioVaoTinhTheoGio.Second;
                                                            sGiayGioVao = second.ToString();
                                                            second = dGioRaTinhTheoGio.Second;
                                                            sGiayGioRa = second.ToString();
                                                            dGioVaoKhaiBaoTinhTheoGioA = Convert.ToDateTime(dtCaLamViecTinhTheoGio.Rows[iCaLamViecTinhTheoGio]["GioVaoLamViec"].ToString());
                                                            sGioVaoKhaiBaoTinhTheoGioA = string.Format("{0:T}", dGioVaoKhaiBaoTinhTheoGioA).Replace("00 ", string.Concat(sGiayGioVao, " "));
                                                            sGioVaoKhaiBaoTinhTheoGioB = string.Concat(sNgayCham, " ", sGioVaoKhaiBaoTinhTheoGioA);
                                                            dGioVaoKhaiBaoTinhTheoGioB = Convert.ToDateTime(sGioVaoKhaiBaoTinhTheoGioB);
                                                            dGioRaKhaiBaoTinhTheoGioA = Convert.ToDateTime(dtCaLamViecTinhTheoGio.Rows[iCaLamViecTinhTheoGio]["GioKetThucLamViec"].ToString());
                                                            sGioRaKhaiBaoTinhTheoGioA = string.Format("{0:T}", dGioRaKhaiBaoTinhTheoGioA).Replace("00 ", string.Concat(sGiayGioRa, " "));
                                                            sGioRaKhaiBaoTinhTheoGioB = string.Concat(sNgayCham, " ", sGioRaKhaiBaoTinhTheoGioA);
                                                            dGioRaKhaiBaoTinhTheoGioB = Convert.ToDateTime(sGioRaKhaiBaoTinhTheoGioB);
                                                            sTruGioDiTre = dtCaLamViecTinhTheoGio.Rows[iCaLamViecTinhTheoGio]["TruGioDiTre"].ToString();
                                                            sBatDauTinhDiTre = dtCaLamViecTinhTheoGio.Rows[iCaLamViecTinhTheoGio]["BatDauTinhDiTre"].ToString();
                                                            iChoPhepDiTre = Convert.ToInt32(dtCaLamViecTinhTheoGio.Rows[iCaLamViecTinhTheoGio]["ChoPhepDiTre"].ToString());
                                                            value = dGioVaoTinhTheoGio - dGioVaoKhaiBaoTinhTheoGioB;
                                                            second = Convert.ToInt32(value.TotalMinutes);
                                                            sPhutTre = second.ToString();
                                                            if (!(sTruGioDiTre == "True"))
                                                            {
                                                                this.DGVTinhCong.Rows[addTinhTheoGio].Cells[9].Value = "0";
                                                            }
                                                            else if (Convert.ToInt32(sPhutTre) >= 0)
                                                            {
                                                                iPhutTre = Convert.ToInt32(sPhutTre) - iChoPhepDiTre;
                                                                if (sBatDauTinhDiTre == "True")
                                                                {
                                                                    if (iPhutTre >= 1)
                                                                    {
                                                                        this.DGVTinhCong.Rows[addTinhTheoGio].Cells[9].Value = iPhutTre.ToString();
                                                                    }
                                                                    else
                                                                    {
                                                                        this.DGVTinhCong.Rows[addTinhTheoGio].Cells[9].Value = "0";
                                                                    }
                                                                }
                                                                else if (iPhutTre >= 1)
                                                                {
                                                                    this.DGVTinhCong.Rows[addTinhTheoGio].Cells[9].Value = sPhutTre;
                                                                }
                                                                else
                                                                {
                                                                    this.DGVTinhCong.Rows[addTinhTheoGio].Cells[9].Value = "0";
                                                                }
                                                            }
                                                            else
                                                            {
                                                                this.DGVTinhCong.Rows[addTinhTheoGio].Cells[9].Value = "0";
                                                            }
                                                            sTruGioVeSom = dtCaLamViecTinhTheoGio.Rows[iCaLamViecTinhTheoGio]["TruGioVeSom"].ToString();
                                                            sBatDauTinhVeSom = dtCaLamViecTinhTheoGio.Rows[iCaLamViecTinhTheoGio]["BatDauTinhVeSom"].ToString();
                                                            iChoPhepVeSom = Convert.ToInt32(dtCaLamViecTinhTheoGio.Rows[iCaLamViecTinhTheoGio]["ChoPhepVeSom"].ToString());
                                                            value = dGioRaKhaiBaoTinhTheoGioB - dGioRaTinhTheoGio;
                                                            second = Convert.ToInt32(value.TotalMinutes);
                                                            sPhutVeSom = second.ToString();
                                                            if (!(sTruGioVeSom == "True"))
                                                            {
                                                                this.DGVTinhCong.Rows[addTinhTheoGio].Cells[10].Value = "0";
                                                            }
                                                            else if (Convert.ToInt32(sPhutVeSom) >= 0)
                                                            {
                                                                iPhutVeSom = Convert.ToInt32(sPhutVeSom) - iChoPhepVeSom;
                                                                if (iPhutVeSom < 1)
                                                                {
                                                                    this.DGVTinhCong.Rows[addTinhTheoGio].Cells[10].Value = "0";
                                                                }
                                                                else if (!(sBatDauTinhVeSom == "True"))
                                                                {
                                                                    this.DGVTinhCong.Rows[addTinhTheoGio].Cells[10].Value = sPhutVeSom;
                                                                }
                                                                else
                                                                {
                                                                    this.DGVTinhCong.Rows[addTinhTheoGio].Cells[10].Value = iPhutVeSom.ToString();
                                                                }
                                                            }
                                                            else
                                                            {
                                                                this.DGVTinhCong.Rows[addTinhTheoGio].Cells[10].Value = "0";
                                                            }
                                                            value = dGioRaTinhTheoGio - dGioRaKhaiBaoTinhTheoGioB;
                                                            second = Convert.ToInt32(value.TotalMinutes);
                                                            sVeTre = second.ToString();
                                                            if (Convert.ToInt32(sVeTre) <= 0)
                                                            {
                                                                this.DGVTinhCong.Rows[addTinhTheoGio].Cells[11].Value = "0";
                                                            }
                                                            else
                                                            {
                                                                this.DGVTinhCong.Rows[addTinhTheoGio].Cells[11].Value = sVeTre;
                                                            }
                                                            iPhut = Convert.ToSingle(dtCaLamViecTinhTheoGio.Rows[iCaLamViecTinhTheoGio]["TongGioTrongCaLamViec"]) * 60f - (float)(Convert.ToInt32(this.DGVTinhCong.Rows[addTinhTheoGio].Cells[9].Value.ToString()) + Convert.ToInt32(this.DGVTinhCong.Rows[addTinhTheoGio].Cells[10].Value));
                                                            dGio = Math.Round(Convert.ToDouble(iPhut) / 60, this.iLamTronGio);
                                                            this.DGVTinhCong.Rows[addTinhTheoGio].Cells[8].Value = dGio.ToString();
                                                            iGio = Convert.ToDouble(dtCaLamViecTinhTheoGio.Rows[iCaLamViecTinhTheoGio]["TongGioTrongCaLamViec"].ToString());
                                                            dCongTinh = Convert.ToDouble(dtCaLamViecTinhTheoGio.Rows[iCaLamViecTinhTheoGio]["CongTinh"].ToString());
                                                            dCong = Math.Round(dGio * dCongTinh / iGio, this.iLamTronCong);
                                                            this.DGVTinhCong.Rows[addTinhTheoGio].Cells[7].Value = dCong.ToString();
                                                            sTangCaTruocGioLamViec = dtCaLamViecTinhTheoGio.Rows[iCaLamViecTinhTheoGio]["TangCaTruocGioLamViec"].ToString();
                                                            sTangCaSauGioLamViec = dtCaLamViecTinhTheoGio.Rows[iCaLamViecTinhTheoGio]["TangCaSauGioLamViec"].ToString();
                                                            if ((sTangCaTruocGioLamViec != "False" ? false : sTangCaSauGioLamViec == "False"))
                                                            {
                                                                this.DGVTinhCong.Rows[addTinhTheoGio].Cells[12].Value = "0";
                                                                this.DGVTinhCong.Rows[addTinhTheoGio].Cells[13].Value = "0";
                                                                this.DGVTinhCong.Rows[addTinhTheoGio].Cells[14].Value = "0";
                                                                this.DGVTinhCong.Rows[addTinhTheoGio].Cells[15].Value = "0";
                                                            }
                                                            sXemCaNayLaTangCa = dtCaLamViecTinhTheoGio.Rows[iCaLamViecTinhTheoGio]["XemCaNayLaTangCa"].ToString();
                                                            iTangCaMuc = Convert.ToInt32(dtCaLamViecTinhTheoGio.Rows[iCaLamViecTinhTheoGio]["TangCaMuc"].ToString());
                                                            if (sXemCaNayLaTangCa == "True")
                                                            {
                                                                if (iTangCaMuc == 1)
                                                                {
                                                                    this.DGVTinhCong.Rows[addTinhTheoGio].Cells[7].Value = "0";
                                                                    this.DGVTinhCong.Rows[addTinhTheoGio].Cells[8].Value = "0";
                                                                    this.DGVTinhCong.Rows[addTinhTheoGio].Cells[12].Value = dGio.ToString();
                                                                    this.DGVTinhCong.Rows[addTinhTheoGio].Cells[13].Value = "0";
                                                                    this.DGVTinhCong.Rows[addTinhTheoGio].Cells[14].Value = "0";
                                                                    this.DGVTinhCong.Rows[addTinhTheoGio].Cells[15].Value = "0";
                                                                }
                                                                if (iTangCaMuc == 2)
                                                                {
                                                                    this.DGVTinhCong.Rows[addTinhTheoGio].Cells[7].Value = "0";
                                                                    this.DGVTinhCong.Rows[addTinhTheoGio].Cells[8].Value = "0";
                                                                    this.DGVTinhCong.Rows[addTinhTheoGio].Cells[12].Value = "0";
                                                                    this.DGVTinhCong.Rows[addTinhTheoGio].Cells[13].Value = dGio.ToString();
                                                                    this.DGVTinhCong.Rows[addTinhTheoGio].Cells[14].Value = "0";
                                                                    this.DGVTinhCong.Rows[addTinhTheoGio].Cells[15].Value = "0";
                                                                }
                                                                if (iTangCaMuc == 3)
                                                                {
                                                                    this.DGVTinhCong.Rows[addTinhTheoGio].Cells[7].Value = "0";
                                                                    this.DGVTinhCong.Rows[addTinhTheoGio].Cells[8].Value = "0";
                                                                    this.DGVTinhCong.Rows[addTinhTheoGio].Cells[12].Value = "0";
                                                                    this.DGVTinhCong.Rows[addTinhTheoGio].Cells[13].Value = "0";
                                                                    this.DGVTinhCong.Rows[addTinhTheoGio].Cells[14].Value = dGio.ToString();
                                                                    this.DGVTinhCong.Rows[addTinhTheoGio].Cells[15].Value = "0";
                                                                }
                                                                if (iTangCaMuc == 4)
                                                                {
                                                                    this.DGVTinhCong.Rows[addTinhTheoGio].Cells[7].Value = "0";
                                                                    this.DGVTinhCong.Rows[addTinhTheoGio].Cells[8].Value = "0";
                                                                    this.DGVTinhCong.Rows[addTinhTheoGio].Cells[12].Value = "0";
                                                                    this.DGVTinhCong.Rows[addTinhTheoGio].Cells[13].Value = "0";
                                                                    this.DGVTinhCong.Rows[addTinhTheoGio].Cells[14].Value = "0";
                                                                    this.DGVTinhCong.Rows[addTinhTheoGio].Cells[15].Value = dGio.ToString();
                                                                }
                                                            }
                                                            sChoPhepTangCaTruocGioLamViecTinhTheoGio = dtCaLamViecTinhTheoGio.Rows[iCaLamViecTinhTheoGio]["TangCaTruocGioLamViec"].ToString();
                                                            iPhutTangCaTruocGioLamViecTinhTheoGio = Convert.ToInt32(dtCaLamViecTinhTheoGio.Rows[iCaLamViecTinhTheoGio]["SoPhutTangCaTruocGioLamViec"].ToString());
                                                            iPhutTangCaTruocGioLamViecDatDen = Convert.ToInt32(dtCaLamViecTinhTheoGio.Rows[iCaLamViecTinhTheoGio]["TangCaTruocGioLamViecDatDen"].ToString());
                                                            iPhutTruTangCaTruoc = Convert.ToInt32(dtCaLamViecTinhTheoGio.Rows[iCaLamViecTinhTheoGio]["PhutTruTangCaTruoc"].ToString());
                                                            sChoPhepTangCaSauGioLamViecTinhTheoGio = dtCaLamViecTinhTheoGio.Rows[iCaLamViecTinhTheoGio]["TangCaSauGioLamViec"].ToString();
                                                            iPhutTangCaSauGioLamViecTinhTheoGio = Convert.ToInt32(dtCaLamViecTinhTheoGio.Rows[iCaLamViecTinhTheoGio]["SoPhutTangCaSauGioLamViec"].ToString());
                                                            iPhutTangCaSauGioLamViecDatDen = Convert.ToInt32(dtCaLamViecTinhTheoGio.Rows[iCaLamViecTinhTheoGio]["TangCaSauGioLamViecDatDen"].ToString());
                                                            iPhutTruTangCaSau = Convert.ToInt32(dtCaLamViecTinhTheoGio.Rows[iCaLamViecTinhTheoGio]["PhutTruTangCaSau"].ToString());
                                                            iGioiHanTC1TinhTheoGio = Convert.ToInt32(dtCaLamViecTinhTheoGio.Rows[iCaLamViecTinhTheoGio]["GioiHanTangCa1"].ToString());
                                                            iGioiHanTC2TinhTheoGio = Convert.ToInt32(dtCaLamViecTinhTheoGio.Rows[iCaLamViecTinhTheoGio]["GioiHanTangCa2"].ToString());
                                                            iGioiHanTC3TinhTheoGio = Convert.ToInt32(dtCaLamViecTinhTheoGio.Rows[iCaLamViecTinhTheoGio]["GioiHanTangCa3"].ToString());
                                                            iGioiHanTC4TinhTheoGio = Convert.ToInt32(dtCaLamViecTinhTheoGio.Rows[iCaLamViecTinhTheoGio]["GioiHanTangCa4"].ToString());
                                                            iTongGioTangCaSauTinhTheoGio = 0;
                                                            iTongGioTangCaTruocTinhTheoGio = 0;
                                                            if ((sChoPhepTangCaTruocGioLamViecTinhTheoGio != "False" ? true : !(sChoPhepTangCaSauGioLamViecTinhTheoGio == "False")))
                                                            {
                                                                if (sChoPhepTangCaTruocGioLamViecTinhTheoGio == "True")
                                                                {
                                                                    value = dGioVaoKhaiBaoTinhTheoGioB - dGioVaoTinhTheoGio;
                                                                    second = Convert.ToInt32(value.TotalMinutes);
                                                                    iThoiGianTruocGioLamTinhTheoGio = Convert.ToInt32(second.ToString());
                                                                    if (iThoiGianTruocGioLamTinhTheoGio > 0)
                                                                    {
                                                                        if (iThoiGianTruocGioLamTinhTheoGio > iPhutTangCaTruocGioLamViecTinhTheoGio)
                                                                        {
                                                                            if (iThoiGianTruocGioLamTinhTheoGio > iPhutTangCaTruocGioLamViecDatDen)
                                                                            {
                                                                                iTongGioTangCaTruocTinhTheoGio = iThoiGianTruocGioLamTinhTheoGio - iPhutTruTangCaTruoc;
                                                                            }
                                                                        }
                                                                    }
                                                                }
                                                                if (sChoPhepTangCaSauGioLamViecTinhTheoGio == "True")
                                                                {
                                                                    value = dGioRaTinhTheoGio - dGioRaKhaiBaoTinhTheoGioB;
                                                                    second = Convert.ToInt32(value.TotalMinutes);
                                                                    iThoiGianSauGioLamViecTinhTheoGio = Convert.ToInt32(second.ToString());
                                                                    if (iThoiGianSauGioLamViecTinhTheoGio > 0)
                                                                    {
                                                                        if (iThoiGianSauGioLamViecTinhTheoGio > iPhutTangCaSauGioLamViecTinhTheoGio)
                                                                        {
                                                                            if (iThoiGianSauGioLamViecTinhTheoGio > iPhutTangCaSauGioLamViecDatDen)
                                                                            {
                                                                                iTongGioTangCaSauTinhTheoGio = iThoiGianSauGioLamViecTinhTheoGio - iPhutTruTangCaSau;
                                                                            }
                                                                        }
                                                                    }
                                                                }
                                                            }
                                                            else
                                                            {
                                                                this.DGVTinhCong.Rows[addTinhTheoGio].Cells[12].Value = "0";
                                                                this.DGVTinhCong.Rows[addTinhTheoGio].Cells[13].Value = "0";
                                                                this.DGVTinhCong.Rows[addTinhTheoGio].Cells[14].Value = "0";
                                                                this.DGVTinhCong.Rows[addTinhTheoGio].Cells[15].Value = "0";
                                                            }
                                                            dTongThoiGianTangCaTinhTheoGio = Convert.ToDouble(iTongGioTangCaTruocTinhTheoGio + iTongGioTangCaSauTinhTheoGio);
                                                            if (dTongThoiGianTangCaTinhTheoGio <= 0)
                                                            {
                                                                this.DGVTinhCong.Rows[addTinhTheoGio].Cells[12].Value = "0";
                                                                this.DGVTinhCong.Rows[addTinhTheoGio].Cells[13].Value = "0";
                                                                this.DGVTinhCong.Rows[addTinhTheoGio].Cells[14].Value = "0";
                                                                this.DGVTinhCong.Rows[addTinhTheoGio].Cells[15].Value = "0";
                                                            }
                                                            else
                                                            {
                                                                if (iGioiHanTC1TinhTheoGio == 0)
                                                                {
                                                                    this.DGVTinhCong.Rows[_nhanVien].Cells[12].Value = Math.Round(dTongThoiGianTangCaTinhTheoGio * this.dTangCa1HeSo / 60, this.iLamTronGio);
                                                                    this.DGVTinhCong.Rows[addTinhTheoGio].Cells[13].Value = "0";
                                                                    this.DGVTinhCong.Rows[addTinhTheoGio].Cells[14].Value = "0";
                                                                    this.DGVTinhCong.Rows[addTinhTheoGio].Cells[15].Value = "0";
                                                                }
                                                                if ((iGioiHanTC1TinhTheoGio == 0 ? false : iGioiHanTC2TinhTheoGio == 0))
                                                                {
                                                                    if (dTongThoiGianTangCaTinhTheoGio >= Convert.ToDouble(iGioiHanTC1TinhTheoGio))
                                                                    {
                                                                        this.DGVTinhCong.Rows[_nhanVien].Cells[12].Value = Math.Round(Convert.ToDouble(iGioiHanTC1TinhTheoGio) / 60 * this.dTangCa1HeSo, this.iLamTronGio);
                                                                        if (dTongThoiGianTangCaTinhTheoGio - Convert.ToDouble(iGioiHanTC1TinhTheoGio) > 0)
                                                                        {
                                                                            this.DGVTinhCong.Rows[_nhanVien].Cells[13].Value = Math.Round((dTongThoiGianTangCaTinhTheoGio - Convert.ToDouble(iGioiHanTC1TinhTheoGio)) * this.dTangCa2HeSo / 60, this.iLamTronGio);
                                                                        }
                                                                        this.DGVTinhCong.Rows[addTinhTheoGio].Cells[14].Value = "0";
                                                                        this.DGVTinhCong.Rows[addTinhTheoGio].Cells[15].Value = "0";
                                                                    }
                                                                    else
                                                                    {
                                                                        this.DGVTinhCong.Rows[_nhanVien].Cells[12].Value = Math.Round(dTongThoiGianTangCaTinhTheoGio * this.dTangCa1HeSo / 60, this.iLamTronGio);
                                                                        this.DGVTinhCong.Rows[addTinhTheoGio].Cells[13].Value = "0";
                                                                        this.DGVTinhCong.Rows[addTinhTheoGio].Cells[14].Value = "0";
                                                                        this.DGVTinhCong.Rows[addTinhTheoGio].Cells[15].Value = "0";
                                                                    }
                                                                }
                                                                if ((iGioiHanTC1TinhTheoGio == 0 || iGioiHanTC2TinhTheoGio == 0 ? false : iGioiHanTC3TinhTheoGio == 0))
                                                                {
                                                                    if (dTongThoiGianTangCaTinhTheoGio >= Convert.ToDouble(iGioiHanTC1TinhTheoGio))
                                                                    {
                                                                        this.DGVTinhCong.Rows[_nhanVien].Cells[12].Value = Math.Round(Convert.ToDouble(iGioiHanTC1TinhTheoGio) * this.dTangCa1HeSo / 60, this.iLamTronGio);
                                                                        if (dTongThoiGianTangCaTinhTheoGio - Convert.ToDouble(iGioiHanTC1TinhTheoGio) >= Convert.ToDouble(iGioiHanTC2TinhTheoGio))
                                                                        {
                                                                            this.DGVTinhCong.Rows[_nhanVien].Cells[12].Value = Math.Round(Convert.ToDouble(iGioiHanTC1TinhTheoGio) * this.dTangCa1HeSo / 60, this.iLamTronGio);
                                                                            this.DGVTinhCong.Rows[_nhanVien].Cells[13].Value = Math.Round(Convert.ToDouble(iGioiHanTC2TinhTheoGio) * this.dTangCa2HeSo / 60, this.iLamTronGio);
                                                                            this.DGVTinhCong.Rows[_nhanVien].Cells[14].Value = Math.Round((dTongThoiGianTangCaTinhTheoGio - Convert.ToDouble(iGioiHanTC1TinhTheoGio) - Convert.ToDouble(iGioiHanTC2TinhTheoGio)) * this.dTangCa3HeSo / 60, this.iLamTronGio);
                                                                            this.DGVTinhCong.Rows[addTinhTheoGio].Cells[15].Value = "0";
                                                                        }
                                                                        else
                                                                        {
                                                                            this.DGVTinhCong.Rows[_nhanVien].Cells[13].Value = Math.Round((dTongThoiGianTangCaTinhTheoGio - Convert.ToDouble(iGioiHanTC1TinhTheoGio)) * this.dTangCa2HeSo / 60, this.iLamTronGio);
                                                                            this.DGVTinhCong.Rows[addTinhTheoGio].Cells[14].Value = "0";
                                                                            this.DGVTinhCong.Rows[addTinhTheoGio].Cells[15].Value = "0";
                                                                        }
                                                                    }
                                                                    else
                                                                    {
                                                                        this.DGVTinhCong.Rows[_nhanVien].Cells[12].Value = Math.Round(dTongThoiGianTangCaTinhTheoGio * this.dTangCa1HeSo / 60, this.iLamTronGio);
                                                                        this.DGVTinhCong.Rows[addTinhTheoGio].Cells[13].Value = "0";
                                                                        this.DGVTinhCong.Rows[addTinhTheoGio].Cells[14].Value = "0";
                                                                        this.DGVTinhCong.Rows[addTinhTheoGio].Cells[15].Value = "0";
                                                                    }
                                                                }
                                                                if ((iGioiHanTC1TinhTheoGio == 0 || iGioiHanTC2TinhTheoGio == 0 || iGioiHanTC3TinhTheoGio == 0 ? false : iGioiHanTC4TinhTheoGio == 0))
                                                                {
                                                                }
                                                            }
                                                            value = dGioRaTinhTheoGio - dGioVaoTinhTheoGio;
                                                            second = Convert.ToInt32(value.TotalMinutes);
                                                            num = Math.Round(Convert.ToDouble(second.ToString()) / 60, this.iLamTronGio);
                                                            sTongGio = num.ToString();
                                                            this.DGVTinhCong.Rows[addTinhTheoGio].Cells[16].Value = sTongGio;
                                                            this.DGVTinhCong.Rows[addTinhTheoGio].Cells[17].Value = dtCaLamViecTinhTheoGio.Rows[iCaLamViecTinhTheoGio]["CongTinh"].ToString();
                                                            this.DGVTinhCong.Rows[addTinhTheoGio].Cells[18].Value = this.sKHDungGio;
                                                            if (!(DateTimeProgress.XuatIDThu((int)dt.AddDays((double)dem).DayOfWeek) == "0"))
                                                            {
                                                                this.DGVTinhCong.Rows[addTinhTheoGio].Cells[19].Value = "NT";
                                                            }
                                                            else
                                                            {
                                                                this.DGVTinhCong.Rows[addTinhTheoGio].Cells[19].Value = "CN";
                                                            }
                                                            this.DGVTinhCong.Rows[addTinhTheoGio].Cells[20].Value = this.sMaChamCong;
                                                            this.DGVTinhCong.Rows[addTinhTheoGio].Cells[21].Value = this.sPhongBanTinhCong;
                                                        }
                                                    }
                                                Label46:
                                                    if (iCaTrongLIchtrinh == 0)
                                                    {
                                                        this.DGVTinhCong.Rows[addTinhTheoGio].Cells[4].Value = "***";
                                                        this.DGVTinhCong.Rows[addTinhTheoGio].Cells[7].Value = "0";
                                                        this.DGVTinhCong.Rows[addTinhTheoGio].Cells[8].Value = "0";
                                                        this.DGVTinhCong.Rows[addTinhTheoGio].Cells[9].Value = "0";
                                                        this.DGVTinhCong.Rows[addTinhTheoGio].Cells[10].Value = "0";
                                                        this.DGVTinhCong.Rows[addTinhTheoGio].Cells[11].Value = "0";
                                                        this.DGVTinhCong.Rows[addTinhTheoGio].Cells[12].Value = "0";
                                                        this.DGVTinhCong.Rows[addTinhTheoGio].Cells[13].Value = "0";
                                                        this.DGVTinhCong.Rows[addTinhTheoGio].Cells[14].Value = "0";
                                                        this.DGVTinhCong.Rows[addTinhTheoGio].Cells[15].Value = "0";
                                                        this.DGVTinhCong.Rows[addTinhTheoGio].Cells[16].Value = "0";
                                                        this.DGVTinhCong.Rows[addTinhTheoGio].Cells[17].Value = "0";
                                                        this.DGVTinhCong.Rows[addTinhTheoGio].Cells[18].Value = this.sKHVang;
                                                        if (!(DateTimeProgress.XuatIDThu((int)dt.AddDays((double)dem).DayOfWeek) == "0"))
                                                        {
                                                            this.DGVTinhCong.Rows[addTinhTheoGio].Cells[19].Value = "NT";
                                                        }
                                                        else
                                                        {
                                                            this.DGVTinhCong.Rows[addTinhTheoGio].Cells[19].Value = "CN";
                                                        }
                                                        this.DGVTinhCong.Rows[addTinhTheoGio].Cells[20].Value = this.sMaChamCong;
                                                        this.DGVTinhCong.Rows[addTinhTheoGio].Cells[21].Value = this.sPhongBanTinhCong;
                                                    }
                                                }
                                                else
                                                {
                                                    addTinhTheoGioThoiGianLonNhat = this.DGVTinhCong.Rows.Add();
                                                    this.DGVTinhCong.Rows[addTinhTheoGioThoiGianLonNhat].Cells[0].Value = this.sMaNhanVien;
                                                    this.DGVTinhCong.Rows[addTinhTheoGioThoiGianLonNhat].Cells[1].Value = this.sTenNhanVien;
                                                    this.DGVTinhCong.Rows[addTinhTheoGioThoiGianLonNhat].Cells[2].Value = this.DGVTinhCong.Rows[_nhanVien].Cells[2].Value.ToString();
                                                    if (this.iNgonNgu == 0)
                                                    {
                                                        DataGridViewCell item20 = this.DGVTinhCong.Rows[addTinhTheoGioThoiGianLonNhat].Cells[3];
                                                        dateTime = dt.AddDays((double)dem);
                                                        item20.Value = DateTimeProgress.XuatThuTinhCong((int)dateTime.DayOfWeek);
                                                    }
                                                    if (this.iNgonNgu == 1)
                                                    {
                                                        DataGridViewCell dataGridViewCell20 = this.DGVTinhCong.Rows[addTinhTheoGioThoiGianLonNhat].Cells[3];
                                                        dateTime = dt.AddDays((double)dem);
                                                        dataGridViewCell20.Value = DateTimeProgress.XuatThuEnglish((int)dateTime.DayOfWeek);
                                                    }
                                                    this.DGVTinhCong.Rows[addTinhTheoGioThoiGianLonNhat].Cells[4].Value = "***";
                                                    this.DGVTinhCong.Rows[addTinhTheoGioThoiGianLonNhat].Cells[6].Value = string.Format(this.sDinhDangThoiGian, dGioRaTinhTheoGio);
                                                    this.DGVTinhCong.Rows[addTinhTheoGioThoiGianLonNhat].Cells[7].Value = "0";
                                                    this.DGVTinhCong.Rows[addTinhTheoGioThoiGianLonNhat].Cells[8].Value = "0";
                                                    this.DGVTinhCong.Rows[addTinhTheoGioThoiGianLonNhat].Cells[9].Value = "0";
                                                    this.DGVTinhCong.Rows[addTinhTheoGioThoiGianLonNhat].Cells[10].Value = "0";
                                                    this.DGVTinhCong.Rows[addTinhTheoGioThoiGianLonNhat].Cells[11].Value = "0";
                                                    this.DGVTinhCong.Rows[addTinhTheoGioThoiGianLonNhat].Cells[12].Value = "0";
                                                    this.DGVTinhCong.Rows[addTinhTheoGioThoiGianLonNhat].Cells[13].Value = "0";
                                                    this.DGVTinhCong.Rows[addTinhTheoGioThoiGianLonNhat].Cells[14].Value = "0";
                                                    this.DGVTinhCong.Rows[addTinhTheoGioThoiGianLonNhat].Cells[15].Value = "0";
                                                    this.DGVTinhCong.Rows[addTinhTheoGioThoiGianLonNhat].Cells[16].Value = "0";
                                                    this.DGVTinhCong.Rows[addTinhTheoGioThoiGianLonNhat].Cells[17].Value = "0";
                                                    this.DGVTinhCong.Rows[addTinhTheoGioThoiGianLonNhat].Cells[18].Value = this.sKHVang;
                                                    if (!(DateTimeProgress.XuatIDThu((int)dt.AddDays((double)dem).DayOfWeek) == "0"))
                                                    {
                                                        this.DGVTinhCong.Rows[addTinhTheoGioThoiGianLonNhat].Cells[19].Value = "NT";
                                                    }
                                                    else
                                                    {
                                                        this.DGVTinhCong.Rows[addTinhTheoGioThoiGianLonNhat].Cells[19].Value = "CN";
                                                    }
                                                    this.DGVTinhCong.Rows[addTinhTheoGioThoiGianLonNhat].Cells[20].Value = this.sMaChamCong;
                                                    this.DGVTinhCong.Rows[addTinhTheoGioThoiGianLonNhat].Cells[21].Value = this.sPhongBanTinhCong;
                                                }
                                            }
                                        }
                                        demTinhTheoGio++;
                                    Label41:;
                                    }
                                    if (demTinhTheoGio == 0)
                                    {
                                        this.DGVTinhCong.Rows[_nhanVien].Cells[7].Value = "0";
                                        this.DGVTinhCong.Rows[_nhanVien].Cells[8].Value = "0";
                                        this.DGVTinhCong.Rows[_nhanVien].Cells[17].Value = "0";
                                        this.DGVTinhCong.Rows[_nhanVien].Cells[18].Value = this.sKHVang;
                                        this.DGVTinhCong.Rows[_nhanVien].Cells[20].Value = this.sMaChamCong;
                                        this.DGVTinhCong.Rows[_nhanVien].Cells[21].Value = this.sPhongBanTinhCong;
                                    }
                                }
                                if (iChonLichTrinh == 7)
                                {
                                    iKiemTraLanChamLichTrinhVaoRa = 0;
                                    iKiemTraLanChamKhoangCachTuDongQuaDemLichTrinhVaoRa = 0;
                                    int demTuDongQuaDem = 0;
                                    int addTuDongQuaDem = 0;
                                    int addTuDongQuaDemB = 0;
                                    DateTime dGioVaoTuDongQuaDem = new DateTime();
                                    DateTime dGioRaTuDongQuaDem = new DateTime();
                                    dGioVaoTuDongQuaDemKiemTraLichTrinhVaoRa = new DateTime();
                                    dGioRaTuDongQuaDemKiemTraLichTrinhVaoRa = new DateTime();
                                    iKiemTraLanChamTuDongQuaDemLichTrinhVaoRa = new DateTime();
                                    dtTuDongQuaDem = new System.Data.DataTable();
                                    this._checkInOutDTO.MaChamCong = Convert.ToInt32(this.sMaChamCong);
                                    this._checkInOutDTO.NgayCham = Convert.ToDateTime(this.DGVTinhCong.Rows[_nhanVien].Cells[2].Value.ToString());
                                    dtTuDongQuaDem = this._checkInOutBLL.getCheckInOutByMaChamCongAndNgayCham(this._checkInOutDTO);
                                    for (iTuDongQuaDem = 0; iTuDongQuaDem < dtTuDongQuaDem.Rows.Count; iTuDongQuaDem++)
                                    {
                                        addGioNguonTuDongQuaDemQuaDem = this.DGVDuLieuChamCongNguon.Rows.Add();
                                        iKiemTraLanChamLichTrinhVaoRa++;
                                        if (iKiemTraLanChamLichTrinhVaoRa == 1)
                                        {
                                            dGioVaoTuDongQuaDemKiemTraLichTrinhVaoRa = Convert.ToDateTime(dtTuDongQuaDem.Rows[iTuDongQuaDem]["GioCham"].ToString());
                                            if ((dtTuDongQuaDem.Rows.Count <= 2 ? true : iKiemTraLanChamKhoangCachTuDongQuaDemLichTrinhVaoRa != 3))
                                            {
                                                this.DGVDuLieuChamCongNguon.Rows[addGioNguonTuDongQuaDemQuaDem].Cells[0].Value = this.sMaChamCong;
                                                this.DGVDuLieuChamCongNguon.Rows[addGioNguonTuDongQuaDemQuaDem].Cells[1].Value = string.Format("{0:d}", dGioVaoTuDongQuaDemKiemTraLichTrinhVaoRa);
                                                this.DGVDuLieuChamCongNguon.Rows[addGioNguonTuDongQuaDemQuaDem].Cells[2].Value = dGioVaoTuDongQuaDemKiemTraLichTrinhVaoRa;
                                                this.DGVDuLieuChamCongNguon.Rows[addGioNguonTuDongQuaDemQuaDem].Cells[3].Value = "Vào";
                                                this.DGVDuLieuChamCongNguon.Rows[addGioNguonTuDongQuaDemQuaDem].Cells[4].Value = "I";
                                                this.DGVDuLieuChamCongNguon.Rows[addGioNguonTuDongQuaDemQuaDem].Cells[6].Value = dtTuDongQuaDem.Rows[iTuDongQuaDem]["MaSoMay"].ToString();
                                            }
                                            else
                                            {
                                                if (Convert.ToInt32(Convert.ToInt32((dGioVaoTuDongQuaDemKiemTraLichTrinhVaoRa - dGioRaTuDongQuaDemKiemTraLichTrinhVaoRa).TotalMinutes).ToString()) < iKhoangCachGiuaHaiCapVaoRa)
                                                {
                                                    goto Label49;
                                                                                                     
                                                }
                                                this.DGVDuLieuChamCongNguon.Rows[addGioNguonTuDongQuaDemQuaDem].Cells[0].Value = this.sMaChamCong;
                                                this.DGVDuLieuChamCongNguon.Rows[addGioNguonTuDongQuaDemQuaDem].Cells[1].Value = string.Format("{0:d}", dGioVaoTuDongQuaDemKiemTraLichTrinhVaoRa);
                                                this.DGVDuLieuChamCongNguon.Rows[addGioNguonTuDongQuaDemQuaDem].Cells[2].Value = dGioVaoTuDongQuaDemKiemTraLichTrinhVaoRa;
                                                this.DGVDuLieuChamCongNguon.Rows[addGioNguonTuDongQuaDemQuaDem].Cells[3].Value = "Vào";
                                                this.DGVDuLieuChamCongNguon.Rows[addGioNguonTuDongQuaDemQuaDem].Cells[4].Value = "I";
                                                this.DGVDuLieuChamCongNguon.Rows[addGioNguonTuDongQuaDemQuaDem].Cells[6].Value = dtTuDongQuaDem.Rows[iTuDongQuaDem]["MaSoMay"].ToString();
                                                iKiemTraLanChamLichTrinhVaoRa = 1;
                                            }
                                        }
                                        if (iKiemTraLanChamLichTrinhVaoRa == 2)
                                        {
                                            dGioRaTuDongQuaDemKiemTraLichTrinhVaoRa = Convert.ToDateTime(dtTuDongQuaDem.Rows[iTuDongQuaDem]["GioCham"].ToString());
                                            if (Convert.ToInt32(Convert.ToInt32((dGioRaTuDongQuaDemKiemTraLichTrinhVaoRa - dGioVaoTuDongQuaDemKiemTraLichTrinhVaoRa).TotalMinutes).ToString()) < iThoiGianNhoNhat)
                                            {
                                              goto Label50;
                                            }
                                            iKiemTraLanChamLichTrinhVaoRa = 0;
                                            iKiemTraLanChamKhoangCachTuDongQuaDemLichTrinhVaoRa = 3;
                                            this.DGVDuLieuChamCongNguon.Rows[addGioNguonTuDongQuaDemQuaDem].Cells[0].Value = this.sMaChamCong;
                                            this.DGVDuLieuChamCongNguon.Rows[addGioNguonTuDongQuaDemQuaDem].Cells[1].Value = string.Format("{0:d}", dGioRaTuDongQuaDemKiemTraLichTrinhVaoRa);
                                            this.DGVDuLieuChamCongNguon.Rows[addGioNguonTuDongQuaDemQuaDem].Cells[2].Value = dGioRaTuDongQuaDemKiemTraLichTrinhVaoRa;
                                            this.DGVDuLieuChamCongNguon.Rows[addGioNguonTuDongQuaDemQuaDem].Cells[3].Value = "Ra";
                                            this.DGVDuLieuChamCongNguon.Rows[addGioNguonTuDongQuaDemQuaDem].Cells[4].Value = "O";
                                            this.DGVDuLieuChamCongNguon.Rows[addGioNguonTuDongQuaDemQuaDem].Cells[6].Value = dtTuDongQuaDem.Rows[iTuDongQuaDem]["MaSoMay"].ToString();
                                        }
                                        demTuDongQuaDem++;
                                        if (!(this._checkInOutDTO.NgayCham == this.dateTimeTuNgay.Value))
                                        {
                                            dGioNgayHomTruoc = new DateTime();
                                            dateTime = dt.AddDays((double)(dem - 1));
                                            DateTime dNgayTruocTuDongQuaDem = Convert.ToDateTime(dateTime.ToString());
                                            System.Data.DataTable dtNgayTruocTuDongQuaDem = new System.Data.DataTable();
                                            this._checkInOutDTO.MaChamCong = Convert.ToInt32(this.sMaChamCong);
                                            this._checkInOutDTO.NgayCham = dNgayTruocTuDongQuaDem;
                                            dtNgayTruocTuDongQuaDem = this._checkInOutBLL.getCheckInOutByMaChamCongAndNgayCham(this._checkInOutDTO);
                                            for (int iNgayTruocTuDongQuaDem = 0; iNgayTruocTuDongQuaDem < dtNgayTruocTuDongQuaDem.Rows.Count; iNgayTruocTuDongQuaDem++)
                                            {
                                                dGioNgayHomTruoc = Convert.ToDateTime(dtNgayTruocTuDongQuaDem.Rows[iNgayTruocTuDongQuaDem]["GioCham"].ToString());
                                            }
                                            if ((dtNgayTruocTuDongQuaDem.Rows.Count == 0 || this.DGVTinhCong.Rows[_nhanVien - 1].Cells[5].Value == null ? true : this.DGVTinhCong.Rows[_nhanVien - 1].Cells[6].Value != null))
                                            {
                                                if (demTuDongQuaDem == 1)
                                                {
                                                    dGioVaoTuDongQuaDem = Convert.ToDateTime(dtTuDongQuaDem.Rows[iTuDongQuaDem]["GioCham"].ToString());
                                                    this.DGVTinhCong.Rows[_nhanVien].Cells[5].Value = string.Format(this.sDinhDangThoiGian, dGioVaoTuDongQuaDem);
                                                    dtNhanCaTuDongQuaDem = new System.Data.DataTable();
                                                    this._chiTietLichTrinhChoCalamViecDTO.MaLichTrinhCaLamViec = sLTCCLVNhanVien;
                                                    this._chiTietLichTrinhChoCalamViecDTO.Thu = sThu;
                                                    dtNhanCaTuDongQuaDem = this._chiTietLichTrinhChoCaLamViecBLL.ChiTietLichTrinhChoCaLamViecNhanCa(this._chiTietLichTrinhChoCalamViecDTO);
                                                    iChiTietLichTrinhChoCaLamViecTuDongQuaDem = 0;
                                                    if (iChiTietLichTrinhChoCaLamViecTuDongQuaDem < dtNhanCaTuDongQuaDem.Rows.Count)
                                                    {
                                                        cellChiTietLichTrinhChoCaLamViecTuDongQuaDem = 3;
                                                        while (cellChiTietLichTrinhChoCaLamViecTuDongQuaDem < 13)
                                                        {
                                                            kiemTraVao = 0;
                                                            kiemTraRa = 0;
                                                            this.sTuDongQuaDemMaCaLamViec = dtNhanCaTuDongQuaDem.Rows[iChiTietLichTrinhChoCaLamViecTuDongQuaDem][cellChiTietLichTrinhChoCaLamViecTuDongQuaDem].ToString();
                                                            dtTuDongQuaDemCa = new System.Data.DataTable();
                                                            this._caLamViecDTO.MaCaLamViec = this.sTuDongQuaDemMaCaLamViec;
                                                            dtTuDongQuaDemCa = this._caLamViecBLL.CaLamViecGetByMaCaLamViec(this._caLamViecDTO);
                                                            iTuDongQuaDemCa = 0;
                                                            while (iTuDongQuaDemCa < dtTuDongQuaDemCa.Rows.Count)
                                                            {
                                                                this.sTuDongQuaDemTenCaLamViec = dtTuDongQuaDemCa.Rows[iTuDongQuaDemCa]["CaLamViec"].ToString();
                                                                dBatDauVaoA = Convert.ToDateTime(dtTuDongQuaDemCa.Rows[iTuDongQuaDemCa]["BatDauVao"].ToString());
                                                                sBatDauVaoA = string.Format("{0:T}", dBatDauVaoA);
                                                                sBatDauVaoB = string.Concat(sNgayCham, " ", sBatDauVaoA);
                                                                dBatDauVaoB = Convert.ToDateTime(sBatDauVaoB);
                                                                dKetThucVaoA = Convert.ToDateTime(dtTuDongQuaDemCa.Rows[iTuDongQuaDemCa]["KetThucVao"].ToString());
                                                                sKetThucVaoA = string.Format("{0:T}", dKetThucVaoA);
                                                                sKetThucVaoB = string.Concat(sNgayCham, " ", sKetThucVaoA);
                                                                dKetThucVaoB = Convert.ToDateTime(sKetThucVaoB);
                                                                dBatDauRaA = Convert.ToDateTime(dtTuDongQuaDemCa.Rows[iTuDongQuaDemCa]["BatDauRa"].ToString());
                                                                sBatDauRaA = string.Format("{0:T}", dBatDauRaA);
                                                                sBatDauRaB = string.Concat(sNgayCham, " ", sBatDauRaA);
                                                                dBatDauRaB = Convert.ToDateTime(sBatDauRaB);
                                                                dKetThucRaA = Convert.ToDateTime(dtTuDongQuaDemCa.Rows[iTuDongQuaDemCa]["KetThucRa"].ToString());
                                                                sKetThucRaA = string.Format("{0:T}", dKetThucRaA);
                                                                sKetThucRaB = string.Concat(sNgayCham, " ", sKetThucRaA);
                                                                dKetThucRaB = Convert.ToDateTime(sKetThucRaB);
                                                                if ((dGioVaoTuDongQuaDem < dBatDauVaoB ? false : dGioVaoTuDongQuaDem <= dKetThucVaoB))
                                                                {
                                                                    kiemTraVao++;
                                                                }
                                                                if ((dGioRaTuDongQuaDem < dBatDauRaB ? false : dGioRaTuDongQuaDem <= dKetThucRaB))
                                                                {
                                                                    kiemTraRa++;
                                                                }
                                                                if ((kiemTraVao != 1 ? true : kiemTraRa != 0))
                                                                {
                                                                    iTuDongQuaDemCa++;
                                                                }
                                                                else
                                                                {
                                                                    goto Label52;
                                                                }
                                                            }
                                                            if (!(this.sTuDongQuaDemMaCaLamViec == ""))
                                                            {
                                                                cellChiTietLichTrinhChoCaLamViecTuDongQuaDem++;
                                                            }
                                                            else
                                                            {
                                                                this.DGVTinhCong.Rows[_nhanVien].Cells[4].Value = "***";
                                                                this.DGVTinhCong.Rows[_nhanVien].Cells[7].Value = "0";
                                                                this.DGVTinhCong.Rows[_nhanVien].Cells[8].Value = "0";
                                                                this.DGVTinhCong.Rows[_nhanVien].Cells[9].Value = "0";
                                                                this.DGVTinhCong.Rows[_nhanVien].Cells[10].Value = "0";
                                                                this.DGVTinhCong.Rows[_nhanVien].Cells[11].Value = "0";
                                                                this.DGVTinhCong.Rows[_nhanVien].Cells[12].Value = "0";
                                                                this.DGVTinhCong.Rows[_nhanVien].Cells[13].Value = "0";
                                                                this.DGVTinhCong.Rows[_nhanVien].Cells[14].Value = "0";
                                                                this.DGVTinhCong.Rows[_nhanVien].Cells[15].Value = "0";
                                                                this.DGVTinhCong.Rows[_nhanVien].Cells[16].Value = "0";
                                                                this.DGVTinhCong.Rows[_nhanVien].Cells[17].Value = "0";
                                                                this.DGVTinhCong.Rows[_nhanVien].Cells[18].Value = this.sKHVang;
                                                                if (!(DateTimeProgress.XuatIDThu((int)dt.AddDays((double)dem).DayOfWeek) == "0"))
                                                                {
                                                                    this.DGVTinhCong.Rows[_nhanVien].Cells[19].Value = "NT";
                                                                }
                                                                else
                                                                {
                                                                    this.DGVTinhCong.Rows[_nhanVien].Cells[19].Value = "CN";
                                                                }
                                                                this.DGVTinhCong.Rows[_nhanVien].Cells[20].Value = this.sMaChamCong;
                                                                this.DGVTinhCong.Rows[_nhanVien].Cells[21].Value = this.sPhongBanTinhCong;
                                                              //  goto Label51;                                                  
                                                                break;
                                                            }
                                                        }
                                                      
                                                    Label52:
                                                        this.DGVTinhCong.Rows[_nhanVien].Cells[4].Value = this.sTuDongQuaDemTenCaLamViec;
                                                        this.DGVTinhCong.Rows[_nhanVien].Cells[7].Value = "0";
                                                        this.DGVTinhCong.Rows[_nhanVien].Cells[8].Value = "0";
                                                        this.DGVTinhCong.Rows[_nhanVien].Cells[9].Value = "0";
                                                        this.DGVTinhCong.Rows[_nhanVien].Cells[10].Value = "0";
                                                        this.DGVTinhCong.Rows[_nhanVien].Cells[11].Value = "0";
                                                        this.DGVTinhCong.Rows[_nhanVien].Cells[12].Value = "0";
                                                        this.DGVTinhCong.Rows[_nhanVien].Cells[13].Value = "0";
                                                        this.DGVTinhCong.Rows[_nhanVien].Cells[14].Value = "0";
                                                        this.DGVTinhCong.Rows[_nhanVien].Cells[15].Value = "0";
                                                        this.DGVTinhCong.Rows[_nhanVien].Cells[16].Value = "0";
                                                        this.DGVTinhCong.Rows[_nhanVien].Cells[17].Value = "0";
                                                        this.DGVTinhCong.Rows[_nhanVien].Cells[18].Value = this.sKHVang;
                                                        if (!(DateTimeProgress.XuatIDThu((int)dt.AddDays((double)dem).DayOfWeek) == "0"))
                                                        {
                                                            this.DGVTinhCong.Rows[_nhanVien].Cells[19].Value = "NT";
                                                        }
                                                        else
                                                        {
                                                            this.DGVTinhCong.Rows[_nhanVien].Cells[19].Value = "CN";
                                                        }
                                                        this.DGVTinhCong.Rows[_nhanVien].Cells[20].Value = this.sMaChamCong;
                                                        this.DGVTinhCong.Rows[_nhanVien].Cells[21].Value = this.sPhongBanTinhCong;
                                                        
                                                    }
                                                   // break;
                                              // Label51:; thu cho nay
                                                }

                                                // ket thuc tu dong qua dem =1
                                               // Label51:
                                                if (demTuDongQuaDem == 2)
                                                {
                                                    dGioRaTuDongQuaDem = Convert.ToDateTime(dtTuDongQuaDem.Rows[iTuDongQuaDem]["GioCham"].ToString());
                                                    this.DGVTinhCong.Rows[_nhanVien].Cells[6].Value = string.Format(this.sDinhDangThoiGian, dGioRaTuDongQuaDem);
                                                    dtNhanCaTuDongQuaDem = new System.Data.DataTable();
                                                    this._chiTietLichTrinhChoCalamViecDTO.MaLichTrinhCaLamViec = sLTCCLVNhanVien;
                                                    this._chiTietLichTrinhChoCalamViecDTO.Thu = sThu;
                                                    dtNhanCaTuDongQuaDem = this._chiTietLichTrinhChoCaLamViecBLL.ChiTietLichTrinhChoCaLamViecNhanCa(this._chiTietLichTrinhChoCalamViecDTO);
                                                    iChiTietLichTrinhChoCaLamViecTuDongQuaDem = 0;
                                                    if (iChiTietLichTrinhChoCaLamViecTuDongQuaDem < dtNhanCaTuDongQuaDem.Rows.Count)
                                                    {
                                                        cellChiTietLichTrinhChoCaLamViecTuDongQuaDem = 3;
                                                        while (cellChiTietLichTrinhChoCaLamViecTuDongQuaDem < 13)
                                                        {
                                                            kiemTraVao = 0;
                                                            kiemTraRa = 0;
                                                            this.sTuDongQuaDemMaCaLamViec = dtNhanCaTuDongQuaDem.Rows[iChiTietLichTrinhChoCaLamViecTuDongQuaDem][cellChiTietLichTrinhChoCaLamViecTuDongQuaDem].ToString();
                                                            dtTuDongQuaDemCa = new System.Data.DataTable();
                                                            this._caLamViecDTO.MaCaLamViec = this.sTuDongQuaDemMaCaLamViec;
                                                            dtTuDongQuaDemCa = this._caLamViecBLL.CaLamViecGetByMaCaLamViec(this._caLamViecDTO);
                                                            iTuDongQuaDemCa = 0;
                                                            while (iTuDongQuaDemCa < dtTuDongQuaDemCa.Rows.Count)
                                                            {
                                                                second = dGioVaoTuDongQuaDem.Second;
                                                                sGiayGioVao = second.ToString();
                                                                second = dGioRaTuDongQuaDem.Second;
                                                                sGiayGioRa = second.ToString();
                                                                this.sTuDongQuaDemTenCaLamViec = dtTuDongQuaDemCa.Rows[iTuDongQuaDemCa]["CaLamViec"].ToString();
                                                                dBatDauVaoA = Convert.ToDateTime(dtTuDongQuaDemCa.Rows[iTuDongQuaDemCa]["BatDauVao"].ToString());
                                                                sBatDauVaoA = string.Format("{0:T}", dBatDauVaoA).Replace("00 ", string.Concat(sGiayGioVao, " "));
                                                                sBatDauVaoB = string.Concat(sNgayCham, " ", sBatDauVaoA);
                                                                dBatDauVaoB = Convert.ToDateTime(sBatDauVaoB);
                                                                dKetThucVaoA = Convert.ToDateTime(dtTuDongQuaDemCa.Rows[iTuDongQuaDemCa]["KetThucVao"].ToString());
                                                                sKetThucVaoA = string.Format("{0:T}", dKetThucVaoA).Replace("00 ", string.Concat(sGiayGioVao, " "));
                                                                sKetThucVaoB = string.Concat(sNgayCham, " ", sKetThucVaoA);
                                                                dKetThucVaoB = Convert.ToDateTime(sKetThucVaoB);
                                                                dBatDauRaA = Convert.ToDateTime(dtTuDongQuaDemCa.Rows[iTuDongQuaDemCa]["BatDauRa"].ToString());
                                                                sBatDauRaA = string.Format("{0:T}", dBatDauRaA).Replace("00 ", string.Concat(sGiayGioRa, " "));
                                                                sBatDauRaB = string.Concat(sNgayCham, " ", sBatDauRaA);
                                                                dBatDauRaB = Convert.ToDateTime(sBatDauRaB);
                                                                dKetThucRaA = Convert.ToDateTime(dtTuDongQuaDemCa.Rows[iTuDongQuaDemCa]["KetThucRa"].ToString());
                                                                sKetThucRaA = string.Format("{0:T}", dKetThucRaA).Replace("00 ", string.Concat(sGiayGioRa, " "));
                                                                sKetThucRaB = string.Concat(sNgayCham, " ", sKetThucRaA);
                                                                dKetThucRaB = Convert.ToDateTime(sKetThucRaB);
                                                                if ((dGioVaoTuDongQuaDem < dBatDauVaoB ? false : dGioVaoTuDongQuaDem <= dKetThucVaoB))
                                                                {
                                                                    kiemTraVao++;
                                                                }
                                                                if ((dGioRaTuDongQuaDem < dBatDauRaB ? false : dGioRaTuDongQuaDem <= dKetThucRaB))
                                                                {
                                                                    kiemTraRa++;
                                                                }
                                                                if ((kiemTraVao != 1 ? true : kiemTraRa != 1))
                                                                {
                                                                    iTuDongQuaDemCa++;
                                                                }
                                                                else
                                                                {
                                                                    goto Label54;
                                                                }
                                                            }
                                                            if (!(this.sTuDongQuaDemMaCaLamViec == ""))
                                                            {
                                                                cellChiTietLichTrinhChoCaLamViecTuDongQuaDem++;
                                                            }
                                                            else
                                                            {
                                                                this.DGVTinhCong.Rows[_nhanVien].Cells[4].Value = "***";
                                                                this.DGVTinhCong.Rows[_nhanVien].Cells[7].Value = "0";
                                                                this.DGVTinhCong.Rows[_nhanVien].Cells[8].Value = "0";
                                                                this.DGVTinhCong.Rows[_nhanVien].Cells[9].Value = "0";
                                                                this.DGVTinhCong.Rows[_nhanVien].Cells[10].Value = "0";
                                                                this.DGVTinhCong.Rows[_nhanVien].Cells[11].Value = "0";
                                                                this.DGVTinhCong.Rows[_nhanVien].Cells[12].Value = "0";
                                                                this.DGVTinhCong.Rows[_nhanVien].Cells[13].Value = "0";
                                                                this.DGVTinhCong.Rows[_nhanVien].Cells[14].Value = "0";
                                                                this.DGVTinhCong.Rows[_nhanVien].Cells[15].Value = "0";
                                                                this.DGVTinhCong.Rows[_nhanVien].Cells[16].Value = "0";
                                                                this.DGVTinhCong.Rows[_nhanVien].Cells[17].Value = "0";
                                                                this.DGVTinhCong.Rows[_nhanVien].Cells[18].Value = this.sKHVang;
                                                                if (!(DateTimeProgress.XuatIDThu((int)dt.AddDays((double)dem).DayOfWeek) == "0"))
                                                                {
                                                                    this.DGVTinhCong.Rows[_nhanVien].Cells[19].Value = "NT";
                                                                }
                                                                else
                                                                {
                                                                    this.DGVTinhCong.Rows[_nhanVien].Cells[19].Value = "CN";
                                                                }
                                                                this.DGVTinhCong.Rows[_nhanVien].Cells[20].Value = this.sMaChamCong;
                                                                this.DGVTinhCong.Rows[_nhanVien].Cells[21].Value = this.sPhongBanTinhCong;
                                                                break;
                                                                // goto Label53;
                                                            }
                                                        }
                                                      
                                                    Label54:
                                                        this.DGVTinhCong.Rows[_nhanVien].Cells[4].Value = this.sTuDongQuaDemTenCaLamViec;
                                                        dtCaLamViecTuDongQuaDem = new System.Data.DataTable();
                                                        this._caLamViecDTO.MaCaLamViec = this.sTuDongQuaDemMaCaLamViec;
                                                        dtCaLamViecTuDongQuaDem = this._caLamViecBLL.CaLamViecGetByMaCaLamViec(this._caLamViecDTO);
                                                        for (iCaLamViecTuDongQuaDem = 0; iCaLamViecTuDongQuaDem < dtCaLamViecTuDongQuaDem.Rows.Count; iCaLamViecTuDongQuaDem++)
                                                        {
                                                            second = dGioVaoTuDongQuaDem.Second;
                                                            sGiayGioVao = second.ToString();
                                                            second = dGioRaTuDongQuaDem.Second;
                                                            sGiayGioRa = second.ToString();
                                                            dGioVaoKhaiBaoTuDongQuaDemA = Convert.ToDateTime(dtCaLamViecTuDongQuaDem.Rows[iCaLamViecTuDongQuaDem]["GioVaoLamViec"].ToString());
                                                            sGioVaoKhaiBaoTuDongQuaDemA = string.Format("{0:T}", dGioVaoKhaiBaoTuDongQuaDemA).Replace("00 ", string.Concat(sGiayGioVao, " "));
                                                            sGioVaoKhaiBaoTuDongQuaDemB = string.Concat(sNgayCham, " ", sGioVaoKhaiBaoTuDongQuaDemA);
                                                            dGioVaoKhaiBaoTuDongQuaDemB = Convert.ToDateTime(sGioVaoKhaiBaoTuDongQuaDemB);
                                                            dGioRaKhaiBaoTuDongQuaDemA = Convert.ToDateTime(dtCaLamViecTuDongQuaDem.Rows[iCaLamViecTuDongQuaDem]["GioKetThucLamViec"].ToString());
                                                            sGioRaKhaiBaoTuDongQuaDemA = string.Format("{0:T}", dGioRaKhaiBaoTuDongQuaDemA).Replace("00 ", string.Concat(sGiayGioRa, " "));
                                                            sGioRaKhaiBaoTuDongQuaDemB = string.Concat(sNgayCham, " ", sGioRaKhaiBaoTuDongQuaDemA);
                                                            dGioRaKhaiBaoTuDongQuaDemB = Convert.ToDateTime(sGioRaKhaiBaoTuDongQuaDemB);
                                                            sTruGioDiTre = dtCaLamViecTuDongQuaDem.Rows[iCaLamViecTuDongQuaDem]["TruGioDiTre"].ToString();
                                                            sBatDauTinhDiTre = dtCaLamViecTuDongQuaDem.Rows[iCaLamViecTuDongQuaDem]["BatDauTinhDiTre"].ToString();
                                                            iChoPhepDiTre = Convert.ToInt32(dtCaLamViecTuDongQuaDem.Rows[iCaLamViecTuDongQuaDem]["ChoPhepDiTre"].ToString());
                                                            value = dGioVaoTuDongQuaDem - dGioVaoKhaiBaoTuDongQuaDemB;
                                                            second = Convert.ToInt32(value.TotalMinutes);
                                                            sPhutTre = second.ToString();
                                                            if (!(sTruGioDiTre == "True"))
                                                            {
                                                                this.DGVTinhCong.Rows[_nhanVien].Cells[9].Value = "0";
                                                            }
                                                            else if (Convert.ToInt32(sPhutTre) >= 0)
                                                            {
                                                                iPhutTre = Convert.ToInt32(sPhutTre) - iChoPhepDiTre;
                                                                if (sBatDauTinhDiTre == "True")
                                                                {
                                                                    if (iPhutTre >= 1)
                                                                    {
                                                                        this.DGVTinhCong.Rows[_nhanVien].Cells[9].Value = iPhutTre.ToString();
                                                                    }
                                                                    else
                                                                    {
                                                                        this.DGVTinhCong.Rows[_nhanVien].Cells[9].Value = "0";
                                                                    }
                                                                }
                                                                else if (iPhutTre >= 1)
                                                                {
                                                                    this.DGVTinhCong.Rows[_nhanVien].Cells[9].Value = sPhutTre;
                                                                }
                                                                else
                                                                {
                                                                    this.DGVTinhCong.Rows[_nhanVien].Cells[9].Value = "0";
                                                                }
                                                            }
                                                            else
                                                            {
                                                                this.DGVTinhCong.Rows[_nhanVien].Cells[9].Value = "0";
                                                            }
                                                            sTruGioVeSom = dtCaLamViecTuDongQuaDem.Rows[iCaLamViecTuDongQuaDem]["TruGioVeSom"].ToString();
                                                            sBatDauTinhVeSom = dtCaLamViecTuDongQuaDem.Rows[iCaLamViecTuDongQuaDem]["BatDauTinhVeSom"].ToString();
                                                            iChoPhepVeSom = Convert.ToInt32(dtCaLamViecTuDongQuaDem.Rows[iCaLamViecTuDongQuaDem]["ChoPhepVeSom"].ToString());
                                                            value = dGioRaKhaiBaoTuDongQuaDemB - dGioRaTuDongQuaDem;
                                                            second = Convert.ToInt32(value.TotalMinutes);
                                                            sPhutVeSom = second.ToString();
                                                            if (!(sTruGioVeSom == "True"))
                                                            {
                                                                this.DGVTinhCong.Rows[_nhanVien].Cells[10].Value = "0";
                                                            }
                                                            else if (Convert.ToInt32(sPhutVeSom) >= 0)
                                                            {
                                                                iPhutVeSom = Convert.ToInt32(sPhutVeSom) - iChoPhepVeSom;
                                                                if (iPhutVeSom < 1)
                                                                {
                                                                    this.DGVTinhCong.Rows[_nhanVien].Cells[10].Value = "0";
                                                                }
                                                                else if (!(sBatDauTinhVeSom == "True"))
                                                                {
                                                                    this.DGVTinhCong.Rows[_nhanVien].Cells[10].Value = sPhutVeSom;
                                                                }
                                                                else
                                                                {
                                                                    this.DGVTinhCong.Rows[_nhanVien].Cells[10].Value = iPhutVeSom.ToString();
                                                                }
                                                            }
                                                            else
                                                            {
                                                                this.DGVTinhCong.Rows[_nhanVien].Cells[10].Value = "0";
                                                            }
                                                            value = dGioRaTuDongQuaDem - dGioRaKhaiBaoTuDongQuaDemB;
                                                            second = Convert.ToInt32(value.TotalMinutes);
                                                            sVeTre = second.ToString();
                                                            if (Convert.ToInt32(sVeTre) <= 0)
                                                            {
                                                                this.DGVTinhCong.Rows[_nhanVien].Cells[11].Value = "0";
                                                            }
                                                            else
                                                            {
                                                                this.DGVTinhCong.Rows[_nhanVien].Cells[11].Value = sVeTre;
                                                            }
                                                            iPhut = Convert.ToSingle(dtCaLamViecTuDongQuaDem.Rows[iCaLamViecTuDongQuaDem]["TongGioTrongCaLamViec"]) * 60f - (float)(Convert.ToInt32(this.DGVTinhCong.Rows[_nhanVien].Cells[9].Value.ToString()) + Convert.ToInt32(this.DGVTinhCong.Rows[_nhanVien].Cells[10].Value));
                                                            dGio = Math.Round(Convert.ToDouble(iPhut) / 60, this.iLamTronGio);
                                                            this.DGVTinhCong.Rows[_nhanVien].Cells[8].Value = dGio.ToString();
                                                            iGio = Convert.ToDouble(dtCaLamViecTuDongQuaDem.Rows[iCaLamViecTuDongQuaDem]["TongGioTrongCaLamViec"].ToString());
                                                            dCongTinh = Convert.ToDouble(dtCaLamViecTuDongQuaDem.Rows[iCaLamViecTuDongQuaDem]["CongTinh"].ToString());
                                                            dCong = Math.Round(dGio * dCongTinh / iGio, this.iLamTronCong);
                                                            this.DGVTinhCong.Rows[_nhanVien].Cells[7].Value = dCong.ToString();
                                                            value = dGioRaTuDongQuaDem - dGioVaoTuDongQuaDem;
                                                            second = Convert.ToInt32(value.TotalMinutes);
                                                            dTongGioThucTeTuDongQuaDem = Math.Round(Convert.ToDouble(second.ToString()) / 60, this.iLamTronGio);
                                                            this.DGVTinhCong.Rows[_nhanVien].Cells[16].Value = dTongGioThucTeTuDongQuaDem.ToString();
                                                            this.DGVTinhCong.Rows[_nhanVien].Cells[17].Value = dtCaLamViecTuDongQuaDem.Rows[iCaLamViecTuDongQuaDem]["CongTinh"].ToString();
                                                            this.DGVTinhCong.Rows[_nhanVien].Cells[18].Value = this.sKHDungGio;
                                                            sChoPhepTangCaTruocGioLamViecTuDongQuaDem = dtCaLamViecTuDongQuaDem.Rows[iCaLamViecTuDongQuaDem]["TangCaTruocGioLamViec"].ToString();
                                                            iPhutTangCaTruocGioLamViecTuDongQuaDem = Convert.ToInt32(dtCaLamViecTuDongQuaDem.Rows[iCaLamViecTuDongQuaDem]["SoPhutTangCaTruocGioLamViec"].ToString());
                                                            iPhutTangCaTruocGioLamViecDatDen = Convert.ToInt32(dtCaLamViecTuDongQuaDem.Rows[iCaLamViecTuDongQuaDem]["TangCaTruocGioLamViecDatDen"].ToString());
                                                            iPhutTruTangCaTruoc = Convert.ToInt32(dtCaLamViecTuDongQuaDem.Rows[iCaLamViecTuDongQuaDem]["PhutTruTangCaTruoc"].ToString());
                                                            sChoPhepTangCaSauGioLamViecTuDongQuaDem = dtCaLamViecTuDongQuaDem.Rows[iCaLamViecTuDongQuaDem]["TangCaSauGioLamViec"].ToString();
                                                            iPhutTangCaSauGioLamViecTuDongQuaDem = Convert.ToInt32(dtCaLamViecTuDongQuaDem.Rows[iCaLamViecTuDongQuaDem]["SoPhutTangCaSauGioLamViec"].ToString());
                                                            iPhutTangCaSauGioLamViecDatDen = Convert.ToInt32(dtCaLamViecTuDongQuaDem.Rows[iCaLamViecTuDongQuaDem]["TangCaSauGioLamViecDatDen"].ToString());
                                                            iPhutTruTangCaSau = Convert.ToInt32(dtCaLamViecTuDongQuaDem.Rows[iCaLamViecTuDongQuaDem]["PhutTruTangCaSau"].ToString());
                                                            iGioiHanTC1TuDongQuaDem = Convert.ToInt32(dtCaLamViecTuDongQuaDem.Rows[iCaLamViecTuDongQuaDem]["GioiHanTangCa1"].ToString());
                                                            iGioiHanTC2TuDongQuaDem = Convert.ToInt32(dtCaLamViecTuDongQuaDem.Rows[iCaLamViecTuDongQuaDem]["GioiHanTangCa2"].ToString());
                                                            iGioiHanTC3TuDongQuaDem = Convert.ToInt32(dtCaLamViecTuDongQuaDem.Rows[iCaLamViecTuDongQuaDem]["GioiHanTangCa3"].ToString());
                                                            iGioiHanTC4TuDongQuaDem = Convert.ToInt32(dtCaLamViecTuDongQuaDem.Rows[iCaLamViecTuDongQuaDem]["GioiHanTangCa4"].ToString());
                                                            iTongGioTangCaSauTuDongQuaDem = 0;
                                                            iTongGioTangCaTruocTuDongQuaDem = 0;
                                                            if ((sChoPhepTangCaTruocGioLamViecTuDongQuaDem != "False" ? true : !(sChoPhepTangCaSauGioLamViecTuDongQuaDem == "False")))
                                                            {
                                                                if (sChoPhepTangCaTruocGioLamViecTuDongQuaDem == "True")
                                                                {
                                                                    value = dGioVaoKhaiBaoTuDongQuaDemB - dGioVaoTuDongQuaDem;
                                                                    second = Convert.ToInt32(value.TotalMinutes);
                                                                    iThoiGianTruocGioLamTuDongQuaDem = Convert.ToInt32(second.ToString());
                                                                    if (iThoiGianTruocGioLamTuDongQuaDem > 0)
                                                                    {
                                                                        if (iThoiGianTruocGioLamTuDongQuaDem > iPhutTangCaTruocGioLamViecTuDongQuaDem)
                                                                        {
                                                                            if (iThoiGianTruocGioLamTuDongQuaDem > iPhutTangCaTruocGioLamViecDatDen)
                                                                            {
                                                                                iTongGioTangCaTruocTuDongQuaDem = iThoiGianTruocGioLamTuDongQuaDem - iPhutTruTangCaTruoc;
                                                                            }
                                                                        }
                                                                    }
                                                                }
                                                                if (sChoPhepTangCaSauGioLamViecTuDongQuaDem == "True")
                                                                {
                                                                    value = dGioRaTuDongQuaDem - dGioRaKhaiBaoTuDongQuaDemB;
                                                                    second = Convert.ToInt32(value.TotalMinutes);
                                                                    iThoiGianSauGioLamViecTuDongQuaDem = Convert.ToInt32(second.ToString());
                                                                    if (iThoiGianSauGioLamViecTuDongQuaDem > 0)
                                                                    {
                                                                        if (iThoiGianSauGioLamViecTuDongQuaDem > iPhutTangCaSauGioLamViecTuDongQuaDem)
                                                                        {
                                                                            if (iThoiGianSauGioLamViecTuDongQuaDem > iPhutTangCaSauGioLamViecDatDen)
                                                                            {
                                                                                iTongGioTangCaSauTuDongQuaDem = iThoiGianSauGioLamViecTuDongQuaDem - iPhutTruTangCaSau;
                                                                            }
                                                                        }
                                                                    }
                                                                }
                                                            }
                                                            else
                                                            {
                                                                this.DGVTinhCong.Rows[_nhanVien].Cells[12].Value = "0";
                                                                this.DGVTinhCong.Rows[_nhanVien].Cells[13].Value = "0";
                                                                this.DGVTinhCong.Rows[_nhanVien].Cells[14].Value = "0";
                                                                this.DGVTinhCong.Rows[_nhanVien].Cells[15].Value = "0";
                                                            }
                                                            dTongThoiGianTangCaTuDongQuaDem = Convert.ToDouble(iTongGioTangCaTruocTuDongQuaDem + iTongGioTangCaSauTuDongQuaDem);
                                                            if (dTongThoiGianTangCaTuDongQuaDem <= 0)
                                                            {
                                                                this.DGVTinhCong.Rows[_nhanVien].Cells[12].Value = "0";
                                                                this.DGVTinhCong.Rows[_nhanVien].Cells[13].Value = "0";
                                                                this.DGVTinhCong.Rows[_nhanVien].Cells[14].Value = "0";
                                                                this.DGVTinhCong.Rows[_nhanVien].Cells[15].Value = "0";
                                                            }
                                                            else
                                                            {
                                                                if (iGioiHanTC1TuDongQuaDem == 0)
                                                                {
                                                                    this.DGVTinhCong.Rows[_nhanVien].Cells[12].Value = Math.Round(dTongThoiGianTangCaTuDongQuaDem * this.dTangCa1HeSo / 60, this.iLamTronGio);
                                                                    this.DGVTinhCong.Rows[_nhanVien].Cells[13].Value = "0";
                                                                    this.DGVTinhCong.Rows[_nhanVien].Cells[14].Value = "0";
                                                                    this.DGVTinhCong.Rows[_nhanVien].Cells[15].Value = "0";
                                                                }
                                                                if ((iGioiHanTC1TuDongQuaDem == 0 ? false : iGioiHanTC2TuDongQuaDem == 0))
                                                                {
                                                                    if (dTongThoiGianTangCaTuDongQuaDem >= Convert.ToDouble(iGioiHanTC1TuDongQuaDem))
                                                                    {
                                                                        this.DGVTinhCong.Rows[_nhanVien].Cells[12].Value = Math.Round(Convert.ToDouble(iGioiHanTC1TuDongQuaDem) / 60 * this.dTangCa1HeSo, this.iLamTronGio);
                                                                        if (dTongThoiGianTangCaTuDongQuaDem - Convert.ToDouble(iGioiHanTC1TuDongQuaDem) > 0)
                                                                        {
                                                                            this.DGVTinhCong.Rows[_nhanVien].Cells[13].Value = Math.Round((dTongThoiGianTangCaTuDongQuaDem - Convert.ToDouble(iGioiHanTC1TuDongQuaDem)) * this.dTangCa2HeSo / 60, this.iLamTronGio);
                                                                        }
                                                                        this.DGVTinhCong.Rows[_nhanVien].Cells[14].Value = "0";
                                                                        this.DGVTinhCong.Rows[_nhanVien].Cells[15].Value = "0";
                                                                    }
                                                                    else
                                                                    {
                                                                        this.DGVTinhCong.Rows[_nhanVien].Cells[12].Value = Math.Round(dTongThoiGianTangCaTuDongQuaDem * this.dTangCa1HeSo / 60, this.iLamTronGio);
                                                                        this.DGVTinhCong.Rows[_nhanVien].Cells[13].Value = "0";
                                                                        this.DGVTinhCong.Rows[_nhanVien].Cells[14].Value = "0";
                                                                        this.DGVTinhCong.Rows[_nhanVien].Cells[15].Value = "0";
                                                                    }
                                                                }
                                                                if ((iGioiHanTC1TuDongQuaDem == 0 || iGioiHanTC2TuDongQuaDem == 0 ? false : iGioiHanTC3TuDongQuaDem == 0))
                                                                {
                                                                    if (dTongThoiGianTangCaTuDongQuaDem >= Convert.ToDouble(iGioiHanTC1TuDongQuaDem))
                                                                    {
                                                                        this.DGVTinhCong.Rows[_nhanVien].Cells[12].Value = Math.Round(Convert.ToDouble(iGioiHanTC1TuDongQuaDem) * this.dTangCa1HeSo / 60, this.iLamTronGio);
                                                                        if (dTongThoiGianTangCaTuDongQuaDem - Convert.ToDouble(iGioiHanTC1TuDongQuaDem) >= Convert.ToDouble(iGioiHanTC2TuDongQuaDem))
                                                                        {
                                                                            this.DGVTinhCong.Rows[_nhanVien].Cells[12].Value = Math.Round(Convert.ToDouble(iGioiHanTC1TuDongQuaDem) * this.dTangCa1HeSo / 60, this.iLamTronGio);
                                                                            this.DGVTinhCong.Rows[_nhanVien].Cells[13].Value = Math.Round(Convert.ToDouble(iGioiHanTC2TuDongQuaDem) * this.dTangCa2HeSo / 60, this.iLamTronGio);
                                                                            this.DGVTinhCong.Rows[_nhanVien].Cells[14].Value = Math.Round((dTongThoiGianTangCaTuDongQuaDem - Convert.ToDouble(iGioiHanTC1TuDongQuaDem) - Convert.ToDouble(iGioiHanTC2TuDongQuaDem)) * this.dTangCa3HeSo / 60, this.iLamTronGio);
                                                                            this.DGVTinhCong.Rows[_nhanVien].Cells[15].Value = "0";
                                                                        }
                                                                        else
                                                                        {
                                                                            this.DGVTinhCong.Rows[_nhanVien].Cells[13].Value = Math.Round((dTongThoiGianTangCaTuDongQuaDem - Convert.ToDouble(iGioiHanTC1TuDongQuaDem)) * this.dTangCa2HeSo / 60, this.iLamTronGio);
                                                                            this.DGVTinhCong.Rows[_nhanVien].Cells[14].Value = "0";
                                                                            this.DGVTinhCong.Rows[_nhanVien].Cells[15].Value = "0";
                                                                        }
                                                                    }
                                                                    else
                                                                    {
                                                                        this.DGVTinhCong.Rows[_nhanVien].Cells[12].Value = Math.Round(dTongThoiGianTangCaTuDongQuaDem * this.dTangCa1HeSo / 60, this.iLamTronGio);
                                                                        this.DGVTinhCong.Rows[_nhanVien].Cells[13].Value = "0";
                                                                        this.DGVTinhCong.Rows[_nhanVien].Cells[14].Value = "0";
                                                                        this.DGVTinhCong.Rows[_nhanVien].Cells[15].Value = "0";
                                                                    }
                                                                }
                                                                if ((iGioiHanTC1TuDongQuaDem == 0 || iGioiHanTC2TuDongQuaDem == 0 || iGioiHanTC3TuDongQuaDem == 0 ? false : iGioiHanTC4TuDongQuaDem == 0))
                                                                {
                                                                }
                                                            }
                                                        }
                                                        if (!(DateTimeProgress.XuatIDThu((int)dt.AddDays((double)dem).DayOfWeek) == "0"))
                                                        {
                                                            this.DGVTinhCong.Rows[_nhanVien].Cells[19].Value = "NT";
                                                        }
                                                        else
                                                        {
                                                            this.DGVTinhCong.Rows[_nhanVien].Cells[19].Value = "CN";
                                                        }
                                                        this.DGVTinhCong.Rows[_nhanVien].Cells[20].Value = this.sMaChamCong;
                                                        this.DGVTinhCong.Rows[_nhanVien].Cells[21].Value = this.sPhongBanTinhCong;
                                                    }
                                                    break;
                                               // Label53:; 
                                                }

                                                // ket thuc tdemTuDongQuaDem == 2

                                      
                                                if ((demTuDongQuaDem % 2 == 0 ? false : demTuDongQuaDem != 1))
                                                {
                                                    addTuDongQuaDemB = this.DGVTinhCong.Rows.Add();
                                                    dGioVaoTuDongQuaDem = Convert.ToDateTime(dtTuDongQuaDem.Rows[iTuDongQuaDem]["GioCham"].ToString());
                                                    this.DGVTinhCong.Rows[addTuDongQuaDemB].Cells[5].Value = string.Format(this.sDinhDangThoiGian, dGioVaoTuDongQuaDem);
                                                    this.DGVTinhCong.Rows[addTuDongQuaDemB].Cells[0].Value = this.sMaNhanVien;
                                                    this.DGVTinhCong.Rows[addTuDongQuaDemB].Cells[1].Value = this.sTenNhanVien;
                                                    this.DGVTinhCong.Rows[addTuDongQuaDemB].Cells[2].Value = this.DGVTinhCong.Rows[_nhanVien].Cells[2].Value.ToString();
                                                    if (this.iNgonNgu == 0)
                                                    {
                                                        DataGridViewCell item21 = this.DGVTinhCong.Rows[addTuDongQuaDemB].Cells[3];
                                                        dateTime = dt.AddDays((double)dem);
                                                        item21.Value = DateTimeProgress.XuatThuTinhCong((int)dateTime.DayOfWeek);
                                                    }
                                                    if (this.iNgonNgu == 1)
                                                    {
                                                        DataGridViewCell dataGridViewCell21 = this.DGVTinhCong.Rows[addTuDongQuaDemB].Cells[3];
                                                        dateTime = dt.AddDays((double)dem);
                                                        dataGridViewCell21.Value = DateTimeProgress.XuatThuEnglish((int)dateTime.DayOfWeek);
                                                    }
                                                    this.DGVTinhCong.Rows[addTuDongQuaDemB].Cells[4].Value = "***";
                                                    this.DGVTinhCong.Rows[addTuDongQuaDemB].Cells[7].Value = "0";
                                                    this.DGVTinhCong.Rows[addTuDongQuaDemB].Cells[8].Value = "0";
                                                    this.DGVTinhCong.Rows[addTuDongQuaDemB].Cells[9].Value = "0";
                                                    this.DGVTinhCong.Rows[addTuDongQuaDemB].Cells[10].Value = "0";
                                                    this.DGVTinhCong.Rows[addTuDongQuaDemB].Cells[11].Value = "0";
                                                    this.DGVTinhCong.Rows[addTuDongQuaDemB].Cells[12].Value = "0";
                                                    this.DGVTinhCong.Rows[addTuDongQuaDemB].Cells[13].Value = "0";
                                                    this.DGVTinhCong.Rows[addTuDongQuaDemB].Cells[14].Value = "0";
                                                    this.DGVTinhCong.Rows[addTuDongQuaDemB].Cells[15].Value = "0";
                                                    this.DGVTinhCong.Rows[addTuDongQuaDemB].Cells[16].Value = "0";
                                                    this.DGVTinhCong.Rows[addTuDongQuaDemB].Cells[17].Value = "0";
                                                    this.DGVTinhCong.Rows[addTuDongQuaDemB].Cells[18].Value = this.sKHVang;
                                                    if (!(DateTimeProgress.XuatIDThu((int)dt.AddDays((double)dem).DayOfWeek) == "0"))
                                                    {
                                                        this.DGVTinhCong.Rows[addTuDongQuaDemB].Cells[19].Value = "NT";
                                                    }
                                                    else
                                                    {
                                                        this.DGVTinhCong.Rows[addTuDongQuaDemB].Cells[19].Value = "CN";
                                                    }
                                                    this.DGVTinhCong.Rows[addTuDongQuaDemB].Cells[20].Value = this.sMaChamCong;
                                                    this.DGVTinhCong.Rows[addTuDongQuaDemB].Cells[21].Value = this.sPhongBanTinhCong;
                                                }

                                                // ket thuc


                                                if ((demTuDongQuaDem % 2 != 0 ? false : demTuDongQuaDem != 2))
                                                {
                                                    dGioRaTuDongQuaDem = Convert.ToDateTime(dtTuDongQuaDem.Rows[iTuDongQuaDem]["GioCham"].ToString());
                                                    this.DGVTinhCong.Rows[addTuDongQuaDemB].Cells[6].Value = string.Format(this.sDinhDangThoiGian, dGioRaTuDongQuaDem);
                                                    dtNhanCaTuDongQuaDem = new System.Data.DataTable();
                                                    this._chiTietLichTrinhChoCalamViecDTO.MaLichTrinhCaLamViec = sLTCCLVNhanVien;
                                                    this._chiTietLichTrinhChoCalamViecDTO.Thu = sThu;
                                                    dtNhanCaTuDongQuaDem = this._chiTietLichTrinhChoCaLamViecBLL.ChiTietLichTrinhChoCaLamViecNhanCa(this._chiTietLichTrinhChoCalamViecDTO);
                                                    iChiTietLichTrinhChoCaLamViecTuDongQuaDem = 0;
                                                    if (iChiTietLichTrinhChoCaLamViecTuDongQuaDem < dtNhanCaTuDongQuaDem.Rows.Count)
                                                    {
                                                        cellChiTietLichTrinhChoCaLamViecTuDongQuaDem = 3;
                                                        while (cellChiTietLichTrinhChoCaLamViecTuDongQuaDem < 13)
                                                        {
                                                            kiemTraVao = 0;
                                                            kiemTraRa = 0;
                                                            this.sTuDongQuaDemMaCaLamViec = dtNhanCaTuDongQuaDem.Rows[iChiTietLichTrinhChoCaLamViecTuDongQuaDem][cellChiTietLichTrinhChoCaLamViecTuDongQuaDem].ToString();
                                                            dtTuDongQuaDemCa = new System.Data.DataTable();
                                                            this._caLamViecDTO.MaCaLamViec = this.sTuDongQuaDemMaCaLamViec;
                                                            dtTuDongQuaDemCa = this._caLamViecBLL.CaLamViecGetByMaCaLamViec(this._caLamViecDTO);
                                                            iTuDongQuaDemCa = 0;
                                                            while (iTuDongQuaDemCa < dtTuDongQuaDemCa.Rows.Count)
                                                            {
                                                                second = dGioVaoTuDongQuaDem.Second;
                                                                sGiayGioVao = second.ToString();
                                                                second = dGioRaTuDongQuaDem.Second;
                                                                sGiayGioRa = second.ToString();
                                                                this.sTuDongQuaDemTenCaLamViec = dtTuDongQuaDemCa.Rows[iTuDongQuaDemCa]["CaLamViec"].ToString();
                                                                dBatDauVaoA = Convert.ToDateTime(dtTuDongQuaDemCa.Rows[iTuDongQuaDemCa]["BatDauVao"].ToString());
                                                                sBatDauVaoA = string.Format("{0:T}", dBatDauVaoA).Replace("00 ", string.Concat(sGiayGioVao, " "));
                                                                sBatDauVaoB = string.Concat(sNgayCham, " ", sBatDauVaoA);
                                                                dBatDauVaoB = Convert.ToDateTime(sBatDauVaoB);
                                                                dKetThucVaoA = Convert.ToDateTime(dtTuDongQuaDemCa.Rows[iTuDongQuaDemCa]["KetThucVao"].ToString());
                                                                sKetThucVaoA = string.Format("{0:T}", dKetThucVaoA).Replace("00 ", string.Concat(sGiayGioVao, " "));
                                                                sKetThucVaoB = string.Concat(sNgayCham, " ", sKetThucVaoA);
                                                                dKetThucVaoB = Convert.ToDateTime(sKetThucVaoB);
                                                                dBatDauRaA = Convert.ToDateTime(dtTuDongQuaDemCa.Rows[iTuDongQuaDemCa]["BatDauRa"].ToString());
                                                                sBatDauRaA = string.Format("{0:T}", dBatDauRaA).Replace("00 ", string.Concat(sGiayGioRa, " "));
                                                                sBatDauRaB = string.Concat(sNgayCham, " ", sBatDauRaA);
                                                                dBatDauRaB = Convert.ToDateTime(sBatDauRaB);
                                                                dKetThucRaA = Convert.ToDateTime(dtTuDongQuaDemCa.Rows[iTuDongQuaDemCa]["KetThucRa"].ToString());
                                                                sKetThucRaA = string.Format("{0:T}", dKetThucRaA).Replace("00 ", string.Concat(sGiayGioRa, " "));
                                                                sKetThucRaB = string.Concat(sNgayCham, " ", sKetThucRaA);
                                                                dKetThucRaB = Convert.ToDateTime(sKetThucRaB);
                                                                if ((dGioVaoTuDongQuaDem < dBatDauVaoB ? false : dGioVaoTuDongQuaDem <= dKetThucVaoB))
                                                                {
                                                                    kiemTraVao++;
                                                                }
                                                                if ((dGioRaTuDongQuaDem < dBatDauRaB ? false : dGioRaTuDongQuaDem <= dKetThucRaB))
                                                                {
                                                                    kiemTraRa++;
                                                                }
                                                                if ((kiemTraVao != 1 ? true : kiemTraRa != 1))
                                                                {
                                                                    iTuDongQuaDemCa++;
                                                                }
                                                                else
                                                                {
                                                                    goto Label56;
                                                                }
                                                            }


                                                            // end wwhile
                                                            if (!(this.sTuDongQuaDemMaCaLamViec == ""))
                                                            {
                                                                cellChiTietLichTrinhChoCaLamViecTuDongQuaDem++;
                                                            }
                                                            else
                                                            {
                                                                this.DGVTinhCong.Rows[addTuDongQuaDemB].Cells[4].Value = "***";
                                                                this.DGVTinhCong.Rows[addTuDongQuaDemB].Cells[7].Value = "0";
                                                                this.DGVTinhCong.Rows[addTuDongQuaDemB].Cells[8].Value = "0";
                                                                this.DGVTinhCong.Rows[addTuDongQuaDemB].Cells[9].Value = "0";
                                                                this.DGVTinhCong.Rows[addTuDongQuaDemB].Cells[10].Value = "0";
                                                                this.DGVTinhCong.Rows[addTuDongQuaDemB].Cells[11].Value = "0";
                                                                this.DGVTinhCong.Rows[addTuDongQuaDemB].Cells[12].Value = "0";
                                                                this.DGVTinhCong.Rows[addTuDongQuaDemB].Cells[13].Value = "0";
                                                                this.DGVTinhCong.Rows[addTuDongQuaDemB].Cells[14].Value = "0";
                                                                this.DGVTinhCong.Rows[addTuDongQuaDemB].Cells[15].Value = "0";
                                                                this.DGVTinhCong.Rows[addTuDongQuaDemB].Cells[16].Value = "0";
                                                                this.DGVTinhCong.Rows[addTuDongQuaDemB].Cells[17].Value = "0";
                                                                this.DGVTinhCong.Rows[addTuDongQuaDemB].Cells[18].Value = this.sKHVang;
                                                                if (!(DateTimeProgress.XuatIDThu((int)dt.AddDays((double)dem).DayOfWeek) == "0"))
                                                                {
                                                                    this.DGVTinhCong.Rows[addTuDongQuaDemB].Cells[19].Value = "NT";
                                                                }
                                                                else
                                                                {
                                                                    this.DGVTinhCong.Rows[addTuDongQuaDemB].Cells[19].Value = "CN";
                                                                }
                                                                this.DGVTinhCong.Rows[addTuDongQuaDemB].Cells[20].Value = this.sMaChamCong;
                                                                this.DGVTinhCong.Rows[addTuDongQuaDemB].Cells[21].Value = this.sPhongBanTinhCong;
                                                            //  tu break;
                                                            }
                                                        }

                                                        // end while
                                                  
                                                    Label56:
                                                        this.DGVTinhCong.Rows[addTuDongQuaDemB].Cells[4].Value = this.sTuDongQuaDemTenCaLamViec;
                                                        dtCaLamViecTuDongQuaDem = new System.Data.DataTable();
                                                        this._caLamViecDTO.MaCaLamViec = this.sTuDongQuaDemMaCaLamViec;
                                                        dtCaLamViecTuDongQuaDem = this._caLamViecBLL.CaLamViecGetByMaCaLamViec(this._caLamViecDTO);
                                                        for (iCaLamViecTuDongQuaDem = 0; iCaLamViecTuDongQuaDem < dtCaLamViecTuDongQuaDem.Rows.Count; iCaLamViecTuDongQuaDem++)
                                                        {
                                                            second = dGioVaoTuDongQuaDem.Second;
                                                            sGiayGioVao = second.ToString();
                                                            second = dGioRaTuDongQuaDem.Second;
                                                            sGiayGioRa = second.ToString();
                                                            dGioVaoKhaiBaoTuDongQuaDemA = Convert.ToDateTime(dtCaLamViecTuDongQuaDem.Rows[iCaLamViecTuDongQuaDem]["GioVaoLamViec"].ToString());
                                                            sGioVaoKhaiBaoTuDongQuaDemA = string.Format("{0:T}", dGioVaoKhaiBaoTuDongQuaDemA).Replace("00 ", string.Concat(sGiayGioVao, " "));
                                                            sGioVaoKhaiBaoTuDongQuaDemB = string.Concat(sNgayCham, " ", sGioVaoKhaiBaoTuDongQuaDemA);
                                                            dGioVaoKhaiBaoTuDongQuaDemB = Convert.ToDateTime(sGioVaoKhaiBaoTuDongQuaDemB);
                                                            dGioRaKhaiBaoTuDongQuaDemA = Convert.ToDateTime(dtCaLamViecTuDongQuaDem.Rows[iCaLamViecTuDongQuaDem]["GioKetThucLamViec"].ToString());
                                                            sGioRaKhaiBaoTuDongQuaDemA = string.Format("{0:T}", dGioRaKhaiBaoTuDongQuaDemA).Replace("00 ", string.Concat(sGiayGioRa, " "));
                                                            sGioRaKhaiBaoTuDongQuaDemB = string.Concat(sNgayCham, " ", sGioRaKhaiBaoTuDongQuaDemA);
                                                            dGioRaKhaiBaoTuDongQuaDemB = Convert.ToDateTime(sGioRaKhaiBaoTuDongQuaDemB);
                                                            sTruGioDiTre = dtCaLamViecTuDongQuaDem.Rows[iCaLamViecTuDongQuaDem]["TruGioDiTre"].ToString();
                                                            sBatDauTinhDiTre = dtCaLamViecTuDongQuaDem.Rows[iCaLamViecTuDongQuaDem]["BatDauTinhDiTre"].ToString();
                                                            iChoPhepDiTre = Convert.ToInt32(dtCaLamViecTuDongQuaDem.Rows[iCaLamViecTuDongQuaDem]["ChoPhepDiTre"].ToString());
                                                            value = dGioVaoTuDongQuaDem - dGioVaoKhaiBaoTuDongQuaDemB;
                                                            second = Convert.ToInt32(value.TotalMinutes);
                                                            sPhutTre = second.ToString();
                                                            if (!(sTruGioDiTre == "True"))
                                                            {
                                                                this.DGVTinhCong.Rows[addTuDongQuaDemB].Cells[9].Value = "0";
                                                            }
                                                            else if (Convert.ToInt32(sPhutTre) >= 0)
                                                            {
                                                                iPhutTre = Convert.ToInt32(sPhutTre) - iChoPhepDiTre;
                                                                if (sBatDauTinhDiTre == "True")
                                                                {
                                                                    if (iPhutTre >= 1)
                                                                    {
                                                                        this.DGVTinhCong.Rows[addTuDongQuaDemB].Cells[9].Value = iPhutTre.ToString();
                                                                    }
                                                                    else
                                                                    {
                                                                        this.DGVTinhCong.Rows[addTuDongQuaDemB].Cells[9].Value = "0";
                                                                    }
                                                                }
                                                                else if (iPhutTre >= 1)
                                                                {
                                                                    this.DGVTinhCong.Rows[addTuDongQuaDemB].Cells[9].Value = sPhutTre;
                                                                }
                                                                else
                                                                {
                                                                    this.DGVTinhCong.Rows[addTuDongQuaDemB].Cells[9].Value = "0";
                                                                }
                                                            }
                                                            else
                                                            {
                                                                this.DGVTinhCong.Rows[addTuDongQuaDemB].Cells[9].Value = "0";
                                                            }
                                                            sTruGioVeSom = dtCaLamViecTuDongQuaDem.Rows[iCaLamViecTuDongQuaDem]["TruGioVeSom"].ToString();
                                                            sBatDauTinhVeSom = dtCaLamViecTuDongQuaDem.Rows[iCaLamViecTuDongQuaDem]["BatDauTinhVeSom"].ToString();
                                                            iChoPhepVeSom = Convert.ToInt32(dtCaLamViecTuDongQuaDem.Rows[iCaLamViecTuDongQuaDem]["ChoPhepVeSom"].ToString());
                                                            value = dGioRaKhaiBaoTuDongQuaDemB - dGioRaTuDongQuaDem;
                                                            second = Convert.ToInt32(value.TotalMinutes);
                                                            sPhutVeSom = second.ToString();
                                                            if (!(sTruGioVeSom == "True"))
                                                            {
                                                                this.DGVTinhCong.Rows[addTuDongQuaDemB].Cells[10].Value = "0";
                                                            }
                                                            else if (Convert.ToInt32(sPhutVeSom) >= 0)
                                                            {
                                                                iPhutVeSom = Convert.ToInt32(sPhutVeSom) - iChoPhepVeSom;
                                                                if (iPhutVeSom < 1)
                                                                {
                                                                    this.DGVTinhCong.Rows[addTuDongQuaDemB].Cells[10].Value = "0";
                                                                }
                                                                else if (!(sBatDauTinhVeSom == "True"))
                                                                {
                                                                    this.DGVTinhCong.Rows[addTuDongQuaDemB].Cells[10].Value = sPhutVeSom;
                                                                }
                                                                else
                                                                {
                                                                    this.DGVTinhCong.Rows[addTuDongQuaDemB].Cells[10].Value = iPhutVeSom.ToString();
                                                                }
                                                            }
                                                            else
                                                            {
                                                                this.DGVTinhCong.Rows[addTuDongQuaDemB].Cells[10].Value = "0";
                                                            }
                                                            value = dGioRaTuDongQuaDem - dGioRaKhaiBaoTuDongQuaDemB;
                                                            second = Convert.ToInt32(value.TotalMinutes);
                                                            sVeTre = second.ToString();
                                                            if (Convert.ToInt32(sVeTre) <= 0)
                                                            {
                                                                this.DGVTinhCong.Rows[addTuDongQuaDemB].Cells[11].Value = "0";
                                                            }
                                                            else
                                                            {
                                                                this.DGVTinhCong.Rows[addTuDongQuaDemB].Cells[11].Value = sVeTre;
                                                            }
                                                            iPhut = Convert.ToSingle(dtCaLamViecTuDongQuaDem.Rows[iCaLamViecTuDongQuaDem]["TongGioTrongCaLamViec"]) * 60f - (float)(Convert.ToInt32(this.DGVTinhCong.Rows[addTuDongQuaDemB].Cells[9].Value.ToString()) + Convert.ToInt32(this.DGVTinhCong.Rows[addTuDongQuaDemB].Cells[10].Value));
                                                            dGio = Math.Round(Convert.ToDouble(iPhut) / 60, this.iLamTronGio);
                                                            this.DGVTinhCong.Rows[addTuDongQuaDemB].Cells[8].Value = dGio.ToString();
                                                            iGio = Convert.ToDouble(dtCaLamViecTuDongQuaDem.Rows[iCaLamViecTuDongQuaDem]["TongGioTrongCaLamViec"].ToString());
                                                            dCongTinh = Convert.ToDouble(dtCaLamViecTuDongQuaDem.Rows[iCaLamViecTuDongQuaDem]["CongTinh"].ToString());
                                                            dCong = Math.Round(dGio * dCongTinh / iGio, this.iLamTronCong);
                                                            this.DGVTinhCong.Rows[addTuDongQuaDemB].Cells[7].Value = dCong.ToString();
                                                            value = dGioRaTuDongQuaDem - dGioVaoTuDongQuaDem;
                                                            second = Convert.ToInt32(value.TotalMinutes);
                                                            dTongGioThucTeTuDongQuaDem = Math.Round(Convert.ToDouble(second.ToString()) / 60, this.iLamTronGio);
                                                            this.DGVTinhCong.Rows[addTuDongQuaDemB].Cells[16].Value = dTongGioThucTeTuDongQuaDem.ToString();
                                                            this.DGVTinhCong.Rows[addTuDongQuaDemB].Cells[17].Value = dtCaLamViecTuDongQuaDem.Rows[iCaLamViecTuDongQuaDem]["CongTinh"].ToString();
                                                            this.DGVTinhCong.Rows[addTuDongQuaDemB].Cells[18].Value = this.sKHDungGio;
                                                            sChoPhepTangCaTruocGioLamViecTuDongQuaDem = dtCaLamViecTuDongQuaDem.Rows[iCaLamViecTuDongQuaDem]["TangCaTruocGioLamViec"].ToString();
                                                            iPhutTangCaTruocGioLamViecTuDongQuaDem = Convert.ToInt32(dtCaLamViecTuDongQuaDem.Rows[iCaLamViecTuDongQuaDem]["SoPhutTangCaTruocGioLamViec"].ToString());
                                                            iPhutTangCaTruocGioLamViecDatDen = Convert.ToInt32(dtCaLamViecTuDongQuaDem.Rows[iCaLamViecTuDongQuaDem]["TangCaTruocGioLamViecDatDen"].ToString());
                                                            iPhutTruTangCaTruoc = Convert.ToInt32(dtCaLamViecTuDongQuaDem.Rows[iCaLamViecTuDongQuaDem]["PhutTruTangCaTruoc"].ToString());
                                                            sChoPhepTangCaSauGioLamViecTuDongQuaDem = dtCaLamViecTuDongQuaDem.Rows[iCaLamViecTuDongQuaDem]["TangCaSauGioLamViec"].ToString();
                                                            iPhutTangCaSauGioLamViecTuDongQuaDem = Convert.ToInt32(dtCaLamViecTuDongQuaDem.Rows[iCaLamViecTuDongQuaDem]["SoPhutTangCaSauGioLamViec"].ToString());
                                                            iPhutTangCaSauGioLamViecDatDen = Convert.ToInt32(dtCaLamViecTuDongQuaDem.Rows[iCaLamViecTuDongQuaDem]["TangCaSauGioLamViecDatDen"].ToString());
                                                            iPhutTruTangCaSau = Convert.ToInt32(dtCaLamViecTuDongQuaDem.Rows[iCaLamViecTuDongQuaDem]["PhutTruTangCaSau"].ToString());
                                                            iGioiHanTC1TuDongQuaDem = Convert.ToInt32(dtCaLamViecTuDongQuaDem.Rows[iCaLamViecTuDongQuaDem]["GioiHanTangCa1"].ToString());
                                                            iGioiHanTC2TuDongQuaDem = Convert.ToInt32(dtCaLamViecTuDongQuaDem.Rows[iCaLamViecTuDongQuaDem]["GioiHanTangCa2"].ToString());
                                                            iGioiHanTC3TuDongQuaDem = Convert.ToInt32(dtCaLamViecTuDongQuaDem.Rows[iCaLamViecTuDongQuaDem]["GioiHanTangCa3"].ToString());
                                                            iGioiHanTC4TuDongQuaDem = Convert.ToInt32(dtCaLamViecTuDongQuaDem.Rows[iCaLamViecTuDongQuaDem]["GioiHanTangCa4"].ToString());
                                                            iTongGioTangCaSauTuDongQuaDem = 0;
                                                            iTongGioTangCaTruocTuDongQuaDem = 0;
                                                            if ((sChoPhepTangCaTruocGioLamViecTuDongQuaDem != "False" ? true : !(sChoPhepTangCaSauGioLamViecTuDongQuaDem == "False")))
                                                            {
                                                                if (sChoPhepTangCaTruocGioLamViecTuDongQuaDem == "True")
                                                                {
                                                                    value = dGioVaoKhaiBaoTuDongQuaDemB - dGioVaoTuDongQuaDem;
                                                                    second = Convert.ToInt32(value.TotalMinutes);
                                                                    iThoiGianTruocGioLamTuDongQuaDem = Convert.ToInt32(second.ToString());
                                                                    if (iThoiGianTruocGioLamTuDongQuaDem > 0)
                                                                    {
                                                                        if (iThoiGianTruocGioLamTuDongQuaDem > iPhutTangCaTruocGioLamViecTuDongQuaDem)
                                                                        {
                                                                            if (iThoiGianTruocGioLamTuDongQuaDem > iPhutTangCaTruocGioLamViecDatDen)
                                                                            {
                                                                                iTongGioTangCaTruocTuDongQuaDem = iThoiGianTruocGioLamTuDongQuaDem - iPhutTruTangCaTruoc;
                                                                            }
                                                                        }
                                                                    }
                                                                }
                                                                if (sChoPhepTangCaSauGioLamViecTuDongQuaDem == "True")
                                                                {
                                                                    value = dGioRaTuDongQuaDem - dGioRaKhaiBaoTuDongQuaDemB;
                                                                    second = Convert.ToInt32(value.TotalMinutes);
                                                                    iThoiGianSauGioLamViecTuDongQuaDem = Convert.ToInt32(second.ToString());
                                                                    if (iThoiGianSauGioLamViecTuDongQuaDem > 0)
                                                                    {
                                                                        if (iThoiGianSauGioLamViecTuDongQuaDem > iPhutTangCaSauGioLamViecTuDongQuaDem)
                                                                        {
                                                                            if (iThoiGianSauGioLamViecTuDongQuaDem > iPhutTangCaSauGioLamViecDatDen)
                                                                            {
                                                                                iTongGioTangCaSauTuDongQuaDem = iThoiGianSauGioLamViecTuDongQuaDem - iPhutTruTangCaSau;
                                                                            }
                                                                        }
                                                                    }
                                                                }
                                                            }
                                                            else
                                                            {
                                                                this.DGVTinhCong.Rows[addTuDongQuaDemB].Cells[12].Value = "0";
                                                                this.DGVTinhCong.Rows[addTuDongQuaDemB].Cells[13].Value = "0";
                                                                this.DGVTinhCong.Rows[addTuDongQuaDemB].Cells[14].Value = "0";
                                                                this.DGVTinhCong.Rows[addTuDongQuaDemB].Cells[15].Value = "0";
                                                            }
                                                            dTongThoiGianTangCaTuDongQuaDem = Convert.ToDouble(iTongGioTangCaTruocTuDongQuaDem + iTongGioTangCaSauTuDongQuaDem);
                                                            if (dTongThoiGianTangCaTuDongQuaDem <= 0)
                                                            {
                                                                this.DGVTinhCong.Rows[addTuDongQuaDemB].Cells[12].Value = "0";
                                                                this.DGVTinhCong.Rows[addTuDongQuaDemB].Cells[13].Value = "0";
                                                                this.DGVTinhCong.Rows[addTuDongQuaDemB].Cells[14].Value = "0";
                                                                this.DGVTinhCong.Rows[addTuDongQuaDemB].Cells[15].Value = "0";
                                                            }
                                                            else
                                                            {
                                                                if (iGioiHanTC1TuDongQuaDem == 0)
                                                                {
                                                                    this.DGVTinhCong.Rows[addTuDongQuaDemB].Cells[12].Value = Math.Round(dTongThoiGianTangCaTuDongQuaDem * this.dTangCa1HeSo / 60, this.iLamTronGio);
                                                                    this.DGVTinhCong.Rows[addTuDongQuaDemB].Cells[13].Value = "0";
                                                                    this.DGVTinhCong.Rows[addTuDongQuaDemB].Cells[14].Value = "0";
                                                                    this.DGVTinhCong.Rows[addTuDongQuaDemB].Cells[15].Value = "0";
                                                                }
                                                                if ((iGioiHanTC1TuDongQuaDem == 0 ? false : iGioiHanTC2TuDongQuaDem == 0))
                                                                {
                                                                    if (dTongThoiGianTangCaTuDongQuaDem >= Convert.ToDouble(iGioiHanTC1TuDongQuaDem))
                                                                    {
                                                                        this.DGVTinhCong.Rows[addTuDongQuaDemB].Cells[12].Value = Math.Round(Convert.ToDouble(iGioiHanTC1TuDongQuaDem) / 60 * this.dTangCa1HeSo, this.iLamTronGio);
                                                                        if (dTongThoiGianTangCaTuDongQuaDem - Convert.ToDouble(iGioiHanTC1TuDongQuaDem) > 0)
                                                                        {
                                                                            this.DGVTinhCong.Rows[addTuDongQuaDemB].Cells[13].Value = Math.Round((dTongThoiGianTangCaTuDongQuaDem - Convert.ToDouble(iGioiHanTC1TuDongQuaDem)) * this.dTangCa2HeSo / 60, this.iLamTronGio);
                                                                        }
                                                                        this.DGVTinhCong.Rows[addTuDongQuaDemB].Cells[14].Value = "0";
                                                                        this.DGVTinhCong.Rows[addTuDongQuaDemB].Cells[15].Value = "0";
                                                                    }
                                                                    else
                                                                    {
                                                                        this.DGVTinhCong.Rows[addTuDongQuaDemB].Cells[12].Value = Math.Round(dTongThoiGianTangCaTuDongQuaDem * this.dTangCa1HeSo / 60, this.iLamTronGio);
                                                                        this.DGVTinhCong.Rows[addTuDongQuaDemB].Cells[13].Value = "0";
                                                                        this.DGVTinhCong.Rows[addTuDongQuaDemB].Cells[14].Value = "0";
                                                                        this.DGVTinhCong.Rows[addTuDongQuaDemB].Cells[15].Value = "0";
                                                                    }
                                                                }
                                                                if ((iGioiHanTC1TuDongQuaDem == 0 || iGioiHanTC2TuDongQuaDem == 0 ? false : iGioiHanTC3TuDongQuaDem == 0))
                                                                {
                                                                    if (dTongThoiGianTangCaTuDongQuaDem >= Convert.ToDouble(iGioiHanTC1TuDongQuaDem))
                                                                    {
                                                                        this.DGVTinhCong.Rows[addTuDongQuaDemB].Cells[12].Value = Math.Round(Convert.ToDouble(iGioiHanTC1TuDongQuaDem) * this.dTangCa1HeSo / 60, this.iLamTronGio);
                                                                        if (dTongThoiGianTangCaTuDongQuaDem - Convert.ToDouble(iGioiHanTC1TuDongQuaDem) >= Convert.ToDouble(iGioiHanTC2TuDongQuaDem))
                                                                        {
                                                                            this.DGVTinhCong.Rows[addTuDongQuaDemB].Cells[12].Value = Math.Round(Convert.ToDouble(iGioiHanTC1TuDongQuaDem) * this.dTangCa1HeSo / 60, this.iLamTronGio);
                                                                            this.DGVTinhCong.Rows[addTuDongQuaDemB].Cells[13].Value = Math.Round(Convert.ToDouble(iGioiHanTC2TuDongQuaDem) * this.dTangCa2HeSo / 60, this.iLamTronGio);
                                                                            this.DGVTinhCong.Rows[addTuDongQuaDemB].Cells[14].Value = Math.Round((dTongThoiGianTangCaTuDongQuaDem - Convert.ToDouble(iGioiHanTC1TuDongQuaDem) - Convert.ToDouble(iGioiHanTC2TuDongQuaDem)) * this.dTangCa3HeSo / 60, this.iLamTronGio);
                                                                            this.DGVTinhCong.Rows[addTuDongQuaDemB].Cells[15].Value = "0";
                                                                        }
                                                                        else
                                                                        {
                                                                            this.DGVTinhCong.Rows[addTuDongQuaDemB].Cells[13].Value = Math.Round((dTongThoiGianTangCaTuDongQuaDem - Convert.ToDouble(iGioiHanTC1TuDongQuaDem)) * this.dTangCa2HeSo / 60, this.iLamTronGio);
                                                                            this.DGVTinhCong.Rows[addTuDongQuaDemB].Cells[14].Value = "0";
                                                                            this.DGVTinhCong.Rows[addTuDongQuaDemB].Cells[15].Value = "0";
                                                                        }
                                                                    }
                                                                    else
                                                                    {
                                                                        this.DGVTinhCong.Rows[addTuDongQuaDemB].Cells[12].Value = Math.Round(dTongThoiGianTangCaTuDongQuaDem * this.dTangCa1HeSo / 60, this.iLamTronGio);
                                                                        this.DGVTinhCong.Rows[addTuDongQuaDemB].Cells[13].Value = "0";
                                                                        this.DGVTinhCong.Rows[addTuDongQuaDemB].Cells[14].Value = "0";
                                                                        this.DGVTinhCong.Rows[addTuDongQuaDemB].Cells[15].Value = "0";
                                                                    }
                                                                }
                                                                if ((iGioiHanTC1TuDongQuaDem == 0 || iGioiHanTC2TuDongQuaDem == 0 || iGioiHanTC3TuDongQuaDem == 0 ? false : iGioiHanTC4TuDongQuaDem == 0))
                                                                {
                                                                }
                                                            }
                                                        }
                                                        if (!(DateTimeProgress.XuatIDThu((int)dt.AddDays((double)dem).DayOfWeek) == "0"))
                                                        {
                                                            this.DGVTinhCong.Rows[addTuDongQuaDemB].Cells[19].Value = "NT";
                                                        }
                                                        else
                                                        {
                                                            this.DGVTinhCong.Rows[addTuDongQuaDemB].Cells[19].Value = "CN";
                                                        }
                                                        this.DGVTinhCong.Rows[addTuDongQuaDemB].Cells[20].Value = this.sMaChamCong;
                                                        this.DGVTinhCong.Rows[addTuDongQuaDemB].Cells[21].Value = this.sPhongBanTinhCong;
                                                    }
                                                    // thu break o day nhe

                                                  break;
                                           //   Label55:;
                                                }

                                              //  en if

                                                //////////////////////////////////////////////////////

                                            }
                                            else if (!(dtNgayTruocTuDongQuaDem.Rows.Count % 2 == 0 || this.DGVTinhCong.Rows[_nhanVien - 1].Cells[5].Value == null ? true : this.DGVTinhCong.Rows[_nhanVien - 1].Cells[6].Value != null))
                                            {
                                                dGioRaNgayTruocTuDongQuaDem = Convert.ToDateTime(dtTuDongQuaDem.Rows[iTuDongQuaDem]["GioCham"].ToString());
                                                this.DGVTinhCong.Rows[_nhanVien - 1].Cells[6].Value = string.Format(this.sDinhDangThoiGian, dGioRaNgayTruocTuDongQuaDem);
                                                demTuDongQuaDem--;
                                                dtNhanCaTuDongQuaDem = new System.Data.DataTable();
                                                this._chiTietLichTrinhChoCalamViecDTO.MaLichTrinhCaLamViec = sLTCCLVNhanVien;
                                                this._chiTietLichTrinhChoCalamViecDTO.Thu = sThu;
                                                dtNhanCaTuDongQuaDem = this._chiTietLichTrinhChoCaLamViecBLL.ChiTietLichTrinhChoCaLamViecNhanCa(this._chiTietLichTrinhChoCalamViecDTO);
                                                iChiTietLichTrinhChoCaLamViecTuDongQuaDem = 0;
                                                if (iChiTietLichTrinhChoCaLamViecTuDongQuaDem < dtNhanCaTuDongQuaDem.Rows.Count)
                                                {
                                                    cellChiTietLichTrinhChoCaLamViecTuDongQuaDem = 3;
                                                    while (cellChiTietLichTrinhChoCaLamViecTuDongQuaDem < 13)
                                                    {
                                                        kiemTraVao = 0;
                                                        kiemTraRa = 0;
                                                        this.sTuDongQuaDemMaCaLamViec = dtNhanCaTuDongQuaDem.Rows[iChiTietLichTrinhChoCaLamViecTuDongQuaDem][cellChiTietLichTrinhChoCaLamViecTuDongQuaDem].ToString();
                                                        dtTuDongQuaDemCa1 = new System.Data.DataTable();
                                                        this._caLamViecDTO.MaCaLamViec = this.sTuDongQuaDemMaCaLamViec;
                                                        dtTuDongQuaDemCa1 = this._caLamViecBLL.CaLamViecGetByMaCaLamViec(this._caLamViecDTO);
                                                        iTuDongQuaDemCa1 = 0;
                                                        while (iTuDongQuaDemCa1 < dtTuDongQuaDemCa1.Rows.Count)
                                                        {
                                                            this.sTuDongQuaDemTenCaLamViec = dtTuDongQuaDemCa1.Rows[iTuDongQuaDemCa1]["CaLamViec"].ToString();
                                                            dBatDauVaoTuDongQuaDemA = Convert.ToDateTime(dtTuDongQuaDemCa1.Rows[iTuDongQuaDemCa1]["BatDauVao"].ToString());
                                                            sBatDauVaoTuDongQuaDemA = string.Format("{0:T}", dBatDauVaoTuDongQuaDemA);
                                                            sBatDauVaoTuDongQuaDemB = string.Concat(sNgayCham, " ", sBatDauVaoTuDongQuaDemA);
                                                            dateTime = Convert.ToDateTime(sBatDauVaoTuDongQuaDemB);
                                                            dBatDauVaoTuDongQuaDemB = dateTime.AddDays(-1);
                                                            dKetThucVaoTuDongQuaDemA = Convert.ToDateTime(dtTuDongQuaDemCa1.Rows[iTuDongQuaDemCa1]["KetThucVao"].ToString());
                                                            sKetThucVaoTuDongQuaDemA = string.Format("{0:T}", dKetThucVaoTuDongQuaDemA);
                                                            sKetThucVaoTuDongQuaDemB = string.Concat(sNgayCham, " ", sKetThucVaoTuDongQuaDemA);
                                                            dateTime = Convert.ToDateTime(sKetThucVaoTuDongQuaDemB);
                                                            dKetThucVaoTuDongQuaDemB = dateTime.AddDays(-1);
                                                            dBatDauRaTuDongQuaDemA = Convert.ToDateTime(dtTuDongQuaDemCa1.Rows[iTuDongQuaDemCa1]["BatDauRa"].ToString());
                                                            sBatDauRaTuDongQuaDemA = string.Format("{0:T}", dBatDauRaTuDongQuaDemA);
                                                            sBatDauRaTuDongQuaDemB = string.Concat(sNgayCham, " ", sBatDauRaTuDongQuaDemA);
                                                            dateTime = Convert.ToDateTime(sBatDauRaTuDongQuaDemB);
                                                            dBatDauRaTuDongQuaDemB = dateTime.AddDays(-1);
                                                            if (!(sBatDauRaTuDongQuaDemA == "12:01:00 AM"))
                                                            {
                                                                dBatDauRaTuDongQuaDemB = Convert.ToDateTime(sBatDauRaTuDongQuaDemB);
                                                            }
                                                            else
                                                            {
                                                                dateTime = dBatDauRaTuDongQuaDemB.AddDays(1);
                                                                dBatDauRaTuDongQuaDemB = Convert.ToDateTime(dateTime.ToString());
                                                            }
                                                            dKetThucRaTuDongQuaDemA = Convert.ToDateTime(dtTuDongQuaDemCa1.Rows[iTuDongQuaDemCa1]["KetThucRa"].ToString());
                                                            sKetThucRaTuDongQuaDemA = string.Format("{0:T}", dKetThucRaTuDongQuaDemA);
                                                            sKetThucRaTuDongQuaDemB = string.Concat(sNgayCham, " ", sKetThucRaTuDongQuaDemA);
                                                            dateTime = Convert.ToDateTime(sKetThucRaTuDongQuaDemB);
                                                            dKetThucRaTuDongQuaDemB = dateTime.AddDays(-1);
                                                            if (!(sBatDauRaTuDongQuaDemA == "12:01:00 AM"))
                                                            {
                                                                dKetThucRaTuDongQuaDemB = Convert.ToDateTime(sKetThucRaTuDongQuaDemB);
                                                            }
                                                            else
                                                            {
                                                                dateTime = dKetThucRaTuDongQuaDemB.AddDays(1);
                                                                dKetThucRaTuDongQuaDemB = Convert.ToDateTime(dateTime.ToString());
                                                            }
                                                            if ((dGioNgayHomTruoc < dBatDauVaoTuDongQuaDemB ? false : dGioNgayHomTruoc <= dKetThucVaoTuDongQuaDemB))
                                                            {
                                                                kiemTraVao++;
                                                            }
                                                            if ((dGioRaNgayTruocTuDongQuaDem < dBatDauRaTuDongQuaDemB ? false : dGioRaNgayTruocTuDongQuaDem <= dKetThucRaTuDongQuaDemB))
                                                            {
                                                                kiemTraRa++;
                                                            }
                                                            if ((kiemTraVao != 1 ? true : kiemTraRa != 1))
                                                            {
                                                                iTuDongQuaDemCa1++;
                                                            }
                                                            else
                                                            {
                                                                goto Label60;
                                                            }
                                                        }
                                                        if (!(this.sTuDongQuaDemMaCaLamViec == ""))
                                                        {
                                                            cellChiTietLichTrinhChoCaLamViecTuDongQuaDem++;
                                                        }
                                                        else
                                                        {
                                                            this.DGVTinhCong.Rows[_nhanVien - 1].Cells[4].Value = "***";
                                                            this.DGVTinhCong.Rows[_nhanVien - 1].Cells[7].Value = "0";
                                                            this.DGVTinhCong.Rows[_nhanVien - 1].Cells[8].Value = "0";
                                                            this.DGVTinhCong.Rows[_nhanVien - 1].Cells[9].Value = "0";
                                                            this.DGVTinhCong.Rows[_nhanVien - 1].Cells[10].Value = "0";
                                                            this.DGVTinhCong.Rows[_nhanVien - 1].Cells[11].Value = "0";
                                                            this.DGVTinhCong.Rows[_nhanVien - 1].Cells[12].Value = "0";
                                                            this.DGVTinhCong.Rows[_nhanVien - 1].Cells[13].Value = "0";
                                                            this.DGVTinhCong.Rows[_nhanVien - 1].Cells[14].Value = "0";
                                                            this.DGVTinhCong.Rows[_nhanVien - 1].Cells[15].Value = "0";
                                                            this.DGVTinhCong.Rows[_nhanVien - 1].Cells[16].Value = "0";
                                                            this.DGVTinhCong.Rows[_nhanVien - 1].Cells[17].Value = "0";
                                                            this.DGVTinhCong.Rows[_nhanVien - 1].Cells[18].Value = this.sKHVang;
                                                            if (!(DateTimeProgress.XuatThuQuaDem((int)dt.AddDays((double)dem).DayOfWeek) == "1"))
                                                            {
                                                                this.DGVTinhCong.Rows[_nhanVien - 1].Cells[19].Value = "NT";
                                                            }
                                                            else
                                                            {
                                                                this.DGVTinhCong.Rows[_nhanVien - 1].Cells[19].Value = "CN";
                                                            }
                                                            this.DGVTinhCong.Rows[_nhanVien - 1].Cells[20].Value = this.sMaChamCong;
                                                            this.DGVTinhCong.Rows[_nhanVien - 1].Cells[21].Value = this.sPhongBanTinhCong;
                                                            //  goto Label59;
                                                            break;
                                                        }
                                                    }

                                                  
                                                Label60:
                                                    this.DGVTinhCong.Rows[_nhanVien - 1].Cells[4].Value = this.sTuDongQuaDemTenCaLamViec;
                                                    dtThongSoCaLamViecTuDongQuaDem = new System.Data.DataTable();
                                                    this._caLamViecDTO.MaCaLamViec = this.sTuDongQuaDemMaCaLamViec;
                                                    dtThongSoCaLamViecTuDongQuaDem = this._caLamViecBLL.CaLamViecGetByMaCaLamViec(this._caLamViecDTO);
                                                    for (iThongSoCaLamViecTuDongQuaDem = 0; iThongSoCaLamViecTuDongQuaDem < dtThongSoCaLamViecTuDongQuaDem.Rows.Count; iThongSoCaLamViecTuDongQuaDem++)
                                                    {
                                                        value = dGioRaNgayTruocTuDongQuaDem - dGioNgayHomTruoc;
                                                        iTongPhutTuDongQuaDem = Convert.ToInt32(value.TotalMinutes);
                                                        dTongGioTuDongQuaDem = Math.Round(Convert.ToDouble(iTongPhutTuDongQuaDem) / 60, this.iLamTronGio);
                                                        this.DGVTinhCong.Rows[_nhanVien - 1].Cells[16].Value = dTongGioTuDongQuaDem.ToString();
                                                        this.DGVTinhCong.Rows[_nhanVien - 1].Cells[17].Value = dtThongSoCaLamViecTuDongQuaDem.Rows[iThongSoCaLamViecTuDongQuaDem]["CongTinh"].ToString();
                                                        second = dGioNgayHomTruoc.Second;
                                                        sGiayGioVao = second.ToString();
                                                        second = dGioRaNgayTruocTuDongQuaDem.Second;
                                                        sGiayGioRa = second.ToString();
                                                        dGioVaoKhaiBaoTuDongQuaDemA = Convert.ToDateTime(dtThongSoCaLamViecTuDongQuaDem.Rows[iThongSoCaLamViecTuDongQuaDem]["GioVaoLamViec"].ToString());
                                                        sGioVaoKhaiBaoTuDongQuaDemA = string.Format("{0:T}", dGioVaoKhaiBaoTuDongQuaDemA).Replace("00 ", string.Concat(sGiayGioVao, " "));
                                                        sGioVaoKhaiBaoTuDongQuaDemB = string.Concat(sNgayCham, " ", sGioVaoKhaiBaoTuDongQuaDemA);
                                                        dGioRaKhaiBaoTuDongQuaDemA = Convert.ToDateTime(dtThongSoCaLamViecTuDongQuaDem.Rows[iThongSoCaLamViecTuDongQuaDem]["GioKetThucLamViec"].ToString());
                                                        sGioRaKhaiBaoTuDongQuaDemA = string.Format("{0:T}", dGioRaKhaiBaoTuDongQuaDemA).Replace("00 ", string.Concat(sGiayGioRa, " "));
                                                        sGioRaKhaiBaoTuDongQuaDemB = string.Concat(sNgayCham, " ", sGioRaKhaiBaoTuDongQuaDemA);
                                                        sCatChuoi = sGioRaKhaiBaoTuDongQuaDemB.Substring(sGioRaKhaiBaoTuDongQuaDemB.Length - 2);
                                                        sTruGioDiTre = dtThongSoCaLamViecTuDongQuaDem.Rows[iThongSoCaLamViecTuDongQuaDem]["TruGioDiTre"].ToString();
                                                        sBatDauTinhDiTre = dtThongSoCaLamViecTuDongQuaDem.Rows[iThongSoCaLamViecTuDongQuaDem]["BatDauTinhDiTre"].ToString();
                                                        if (!(sTruGioDiTre == "True"))
                                                        {
                                                            this.DGVTinhCong.Rows[_nhanVien - 1].Cells[9].Value = "0";
                                                        }
                                                        else
                                                        {
                                                            iChoPhepTreTuDongQuaDem = Convert.ToInt32(dtThongSoCaLamViecTuDongQuaDem.Rows[iThongSoCaLamViecTuDongQuaDem]["ChoPhepDiTre"].ToString());
                                                            if (!(sBatDauTinhDiTre == "True"))
                                                            {
                                                                dateTime = Convert.ToDateTime(sGioVaoKhaiBaoTuDongQuaDemB);
                                                                value = dGioNgayHomTruoc - dateTime.AddDays(-1);
                                                                iPhutTreTuDongQuaDem = Convert.ToInt32(value.TotalMinutes) - iChoPhepTreTuDongQuaDem;
                                                                if (iPhutTreTuDongQuaDem <= 0)
                                                                {
                                                                    this.DGVTinhCong.Rows[_nhanVien - 1].Cells[9].Value = "0";
                                                                }
                                                                else
                                                                {
                                                                    DataGridViewCell str4 = this.DGVTinhCong.Rows[_nhanVien - 1].Cells[9];
                                                                    dateTime = Convert.ToDateTime(sGioVaoKhaiBaoTuDongQuaDemB);
                                                                    value = dGioNgayHomTruoc - dateTime.AddDays(-1);
                                                                    second = Convert.ToInt32(value.TotalMinutes);
                                                                    str4.Value = second.ToString();
                                                                }
                                                            }
                                                            else
                                                            {
                                                                dateTime = Convert.ToDateTime(sGioVaoKhaiBaoTuDongQuaDemB);
                                                                value = dGioNgayHomTruoc - dateTime.AddDays(-1);
                                                                iPhutTreTuDongQuaDem = Convert.ToInt32(value.TotalMinutes) - iChoPhepTreTuDongQuaDem;
                                                                if (iPhutTreTuDongQuaDem <= 0)
                                                                {
                                                                    this.DGVTinhCong.Rows[_nhanVien - 1].Cells[9].Value = "0";
                                                                }
                                                                else
                                                                {
                                                                    this.DGVTinhCong.Rows[_nhanVien - 1].Cells[9].Value = iPhutTreTuDongQuaDem.ToString();
                                                                }
                                                            }
                                                        }
                                                        sTruGioVeSom = dtThongSoCaLamViecTuDongQuaDem.Rows[iThongSoCaLamViecTuDongQuaDem]["TruGioVeSom"].ToString();
                                                        sBatDauTinhVeSom = dtThongSoCaLamViecTuDongQuaDem.Rows[iThongSoCaLamViecTuDongQuaDem]["BatDauTinhVeSom"].ToString();
                                                        if (!(sTruGioVeSom == "True"))
                                                        {
                                                            this.DGVTinhCong.Rows[_nhanVien - 1].Cells[10].Value = "0";
                                                        }
                                                        else
                                                        {
                                                            iChoPhepVeSomTuDongQuaDem = Convert.ToInt32(dtThongSoCaLamViecTuDongQuaDem.Rows[iThongSoCaLamViecTuDongQuaDem]["ChoPhepVeSom"].ToString());
                                                            if (!(sBatDauTinhVeSom == "True"))
                                                            {
                                                                value = Convert.ToDateTime(sGioRaKhaiBaoTuDongQuaDemB) - dGioRaNgayTruocTuDongQuaDem;
                                                                iPhutVeSomTuDongQuaDem = Convert.ToInt32(value.TotalMinutes) - iChoPhepVeSomTuDongQuaDem;
                                                                if (iPhutVeSomTuDongQuaDem <= 0)
                                                                {
                                                                    this.DGVTinhCong.Rows[_nhanVien - 1].Cells[10].Value = "0";
                                                                }
                                                                else
                                                                {
                                                                    DataGridViewCell str5 = this.DGVTinhCong.Rows[_nhanVien - 1].Cells[10];
                                                                    value = Convert.ToDateTime(sGioRaKhaiBaoTuDongQuaDemB) - dGioRaNgayTruocTuDongQuaDem;
                                                                    second = Convert.ToInt32(value.TotalMinutes);
                                                                    str5.Value = second.ToString();
                                                                }
                                                            }
                                                            else if (!(sCatChuoi == "PM"))
                                                            {
                                                                value = Convert.ToDateTime(sGioRaKhaiBaoTuDongQuaDemB) - dGioRaNgayTruocTuDongQuaDem;
                                                                iPhutVeSomTuDongQuaDem = Convert.ToInt32(value.TotalMinutes) - iChoPhepVeSomTuDongQuaDem;
                                                                if (iPhutVeSomTuDongQuaDem <= 0)
                                                                {
                                                                    this.DGVTinhCong.Rows[_nhanVien - 1].Cells[10].Value = "0";
                                                                }
                                                                else
                                                                {
                                                                    this.DGVTinhCong.Rows[_nhanVien - 1].Cells[10].Value = iPhutVeSomTuDongQuaDem.ToString();
                                                                }
                                                            }
                                                            else
                                                            {
                                                                dateTime = Convert.ToDateTime(sGioRaKhaiBaoTuDongQuaDemB);
                                                                value = dateTime.AddDays(-1) - dGioRaNgayTruocTuDongQuaDem;
                                                                iPhutVeSomTuDongQuaDem = Convert.ToInt32(value.TotalMinutes) - iChoPhepVeSomTuDongQuaDem;
                                                                if (iPhutVeSomTuDongQuaDem <= 0)
                                                                {
                                                                    this.DGVTinhCong.Rows[_nhanVien - 1].Cells[10].Value = "0";
                                                                }
                                                                else
                                                                {
                                                                    this.DGVTinhCong.Rows[_nhanVien - 1].Cells[10].Value = iPhutVeSomTuDongQuaDem.ToString();
                                                                }
                                                            }
                                                        }
                                                        if (!(sCatChuoi == "PM"))
                                                        {
                                                            value = dGioRaNgayTruocTuDongQuaDem - Convert.ToDateTime(sGioRaKhaiBaoTuDongQuaDemB);
                                                            iPhutVeTre = Convert.ToInt32(value.TotalMinutes);
                                                            if (iPhutVeTre <= 0)
                                                            {
                                                                this.DGVTinhCong.Rows[_nhanVien - 1].Cells[11].Value = "0";
                                                            }
                                                            else
                                                            {
                                                                this.DGVTinhCong.Rows[_nhanVien - 1].Cells[11].Value = iPhutVeTre;
                                                            }
                                                        }
                                                        else
                                                        {
                                                            dateTime = Convert.ToDateTime(sGioRaKhaiBaoTuDongQuaDemB);
                                                            value = dGioRaNgayTruocTuDongQuaDem - dateTime.AddDays(-1);
                                                            iPhutVeTre = Convert.ToInt32(value.TotalMinutes);
                                                            if (iPhutVeTre <= 0)
                                                            {
                                                                this.DGVTinhCong.Rows[_nhanVien - 1].Cells[11].Value = "0";
                                                            }
                                                            else
                                                            {
                                                                this.DGVTinhCong.Rows[_nhanVien - 1].Cells[11].Value = iPhutVeTre;
                                                            }
                                                        }
                                                        dTongGioTrongCaTuDongQuaDem = Convert.ToDouble(dtThongSoCaLamViecTuDongQuaDem.Rows[iThongSoCaLamViecTuDongQuaDem]["TongGioTrongCaLamViec"].ToString());
                                                        dTongCongTrongCaTuDongQuaDem = Convert.ToDouble(dtThongSoCaLamViecTuDongQuaDem.Rows[iThongSoCaLamViecTuDongQuaDem]["CongTinh"].ToString());
                                                        dTongPhutTreSomTuDongQuaDem = Convert.ToDouble(this.DGVTinhCong.Rows[_nhanVien - 1].Cells[9].Value.ToString()) + Convert.ToDouble(this.DGVTinhCong.Rows[_nhanVien - 1].Cells[10].Value.ToString());
                                                        dSoPhutLamDuocTrongCa = dTongGioTrongCaTuDongQuaDem * 60 - dTongPhutTreSomTuDongQuaDem;
                                                        this.DGVTinhCong.Rows[_nhanVien - 1].Cells[8].Value = Math.Round(dSoPhutLamDuocTrongCa / 60, this.iLamTronGio);
                                                        this.DGVTinhCong.Rows[_nhanVien - 1].Cells[7].Value = Math.Round(Convert.ToDouble(this.DGVTinhCong.Rows[_nhanVien - 1].Cells[8].Value.ToString()) * dTongCongTrongCaTuDongQuaDem / dTongGioTrongCaTuDongQuaDem, this.iLamTronCong);
                                                        sChoPhepTangCaTruocGioLamViecTuDongQuaDem = dtThongSoCaLamViecTuDongQuaDem.Rows[iThongSoCaLamViecTuDongQuaDem]["TangCaTruocGioLamViec"].ToString();
                                                        iPhutTangCaTruocGioLamViecTuDongQuaDem = Convert.ToInt32(dtThongSoCaLamViecTuDongQuaDem.Rows[iThongSoCaLamViecTuDongQuaDem]["SoPhutTangCaTruocGioLamViec"].ToString());
                                                        iPhutTangCaTruocGioLamViecDatDen = Convert.ToInt32(dtThongSoCaLamViecTuDongQuaDem.Rows[iThongSoCaLamViecTuDongQuaDem]["TangCaTruocGioLamViecDatDen"].ToString());
                                                        iPhutTruTangCaTruoc = Convert.ToInt32(dtThongSoCaLamViecTuDongQuaDem.Rows[iThongSoCaLamViecTuDongQuaDem]["PhutTruTangCaTruoc"].ToString());
                                                        sChoPhepTangCaSauGioLamViecTuDongQuaDem = dtThongSoCaLamViecTuDongQuaDem.Rows[iThongSoCaLamViecTuDongQuaDem]["TangCaSauGioLamViec"].ToString();
                                                        iPhutTangCaSauGioLamViecTuDongQuaDem = Convert.ToInt32(dtThongSoCaLamViecTuDongQuaDem.Rows[iThongSoCaLamViecTuDongQuaDem]["SoPhutTangCaSauGioLamViec"].ToString());
                                                        iPhutTangCaSauGioLamViecDatDen = Convert.ToInt32(dtThongSoCaLamViecTuDongQuaDem.Rows[iThongSoCaLamViecTuDongQuaDem]["TangCaSauGioLamViecDatDen"].ToString());
                                                        iPhutTruTangCaSau = Convert.ToInt32(dtThongSoCaLamViecTuDongQuaDem.Rows[iThongSoCaLamViecTuDongQuaDem]["PhutTruTangCaSau"].ToString());
                                                        iGioiHanTC1TuDongQuaDem = Convert.ToInt32(dtThongSoCaLamViecTuDongQuaDem.Rows[iThongSoCaLamViecTuDongQuaDem]["GioiHanTangCa1"].ToString());
                                                        iGioiHanTC2TuDongQuaDem = Convert.ToInt32(dtThongSoCaLamViecTuDongQuaDem.Rows[iThongSoCaLamViecTuDongQuaDem]["GioiHanTangCa2"].ToString());
                                                        iGioiHanTC3TuDongQuaDem = Convert.ToInt32(dtThongSoCaLamViecTuDongQuaDem.Rows[iThongSoCaLamViecTuDongQuaDem]["GioiHanTangCa3"].ToString());
                                                        iGioiHanTC4TuDongQuaDem = Convert.ToInt32(dtThongSoCaLamViecTuDongQuaDem.Rows[iThongSoCaLamViecTuDongQuaDem]["GioiHanTangCa4"].ToString());
                                                        iTongGioTangCaSauTuDongQuaDem = 0;
                                                        iTongGioTangCaTruocTuDongQuaDem = 0;
                                                        if ((sChoPhepTangCaTruocGioLamViecTuDongQuaDem != "False" ? true : !(sChoPhepTangCaSauGioLamViecTuDongQuaDem == "False")))
                                                        {
                                                            if (sChoPhepTangCaTruocGioLamViecTuDongQuaDem == "True")
                                                            {
                                                                dateTime = Convert.ToDateTime(sGioVaoKhaiBaoTuDongQuaDemB);
                                                                value = dateTime.AddDays(-1) - dGioNgayHomTruoc;
                                                                second = Convert.ToInt32(value.TotalMinutes);
                                                                iThoiGianTruocGioLamTuDongQuaDem = Convert.ToInt32(second.ToString());
                                                                if (iThoiGianTruocGioLamTuDongQuaDem > 0)
                                                                {
                                                                    if (iThoiGianTruocGioLamTuDongQuaDem > iPhutTangCaTruocGioLamViecTuDongQuaDem)
                                                                    {
                                                                        if (iThoiGianTruocGioLamTuDongQuaDem > iPhutTangCaTruocGioLamViecDatDen)
                                                                        {
                                                                            iTongGioTangCaTruocTuDongQuaDem = iThoiGianTruocGioLamTuDongQuaDem - iPhutTruTangCaTruoc;
                                                                        }
                                                                    }
                                                                }
                                                            }
                                                            if (sChoPhepTangCaSauGioLamViecTuDongQuaDem == "True")
                                                            {
                                                                if (!(sCatChuoi == "PM"))
                                                                {
                                                                    value = dGioRaNgayTruocTuDongQuaDem - Convert.ToDateTime(sGioRaKhaiBaoTuDongQuaDemB);
                                                                    second = Convert.ToInt32(value.TotalMinutes);
                                                                    iThoiGianSauGioLamViecTuDongQuaDem = Convert.ToInt32(second.ToString());
                                                                    if (iThoiGianSauGioLamViecTuDongQuaDem > 0)
                                                                    {
                                                                        if (iThoiGianSauGioLamViecTuDongQuaDem > iPhutTangCaSauGioLamViecTuDongQuaDem)
                                                                        {
                                                                            if (iThoiGianSauGioLamViecTuDongQuaDem > iPhutTangCaSauGioLamViecDatDen)
                                                                            {
                                                                                iTongGioTangCaSauTuDongQuaDem = iThoiGianSauGioLamViecTuDongQuaDem - iPhutTruTangCaSau;
                                                                            }
                                                                        }
                                                                    }
                                                                }
                                                                else
                                                                {
                                                                    dateTime = Convert.ToDateTime(sGioRaKhaiBaoTuDongQuaDemB);
                                                                    value = dGioRaNgayTruocTuDongQuaDem - dateTime.AddDays(-1);
                                                                    second = Convert.ToInt32(value.TotalMinutes);
                                                                    iThoiGianSauGioLamViecTuDongQuaDem = Convert.ToInt32(second.ToString());
                                                                    if (iThoiGianSauGioLamViecTuDongQuaDem > 0)
                                                                    {
                                                                        if (iThoiGianSauGioLamViecTuDongQuaDem > iPhutTangCaSauGioLamViecTuDongQuaDem)
                                                                        {
                                                                            if (iThoiGianSauGioLamViecTuDongQuaDem > iPhutTangCaSauGioLamViecDatDen)
                                                                            {
                                                                                iTongGioTangCaSauTuDongQuaDem = iThoiGianSauGioLamViecTuDongQuaDem - iPhutTruTangCaSau;
                                                                            }
                                                                        }
                                                                    }
                                                                }
                                                            }
                                                        }
                                                        else
                                                        {
                                                            this.DGVTinhCong.Rows[_nhanVien].Cells[12].Value = "0";
                                                            this.DGVTinhCong.Rows[_nhanVien].Cells[13].Value = "0";
                                                            this.DGVTinhCong.Rows[_nhanVien].Cells[14].Value = "0";
                                                            this.DGVTinhCong.Rows[_nhanVien].Cells[15].Value = "0";
                                                        }
                                                        dTongThoiGianTangCaTuDongQuaDem = Convert.ToDouble(iTongGioTangCaTruocTuDongQuaDem + iTongGioTangCaSauTuDongQuaDem);
                                                        if (dTongThoiGianTangCaTuDongQuaDem <= 0)
                                                        {
                                                            this.DGVTinhCong.Rows[_nhanVien - 1].Cells[12].Value = "0";
                                                            this.DGVTinhCong.Rows[_nhanVien - 1].Cells[13].Value = "0";
                                                            this.DGVTinhCong.Rows[_nhanVien - 1].Cells[14].Value = "0";
                                                            this.DGVTinhCong.Rows[_nhanVien - 1].Cells[15].Value = "0";
                                                        }
                                                        else
                                                        {
                                                            if (iGioiHanTC1TuDongQuaDem == 0)
                                                            {
                                                                this.DGVTinhCong.Rows[_nhanVien - 1].Cells[12].Value = Math.Round(dTongThoiGianTangCaTuDongQuaDem * this.dTangCa1HeSo / 60, this.iLamTronGio);
                                                                this.DGVTinhCong.Rows[_nhanVien - 1].Cells[13].Value = "0";
                                                                this.DGVTinhCong.Rows[_nhanVien - 1].Cells[14].Value = "0";
                                                                this.DGVTinhCong.Rows[_nhanVien - 1].Cells[15].Value = "0";
                                                            }
                                                            if ((iGioiHanTC1TuDongQuaDem == 0 ? false : iGioiHanTC2TuDongQuaDem == 0))
                                                            {
                                                                if (dTongThoiGianTangCaTuDongQuaDem >= Convert.ToDouble(iGioiHanTC1TuDongQuaDem))
                                                                {
                                                                    this.DGVTinhCong.Rows[_nhanVien - 1].Cells[12].Value = Math.Round(Convert.ToDouble(iGioiHanTC1TuDongQuaDem) / 60 * this.dTangCa1HeSo, this.iLamTronGio);
                                                                    if (dTongThoiGianTangCaTuDongQuaDem - Convert.ToDouble(iGioiHanTC1TuDongQuaDem) > 0)
                                                                    {
                                                                        this.DGVTinhCong.Rows[_nhanVien - 1].Cells[13].Value = Math.Round((dTongThoiGianTangCaTuDongQuaDem - Convert.ToDouble(iGioiHanTC1TuDongQuaDem)) * this.dTangCa2HeSo / 60, this.iLamTronGio);
                                                                    }
                                                                    this.DGVTinhCong.Rows[_nhanVien - 1].Cells[14].Value = "0";
                                                                    this.DGVTinhCong.Rows[_nhanVien - 1].Cells[15].Value = "0";
                                                                }
                                                                else
                                                                {
                                                                    this.DGVTinhCong.Rows[_nhanVien - 1].Cells[12].Value = Math.Round(dTongThoiGianTangCaTuDongQuaDem * this.dTangCa1HeSo / 60, this.iLamTronGio);
                                                                    this.DGVTinhCong.Rows[_nhanVien - 1].Cells[13].Value = "0";
                                                                    this.DGVTinhCong.Rows[_nhanVien - 1].Cells[14].Value = "0";
                                                                    this.DGVTinhCong.Rows[_nhanVien - 1].Cells[15].Value = "0";
                                                                }
                                                            }
                                                            if ((iGioiHanTC1TuDongQuaDem == 0 || iGioiHanTC2TuDongQuaDem == 0 ? false : iGioiHanTC3TuDongQuaDem == 0))
                                                            {
                                                                if (dTongThoiGianTangCaTuDongQuaDem >= Convert.ToDouble(iGioiHanTC1TuDongQuaDem))
                                                                {
                                                                    this.DGVTinhCong.Rows[_nhanVien - 1].Cells[12].Value = Math.Round(Convert.ToDouble(iGioiHanTC1TuDongQuaDem) * this.dTangCa1HeSo / 60, this.iLamTronGio);
                                                                    if (dTongThoiGianTangCaTuDongQuaDem - Convert.ToDouble(iGioiHanTC1TuDongQuaDem) >= Convert.ToDouble(iGioiHanTC2TuDongQuaDem))
                                                                    {
                                                                        this.DGVTinhCong.Rows[_nhanVien - 1].Cells[12].Value = Math.Round(Convert.ToDouble(iGioiHanTC1TuDongQuaDem) * this.dTangCa1HeSo / 60, this.iLamTronGio);
                                                                        this.DGVTinhCong.Rows[_nhanVien - 1].Cells[13].Value = Math.Round(Convert.ToDouble(iGioiHanTC2TuDongQuaDem) * this.dTangCa2HeSo / 60, this.iLamTronGio);
                                                                        this.DGVTinhCong.Rows[_nhanVien - 1].Cells[14].Value = Math.Round((dTongThoiGianTangCaTuDongQuaDem - Convert.ToDouble(iGioiHanTC1TuDongQuaDem) - Convert.ToDouble(iGioiHanTC2TuDongQuaDem)) * this.dTangCa3HeSo / 60, this.iLamTronGio);
                                                                        this.DGVTinhCong.Rows[_nhanVien - 1].Cells[15].Value = "0";
                                                                    }
                                                                    else
                                                                    {
                                                                        this.DGVTinhCong.Rows[_nhanVien - 1].Cells[13].Value = Math.Round((dTongThoiGianTangCaTuDongQuaDem - Convert.ToDouble(iGioiHanTC1TuDongQuaDem)) * this.dTangCa2HeSo / 60, this.iLamTronGio);
                                                                        this.DGVTinhCong.Rows[_nhanVien - 1].Cells[14].Value = "0";
                                                                        this.DGVTinhCong.Rows[_nhanVien - 1].Cells[15].Value = "0";
                                                                    }
                                                                }
                                                                else
                                                                {
                                                                    this.DGVTinhCong.Rows[_nhanVien - 1].Cells[12].Value = Math.Round(dTongThoiGianTangCaTuDongQuaDem * this.dTangCa1HeSo / 60, this.iLamTronGio);
                                                                    this.DGVTinhCong.Rows[_nhanVien - 1].Cells[13].Value = "0";
                                                                    this.DGVTinhCong.Rows[_nhanVien - 1].Cells[14].Value = "0";
                                                                    this.DGVTinhCong.Rows[_nhanVien - 1].Cells[15].Value = "0";
                                                                }
                                                            }
                                                            if ((iGioiHanTC1TuDongQuaDem == 0 || iGioiHanTC2TuDongQuaDem == 0 || iGioiHanTC3TuDongQuaDem == 0 ? false : iGioiHanTC4TuDongQuaDem == 0))
                                                            {
                                                            }
                                                        }
                                                        this.DGVTinhCong.Rows[_nhanVien - 1].Cells[18].Value = this.sKHDungGio;
                                                        if (!(DateTimeProgress.XuatThuQuaDem((int)dt.AddDays((double)dem).DayOfWeek) == "1"))
                                                        {
                                                            this.DGVTinhCong.Rows[_nhanVien - 1].Cells[19].Value = "NT";
                                                        }
                                                        else
                                                        {
                                                            this.DGVTinhCong.Rows[_nhanVien - 1].Cells[19].Value = "CN";
                                                        }
                                                        this.DGVTinhCong.Rows[_nhanVien - 1].Cells[20].Value = this.sMaChamCong;
                                                        this.DGVTinhCong.Rows[_nhanVien - 1].Cells[21].Value = this.sPhongBanTinhCong;
                                                    }
                                                }
                                                // co nen dat o day hay khong
                                               // break;
                                        //  Label59:;
                                            }
                                       
                                            else if ((dtNgayTruocTuDongQuaDem.Rows.Count % 2 != 0 || this.DGVTinhCong.Rows[_nhanVien - 1].Cells[5].Value == null ? true : this.DGVTinhCong.Rows[_nhanVien - 1].Cells[6].Value != null))
                                            {
                                                DateTime dGioVaoNgayTruocTuDongQuaDem = Convert.ToDateTime(dtTuDongQuaDem.Rows[iTuDongQuaDem]["GioCham"].ToString());
                                                this.DGVTinhCong.Rows[_nhanVien].Cells[5].Value = string.Format(this.sDinhDangThoiGian, dGioVaoNgayTruocTuDongQuaDem);
                                            }
                                            else
                                            {
                                                dGioRaNgayTruocTuDongQuaDem = Convert.ToDateTime(dtTuDongQuaDem.Rows[iTuDongQuaDem]["GioCham"].ToString());
                                                this.DGVTinhCong.Rows[_nhanVien - 1].Cells[6].Value = string.Format(this.sDinhDangThoiGian, dGioRaNgayTruocTuDongQuaDem);
                                                demTuDongQuaDem--;
                                                dtNhanCaTuDongQuaDem = new System.Data.DataTable();
                                                this._chiTietLichTrinhChoCalamViecDTO.MaLichTrinhCaLamViec = sLTCCLVNhanVien;
                                                this._chiTietLichTrinhChoCalamViecDTO.Thu = sThu;
                                                dtNhanCaTuDongQuaDem = this._chiTietLichTrinhChoCaLamViecBLL.ChiTietLichTrinhChoCaLamViecNhanCa(this._chiTietLichTrinhChoCalamViecDTO);
                                                iChiTietLichTrinhChoCaLamViecTuDongQuaDem = 0;
                                                if (iChiTietLichTrinhChoCaLamViecTuDongQuaDem < dtNhanCaTuDongQuaDem.Rows.Count)
                                                {
                                                    cellChiTietLichTrinhChoCaLamViecTuDongQuaDem = 3;
                                                    while (cellChiTietLichTrinhChoCaLamViecTuDongQuaDem < 13)
                                                    {
                                                        kiemTraVao = 0;
                                                        kiemTraRa = 0;
                                                        this.sTuDongQuaDemMaCaLamViec = dtNhanCaTuDongQuaDem.Rows[iChiTietLichTrinhChoCaLamViecTuDongQuaDem][cellChiTietLichTrinhChoCaLamViecTuDongQuaDem].ToString();
                                                        dtTuDongQuaDemCa1 = new System.Data.DataTable();
                                                        this._caLamViecDTO.MaCaLamViec = this.sTuDongQuaDemMaCaLamViec;
                                                        dtTuDongQuaDemCa1 = this._caLamViecBLL.CaLamViecGetByMaCaLamViec(this._caLamViecDTO);
                                                        iTuDongQuaDemCa1 = 0;
                                                        while (iTuDongQuaDemCa1 < dtTuDongQuaDemCa1.Rows.Count)
                                                        {
                                                            this.sTuDongQuaDemTenCaLamViec = dtTuDongQuaDemCa1.Rows[iTuDongQuaDemCa1]["CaLamViec"].ToString();
                                                            dBatDauVaoTuDongQuaDemA = Convert.ToDateTime(dtTuDongQuaDemCa1.Rows[iTuDongQuaDemCa1]["BatDauVao"].ToString());
                                                            sBatDauVaoTuDongQuaDemA = string.Format("{0:T}", dBatDauVaoTuDongQuaDemA);
                                                            sBatDauVaoTuDongQuaDemB = string.Concat(sNgayCham, " ", sBatDauVaoTuDongQuaDemA);
                                                            dateTime = Convert.ToDateTime(sBatDauVaoTuDongQuaDemB);
                                                            dBatDauVaoTuDongQuaDemB = dateTime.AddDays(-1);
                                                            dKetThucVaoTuDongQuaDemA = Convert.ToDateTime(dtTuDongQuaDemCa1.Rows[iTuDongQuaDemCa1]["KetThucVao"].ToString());
                                                            sKetThucVaoTuDongQuaDemA = string.Format("{0:T}", dKetThucVaoTuDongQuaDemA);
                                                            sKetThucVaoTuDongQuaDemB = string.Concat(sNgayCham, " ", sKetThucVaoTuDongQuaDemA);
                                                            dateTime = Convert.ToDateTime(sKetThucVaoTuDongQuaDemB);
                                                            dKetThucVaoTuDongQuaDemB = dateTime.AddDays(-1);
                                                            dBatDauRaTuDongQuaDemA = Convert.ToDateTime(dtTuDongQuaDemCa1.Rows[iTuDongQuaDemCa1]["BatDauRa"].ToString());
                                                            sBatDauRaTuDongQuaDemA = string.Format("{0:T}", dBatDauRaTuDongQuaDemA);
                                                            sBatDauRaTuDongQuaDemB = string.Concat(sNgayCham, " ", sBatDauRaTuDongQuaDemA);
                                                            dateTime = Convert.ToDateTime(sBatDauRaTuDongQuaDemB);
                                                            dBatDauRaTuDongQuaDemB = dateTime.AddDays(-1);
                                                            if (!(sBatDauRaTuDongQuaDemA == "12:01:00 AM"))
                                                            {
                                                                dBatDauRaTuDongQuaDemB = Convert.ToDateTime(sBatDauRaTuDongQuaDemB);
                                                            }
                                                            else
                                                            {
                                                                dateTime = dBatDauRaTuDongQuaDemB.AddDays(1);
                                                                dBatDauRaTuDongQuaDemB = Convert.ToDateTime(dateTime.ToString());
                                                            }
                                                            dKetThucRaTuDongQuaDemA = Convert.ToDateTime(dtTuDongQuaDemCa1.Rows[iTuDongQuaDemCa1]["KetThucRa"].ToString());
                                                            sKetThucRaTuDongQuaDemA = string.Format("{0:T}", dKetThucRaTuDongQuaDemA);
                                                            sKetThucRaTuDongQuaDemB = string.Concat(sNgayCham, " ", sKetThucRaTuDongQuaDemA);
                                                            dateTime = Convert.ToDateTime(sKetThucRaTuDongQuaDemB);
                                                            dKetThucRaTuDongQuaDemB = dateTime.AddDays(-1);
                                                            if (!(sBatDauRaTuDongQuaDemA == "12:01:00 AM"))
                                                            {
                                                                dKetThucRaTuDongQuaDemB = Convert.ToDateTime(sKetThucRaTuDongQuaDemB);
                                                            }
                                                            else
                                                            {
                                                                dateTime = dKetThucRaTuDongQuaDemB.AddDays(1);
                                                                dKetThucRaTuDongQuaDemB = Convert.ToDateTime(dateTime.ToString());
                                                            }
                                                            if ((dGioNgayHomTruoc < dBatDauVaoTuDongQuaDemB ? false : dGioNgayHomTruoc <= dKetThucVaoTuDongQuaDemB))
                                                            {
                                                                kiemTraVao++;
                                                            }
                                                            if ((dGioRaNgayTruocTuDongQuaDem < dBatDauRaTuDongQuaDemB ? false : dGioRaNgayTruocTuDongQuaDem <= dKetThucRaTuDongQuaDemB))
                                                            {
                                                                kiemTraRa++;
                                                            }
                                                            if ((kiemTraVao != 1 ? true : kiemTraRa != 1))
                                                            {
                                                                iTuDongQuaDemCa1++;
                                                            }
                                                            else
                                                            {
                                                                goto Label58;
                                                            }
                                                        }
                                                        if (!(this.sTuDongQuaDemMaCaLamViec == ""))
                                                        {
                                                            cellChiTietLichTrinhChoCaLamViecTuDongQuaDem++;
                                                        }
                                                        else
                                                        {
                                                            this.DGVTinhCong.Rows[_nhanVien - 1].Cells[4].Value = "***";
                                                            this.DGVTinhCong.Rows[_nhanVien - 1].Cells[7].Value = "0";
                                                            this.DGVTinhCong.Rows[_nhanVien - 1].Cells[8].Value = "0";
                                                            this.DGVTinhCong.Rows[_nhanVien - 1].Cells[9].Value = "0";
                                                            this.DGVTinhCong.Rows[_nhanVien - 1].Cells[10].Value = "0";
                                                            this.DGVTinhCong.Rows[_nhanVien - 1].Cells[11].Value = "0";
                                                            this.DGVTinhCong.Rows[_nhanVien - 1].Cells[12].Value = "0";
                                                            this.DGVTinhCong.Rows[_nhanVien - 1].Cells[13].Value = "0";
                                                            this.DGVTinhCong.Rows[_nhanVien - 1].Cells[14].Value = "0";
                                                            this.DGVTinhCong.Rows[_nhanVien - 1].Cells[15].Value = "0";
                                                            this.DGVTinhCong.Rows[_nhanVien - 1].Cells[16].Value = "0";
                                                            this.DGVTinhCong.Rows[_nhanVien - 1].Cells[17].Value = "0";
                                                            this.DGVTinhCong.Rows[_nhanVien - 1].Cells[18].Value = this.sKHVang;
                                                            if (!(DateTimeProgress.XuatThuQuaDem((int)dt.AddDays((double)dem).DayOfWeek) == "1"))
                                                            {
                                                                this.DGVTinhCong.Rows[_nhanVien - 1].Cells[19].Value = "NT";
                                                            }
                                                            else
                                                            {
                                                                this.DGVTinhCong.Rows[_nhanVien - 1].Cells[19].Value = "CN";
                                                            }
                                                            this.DGVTinhCong.Rows[_nhanVien - 1].Cells[20].Value = this.sMaChamCong;
                                                            this.DGVTinhCong.Rows[_nhanVien - 1].Cells[21].Value = this.sPhongBanTinhCong;
                                                            //   goto Label57;
                                                            break;
                                                        }
                                                    }
                                                
                                                Label58:
                                                    this.DGVTinhCong.Rows[_nhanVien - 1].Cells[4].Value = this.sTuDongQuaDemTenCaLamViec;
                                                    dtThongSoCaLamViecTuDongQuaDem = new System.Data.DataTable();
                                                    this._caLamViecDTO.MaCaLamViec = this.sTuDongQuaDemMaCaLamViec;
                                                    dtThongSoCaLamViecTuDongQuaDem = this._caLamViecBLL.CaLamViecGetByMaCaLamViec(this._caLamViecDTO);
                                                    for (iThongSoCaLamViecTuDongQuaDem = 0; iThongSoCaLamViecTuDongQuaDem < dtThongSoCaLamViecTuDongQuaDem.Rows.Count; iThongSoCaLamViecTuDongQuaDem++)
                                                    {
                                                        value = dGioRaNgayTruocTuDongQuaDem - dGioNgayHomTruoc;
                                                        iTongPhutTuDongQuaDem = Convert.ToInt32(value.TotalMinutes);
                                                        dTongGioTuDongQuaDem = Math.Round(Convert.ToDouble(iTongPhutTuDongQuaDem) / 60, this.iLamTronGio);
                                                        this.DGVTinhCong.Rows[_nhanVien - 1].Cells[16].Value = dTongGioTuDongQuaDem.ToString();
                                                        this.DGVTinhCong.Rows[_nhanVien - 1].Cells[17].Value = dtThongSoCaLamViecTuDongQuaDem.Rows[iThongSoCaLamViecTuDongQuaDem]["CongTinh"].ToString();
                                                        second = dGioNgayHomTruoc.Second;
                                                        sGiayGioVao = second.ToString();
                                                        second = dGioRaNgayTruocTuDongQuaDem.Second;
                                                        sGiayGioRa = second.ToString();
                                                        dGioVaoKhaiBaoTuDongQuaDemA = Convert.ToDateTime(dtThongSoCaLamViecTuDongQuaDem.Rows[iThongSoCaLamViecTuDongQuaDem]["GioVaoLamViec"].ToString());
                                                        sGioVaoKhaiBaoTuDongQuaDemA = string.Format("{0:T}", dGioVaoKhaiBaoTuDongQuaDemA).Replace("00 ", string.Concat(sGiayGioVao, " "));
                                                        sGioVaoKhaiBaoTuDongQuaDemB = string.Concat(sNgayCham, " ", sGioVaoKhaiBaoTuDongQuaDemA);
                                                        dGioRaKhaiBaoTuDongQuaDemA = Convert.ToDateTime(dtThongSoCaLamViecTuDongQuaDem.Rows[iThongSoCaLamViecTuDongQuaDem]["GioKetThucLamViec"].ToString());
                                                        sGioRaKhaiBaoTuDongQuaDemA = string.Format("{0:T}", dGioRaKhaiBaoTuDongQuaDemA).Replace("00 ", string.Concat(sGiayGioRa, " "));
                                                        sGioRaKhaiBaoTuDongQuaDemB = string.Concat(sNgayCham, " ", sGioRaKhaiBaoTuDongQuaDemA);
                                                        sCatChuoi = sGioRaKhaiBaoTuDongQuaDemB.Substring(sGioRaKhaiBaoTuDongQuaDemB.Length - 2);
                                                        sTruGioDiTre = dtThongSoCaLamViecTuDongQuaDem.Rows[iThongSoCaLamViecTuDongQuaDem]["TruGioDiTre"].ToString();
                                                        sBatDauTinhDiTre = dtThongSoCaLamViecTuDongQuaDem.Rows[iThongSoCaLamViecTuDongQuaDem]["BatDauTinhDiTre"].ToString();
                                                        if (!(sTruGioDiTre == "True"))
                                                        {
                                                            this.DGVTinhCong.Rows[_nhanVien - 1].Cells[9].Value = "0";
                                                        }
                                                        else
                                                        {
                                                            iChoPhepTreTuDongQuaDem = Convert.ToInt32(dtThongSoCaLamViecTuDongQuaDem.Rows[iThongSoCaLamViecTuDongQuaDem]["ChoPhepDiTre"].ToString());
                                                            if (!(sBatDauTinhDiTre == "True"))
                                                            {
                                                                dateTime = Convert.ToDateTime(sGioVaoKhaiBaoTuDongQuaDemB);
                                                                value = dGioNgayHomTruoc - dateTime.AddDays(-1);
                                                                iPhutTreTuDongQuaDem = Convert.ToInt32(value.TotalMinutes) - iChoPhepTreTuDongQuaDem;
                                                                if (iPhutTreTuDongQuaDem <= 0)
                                                                {
                                                                    this.DGVTinhCong.Rows[_nhanVien - 1].Cells[9].Value = "0";
                                                                }
                                                                else
                                                                {
                                                                    DataGridViewCell str6 = this.DGVTinhCong.Rows[_nhanVien - 1].Cells[9];
                                                                    dateTime = Convert.ToDateTime(sGioVaoKhaiBaoTuDongQuaDemB);
                                                                    value = dGioNgayHomTruoc - dateTime.AddDays(-1);
                                                                    second = Convert.ToInt32(value.TotalMinutes);
                                                                    str6.Value = second.ToString();
                                                                }
                                                            }
                                                            else
                                                            {
                                                                dateTime = Convert.ToDateTime(sGioVaoKhaiBaoTuDongQuaDemB);
                                                                value = dGioNgayHomTruoc - dateTime.AddDays(-1);
                                                                iPhutTreTuDongQuaDem = Convert.ToInt32(value.TotalMinutes) - iChoPhepTreTuDongQuaDem;
                                                                if (iPhutTreTuDongQuaDem <= 0)
                                                                {
                                                                    this.DGVTinhCong.Rows[_nhanVien - 1].Cells[9].Value = "0";
                                                                }
                                                                else
                                                                {
                                                                    this.DGVTinhCong.Rows[_nhanVien - 1].Cells[9].Value = iPhutTreTuDongQuaDem.ToString();
                                                                }
                                                            }
                                                        }
                                                        sTruGioVeSom = dtThongSoCaLamViecTuDongQuaDem.Rows[iThongSoCaLamViecTuDongQuaDem]["TruGioVeSom"].ToString();
                                                        sBatDauTinhVeSom = dtThongSoCaLamViecTuDongQuaDem.Rows[iThongSoCaLamViecTuDongQuaDem]["BatDauTinhVeSom"].ToString();
                                                        if (!(sTruGioVeSom == "True"))
                                                        {
                                                            this.DGVTinhCong.Rows[_nhanVien - 1].Cells[10].Value = "0";
                                                        }
                                                        else
                                                        {
                                                            iChoPhepVeSomTuDongQuaDem = Convert.ToInt32(dtThongSoCaLamViecTuDongQuaDem.Rows[iThongSoCaLamViecTuDongQuaDem]["ChoPhepVeSom"].ToString());
                                                            if (!(sBatDauTinhVeSom == "True"))
                                                            {
                                                                value = Convert.ToDateTime(sGioRaKhaiBaoTuDongQuaDemB) - dGioRaNgayTruocTuDongQuaDem;
                                                                iPhutVeSomTuDongQuaDem = Convert.ToInt32(value.TotalMinutes) - iChoPhepVeSomTuDongQuaDem;
                                                                if (iPhutVeSomTuDongQuaDem <= 0)
                                                                {
                                                                    this.DGVTinhCong.Rows[_nhanVien - 1].Cells[10].Value = "0";
                                                                }
                                                                else
                                                                {
                                                                    DataGridViewCell str7 = this.DGVTinhCong.Rows[_nhanVien - 1].Cells[10];
                                                                    value = Convert.ToDateTime(sGioRaKhaiBaoTuDongQuaDemB) - dGioRaNgayTruocTuDongQuaDem;
                                                                    second = Convert.ToInt32(value.TotalMinutes);
                                                                    str7.Value = second.ToString();
                                                                }
                                                            }
                                                            else if (!(sCatChuoi == "PM"))
                                                            {
                                                                value = Convert.ToDateTime(sGioRaKhaiBaoTuDongQuaDemB) - dGioRaNgayTruocTuDongQuaDem;
                                                                iPhutVeSomTuDongQuaDem = Convert.ToInt32(value.TotalMinutes) - iChoPhepVeSomTuDongQuaDem;
                                                                if (iPhutVeSomTuDongQuaDem <= 0)
                                                                {
                                                                    this.DGVTinhCong.Rows[_nhanVien - 1].Cells[10].Value = "0";
                                                                }
                                                                else
                                                                {
                                                                    this.DGVTinhCong.Rows[_nhanVien - 1].Cells[10].Value = iPhutVeSomTuDongQuaDem.ToString();
                                                                }
                                                            }
                                                            else
                                                            {
                                                                dateTime = Convert.ToDateTime(sGioRaKhaiBaoTuDongQuaDemB);
                                                                value = dateTime.AddDays(-1) - dGioRaNgayTruocTuDongQuaDem;
                                                                iPhutVeSomTuDongQuaDem = Convert.ToInt32(value.TotalMinutes) - iChoPhepVeSomTuDongQuaDem;
                                                                if (iPhutVeSomTuDongQuaDem <= 0)
                                                                {
                                                                    this.DGVTinhCong.Rows[_nhanVien - 1].Cells[10].Value = "0";
                                                                }
                                                                else
                                                                {
                                                                    this.DGVTinhCong.Rows[_nhanVien - 1].Cells[10].Value = iPhutVeSomTuDongQuaDem.ToString();
                                                                }
                                                            }
                                                        }
                                                        if (!(sCatChuoi == "PM"))
                                                        {
                                                            value = dGioRaNgayTruocTuDongQuaDem - Convert.ToDateTime(sGioRaKhaiBaoTuDongQuaDemB);
                                                            iPhutVeTre = Convert.ToInt32(value.TotalMinutes);
                                                            if (iPhutVeTre <= 0)
                                                            {
                                                                this.DGVTinhCong.Rows[_nhanVien - 1].Cells[11].Value = "0";
                                                            }
                                                            else
                                                            {
                                                                this.DGVTinhCong.Rows[_nhanVien - 1].Cells[11].Value = iPhutVeTre;
                                                            }
                                                        }
                                                        else
                                                        {
                                                            dateTime = Convert.ToDateTime(sGioRaKhaiBaoTuDongQuaDemB);
                                                            value = dGioRaNgayTruocTuDongQuaDem - dateTime.AddDays(-1);
                                                            iPhutVeTre = Convert.ToInt32(value.TotalMinutes);
                                                            if (iPhutVeTre <= 0)
                                                            {
                                                                this.DGVTinhCong.Rows[_nhanVien - 1].Cells[11].Value = "0";
                                                            }
                                                            else
                                                            {
                                                                this.DGVTinhCong.Rows[_nhanVien - 1].Cells[11].Value = iPhutVeTre;
                                                            }
                                                        }
                                                        dTongGioTrongCaTuDongQuaDem = Convert.ToDouble(dtThongSoCaLamViecTuDongQuaDem.Rows[iThongSoCaLamViecTuDongQuaDem]["TongGioTrongCaLamViec"].ToString());
                                                        dTongCongTrongCaTuDongQuaDem = Convert.ToDouble(dtThongSoCaLamViecTuDongQuaDem.Rows[iThongSoCaLamViecTuDongQuaDem]["CongTinh"].ToString());
                                                        dTongPhutTreSomTuDongQuaDem = Convert.ToDouble(this.DGVTinhCong.Rows[_nhanVien - 1].Cells[9].Value.ToString()) + Convert.ToDouble(this.DGVTinhCong.Rows[_nhanVien - 1].Cells[10].Value.ToString());
                                                        dSoPhutLamDuocTrongCa = dTongGioTrongCaTuDongQuaDem * 60 - dTongPhutTreSomTuDongQuaDem;
                                                        this.DGVTinhCong.Rows[_nhanVien - 1].Cells[8].Value = Math.Round(dSoPhutLamDuocTrongCa / 60, this.iLamTronGio);
                                                        this.DGVTinhCong.Rows[_nhanVien - 1].Cells[7].Value = Math.Round(Convert.ToDouble(this.DGVTinhCong.Rows[_nhanVien - 1].Cells[8].Value.ToString()) * dTongCongTrongCaTuDongQuaDem / dTongGioTrongCaTuDongQuaDem, this.iLamTronCong);
                                                        sChoPhepTangCaTruocGioLamViecTuDongQuaDem = dtThongSoCaLamViecTuDongQuaDem.Rows[iThongSoCaLamViecTuDongQuaDem]["TangCaTruocGioLamViec"].ToString();
                                                        iPhutTangCaTruocGioLamViecTuDongQuaDem = Convert.ToInt32(dtThongSoCaLamViecTuDongQuaDem.Rows[iThongSoCaLamViecTuDongQuaDem]["SoPhutTangCaTruocGioLamViec"].ToString());
                                                        iPhutTangCaTruocGioLamViecDatDen = Convert.ToInt32(dtThongSoCaLamViecTuDongQuaDem.Rows[iThongSoCaLamViecTuDongQuaDem]["TangCaTruocGioLamViecDatDen"].ToString());
                                                        iPhutTruTangCaTruoc = Convert.ToInt32(dtThongSoCaLamViecTuDongQuaDem.Rows[iThongSoCaLamViecTuDongQuaDem]["PhutTruTangCaTruoc"].ToString());
                                                        sChoPhepTangCaSauGioLamViecTuDongQuaDem = dtThongSoCaLamViecTuDongQuaDem.Rows[iThongSoCaLamViecTuDongQuaDem]["TangCaSauGioLamViec"].ToString();
                                                        iPhutTangCaSauGioLamViecTuDongQuaDem = Convert.ToInt32(dtThongSoCaLamViecTuDongQuaDem.Rows[iThongSoCaLamViecTuDongQuaDem]["SoPhutTangCaSauGioLamViec"].ToString());
                                                        iPhutTangCaSauGioLamViecDatDen = Convert.ToInt32(dtThongSoCaLamViecTuDongQuaDem.Rows[iThongSoCaLamViecTuDongQuaDem]["TangCaSauGioLamViecDatDen"].ToString());
                                                        iPhutTruTangCaSau = Convert.ToInt32(dtThongSoCaLamViecTuDongQuaDem.Rows[iThongSoCaLamViecTuDongQuaDem]["PhutTruTangCaSau"].ToString());
                                                        iGioiHanTC1TuDongQuaDem = Convert.ToInt32(dtThongSoCaLamViecTuDongQuaDem.Rows[iThongSoCaLamViecTuDongQuaDem]["GioiHanTangCa1"].ToString());
                                                        iGioiHanTC2TuDongQuaDem = Convert.ToInt32(dtThongSoCaLamViecTuDongQuaDem.Rows[iThongSoCaLamViecTuDongQuaDem]["GioiHanTangCa2"].ToString());
                                                        iGioiHanTC3TuDongQuaDem = Convert.ToInt32(dtThongSoCaLamViecTuDongQuaDem.Rows[iThongSoCaLamViecTuDongQuaDem]["GioiHanTangCa3"].ToString());
                                                        iGioiHanTC4TuDongQuaDem = Convert.ToInt32(dtThongSoCaLamViecTuDongQuaDem.Rows[iThongSoCaLamViecTuDongQuaDem]["GioiHanTangCa4"].ToString());
                                                        iTongGioTangCaSauTuDongQuaDem = 0;
                                                        iTongGioTangCaTruocTuDongQuaDem = 0;
                                                        if ((sChoPhepTangCaTruocGioLamViecTuDongQuaDem != "False" ? true : !(sChoPhepTangCaSauGioLamViecTuDongQuaDem == "False")))
                                                        {
                                                            if (sChoPhepTangCaTruocGioLamViecTuDongQuaDem == "True")
                                                            {
                                                                dateTime = Convert.ToDateTime(sGioVaoKhaiBaoTuDongQuaDemB);
                                                                value = dateTime.AddDays(-1) - dGioNgayHomTruoc;
                                                                second = Convert.ToInt32(value.TotalMinutes);
                                                                iThoiGianTruocGioLamTuDongQuaDem = Convert.ToInt32(second.ToString());
                                                                if (iThoiGianTruocGioLamTuDongQuaDem > 0)
                                                                {
                                                                    if (iThoiGianTruocGioLamTuDongQuaDem > iPhutTangCaTruocGioLamViecTuDongQuaDem)
                                                                    {
                                                                        if (iThoiGianTruocGioLamTuDongQuaDem > iPhutTangCaTruocGioLamViecDatDen)
                                                                        {
                                                                            iTongGioTangCaTruocTuDongQuaDem = iThoiGianTruocGioLamTuDongQuaDem - iPhutTruTangCaTruoc;
                                                                        }
                                                                    }
                                                                }
                                                            }
                                                            if (sChoPhepTangCaSauGioLamViecTuDongQuaDem == "True")
                                                            {
                                                                if (!(sCatChuoi == "PM"))
                                                                {
                                                                    value = dGioRaNgayTruocTuDongQuaDem - Convert.ToDateTime(sGioRaKhaiBaoTuDongQuaDemB);
                                                                    second = Convert.ToInt32(value.TotalMinutes);
                                                                    iThoiGianSauGioLamViecTuDongQuaDem = Convert.ToInt32(second.ToString());
                                                                    if (iThoiGianSauGioLamViecTuDongQuaDem > 0)
                                                                    {
                                                                        if (iThoiGianSauGioLamViecTuDongQuaDem > iPhutTangCaSauGioLamViecTuDongQuaDem)
                                                                        {
                                                                            if (iThoiGianSauGioLamViecTuDongQuaDem > iPhutTangCaSauGioLamViecDatDen)
                                                                            {
                                                                                iTongGioTangCaSauTuDongQuaDem = iThoiGianSauGioLamViecTuDongQuaDem - iPhutTruTangCaSau;
                                                                            }
                                                                        }
                                                                    }
                                                                }
                                                                else
                                                                {
                                                                    dateTime = Convert.ToDateTime(sGioRaKhaiBaoTuDongQuaDemB);
                                                                    value = dGioRaNgayTruocTuDongQuaDem - dateTime.AddDays(-1);
                                                                    second = Convert.ToInt32(value.TotalMinutes);
                                                                    iThoiGianSauGioLamViecTuDongQuaDem = Convert.ToInt32(second.ToString());
                                                                    if (iThoiGianSauGioLamViecTuDongQuaDem > 0)
                                                                    {
                                                                        if (iThoiGianSauGioLamViecTuDongQuaDem > iPhutTangCaSauGioLamViecTuDongQuaDem)
                                                                        {
                                                                            if (iThoiGianSauGioLamViecTuDongQuaDem > iPhutTangCaSauGioLamViecDatDen)
                                                                            {
                                                                                iTongGioTangCaSauTuDongQuaDem = iThoiGianSauGioLamViecTuDongQuaDem - iPhutTruTangCaSau;
                                                                            }
                                                                        }
                                                                    }
                                                                }
                                                            }
                                                        }
                                                        else
                                                        {
                                                            this.DGVTinhCong.Rows[_nhanVien].Cells[12].Value = "0";
                                                            this.DGVTinhCong.Rows[_nhanVien].Cells[13].Value = "0";
                                                            this.DGVTinhCong.Rows[_nhanVien].Cells[14].Value = "0";
                                                            this.DGVTinhCong.Rows[_nhanVien].Cells[15].Value = "0";
                                                        }
                                                        dTongThoiGianTangCaTuDongQuaDem = Convert.ToDouble(iTongGioTangCaTruocTuDongQuaDem + iTongGioTangCaSauTuDongQuaDem);
                                                        if (dTongThoiGianTangCaTuDongQuaDem <= 0)
                                                        {
                                                            this.DGVTinhCong.Rows[_nhanVien - 1].Cells[12].Value = "0";
                                                            this.DGVTinhCong.Rows[_nhanVien - 1].Cells[13].Value = "0";
                                                            this.DGVTinhCong.Rows[_nhanVien - 1].Cells[14].Value = "0";
                                                            this.DGVTinhCong.Rows[_nhanVien - 1].Cells[15].Value = "0";
                                                        }
                                                        else
                                                        {
                                                            if (iGioiHanTC1TuDongQuaDem == 0)
                                                            {
                                                                this.DGVTinhCong.Rows[_nhanVien - 1].Cells[12].Value = Math.Round(dTongThoiGianTangCaTuDongQuaDem * this.dTangCa1HeSo / 60, this.iLamTronGio);
                                                                this.DGVTinhCong.Rows[_nhanVien - 1].Cells[13].Value = "0";
                                                                this.DGVTinhCong.Rows[_nhanVien - 1].Cells[14].Value = "0";
                                                                this.DGVTinhCong.Rows[_nhanVien - 1].Cells[15].Value = "0";
                                                            }
                                                            if ((iGioiHanTC1TuDongQuaDem == 0 ? false : iGioiHanTC2TuDongQuaDem == 0))
                                                            {
                                                                if (dTongThoiGianTangCaTuDongQuaDem >= Convert.ToDouble(iGioiHanTC1TuDongQuaDem))
                                                                {
                                                                    this.DGVTinhCong.Rows[_nhanVien - 1].Cells[12].Value = Math.Round(Convert.ToDouble(iGioiHanTC1TuDongQuaDem) / 60 * this.dTangCa1HeSo, this.iLamTronGio);
                                                                    if (dTongThoiGianTangCaTuDongQuaDem - Convert.ToDouble(iGioiHanTC1TuDongQuaDem) > 0)
                                                                    {
                                                                        this.DGVTinhCong.Rows[_nhanVien - 1].Cells[13].Value = Math.Round((dTongThoiGianTangCaTuDongQuaDem - Convert.ToDouble(iGioiHanTC1TuDongQuaDem)) * this.dTangCa2HeSo / 60, this.iLamTronGio);
                                                                    }
                                                                    this.DGVTinhCong.Rows[_nhanVien - 1].Cells[14].Value = "0";
                                                                    this.DGVTinhCong.Rows[_nhanVien - 1].Cells[15].Value = "0";
                                                                }
                                                                else
                                                                {
                                                                    this.DGVTinhCong.Rows[_nhanVien - 1].Cells[12].Value = Math.Round(dTongThoiGianTangCaTuDongQuaDem * this.dTangCa1HeSo / 60, this.iLamTronGio);
                                                                    this.DGVTinhCong.Rows[_nhanVien - 1].Cells[13].Value = "0";
                                                                    this.DGVTinhCong.Rows[_nhanVien - 1].Cells[14].Value = "0";
                                                                    this.DGVTinhCong.Rows[_nhanVien - 1].Cells[15].Value = "0";
                                                                }
                                                            }
                                                            if ((iGioiHanTC1TuDongQuaDem == 0 || iGioiHanTC2TuDongQuaDem == 0 ? false : iGioiHanTC3TuDongQuaDem == 0))
                                                            {
                                                                if (dTongThoiGianTangCaTuDongQuaDem >= Convert.ToDouble(iGioiHanTC1TuDongQuaDem))
                                                                {
                                                                    this.DGVTinhCong.Rows[_nhanVien - 1].Cells[12].Value = Math.Round(Convert.ToDouble(iGioiHanTC1TuDongQuaDem) * this.dTangCa1HeSo / 60, this.iLamTronGio);
                                                                    if (dTongThoiGianTangCaTuDongQuaDem - Convert.ToDouble(iGioiHanTC1TuDongQuaDem) >= Convert.ToDouble(iGioiHanTC2TuDongQuaDem))
                                                                    {
                                                                        this.DGVTinhCong.Rows[_nhanVien - 1].Cells[12].Value = Math.Round(Convert.ToDouble(iGioiHanTC1TuDongQuaDem) * this.dTangCa1HeSo / 60, this.iLamTronGio);
                                                                        this.DGVTinhCong.Rows[_nhanVien - 1].Cells[13].Value = Math.Round(Convert.ToDouble(iGioiHanTC2TuDongQuaDem) * this.dTangCa2HeSo / 60, this.iLamTronGio);
                                                                        this.DGVTinhCong.Rows[_nhanVien - 1].Cells[14].Value = Math.Round((dTongThoiGianTangCaTuDongQuaDem - Convert.ToDouble(iGioiHanTC1TuDongQuaDem) - Convert.ToDouble(iGioiHanTC2TuDongQuaDem)) * this.dTangCa3HeSo / 60, this.iLamTronGio);
                                                                        this.DGVTinhCong.Rows[_nhanVien - 1].Cells[15].Value = "0";
                                                                    }
                                                                    else
                                                                    {
                                                                        this.DGVTinhCong.Rows[_nhanVien - 1].Cells[13].Value = Math.Round((dTongThoiGianTangCaTuDongQuaDem - Convert.ToDouble(iGioiHanTC1TuDongQuaDem)) * this.dTangCa2HeSo / 60, this.iLamTronGio);
                                                                        this.DGVTinhCong.Rows[_nhanVien - 1].Cells[14].Value = "0";
                                                                        this.DGVTinhCong.Rows[_nhanVien - 1].Cells[15].Value = "0";
                                                                    }
                                                                }
                                                                else
                                                                {
                                                                    this.DGVTinhCong.Rows[_nhanVien - 1].Cells[12].Value = Math.Round(dTongThoiGianTangCaTuDongQuaDem * this.dTangCa1HeSo / 60, this.iLamTronGio);
                                                                    this.DGVTinhCong.Rows[_nhanVien - 1].Cells[13].Value = "0";
                                                                    this.DGVTinhCong.Rows[_nhanVien - 1].Cells[14].Value = "0";
                                                                    this.DGVTinhCong.Rows[_nhanVien - 1].Cells[15].Value = "0";
                                                                }
                                                            }
                                                            if ((iGioiHanTC1TuDongQuaDem == 0 || iGioiHanTC2TuDongQuaDem == 0 || iGioiHanTC3TuDongQuaDem == 0 ? false : iGioiHanTC4TuDongQuaDem == 0))
                                                            {
                                                            }
                                                        }
                                                        this.DGVTinhCong.Rows[_nhanVien - 1].Cells[18].Value = this.sKHDungGio;
                                                        if (!(DateTimeProgress.XuatThuQuaDem((int)dt.AddDays((double)dem).DayOfWeek) == "1"))
                                                        {
                                                            this.DGVTinhCong.Rows[_nhanVien - 1].Cells[19].Value = "NT";
                                                        }
                                                        else
                                                        {
                                                            this.DGVTinhCong.Rows[_nhanVien - 1].Cells[19].Value = "CN";
                                                        }
                                                        this.DGVTinhCong.Rows[_nhanVien - 1].Cells[20].Value = this.sMaChamCong;
                                                        this.DGVTinhCong.Rows[_nhanVien - 1].Cells[21].Value = this.sPhongBanTinhCong;
                                                    }
                                                }
                                                break;
                                            //Label57:;
                                            }
                                        }
                                        else
                                        {
                                            if (demTuDongQuaDem == 1)
                                            {
                                                dGioVaoTuDongQuaDem = Convert.ToDateTime(dtTuDongQuaDem.Rows[iTuDongQuaDem]["GioCham"].ToString());
                                                this.DGVTinhCong.Rows[_nhanVien].Cells[5].Value = string.Format(this.sDinhDangThoiGian, dGioVaoTuDongQuaDem);
                                                dtNhanCaTuDongQuaDem = new System.Data.DataTable();
                                                this._chiTietLichTrinhChoCalamViecDTO.MaLichTrinhCaLamViec = sLTCCLVNhanVien;
                                                this._chiTietLichTrinhChoCalamViecDTO.Thu = sThu;
                                                dtNhanCaTuDongQuaDem = this._chiTietLichTrinhChoCaLamViecBLL.ChiTietLichTrinhChoCaLamViecNhanCa(this._chiTietLichTrinhChoCalamViecDTO);
                                                iChiTietLichTrinhChoCaLamViecTuDongQuaDem = 0;
                                                if (iChiTietLichTrinhChoCaLamViecTuDongQuaDem < dtNhanCaTuDongQuaDem.Rows.Count)
                                                {
                                                    cellChiTietLichTrinhChoCaLamViecTuDongQuaDem = 3;
                                                    while (cellChiTietLichTrinhChoCaLamViecTuDongQuaDem < 13)
                                                    {
                                                        kiemTraVao = 0;
                                                        kiemTraRa = 0;
                                                        this.sTuDongQuaDemMaCaLamViec = dtNhanCaTuDongQuaDem.Rows[iChiTietLichTrinhChoCaLamViecTuDongQuaDem][cellChiTietLichTrinhChoCaLamViecTuDongQuaDem].ToString();
                                                        dtTuDongQuaDemCa = new System.Data.DataTable();
                                                        this._caLamViecDTO.MaCaLamViec = this.sTuDongQuaDemMaCaLamViec;
                                                        dtTuDongQuaDemCa = this._caLamViecBLL.CaLamViecGetByMaCaLamViec(this._caLamViecDTO);
                                                        iTuDongQuaDemCa = 0;
                                                        while (iTuDongQuaDemCa < dtTuDongQuaDemCa.Rows.Count)
                                                        {
                                                            this.sTuDongQuaDemTenCaLamViec = dtTuDongQuaDemCa.Rows[iTuDongQuaDemCa]["CaLamViec"].ToString();
                                                            dBatDauVaoA = Convert.ToDateTime(dtTuDongQuaDemCa.Rows[iTuDongQuaDemCa]["BatDauVao"].ToString());
                                                            sBatDauVaoA = string.Format("{0:T}", dBatDauVaoA);
                                                            sBatDauVaoB = string.Concat(sNgayCham, " ", sBatDauVaoA);
                                                            dBatDauVaoB = Convert.ToDateTime(sBatDauVaoB);
                                                            dKetThucVaoA = Convert.ToDateTime(dtTuDongQuaDemCa.Rows[iTuDongQuaDemCa]["KetThucVao"].ToString());
                                                            sKetThucVaoA = string.Format("{0:T}", dKetThucVaoA);
                                                            sKetThucVaoB = string.Concat(sNgayCham, " ", sKetThucVaoA);
                                                            dKetThucVaoB = Convert.ToDateTime(sKetThucVaoB);
                                                            dBatDauRaA = Convert.ToDateTime(dtTuDongQuaDemCa.Rows[iTuDongQuaDemCa]["BatDauRa"].ToString());
                                                            sBatDauRaA = string.Format("{0:T}", dBatDauRaA);
                                                            sBatDauRaB = string.Concat(sNgayCham, " ", sBatDauRaA);
                                                            dBatDauRaB = Convert.ToDateTime(sBatDauRaB);
                                                            dKetThucRaA = Convert.ToDateTime(dtTuDongQuaDemCa.Rows[iTuDongQuaDemCa]["KetThucRa"].ToString());
                                                            sKetThucRaA = string.Format("{0:T}", dKetThucRaA);
                                                            sKetThucRaB = string.Concat(sNgayCham, " ", sKetThucRaA);
                                                            dKetThucRaB = Convert.ToDateTime(sKetThucRaB);
                                                            if ((dGioVaoTuDongQuaDem < dBatDauVaoB ? false : dGioVaoTuDongQuaDem <= dKetThucVaoB))
                                                            {
                                                                kiemTraVao++;
                                                            }
                                                            if ((dGioRaTuDongQuaDem < dBatDauRaB ? false : dGioRaTuDongQuaDem <= dKetThucRaB))
                                                            {
                                                                kiemTraRa++;
                                                            }
                                                            if ((kiemTraVao != 1 ? true : kiemTraRa != 0))
                                                            {
                                                                iTuDongQuaDemCa++;
                                                            }
                                                            else
                                                            {
                                                                goto Label62;
                                                            }
                                                        }
                                                        if (!(this.sTuDongQuaDemMaCaLamViec == ""))
                                                        {
                                                            cellChiTietLichTrinhChoCaLamViecTuDongQuaDem++;
                                                        }
                                                        else
                                                        {
                                                            this.DGVTinhCong.Rows[_nhanVien].Cells[4].Value = "***";
                                                            this.DGVTinhCong.Rows[_nhanVien].Cells[7].Value = "0";
                                                            this.DGVTinhCong.Rows[_nhanVien].Cells[8].Value = "0";
                                                            this.DGVTinhCong.Rows[_nhanVien].Cells[9].Value = "0";
                                                            this.DGVTinhCong.Rows[_nhanVien].Cells[10].Value = "0";
                                                            this.DGVTinhCong.Rows[_nhanVien].Cells[11].Value = "0";
                                                            this.DGVTinhCong.Rows[_nhanVien].Cells[12].Value = "0";
                                                            this.DGVTinhCong.Rows[_nhanVien].Cells[13].Value = "0";
                                                            this.DGVTinhCong.Rows[_nhanVien].Cells[14].Value = "0";
                                                            this.DGVTinhCong.Rows[_nhanVien].Cells[15].Value = "0";
                                                            this.DGVTinhCong.Rows[_nhanVien].Cells[16].Value = "0";
                                                            this.DGVTinhCong.Rows[_nhanVien].Cells[17].Value = "0";
                                                            this.DGVTinhCong.Rows[_nhanVien].Cells[18].Value = this.sKHVang;
                                                            if (!(DateTimeProgress.XuatIDThu((int)dt.AddDays((double)dem).DayOfWeek) == "0"))
                                                            {
                                                                this.DGVTinhCong.Rows[_nhanVien].Cells[19].Value = "NT";
                                                            }
                                                            else
                                                            {
                                                                this.DGVTinhCong.Rows[_nhanVien].Cells[19].Value = "CN";
                                                            }
                                                            this.DGVTinhCong.Rows[_nhanVien].Cells[20].Value = this.sMaChamCong;
                                                            this.DGVTinhCong.Rows[_nhanVien].Cells[21].Value = this.sPhongBanTinhCong;

                                                            break;

                                                            //goto Label61;
                                                        }
                                                    }
                                                  
                                                Label62:
                                                    this.DGVTinhCong.Rows[_nhanVien].Cells[4].Value = this.sTuDongQuaDemTenCaLamViec;
                                                    this.DGVTinhCong.Rows[_nhanVien].Cells[7].Value = "0";
                                                    this.DGVTinhCong.Rows[_nhanVien].Cells[8].Value = "0";
                                                    this.DGVTinhCong.Rows[_nhanVien].Cells[9].Value = "0";
                                                    this.DGVTinhCong.Rows[_nhanVien].Cells[10].Value = "0";
                                                    this.DGVTinhCong.Rows[_nhanVien].Cells[11].Value = "0";
                                                    this.DGVTinhCong.Rows[_nhanVien].Cells[12].Value = "0";
                                                    this.DGVTinhCong.Rows[_nhanVien].Cells[13].Value = "0";
                                                    this.DGVTinhCong.Rows[_nhanVien].Cells[14].Value = "0";
                                                    this.DGVTinhCong.Rows[_nhanVien].Cells[15].Value = "0";
                                                    this.DGVTinhCong.Rows[_nhanVien].Cells[16].Value = "0";
                                                    this.DGVTinhCong.Rows[_nhanVien].Cells[17].Value = "0";
                                                    this.DGVTinhCong.Rows[_nhanVien].Cells[18].Value = this.sKHVang;
                                                    if (!(DateTimeProgress.XuatIDThu((int)dt.AddDays((double)dem).DayOfWeek) == "0"))
                                                    {
                                                        this.DGVTinhCong.Rows[_nhanVien].Cells[19].Value = "NT";
                                                    }
                                                    else
                                                    {
                                                        this.DGVTinhCong.Rows[_nhanVien].Cells[19].Value = "CN";
                                                    }
                                                    this.DGVTinhCong.Rows[_nhanVien].Cells[20].Value = this.sMaChamCong;
                                                    this.DGVTinhCong.Rows[_nhanVien].Cells[21].Value = this.sPhongBanTinhCong;
                                                }

                                                //    Label61:;
                                                break;

                                            }
                                            if (demTuDongQuaDem == 2)
                                            {
                                                dGioRaTuDongQuaDem = Convert.ToDateTime(dtTuDongQuaDem.Rows[iTuDongQuaDem]["GioCham"].ToString());
                                                this.DGVTinhCong.Rows[_nhanVien].Cells[6].Value = string.Format(this.sDinhDangThoiGian, dGioRaTuDongQuaDem);
                                                dtNhanCaTuDongQuaDem = new System.Data.DataTable();
                                                this._chiTietLichTrinhChoCalamViecDTO.MaLichTrinhCaLamViec = sLTCCLVNhanVien;
                                                this._chiTietLichTrinhChoCalamViecDTO.Thu = sThu;
                                                dtNhanCaTuDongQuaDem = this._chiTietLichTrinhChoCaLamViecBLL.ChiTietLichTrinhChoCaLamViecNhanCa(this._chiTietLichTrinhChoCalamViecDTO);
                                                iChiTietLichTrinhChoCaLamViecTuDongQuaDem = 0;
                                                if (iChiTietLichTrinhChoCaLamViecTuDongQuaDem < dtNhanCaTuDongQuaDem.Rows.Count)
                                                {
                                                    cellChiTietLichTrinhChoCaLamViecTuDongQuaDem = 3;
                                                    while (cellChiTietLichTrinhChoCaLamViecTuDongQuaDem < 13)
                                                    {
                                                        kiemTraVao = 0;
                                                        kiemTraRa = 0;
                                                        this.sTuDongQuaDemMaCaLamViec = dtNhanCaTuDongQuaDem.Rows[iChiTietLichTrinhChoCaLamViecTuDongQuaDem][cellChiTietLichTrinhChoCaLamViecTuDongQuaDem].ToString();
                                                        dtTuDongQuaDemCa = new System.Data.DataTable();
                                                        this._caLamViecDTO.MaCaLamViec = this.sTuDongQuaDemMaCaLamViec;
                                                        dtTuDongQuaDemCa = this._caLamViecBLL.CaLamViecGetByMaCaLamViec(this._caLamViecDTO);
                                                        iTuDongQuaDemCa = 0;
                                                        while (iTuDongQuaDemCa < dtTuDongQuaDemCa.Rows.Count)
                                                        {
                                                            second = dGioVaoTuDongQuaDem.Second;
                                                            sGiayGioVao = second.ToString();
                                                            second = dGioRaTuDongQuaDem.Second;
                                                            sGiayGioRa = second.ToString();
                                                            this.sTuDongQuaDemTenCaLamViec = dtTuDongQuaDemCa.Rows[iTuDongQuaDemCa]["CaLamViec"].ToString();
                                                            dBatDauVaoA = Convert.ToDateTime(dtTuDongQuaDemCa.Rows[iTuDongQuaDemCa]["BatDauVao"].ToString());
                                                            sBatDauVaoA = string.Format("{0:T}", dBatDauVaoA).Replace("00 ", string.Concat(sGiayGioVao, " "));
                                                            sBatDauVaoB = string.Concat(sNgayCham, " ", sBatDauVaoA);
                                                            dBatDauVaoB = Convert.ToDateTime(sBatDauVaoB);
                                                            dKetThucVaoA = Convert.ToDateTime(dtTuDongQuaDemCa.Rows[iTuDongQuaDemCa]["KetThucVao"].ToString());
                                                            sKetThucVaoA = string.Format("{0:T}", dKetThucVaoA).Replace("00 ", string.Concat(sGiayGioVao, " "));
                                                            sKetThucVaoB = string.Concat(sNgayCham, " ", sKetThucVaoA);
                                                            dKetThucVaoB = Convert.ToDateTime(sKetThucVaoB);
                                                            dBatDauRaA = Convert.ToDateTime(dtTuDongQuaDemCa.Rows[iTuDongQuaDemCa]["BatDauRa"].ToString());
                                                            sBatDauRaA = string.Format("{0:T}", dBatDauRaA).Replace("00 ", string.Concat(sGiayGioRa, " "));
                                                            sBatDauRaB = string.Concat(sNgayCham, " ", sBatDauRaA);
                                                            dBatDauRaB = Convert.ToDateTime(sBatDauRaB);
                                                            dKetThucRaA = Convert.ToDateTime(dtTuDongQuaDemCa.Rows[iTuDongQuaDemCa]["KetThucRa"].ToString());
                                                            sKetThucRaA = string.Format("{0:T}", dKetThucRaA).Replace("00 ", string.Concat(sGiayGioRa, " "));
                                                            sKetThucRaB = string.Concat(sNgayCham, " ", sKetThucRaA);
                                                            dKetThucRaB = Convert.ToDateTime(sKetThucRaB);
                                                            if ((dGioVaoTuDongQuaDem < dBatDauVaoB ? false : dGioVaoTuDongQuaDem <= dKetThucVaoB))
                                                            {
                                                                kiemTraVao++;
                                                            }
                                                            if ((dGioRaTuDongQuaDem < dBatDauRaB ? false : dGioRaTuDongQuaDem <= dKetThucRaB))
                                                            {
                                                                kiemTraRa++;
                                                            }
                                                            if ((kiemTraVao != 1 ? true : kiemTraRa != 1))
                                                            {
                                                                iTuDongQuaDemCa++;
                                                            }
                                                            else
                                                            {
                                                                goto Label64;
                                                            }
                                                        }
                                                        if (!(this.sTuDongQuaDemMaCaLamViec == ""))
                                                        {
                                                            cellChiTietLichTrinhChoCaLamViecTuDongQuaDem++;
                                                        }
                                                        else
                                                        {
                                                            this.DGVTinhCong.Rows[_nhanVien].Cells[4].Value = "***";
                                                            this.DGVTinhCong.Rows[_nhanVien].Cells[7].Value = "0";
                                                            this.DGVTinhCong.Rows[_nhanVien].Cells[8].Value = "0";
                                                            this.DGVTinhCong.Rows[_nhanVien].Cells[9].Value = "0";
                                                            this.DGVTinhCong.Rows[_nhanVien].Cells[10].Value = "0";
                                                            this.DGVTinhCong.Rows[_nhanVien].Cells[11].Value = "0";
                                                            this.DGVTinhCong.Rows[_nhanVien].Cells[12].Value = "0";
                                                            this.DGVTinhCong.Rows[_nhanVien].Cells[13].Value = "0";
                                                            this.DGVTinhCong.Rows[_nhanVien].Cells[14].Value = "0";
                                                            this.DGVTinhCong.Rows[_nhanVien].Cells[15].Value = "0";
                                                            this.DGVTinhCong.Rows[_nhanVien].Cells[16].Value = "0";
                                                            this.DGVTinhCong.Rows[_nhanVien].Cells[17].Value = "0";
                                                            this.DGVTinhCong.Rows[_nhanVien].Cells[18].Value = this.sKHVang;
                                                            if (!(DateTimeProgress.XuatIDThu((int)dt.AddDays((double)dem).DayOfWeek) == "0"))
                                                            {
                                                                this.DGVTinhCong.Rows[_nhanVien].Cells[19].Value = "NT";
                                                            }
                                                            else
                                                            {
                                                                this.DGVTinhCong.Rows[_nhanVien].Cells[19].Value = "CN";
                                                            }
                                                            this.DGVTinhCong.Rows[_nhanVien].Cells[20].Value = this.sMaChamCong;
                                                            this.DGVTinhCong.Rows[_nhanVien].Cells[21].Value = this.sPhongBanTinhCong;
                                                            //  goto Label63;
                                                            break;
                                                        }
                                                    }
                                              
                                                Label64:
                                                    this.DGVTinhCong.Rows[_nhanVien].Cells[4].Value = this.sTuDongQuaDemTenCaLamViec;
                                                    dtCaLamViecTuDongQuaDem = new System.Data.DataTable();
                                                    this._caLamViecDTO.MaCaLamViec = this.sTuDongQuaDemMaCaLamViec;
                                                    dtCaLamViecTuDongQuaDem = this._caLamViecBLL.CaLamViecGetByMaCaLamViec(this._caLamViecDTO);
                                                    for (iCaLamViecTuDongQuaDem = 0; iCaLamViecTuDongQuaDem < dtCaLamViecTuDongQuaDem.Rows.Count; iCaLamViecTuDongQuaDem++)
                                                    {
                                                        second = dGioVaoTuDongQuaDem.Second;
                                                        sGiayGioVao = second.ToString();
                                                        second = dGioRaTuDongQuaDem.Second;
                                                        sGiayGioRa = second.ToString();
                                                        dGioVaoKhaiBaoTuDongQuaDemA = Convert.ToDateTime(dtCaLamViecTuDongQuaDem.Rows[iCaLamViecTuDongQuaDem]["GioVaoLamViec"].ToString());
                                                        sGioVaoKhaiBaoTuDongQuaDemA = string.Format("{0:T}", dGioVaoKhaiBaoTuDongQuaDemA).Replace("00 ", string.Concat(sGiayGioVao, " "));
                                                        sGioVaoKhaiBaoTuDongQuaDemB = string.Concat(sNgayCham, " ", sGioVaoKhaiBaoTuDongQuaDemA);
                                                        dGioVaoKhaiBaoTuDongQuaDemB = Convert.ToDateTime(sGioVaoKhaiBaoTuDongQuaDemB);
                                                        dGioRaKhaiBaoTuDongQuaDemA = Convert.ToDateTime(dtCaLamViecTuDongQuaDem.Rows[iCaLamViecTuDongQuaDem]["GioKetThucLamViec"].ToString());
                                                        sGioRaKhaiBaoTuDongQuaDemA = string.Format("{0:T}", dGioRaKhaiBaoTuDongQuaDemA).Replace("00 ", string.Concat(sGiayGioRa, " "));
                                                        sGioRaKhaiBaoTuDongQuaDemB = string.Concat(sNgayCham, " ", sGioRaKhaiBaoTuDongQuaDemA);
                                                        dGioRaKhaiBaoTuDongQuaDemB = Convert.ToDateTime(sGioRaKhaiBaoTuDongQuaDemB);
                                                        sTruGioDiTre = dtCaLamViecTuDongQuaDem.Rows[iCaLamViecTuDongQuaDem]["TruGioDiTre"].ToString();
                                                        sBatDauTinhDiTre = dtCaLamViecTuDongQuaDem.Rows[iCaLamViecTuDongQuaDem]["BatDauTinhDiTre"].ToString();
                                                        iChoPhepDiTre = Convert.ToInt32(dtCaLamViecTuDongQuaDem.Rows[iCaLamViecTuDongQuaDem]["ChoPhepDiTre"].ToString());
                                                        value = dGioVaoTuDongQuaDem - dGioVaoKhaiBaoTuDongQuaDemB;
                                                        second = Convert.ToInt32(value.TotalMinutes);
                                                        sPhutTre = second.ToString();
                                                        if (!(sTruGioDiTre == "True"))
                                                        {
                                                            this.DGVTinhCong.Rows[_nhanVien].Cells[9].Value = "0";
                                                        }
                                                        else if (Convert.ToInt32(sPhutTre) >= 0)
                                                        {
                                                            iPhutTre = Convert.ToInt32(sPhutTre) - iChoPhepDiTre;
                                                            if (sBatDauTinhDiTre == "True")
                                                            {
                                                                if (iPhutTre >= 1)
                                                                {
                                                                    this.DGVTinhCong.Rows[_nhanVien].Cells[9].Value = iPhutTre.ToString();
                                                                }
                                                                else
                                                                {
                                                                    this.DGVTinhCong.Rows[_nhanVien].Cells[9].Value = "0";
                                                                }
                                                            }
                                                            else if (iPhutTre >= 1)
                                                            {
                                                                this.DGVTinhCong.Rows[_nhanVien].Cells[9].Value = sPhutTre;
                                                            }
                                                            else
                                                            {
                                                                this.DGVTinhCong.Rows[_nhanVien].Cells[9].Value = "0";
                                                            }
                                                        }
                                                        else
                                                        {
                                                            this.DGVTinhCong.Rows[_nhanVien].Cells[9].Value = "0";
                                                        }
                                                        sTruGioVeSom = dtCaLamViecTuDongQuaDem.Rows[iCaLamViecTuDongQuaDem]["TruGioVeSom"].ToString();
                                                        sBatDauTinhVeSom = dtCaLamViecTuDongQuaDem.Rows[iCaLamViecTuDongQuaDem]["BatDauTinhVeSom"].ToString();
                                                        iChoPhepVeSom = Convert.ToInt32(dtCaLamViecTuDongQuaDem.Rows[iCaLamViecTuDongQuaDem]["ChoPhepVeSom"].ToString());
                                                        value = dGioRaKhaiBaoTuDongQuaDemB - dGioRaTuDongQuaDem;
                                                        second = Convert.ToInt32(value.TotalMinutes);
                                                        sPhutVeSom = second.ToString();
                                                        if (!(sTruGioVeSom == "True"))
                                                        {
                                                            this.DGVTinhCong.Rows[_nhanVien].Cells[10].Value = "0";
                                                        }
                                                        else if (Convert.ToInt32(sPhutVeSom) >= 0)
                                                        {
                                                            iPhutVeSom = Convert.ToInt32(sPhutVeSom) - iChoPhepVeSom;
                                                            if (iPhutVeSom < 1)
                                                            {
                                                                this.DGVTinhCong.Rows[_nhanVien].Cells[10].Value = "0";
                                                            }
                                                            else if (!(sBatDauTinhVeSom == "True"))
                                                            {
                                                                this.DGVTinhCong.Rows[_nhanVien].Cells[10].Value = sPhutVeSom;
                                                            }
                                                            else
                                                            {
                                                                this.DGVTinhCong.Rows[_nhanVien].Cells[10].Value = iPhutVeSom.ToString();
                                                            }
                                                        }
                                                        else
                                                        {
                                                            this.DGVTinhCong.Rows[_nhanVien].Cells[10].Value = "0";
                                                        }
                                                        value = dGioRaTuDongQuaDem - dGioRaKhaiBaoTuDongQuaDemB;
                                                        second = Convert.ToInt32(value.TotalMinutes);
                                                        sVeTre = second.ToString();
                                                        if (Convert.ToInt32(sVeTre) <= 0)
                                                        {
                                                            this.DGVTinhCong.Rows[_nhanVien].Cells[11].Value = "0";
                                                        }
                                                        else
                                                        {
                                                            this.DGVTinhCong.Rows[_nhanVien].Cells[11].Value = sVeTre;
                                                        }
                                                        iPhut = Convert.ToSingle(dtCaLamViecTuDongQuaDem.Rows[iCaLamViecTuDongQuaDem]["TongGioTrongCaLamViec"]) * 60f - (float)(Convert.ToInt32(this.DGVTinhCong.Rows[_nhanVien].Cells[9].Value.ToString()) + Convert.ToInt32(this.DGVTinhCong.Rows[_nhanVien].Cells[10].Value));
                                                        dGio = Math.Round(Convert.ToDouble(iPhut) / 60, this.iLamTronGio);
                                                        this.DGVTinhCong.Rows[_nhanVien].Cells[8].Value = dGio.ToString();
                                                        iGio = Convert.ToDouble(dtCaLamViecTuDongQuaDem.Rows[iCaLamViecTuDongQuaDem]["TongGioTrongCaLamViec"].ToString());
                                                        dCongTinh = Convert.ToDouble(dtCaLamViecTuDongQuaDem.Rows[iCaLamViecTuDongQuaDem]["CongTinh"].ToString());
                                                        dCong = Math.Round(dGio * dCongTinh / iGio, this.iLamTronCong);
                                                        this.DGVTinhCong.Rows[_nhanVien].Cells[7].Value = dCong.ToString();
                                                        value = dGioRaTuDongQuaDem - dGioVaoTuDongQuaDem;
                                                        second = Convert.ToInt32(value.TotalMinutes);
                                                        dTongGioThucTeTuDongQuaDem = Math.Round(Convert.ToDouble(second.ToString()) / 60, this.iLamTronGio);
                                                        this.DGVTinhCong.Rows[_nhanVien].Cells[16].Value = dTongGioThucTeTuDongQuaDem.ToString();
                                                        this.DGVTinhCong.Rows[_nhanVien].Cells[17].Value = dtCaLamViecTuDongQuaDem.Rows[iCaLamViecTuDongQuaDem]["CongTinh"].ToString();
                                                        this.DGVTinhCong.Rows[_nhanVien].Cells[18].Value = this.sKHDungGio;
                                                        sChoPhepTangCaTruocGioLamViecTuDongQuaDem = dtCaLamViecTuDongQuaDem.Rows[iCaLamViecTuDongQuaDem]["TangCaTruocGioLamViec"].ToString();
                                                        iPhutTangCaTruocGioLamViecTuDongQuaDem = Convert.ToInt32(dtCaLamViecTuDongQuaDem.Rows[iCaLamViecTuDongQuaDem]["SoPhutTangCaTruocGioLamViec"].ToString());
                                                        iPhutTangCaTruocGioLamViecDatDen = Convert.ToInt32(dtCaLamViecTuDongQuaDem.Rows[iCaLamViecTuDongQuaDem]["TangCaTruocGioLamViecDatDen"].ToString());
                                                        iPhutTruTangCaTruoc = Convert.ToInt32(dtCaLamViecTuDongQuaDem.Rows[iCaLamViecTuDongQuaDem]["PhutTruTangCaTruoc"].ToString());
                                                        sChoPhepTangCaSauGioLamViecTuDongQuaDem = dtCaLamViecTuDongQuaDem.Rows[iCaLamViecTuDongQuaDem]["TangCaSauGioLamViec"].ToString();
                                                        iPhutTangCaSauGioLamViecTuDongQuaDem = Convert.ToInt32(dtCaLamViecTuDongQuaDem.Rows[iCaLamViecTuDongQuaDem]["SoPhutTangCaSauGioLamViec"].ToString());
                                                        iPhutTangCaSauGioLamViecDatDen = Convert.ToInt32(dtCaLamViecTuDongQuaDem.Rows[iCaLamViecTuDongQuaDem]["TangCaSauGioLamViecDatDen"].ToString());
                                                        iPhutTruTangCaSau = Convert.ToInt32(dtCaLamViecTuDongQuaDem.Rows[iCaLamViecTuDongQuaDem]["PhutTruTangCaSau"].ToString());
                                                        iGioiHanTC1TuDongQuaDem = Convert.ToInt32(dtCaLamViecTuDongQuaDem.Rows[iCaLamViecTuDongQuaDem]["GioiHanTangCa1"].ToString());
                                                        iGioiHanTC2TuDongQuaDem = Convert.ToInt32(dtCaLamViecTuDongQuaDem.Rows[iCaLamViecTuDongQuaDem]["GioiHanTangCa2"].ToString());
                                                        iGioiHanTC3TuDongQuaDem = Convert.ToInt32(dtCaLamViecTuDongQuaDem.Rows[iCaLamViecTuDongQuaDem]["GioiHanTangCa3"].ToString());
                                                        iGioiHanTC4TuDongQuaDem = Convert.ToInt32(dtCaLamViecTuDongQuaDem.Rows[iCaLamViecTuDongQuaDem]["GioiHanTangCa4"].ToString());
                                                        iTongGioTangCaSauTuDongQuaDem = 0;
                                                        iTongGioTangCaTruocTuDongQuaDem = 0;
                                                        if ((sChoPhepTangCaTruocGioLamViecTuDongQuaDem != "False" ? true : !(sChoPhepTangCaSauGioLamViecTuDongQuaDem == "False")))
                                                        {
                                                            if (sChoPhepTangCaTruocGioLamViecTuDongQuaDem == "True")
                                                            {
                                                                value = dGioVaoKhaiBaoTuDongQuaDemB - dGioVaoTuDongQuaDem;
                                                                second = Convert.ToInt32(value.TotalMinutes);
                                                                iThoiGianTruocGioLamTuDongQuaDem = Convert.ToInt32(second.ToString());
                                                                if (iThoiGianTruocGioLamTuDongQuaDem > 0)
                                                                {
                                                                    if (iThoiGianTruocGioLamTuDongQuaDem > iPhutTangCaTruocGioLamViecTuDongQuaDem)
                                                                    {
                                                                        if (iThoiGianTruocGioLamTuDongQuaDem > iPhutTangCaTruocGioLamViecDatDen)
                                                                        {
                                                                            iTongGioTangCaTruocTuDongQuaDem = iThoiGianTruocGioLamTuDongQuaDem - iPhutTruTangCaTruoc;
                                                                        }
                                                                    }
                                                                }
                                                            }
                                                            if (sChoPhepTangCaSauGioLamViecTuDongQuaDem == "True")
                                                            {
                                                                value = dGioRaTuDongQuaDem - dGioRaKhaiBaoTuDongQuaDemB;
                                                                second = Convert.ToInt32(value.TotalMinutes);
                                                                iThoiGianSauGioLamViecTuDongQuaDem = Convert.ToInt32(second.ToString());
                                                                if (iThoiGianSauGioLamViecTuDongQuaDem > 0)
                                                                {
                                                                    if (iThoiGianSauGioLamViecTuDongQuaDem > iPhutTangCaSauGioLamViecTuDongQuaDem)
                                                                    {
                                                                        if (iThoiGianSauGioLamViecTuDongQuaDem > iPhutTangCaSauGioLamViecDatDen)
                                                                        {
                                                                            iTongGioTangCaSauTuDongQuaDem = iThoiGianSauGioLamViecTuDongQuaDem - iPhutTruTangCaSau;
                                                                        }
                                                                    }
                                                                }
                                                            }
                                                        }
                                                        else
                                                        {
                                                            this.DGVTinhCong.Rows[_nhanVien].Cells[12].Value = "0";
                                                            this.DGVTinhCong.Rows[_nhanVien].Cells[13].Value = "0";
                                                            this.DGVTinhCong.Rows[_nhanVien].Cells[14].Value = "0";
                                                            this.DGVTinhCong.Rows[_nhanVien].Cells[15].Value = "0";
                                                        }
                                                        dTongThoiGianTangCaTuDongQuaDem = Convert.ToDouble(iTongGioTangCaTruocTuDongQuaDem + iTongGioTangCaSauTuDongQuaDem);
                                                        if (dTongThoiGianTangCaTuDongQuaDem <= 0)
                                                        {
                                                            this.DGVTinhCong.Rows[_nhanVien].Cells[12].Value = "0";
                                                            this.DGVTinhCong.Rows[_nhanVien].Cells[13].Value = "0";
                                                            this.DGVTinhCong.Rows[_nhanVien].Cells[14].Value = "0";
                                                            this.DGVTinhCong.Rows[_nhanVien].Cells[15].Value = "0";
                                                        }
                                                        else
                                                        {
                                                            if (iGioiHanTC1TuDongQuaDem == 0)
                                                            {
                                                                this.DGVTinhCong.Rows[_nhanVien].Cells[12].Value = Math.Round(dTongThoiGianTangCaTuDongQuaDem * this.dTangCa1HeSo / 60, this.iLamTronGio);
                                                                this.DGVTinhCong.Rows[_nhanVien].Cells[13].Value = "0";
                                                                this.DGVTinhCong.Rows[_nhanVien].Cells[14].Value = "0";
                                                                this.DGVTinhCong.Rows[_nhanVien].Cells[15].Value = "0";
                                                            }
                                                            if ((iGioiHanTC1TuDongQuaDem == 0 ? false : iGioiHanTC2TuDongQuaDem == 0))
                                                            {
                                                                if (dTongThoiGianTangCaTuDongQuaDem >= Convert.ToDouble(iGioiHanTC1TuDongQuaDem))
                                                                {
                                                                    this.DGVTinhCong.Rows[_nhanVien].Cells[12].Value = Math.Round(Convert.ToDouble(iGioiHanTC1TuDongQuaDem) / 60 * this.dTangCa1HeSo, this.iLamTronGio);
                                                                    if (dTongThoiGianTangCaTuDongQuaDem - Convert.ToDouble(iGioiHanTC1TuDongQuaDem) > 0)
                                                                    {
                                                                        this.DGVTinhCong.Rows[_nhanVien].Cells[13].Value = Math.Round((dTongThoiGianTangCaTuDongQuaDem - Convert.ToDouble(iGioiHanTC1TuDongQuaDem)) * this.dTangCa2HeSo / 60, this.iLamTronGio);
                                                                    }
                                                                    this.DGVTinhCong.Rows[_nhanVien].Cells[14].Value = "0";
                                                                    this.DGVTinhCong.Rows[_nhanVien].Cells[15].Value = "0";
                                                                }
                                                                else
                                                                {
                                                                    this.DGVTinhCong.Rows[_nhanVien].Cells[12].Value = Math.Round(dTongThoiGianTangCaTuDongQuaDem * this.dTangCa1HeSo / 60, this.iLamTronGio);
                                                                    this.DGVTinhCong.Rows[_nhanVien].Cells[13].Value = "0";
                                                                    this.DGVTinhCong.Rows[_nhanVien].Cells[14].Value = "0";
                                                                    this.DGVTinhCong.Rows[_nhanVien].Cells[15].Value = "0";
                                                                }
                                                            }
                                                            if ((iGioiHanTC1TuDongQuaDem == 0 || iGioiHanTC2TuDongQuaDem == 0 ? false : iGioiHanTC3TuDongQuaDem == 0))
                                                            {
                                                                if (dTongThoiGianTangCaTuDongQuaDem >= Convert.ToDouble(iGioiHanTC1TuDongQuaDem))
                                                                {
                                                                    this.DGVTinhCong.Rows[_nhanVien].Cells[12].Value = Math.Round(Convert.ToDouble(iGioiHanTC1TuDongQuaDem) * this.dTangCa1HeSo / 60, this.iLamTronGio);
                                                                    if (dTongThoiGianTangCaTuDongQuaDem - Convert.ToDouble(iGioiHanTC1TuDongQuaDem) >= Convert.ToDouble(iGioiHanTC2TuDongQuaDem))
                                                                    {
                                                                        this.DGVTinhCong.Rows[_nhanVien].Cells[12].Value = Math.Round(Convert.ToDouble(iGioiHanTC1TuDongQuaDem) * this.dTangCa1HeSo / 60, this.iLamTronGio);
                                                                        this.DGVTinhCong.Rows[_nhanVien].Cells[13].Value = Math.Round(Convert.ToDouble(iGioiHanTC2TuDongQuaDem) * this.dTangCa2HeSo / 60, this.iLamTronGio);
                                                                        this.DGVTinhCong.Rows[_nhanVien].Cells[14].Value = Math.Round((dTongThoiGianTangCaTuDongQuaDem - Convert.ToDouble(iGioiHanTC1TuDongQuaDem) - Convert.ToDouble(iGioiHanTC2TuDongQuaDem)) * this.dTangCa3HeSo / 60, this.iLamTronGio);
                                                                        this.DGVTinhCong.Rows[_nhanVien].Cells[15].Value = "0";
                                                                    }
                                                                    else
                                                                    {
                                                                        this.DGVTinhCong.Rows[_nhanVien].Cells[13].Value = Math.Round((dTongThoiGianTangCaTuDongQuaDem - Convert.ToDouble(iGioiHanTC1TuDongQuaDem)) * this.dTangCa2HeSo / 60, this.iLamTronGio);
                                                                        this.DGVTinhCong.Rows[_nhanVien].Cells[14].Value = "0";
                                                                        this.DGVTinhCong.Rows[_nhanVien].Cells[15].Value = "0";
                                                                    }
                                                                }
                                                                else
                                                                {
                                                                    this.DGVTinhCong.Rows[_nhanVien].Cells[12].Value = Math.Round(dTongThoiGianTangCaTuDongQuaDem * this.dTangCa1HeSo / 60, this.iLamTronGio);
                                                                    this.DGVTinhCong.Rows[_nhanVien].Cells[13].Value = "0";
                                                                    this.DGVTinhCong.Rows[_nhanVien].Cells[14].Value = "0";
                                                                    this.DGVTinhCong.Rows[_nhanVien].Cells[15].Value = "0";
                                                                }
                                                            }
                                                            if ((iGioiHanTC1TuDongQuaDem == 0 || iGioiHanTC2TuDongQuaDem == 0 || iGioiHanTC3TuDongQuaDem == 0 ? false : iGioiHanTC4TuDongQuaDem == 0))
                                                            {
                                                            }
                                                        }
                                                    }
                                                    if (!(DateTimeProgress.XuatIDThu((int)dt.AddDays((double)dem).DayOfWeek) == "0"))
                                                    {
                                                        this.DGVTinhCong.Rows[_nhanVien].Cells[19].Value = "NT";
                                                    }
                                                    else
                                                    {
                                                        this.DGVTinhCong.Rows[_nhanVien].Cells[19].Value = "CN";
                                                    }
                                                    this.DGVTinhCong.Rows[_nhanVien].Cells[20].Value = this.sMaChamCong;
                                                    this.DGVTinhCong.Rows[_nhanVien].Cells[21].Value = this.sPhongBanTinhCong;
                                                }


                                                break;
                                                //  Label63:;
                                            }
                                            if ((demTuDongQuaDem % 2 == 0 ? false : demTuDongQuaDem != 1))
                                            {
                                                addTuDongQuaDem = this.DGVTinhCong.Rows.Add();
                                                dGioVaoTuDongQuaDem = Convert.ToDateTime(dtTuDongQuaDem.Rows[iTuDongQuaDem]["GioCham"].ToString());
                                                this.DGVTinhCong.Rows[addTuDongQuaDem].Cells[5].Value = string.Format(this.sDinhDangThoiGian, dGioVaoTuDongQuaDem);
                                                this.DGVTinhCong.Rows[addTuDongQuaDem].Cells[0].Value = this.sMaNhanVien;
                                                this.DGVTinhCong.Rows[addTuDongQuaDem].Cells[1].Value = this.sTenNhanVien;
                                                this.DGVTinhCong.Rows[addTuDongQuaDem].Cells[2].Value = this.DGVTinhCong.Rows[_nhanVien].Cells[2].Value.ToString();
                                                if (this.iNgonNgu == 0)
                                                {
                                                    DataGridViewCell item22 = this.DGVTinhCong.Rows[addTuDongQuaDem].Cells[3];
                                                    dateTime = dt.AddDays((double)dem);
                                                    item22.Value = DateTimeProgress.XuatThuTinhCong((int)dateTime.DayOfWeek);
                                                }
                                                if (this.iNgonNgu == 1)
                                                {
                                                    DataGridViewCell dataGridViewCell22 = this.DGVTinhCong.Rows[addTuDongQuaDem].Cells[3];
                                                    dateTime = dt.AddDays((double)dem);
                                                    dataGridViewCell22.Value = DateTimeProgress.XuatThuEnglish((int)dateTime.DayOfWeek);
                                                }
                                                this.DGVTinhCong.Rows[addTuDongQuaDem].Cells[4].Value = "***";
                                                this.DGVTinhCong.Rows[addTuDongQuaDem].Cells[7].Value = "0";
                                                this.DGVTinhCong.Rows[addTuDongQuaDem].Cells[8].Value = "0";
                                                this.DGVTinhCong.Rows[addTuDongQuaDem].Cells[9].Value = "0";
                                                this.DGVTinhCong.Rows[addTuDongQuaDem].Cells[10].Value = "0";
                                                this.DGVTinhCong.Rows[addTuDongQuaDem].Cells[11].Value = "0";
                                                this.DGVTinhCong.Rows[addTuDongQuaDem].Cells[12].Value = "0";
                                                this.DGVTinhCong.Rows[addTuDongQuaDem].Cells[13].Value = "0";
                                                this.DGVTinhCong.Rows[addTuDongQuaDem].Cells[14].Value = "0";
                                                this.DGVTinhCong.Rows[addTuDongQuaDem].Cells[15].Value = "0";
                                                this.DGVTinhCong.Rows[addTuDongQuaDem].Cells[16].Value = "0";
                                                this.DGVTinhCong.Rows[addTuDongQuaDem].Cells[17].Value = "0";
                                                this.DGVTinhCong.Rows[addTuDongQuaDem].Cells[18].Value = this.sKHVang;
                                                if (!(DateTimeProgress.XuatIDThu((int)dt.AddDays((double)dem).DayOfWeek) == "0"))
                                                {
                                                    this.DGVTinhCong.Rows[addTuDongQuaDem].Cells[19].Value = "NT";
                                                }
                                                else
                                                {
                                                    this.DGVTinhCong.Rows[addTuDongQuaDem].Cells[19].Value = "CN";
                                                }
                                                this.DGVTinhCong.Rows[addTuDongQuaDem].Cells[20].Value = this.sMaChamCong;
                                                this.DGVTinhCong.Rows[addTuDongQuaDem].Cells[21].Value = this.sPhongBanTinhCong;
                                            }
                                            if ((demTuDongQuaDem % 2 != 0 ? false : demTuDongQuaDem != 2))
                                            {
                                                dGioRaTuDongQuaDem = Convert.ToDateTime(dtTuDongQuaDem.Rows[iTuDongQuaDem]["GioCham"].ToString());
                                                this.DGVTinhCong.Rows[addTuDongQuaDem].Cells[6].Value = string.Format(this.sDinhDangThoiGian, dGioRaTuDongQuaDem);
                                                dtNhanCaTuDongQuaDem = new System.Data.DataTable();
                                                this._chiTietLichTrinhChoCalamViecDTO.MaLichTrinhCaLamViec = sLTCCLVNhanVien;
                                                this._chiTietLichTrinhChoCalamViecDTO.Thu = sThu;
                                                dtNhanCaTuDongQuaDem = this._chiTietLichTrinhChoCaLamViecBLL.ChiTietLichTrinhChoCaLamViecNhanCa(this._chiTietLichTrinhChoCalamViecDTO);
                                                iChiTietLichTrinhChoCaLamViecTuDongQuaDem = 0;
                                                if (iChiTietLichTrinhChoCaLamViecTuDongQuaDem < dtNhanCaTuDongQuaDem.Rows.Count)
                                                {
                                                    cellChiTietLichTrinhChoCaLamViecTuDongQuaDem = 3;
                                                    while (cellChiTietLichTrinhChoCaLamViecTuDongQuaDem < 13)
                                                    {
                                                        kiemTraVao = 0;
                                                        kiemTraRa = 0;
                                                        this.sTuDongQuaDemMaCaLamViec = dtNhanCaTuDongQuaDem.Rows[iChiTietLichTrinhChoCaLamViecTuDongQuaDem][cellChiTietLichTrinhChoCaLamViecTuDongQuaDem].ToString();
                                                        dtTuDongQuaDemCa = new System.Data.DataTable();
                                                        this._caLamViecDTO.MaCaLamViec = this.sTuDongQuaDemMaCaLamViec;
                                                        dtTuDongQuaDemCa = this._caLamViecBLL.CaLamViecGetByMaCaLamViec(this._caLamViecDTO);
                                                        iTuDongQuaDemCa = 0;
                                                        while (iTuDongQuaDemCa < dtTuDongQuaDemCa.Rows.Count)
                                                        {
                                                            this.sTuDongQuaDemTenCaLamViec = dtTuDongQuaDemCa.Rows[iTuDongQuaDemCa]["CaLamViec"].ToString();
                                                            dBatDauVaoA = Convert.ToDateTime(dtTuDongQuaDemCa.Rows[iTuDongQuaDemCa]["BatDauVao"].ToString());
                                                            sBatDauVaoA = string.Format("{0:T}", dBatDauVaoA);
                                                            sBatDauVaoB = string.Concat(sNgayCham, " ", sBatDauVaoA);
                                                            dBatDauVaoB = Convert.ToDateTime(sBatDauVaoB);
                                                            dKetThucVaoA = Convert.ToDateTime(dtTuDongQuaDemCa.Rows[iTuDongQuaDemCa]["KetThucVao"].ToString());
                                                            sKetThucVaoA = string.Format("{0:T}", dKetThucVaoA);
                                                            sKetThucVaoB = string.Concat(sNgayCham, " ", sKetThucVaoA);
                                                            dKetThucVaoB = Convert.ToDateTime(sKetThucVaoB);
                                                            dBatDauRaA = Convert.ToDateTime(dtTuDongQuaDemCa.Rows[iTuDongQuaDemCa]["BatDauRa"].ToString());
                                                            sBatDauRaA = string.Format("{0:T}", dBatDauRaA);
                                                            sBatDauRaB = string.Concat(sNgayCham, " ", sBatDauRaA);
                                                            dBatDauRaB = Convert.ToDateTime(sBatDauRaB);
                                                            dKetThucRaA = Convert.ToDateTime(dtTuDongQuaDemCa.Rows[iTuDongQuaDemCa]["KetThucRa"].ToString());
                                                            sKetThucRaA = string.Format("{0:T}", dKetThucRaA);
                                                            sKetThucRaB = string.Concat(sNgayCham, " ", sKetThucRaA);
                                                            dKetThucRaB = Convert.ToDateTime(sKetThucRaB);
                                                            if ((dGioVaoTuDongQuaDem < dBatDauVaoB ? false : dGioVaoTuDongQuaDem <= dKetThucVaoB))
                                                            {
                                                                kiemTraVao++;
                                                            }
                                                            if ((dGioRaTuDongQuaDem < dBatDauRaB ? false : dGioRaTuDongQuaDem <= dKetThucRaB))
                                                            {
                                                                kiemTraRa++;
                                                            }
                                                            if ((kiemTraVao != 1 ? true : kiemTraRa != 1))
                                                            {
                                                                iTuDongQuaDemCa++;
                                                            }
                                                            else
                                                            {
                                                                goto Label66;
                                                            }
                                                        }
                                                        if (!(this.sTuDongQuaDemMaCaLamViec == ""))
                                                        {
                                                            cellChiTietLichTrinhChoCaLamViecTuDongQuaDem++;
                                                        }
                                                        else
                                                        {
                                                            this.DGVTinhCong.Rows[addTuDongQuaDem].Cells[4].Value = "***";
                                                            this.DGVTinhCong.Rows[addTuDongQuaDem].Cells[7].Value = "0";
                                                            this.DGVTinhCong.Rows[addTuDongQuaDem].Cells[8].Value = "0";
                                                            this.DGVTinhCong.Rows[addTuDongQuaDem].Cells[9].Value = "0";
                                                            this.DGVTinhCong.Rows[addTuDongQuaDem].Cells[10].Value = "0";
                                                            this.DGVTinhCong.Rows[addTuDongQuaDem].Cells[11].Value = "0";
                                                            this.DGVTinhCong.Rows[addTuDongQuaDem].Cells[12].Value = "0";
                                                            this.DGVTinhCong.Rows[addTuDongQuaDem].Cells[13].Value = "0";
                                                            this.DGVTinhCong.Rows[addTuDongQuaDem].Cells[14].Value = "0";
                                                            this.DGVTinhCong.Rows[addTuDongQuaDem].Cells[15].Value = "0";
                                                            this.DGVTinhCong.Rows[addTuDongQuaDem].Cells[16].Value = "0";
                                                            this.DGVTinhCong.Rows[addTuDongQuaDem].Cells[17].Value = "0";
                                                            this.DGVTinhCong.Rows[addTuDongQuaDem].Cells[18].Value = this.sKHVang;
                                                            if (!(DateTimeProgress.XuatIDThu((int)dt.AddDays((double)dem).DayOfWeek) == "0"))
                                                            {
                                                                this.DGVTinhCong.Rows[addTuDongQuaDem].Cells[19].Value = "NT";
                                                            }
                                                            else
                                                            {
                                                                this.DGVTinhCong.Rows[addTuDongQuaDem].Cells[19].Value = "CN";
                                                            }
                                                            this.DGVTinhCong.Rows[addTuDongQuaDem].Cells[20].Value = this.sMaChamCong;
                                                            this.DGVTinhCong.Rows[addTuDongQuaDem].Cells[21].Value = this.sPhongBanTinhCong;
                                                            // goto Label65;
                                                            break;
                                                        }
                                                    }
                                                  
                                                Label66:
                                                    this.DGVTinhCong.Rows[addTuDongQuaDem].Cells[4].Value = this.sTuDongQuaDemTenCaLamViec;
                                                    dtCaLamViecTuDongQuaDem = new System.Data.DataTable();
                                                    this._caLamViecDTO.MaCaLamViec = this.sTuDongQuaDemMaCaLamViec;
                                                    dtCaLamViecTuDongQuaDem = this._caLamViecBLL.CaLamViecGetByMaCaLamViec(this._caLamViecDTO);
                                                    for (iCaLamViecTuDongQuaDem = 0; iCaLamViecTuDongQuaDem < dtCaLamViecTuDongQuaDem.Rows.Count; iCaLamViecTuDongQuaDem++)
                                                    {
                                                        second = dGioVaoTuDongQuaDem.Second;
                                                        sGiayGioVao = second.ToString();
                                                        second = dGioRaTuDongQuaDem.Second;
                                                        sGiayGioRa = second.ToString();
                                                        dGioVaoKhaiBaoTuDongQuaDemA = Convert.ToDateTime(dtCaLamViecTuDongQuaDem.Rows[iCaLamViecTuDongQuaDem]["GioVaoLamViec"].ToString());
                                                        sGioVaoKhaiBaoTuDongQuaDemA = string.Format("{0:T}", dGioVaoKhaiBaoTuDongQuaDemA).Replace("00 ", string.Concat(sGiayGioVao, " "));
                                                        sGioVaoKhaiBaoTuDongQuaDemB = string.Concat(sNgayCham, " ", sGioVaoKhaiBaoTuDongQuaDemA);
                                                        dGioVaoKhaiBaoTuDongQuaDemB = Convert.ToDateTime(sGioVaoKhaiBaoTuDongQuaDemB);
                                                        dGioRaKhaiBaoTuDongQuaDemA = Convert.ToDateTime(dtCaLamViecTuDongQuaDem.Rows[iCaLamViecTuDongQuaDem]["GioKetThucLamViec"].ToString());
                                                        sGioRaKhaiBaoTuDongQuaDemA = string.Format("{0:T}", dGioRaKhaiBaoTuDongQuaDemA).Replace("00 ", string.Concat(sGiayGioRa, " "));
                                                        sGioRaKhaiBaoTuDongQuaDemB = string.Concat(sNgayCham, " ", sGioRaKhaiBaoTuDongQuaDemA);
                                                        dGioRaKhaiBaoTuDongQuaDemB = Convert.ToDateTime(sGioRaKhaiBaoTuDongQuaDemB);
                                                        sTruGioDiTre = dtCaLamViecTuDongQuaDem.Rows[iCaLamViecTuDongQuaDem]["TruGioDiTre"].ToString();
                                                        sBatDauTinhDiTre = dtCaLamViecTuDongQuaDem.Rows[iCaLamViecTuDongQuaDem]["BatDauTinhDiTre"].ToString();
                                                        iChoPhepDiTre = Convert.ToInt32(dtCaLamViecTuDongQuaDem.Rows[iCaLamViecTuDongQuaDem]["ChoPhepDiTre"].ToString());
                                                        value = dGioVaoTuDongQuaDem - dGioVaoKhaiBaoTuDongQuaDemB;
                                                        second = Convert.ToInt32(value.TotalMinutes);
                                                        sPhutTre = second.ToString();
                                                        if (!(sTruGioDiTre == "True"))
                                                        {
                                                            this.DGVTinhCong.Rows[addTuDongQuaDem].Cells[9].Value = "0";
                                                        }
                                                        else if (Convert.ToInt32(sPhutTre) >= 0)
                                                        {
                                                            iPhutTre = Convert.ToInt32(sPhutTre) - iChoPhepDiTre;
                                                            if (sBatDauTinhDiTre == "True")
                                                            {
                                                                if (iPhutTre >= 1)
                                                                {
                                                                    this.DGVTinhCong.Rows[addTuDongQuaDem].Cells[9].Value = iPhutTre.ToString();
                                                                }
                                                                else
                                                                {
                                                                    this.DGVTinhCong.Rows[addTuDongQuaDem].Cells[9].Value = "0";
                                                                }
                                                            }
                                                            else if (iPhutTre >= 1)
                                                            {
                                                                this.DGVTinhCong.Rows[addTuDongQuaDem].Cells[9].Value = sPhutTre;
                                                            }
                                                            else
                                                            {
                                                                this.DGVTinhCong.Rows[addTuDongQuaDem].Cells[9].Value = "0";
                                                            }
                                                        }
                                                        else
                                                        {
                                                            this.DGVTinhCong.Rows[addTuDongQuaDem].Cells[9].Value = "0";
                                                        }
                                                        sTruGioVeSom = dtCaLamViecTuDongQuaDem.Rows[iCaLamViecTuDongQuaDem]["TruGioVeSom"].ToString();
                                                        sBatDauTinhVeSom = dtCaLamViecTuDongQuaDem.Rows[iCaLamViecTuDongQuaDem]["BatDauTinhVeSom"].ToString();
                                                        iChoPhepVeSom = Convert.ToInt32(dtCaLamViecTuDongQuaDem.Rows[iCaLamViecTuDongQuaDem]["ChoPhepVeSom"].ToString());
                                                        value = dGioRaKhaiBaoTuDongQuaDemB - dGioRaTuDongQuaDem;
                                                        second = Convert.ToInt32(value.TotalMinutes);
                                                        sPhutVeSom = second.ToString();
                                                        if (!(sTruGioVeSom == "True"))
                                                        {
                                                            this.DGVTinhCong.Rows[addTuDongQuaDem].Cells[10].Value = "0";
                                                        }
                                                        else if (Convert.ToInt32(sPhutVeSom) >= 0)
                                                        {
                                                            iPhutVeSom = Convert.ToInt32(sPhutVeSom) - iChoPhepVeSom;
                                                            if (iPhutVeSom < 1)
                                                            {
                                                                this.DGVTinhCong.Rows[addTuDongQuaDem].Cells[10].Value = "0";
                                                            }
                                                            else if (!(sBatDauTinhVeSom == "True"))
                                                            {
                                                                this.DGVTinhCong.Rows[addTuDongQuaDem].Cells[10].Value = sPhutVeSom;
                                                            }
                                                            else
                                                            {
                                                                this.DGVTinhCong.Rows[addTuDongQuaDem].Cells[10].Value = iPhutVeSom.ToString();
                                                            }
                                                        }
                                                        else
                                                        {
                                                            this.DGVTinhCong.Rows[addTuDongQuaDem].Cells[10].Value = "0";
                                                        }
                                                        value = dGioRaTuDongQuaDem - dGioRaKhaiBaoTuDongQuaDemB;
                                                        second = Convert.ToInt32(value.TotalMinutes);
                                                        sVeTre = second.ToString();
                                                        if (Convert.ToInt32(sVeTre) <= 0)
                                                        {
                                                            this.DGVTinhCong.Rows[addTuDongQuaDem].Cells[11].Value = "0";
                                                        }
                                                        else
                                                        {
                                                            this.DGVTinhCong.Rows[addTuDongQuaDem].Cells[11].Value = sVeTre;
                                                        }
                                                        iPhut = Convert.ToSingle(dtCaLamViecTuDongQuaDem.Rows[iCaLamViecTuDongQuaDem]["TongGioTrongCaLamViec"]) * 60f - (float)(Convert.ToInt32(this.DGVTinhCong.Rows[addTuDongQuaDem].Cells[9].Value.ToString()) + Convert.ToInt32(this.DGVTinhCong.Rows[addTuDongQuaDem].Cells[10].Value));
                                                        dGio = Math.Round(Convert.ToDouble(iPhut) / 60, this.iLamTronGio);
                                                        this.DGVTinhCong.Rows[addTuDongQuaDem].Cells[8].Value = dGio.ToString();
                                                        iGio = Convert.ToDouble(dtCaLamViecTuDongQuaDem.Rows[iCaLamViecTuDongQuaDem]["TongGioTrongCaLamViec"].ToString());
                                                        dCongTinh = Convert.ToDouble(dtCaLamViecTuDongQuaDem.Rows[iCaLamViecTuDongQuaDem]["CongTinh"].ToString());
                                                        dCong = Math.Round(dGio * dCongTinh / iGio, this.iLamTronCong);
                                                        this.DGVTinhCong.Rows[addTuDongQuaDem].Cells[7].Value = dCong.ToString();
                                                        value = dGioRaTuDongQuaDem - dGioVaoTuDongQuaDem;
                                                        second = Convert.ToInt32(value.TotalMinutes);
                                                        dTongGioThucTeTuDongQuaDem = Math.Round(Convert.ToDouble(second.ToString()) / 60, this.iLamTronGio);
                                                        this.DGVTinhCong.Rows[addTuDongQuaDem].Cells[16].Value = dTongGioThucTeTuDongQuaDem.ToString();
                                                        this.DGVTinhCong.Rows[addTuDongQuaDem].Cells[17].Value = dtCaLamViecTuDongQuaDem.Rows[iCaLamViecTuDongQuaDem]["CongTinh"].ToString();
                                                        this.DGVTinhCong.Rows[addTuDongQuaDem].Cells[18].Value = this.sKHDungGio;
                                                        sChoPhepTangCaTruocGioLamViecTuDongQuaDem = dtCaLamViecTuDongQuaDem.Rows[iCaLamViecTuDongQuaDem]["TangCaTruocGioLamViec"].ToString();
                                                        iPhutTangCaTruocGioLamViecTuDongQuaDem = Convert.ToInt32(dtCaLamViecTuDongQuaDem.Rows[iCaLamViecTuDongQuaDem]["SoPhutTangCaTruocGioLamViec"].ToString());
                                                        iPhutTangCaTruocGioLamViecDatDen = Convert.ToInt32(dtCaLamViecTuDongQuaDem.Rows[iCaLamViecTuDongQuaDem]["TangCaTruocGioLamViecDatDen"].ToString());
                                                        iPhutTruTangCaTruoc = Convert.ToInt32(dtCaLamViecTuDongQuaDem.Rows[iCaLamViecTuDongQuaDem]["PhutTruTangCaTruoc"].ToString());
                                                        sChoPhepTangCaSauGioLamViecTuDongQuaDem = dtCaLamViecTuDongQuaDem.Rows[iCaLamViecTuDongQuaDem]["TangCaSauGioLamViec"].ToString();
                                                        iPhutTangCaSauGioLamViecTuDongQuaDem = Convert.ToInt32(dtCaLamViecTuDongQuaDem.Rows[iCaLamViecTuDongQuaDem]["SoPhutTangCaSauGioLamViec"].ToString());
                                                        iPhutTangCaSauGioLamViecDatDen = Convert.ToInt32(dtCaLamViecTuDongQuaDem.Rows[iCaLamViecTuDongQuaDem]["TangCaSauGioLamViecDatDen"].ToString());
                                                        iPhutTruTangCaSau = Convert.ToInt32(dtCaLamViecTuDongQuaDem.Rows[iCaLamViecTuDongQuaDem]["PhutTruTangCaSau"].ToString());
                                                        iGioiHanTC1TuDongQuaDem = Convert.ToInt32(dtCaLamViecTuDongQuaDem.Rows[iCaLamViecTuDongQuaDem]["GioiHanTangCa1"].ToString());
                                                        iGioiHanTC2TuDongQuaDem = Convert.ToInt32(dtCaLamViecTuDongQuaDem.Rows[iCaLamViecTuDongQuaDem]["GioiHanTangCa2"].ToString());
                                                        iGioiHanTC3TuDongQuaDem = Convert.ToInt32(dtCaLamViecTuDongQuaDem.Rows[iCaLamViecTuDongQuaDem]["GioiHanTangCa3"].ToString());
                                                        iGioiHanTC4TuDongQuaDem = Convert.ToInt32(dtCaLamViecTuDongQuaDem.Rows[iCaLamViecTuDongQuaDem]["GioiHanTangCa4"].ToString());
                                                        iTongGioTangCaSauTuDongQuaDem = 0;
                                                        iTongGioTangCaTruocTuDongQuaDem = 0;
                                                        if ((sChoPhepTangCaTruocGioLamViecTuDongQuaDem != "False" ? true : !(sChoPhepTangCaSauGioLamViecTuDongQuaDem == "False")))
                                                        {
                                                            if (sChoPhepTangCaTruocGioLamViecTuDongQuaDem == "True")
                                                            {
                                                                value = dGioVaoKhaiBaoTuDongQuaDemB - dGioVaoTuDongQuaDem;
                                                                second = Convert.ToInt32(value.TotalMinutes);
                                                                iThoiGianTruocGioLamTuDongQuaDem = Convert.ToInt32(second.ToString());
                                                                if (iThoiGianTruocGioLamTuDongQuaDem > 0)
                                                                {
                                                                    if (iThoiGianTruocGioLamTuDongQuaDem > iPhutTangCaTruocGioLamViecTuDongQuaDem)
                                                                    {
                                                                        if (iThoiGianTruocGioLamTuDongQuaDem > iPhutTangCaTruocGioLamViecDatDen)
                                                                        {
                                                                            iTongGioTangCaTruocTuDongQuaDem = iThoiGianTruocGioLamTuDongQuaDem - iPhutTruTangCaTruoc;
                                                                        }
                                                                    }
                                                                }
                                                            }
                                                            if (sChoPhepTangCaSauGioLamViecTuDongQuaDem == "True")
                                                            {
                                                                value = dGioRaTuDongQuaDem - dGioRaKhaiBaoTuDongQuaDemB;
                                                                second = Convert.ToInt32(value.TotalMinutes);
                                                                iThoiGianSauGioLamViecTuDongQuaDem = Convert.ToInt32(second.ToString());
                                                                if (iThoiGianSauGioLamViecTuDongQuaDem > 0)
                                                                {
                                                                    if (iThoiGianSauGioLamViecTuDongQuaDem > iPhutTangCaSauGioLamViecTuDongQuaDem)
                                                                    {
                                                                        if (iThoiGianSauGioLamViecTuDongQuaDem > iPhutTangCaSauGioLamViecDatDen)
                                                                        {
                                                                            iTongGioTangCaSauTuDongQuaDem = iThoiGianSauGioLamViecTuDongQuaDem - iPhutTruTangCaSau;
                                                                        }
                                                                    }
                                                                }
                                                            }
                                                        }
                                                        else
                                                        {
                                                            this.DGVTinhCong.Rows[addTuDongQuaDem].Cells[12].Value = "0";
                                                            this.DGVTinhCong.Rows[addTuDongQuaDem].Cells[13].Value = "0";
                                                            this.DGVTinhCong.Rows[addTuDongQuaDem].Cells[14].Value = "0";
                                                            this.DGVTinhCong.Rows[addTuDongQuaDem].Cells[15].Value = "0";
                                                        }
                                                        dTongThoiGianTangCaTuDongQuaDem = Convert.ToDouble(iTongGioTangCaTruocTuDongQuaDem + iTongGioTangCaSauTuDongQuaDem);
                                                        if (dTongThoiGianTangCaTuDongQuaDem <= 0)
                                                        {
                                                            this.DGVTinhCong.Rows[addTuDongQuaDem].Cells[12].Value = "0";
                                                            this.DGVTinhCong.Rows[addTuDongQuaDem].Cells[13].Value = "0";
                                                            this.DGVTinhCong.Rows[addTuDongQuaDem].Cells[14].Value = "0";
                                                            this.DGVTinhCong.Rows[addTuDongQuaDem].Cells[15].Value = "0";
                                                        }
                                                        else
                                                        {
                                                            if (iGioiHanTC1TuDongQuaDem == 0)
                                                            {
                                                                this.DGVTinhCong.Rows[addTuDongQuaDem].Cells[12].Value = Math.Round(dTongThoiGianTangCaTuDongQuaDem * this.dTangCa1HeSo / 60, this.iLamTronGio);
                                                                this.DGVTinhCong.Rows[addTuDongQuaDem].Cells[13].Value = "0";
                                                                this.DGVTinhCong.Rows[addTuDongQuaDem].Cells[14].Value = "0";
                                                                this.DGVTinhCong.Rows[addTuDongQuaDem].Cells[15].Value = "0";
                                                            }
                                                            if ((iGioiHanTC1TuDongQuaDem == 0 ? false : iGioiHanTC2TuDongQuaDem == 0))
                                                            {
                                                                if (dTongThoiGianTangCaTuDongQuaDem >= Convert.ToDouble(iGioiHanTC1TuDongQuaDem))
                                                                {
                                                                    this.DGVTinhCong.Rows[addTuDongQuaDem].Cells[12].Value = Math.Round(Convert.ToDouble(iGioiHanTC1TuDongQuaDem) / 60 * this.dTangCa1HeSo, this.iLamTronGio);
                                                                    if (dTongThoiGianTangCaTuDongQuaDem - Convert.ToDouble(iGioiHanTC1TuDongQuaDem) > 0)
                                                                    {
                                                                        this.DGVTinhCong.Rows[addTuDongQuaDem].Cells[13].Value = Math.Round((dTongThoiGianTangCaTuDongQuaDem - Convert.ToDouble(iGioiHanTC1TuDongQuaDem)) * this.dTangCa2HeSo / 60, this.iLamTronGio);
                                                                    }
                                                                    this.DGVTinhCong.Rows[addTuDongQuaDem].Cells[14].Value = "0";
                                                                    this.DGVTinhCong.Rows[addTuDongQuaDem].Cells[15].Value = "0";
                                                                }
                                                                else
                                                                {
                                                                    this.DGVTinhCong.Rows[addTuDongQuaDem].Cells[12].Value = Math.Round(dTongThoiGianTangCaTuDongQuaDem * this.dTangCa1HeSo / 60, this.iLamTronGio);
                                                                    this.DGVTinhCong.Rows[addTuDongQuaDem].Cells[13].Value = "0";
                                                                    this.DGVTinhCong.Rows[addTuDongQuaDem].Cells[14].Value = "0";
                                                                    this.DGVTinhCong.Rows[addTuDongQuaDem].Cells[15].Value = "0";
                                                                }
                                                            }
                                                            if ((iGioiHanTC1TuDongQuaDem == 0 || iGioiHanTC2TuDongQuaDem == 0 ? false : iGioiHanTC3TuDongQuaDem == 0))
                                                            {
                                                                if (dTongThoiGianTangCaTuDongQuaDem >= Convert.ToDouble(iGioiHanTC1TuDongQuaDem))
                                                                {
                                                                    this.DGVTinhCong.Rows[addTuDongQuaDem].Cells[12].Value = Math.Round(Convert.ToDouble(iGioiHanTC1TuDongQuaDem) * this.dTangCa1HeSo / 60, this.iLamTronGio);
                                                                    if (dTongThoiGianTangCaTuDongQuaDem - Convert.ToDouble(iGioiHanTC1TuDongQuaDem) >= Convert.ToDouble(iGioiHanTC2TuDongQuaDem))
                                                                    {
                                                                        this.DGVTinhCong.Rows[addTuDongQuaDem].Cells[12].Value = Math.Round(Convert.ToDouble(iGioiHanTC1TuDongQuaDem) * this.dTangCa1HeSo / 60, this.iLamTronGio);
                                                                        this.DGVTinhCong.Rows[addTuDongQuaDem].Cells[13].Value = Math.Round(Convert.ToDouble(iGioiHanTC2TuDongQuaDem) * this.dTangCa2HeSo / 60, this.iLamTronGio);
                                                                        this.DGVTinhCong.Rows[addTuDongQuaDem].Cells[14].Value = Math.Round((dTongThoiGianTangCaTuDongQuaDem - Convert.ToDouble(iGioiHanTC1TuDongQuaDem) - Convert.ToDouble(iGioiHanTC2TuDongQuaDem)) * this.dTangCa3HeSo / 60, this.iLamTronGio);
                                                                        this.DGVTinhCong.Rows[addTuDongQuaDem].Cells[15].Value = "0";
                                                                    }
                                                                    else
                                                                    {
                                                                        this.DGVTinhCong.Rows[addTuDongQuaDem].Cells[13].Value = Math.Round((dTongThoiGianTangCaTuDongQuaDem - Convert.ToDouble(iGioiHanTC1TuDongQuaDem)) * this.dTangCa2HeSo / 60, this.iLamTronGio);
                                                                        this.DGVTinhCong.Rows[addTuDongQuaDem].Cells[14].Value = "0";
                                                                        this.DGVTinhCong.Rows[addTuDongQuaDem].Cells[15].Value = "0";
                                                                    }
                                                                }
                                                                else
                                                                {
                                                                    this.DGVTinhCong.Rows[addTuDongQuaDem].Cells[12].Value = Math.Round(dTongThoiGianTangCaTuDongQuaDem * this.dTangCa1HeSo / 60, this.iLamTronGio);
                                                                    this.DGVTinhCong.Rows[addTuDongQuaDem].Cells[13].Value = "0";
                                                                    this.DGVTinhCong.Rows[addTuDongQuaDem].Cells[14].Value = "0";
                                                                    this.DGVTinhCong.Rows[addTuDongQuaDem].Cells[15].Value = "0";
                                                                }
                                                            }
                                                            if ((iGioiHanTC1TuDongQuaDem == 0 || iGioiHanTC2TuDongQuaDem == 0 || iGioiHanTC3TuDongQuaDem == 0 ? false : iGioiHanTC4TuDongQuaDem == 0))
                                                            {
                                                            }
                                                        }
                                                    }
                                                    if (!(DateTimeProgress.XuatIDThu((int)dt.AddDays((double)dem).DayOfWeek) == "0"))
                                                    {
                                                        this.DGVTinhCong.Rows[addTuDongQuaDem].Cells[19].Value = "NT";
                                                    }
                                                    else
                                                    {
                                                        this.DGVTinhCong.Rows[addTuDongQuaDem].Cells[19].Value = "CN";
                                                    }
                                                    this.DGVTinhCong.Rows[addTuDongQuaDem].Cells[20].Value = this.sMaChamCong;
                                                    this.DGVTinhCong.Rows[addTuDongQuaDem].Cells[21].Value = this.sPhongBanTinhCong;
                                                }

                                                break;
                                            //Label65:;
                                            }
                                        }

                                        break;
                                   Label48:;
                                    }
                              
                                    if (demTuDongQuaDem == 0)
                                    {
                                        this.DGVTinhCong.Rows[_nhanVien].Cells[7].Value = "0";
                                        this.DGVTinhCong.Rows[_nhanVien].Cells[8].Value = "0";
                                        this.DGVTinhCong.Rows[_nhanVien].Cells[17].Value = "0";
                                        this.DGVTinhCong.Rows[_nhanVien].Cells[18].Value = this.sKHVang;
                                        if (!(DateTimeProgress.XuatIDThu((int)dt.AddDays((double)dem).DayOfWeek) == "0"))
                                        {
                                            this.DGVTinhCong.Rows[_nhanVien].Cells[19].Value = "NT";
                                        }
                                        else
                                        {
                                            this.DGVTinhCong.Rows[_nhanVien].Cells[19].Value = "CN";
                                        }
                                        this.DGVTinhCong.Rows[_nhanVien].Cells[20].Value = this.sMaChamCong;
                                        this.DGVTinhCong.Rows[_nhanVien].Cells[21].Value = this.sPhongBanTinhCong;
                                    }
                                }
                            }
                            if (iKiemTraSapXepCa == 0)
                            {
                                System.Data.DataTable dtKiemTraChamCong = new System.Data.DataTable();
                                this._checkInOutDTO.MaChamCong = Convert.ToInt32(this.sMaChamCong);
                                this._checkInOutDTO.NgayCham = Convert.ToDateTime(this.DGVTinhCong.Rows[_nhanVien].Cells[2].Value.ToString());
                                dtKiemTraChamCong = this._checkInOutBLL.getCheckInOutByMaChamCongAndNgayCham(this._checkInOutDTO);
                                int iKiemTraNghi = 0;
                                System.Data.DataTable dtNgayLe = new System.Data.DataTable();
                                this._ngayLeDTO.Ngay = Convert.ToDateTime(this.DGVTinhCong.Rows[_nhanVien].Cells[2].Value.ToString());
                                dtNgayLe = this._ngayLeBLL.NgayLeGetTinhCong(this._ngayLeDTO);
                                for (int iNgayLe = 0; iNgayLe < dtNgayLe.Rows.Count; iNgayLe++)
                                {
                                    if (dtKiemTraChamCong.Rows.Count != 0)
                                    {
                                        fCongTinh = Convert.ToDouble(dtNgayLe.Rows[iNgayLe]["CongTinh"].ToString());
                                        fGio = Convert.ToDouble(dtNgayLe.Rows[iNgayLe]["Gio"].ToString());
                                        if (dtNgayLe.Rows[iNgayLe]["XacNhan"].ToString() == "True")
                                        {
                                            int addNgayLe = this.DGVTinhCong.Rows.Add();
                                            this.DGVTinhCong.Rows[addNgayLe].Cells[0].Value = this.sMaNhanVien;
                                            this.DGVTinhCong.Rows[addNgayLe].Cells[1].Value = this.sTenNhanVien;
                                            DataGridViewCell item23 = this.DGVTinhCong.Rows[addNgayLe].Cells[2];
                                            dateTime = dt.AddDays((double)dem);
                                            item23.Value = string.Format("{0:d}", Convert.ToDateTime(dateTime.ToString()));
                                            DataGridViewCell dataGridViewCell23 = this.DGVTinhCong.Rows[addNgayLe].Cells[3];
                                            dateTime = dt.AddDays((double)dem);
                                            dataGridViewCell23.Value = DateTimeProgress.XuatThuTinhCong((int)dateTime.DayOfWeek);
                                            this.DGVTinhCong.Rows[addNgayLe].Cells[7].Value = fCongTinh;
                                            this.DGVTinhCong.Rows[addNgayLe].Cells[8].Value = fGio;
                                            this.DGVTinhCong.Rows[addNgayLe].Cells[17].Value = "";
                                            this.DGVTinhCong.Rows[addNgayLe].Cells[18].Value = this.sKHLe;
                                            this.DGVTinhCong.Rows[addNgayLe].Cells[20].Value = this.sMaChamCong;
                                            iKiemTraNghi++;
                                        }
                                    }
                                    else
                                    {
                                        fCongTinh = Convert.ToDouble(dtNgayLe.Rows[iNgayLe]["CongTinh"].ToString());
                                        fGio = Convert.ToDouble(dtNgayLe.Rows[iNgayLe]["Gio"].ToString());
                                        if (dtNgayLe.Rows[iNgayLe]["XacNhan"].ToString() == "True")
                                        {
                                            this.DGVTinhCong.Rows[_nhanVien].Cells[0].Value = this.sMaNhanVien;
                                            this.DGVTinhCong.Rows[_nhanVien].Cells[1].Value = this.sTenNhanVien;
                                            DataGridViewCell item24 = this.DGVTinhCong.Rows[_nhanVien].Cells[2];
                                            dateTime = dt.AddDays((double)dem);
                                            item24.Value = string.Format("{0:d}", Convert.ToDateTime(dateTime.ToString()));
                                            DataGridViewCell dataGridViewCell24 = this.DGVTinhCong.Rows[_nhanVien].Cells[3];
                                            dateTime = dt.AddDays((double)dem);
                                            dataGridViewCell24.Value = DateTimeProgress.XuatThuTinhCong((int)dateTime.DayOfWeek);
                                            this.DGVTinhCong.Rows[_nhanVien].Cells[7].Value = fCongTinh;
                                            this.DGVTinhCong.Rows[_nhanVien].Cells[8].Value = fGio;
                                            this.DGVTinhCong.Rows[_nhanVien].Cells[17].Value = "";
                                            this.DGVTinhCong.Rows[_nhanVien].Cells[18].Value = this.sKHLe;
                                            this.DGVTinhCong.Rows[_nhanVien].Cells[20].Value = this.sMaChamCong;
                                            iKiemTraNghi++;
                                        }
                                    }
                                }
                                System.Data.DataTable dtCongTac = new System.Data.DataTable();
                                this._chiTietDiCongTacDTO.MaChamCong = Convert.ToInt32(this.sMaChamCong);
                                this._chiTietDiCongTacDTO.Ngay = Convert.ToDateTime(this.DGVTinhCong.Rows[_nhanVien].Cells[2].Value.ToString());
                                dtCongTac = this._chiTietDiCongTacBLL.ChiTietDiCongTacGetTinhCong(this._chiTietDiCongTacDTO);
                                for (int iCongTac = 0; iCongTac < dtCongTac.Rows.Count; iCongTac++)
                                {
                                    if ((dtKiemTraChamCong.Rows.Count != 0 ? true : iKiemTraNghi != 0))
                                    {
                                        int addCongTac = this.DGVTinhCong.Rows.Add();
                                        this.DGVTinhCong.Rows[addCongTac].Cells[0].Value = this.sMaNhanVien;
                                        this.DGVTinhCong.Rows[addCongTac].Cells[1].Value = this.sTenNhanVien;
                                        DataGridViewCell item25 = this.DGVTinhCong.Rows[addCongTac].Cells[2];
                                        dateTime = dt.AddDays((double)dem);
                                        item25.Value = string.Format("{0:d}", Convert.ToDateTime(dateTime.ToString()));
                                        DataGridViewCell dataGridViewCell25 = this.DGVTinhCong.Rows[addCongTac].Cells[3];
                                        dateTime = dt.AddDays((double)dem);
                                        dataGridViewCell25.Value = DateTimeProgress.XuatThuTinhCong((int)dateTime.DayOfWeek);
                                        this.DGVTinhCong.Rows[addCongTac].Cells[5].Value = string.Format("{0:HH:mm}", Convert.ToDateTime(dtCongTac.Rows[iCongTac]["GioDi"].ToString()));
                                        this.DGVTinhCong.Rows[addCongTac].Cells[6].Value = string.Format("{0:HH:mm}", Convert.ToDateTime(dtCongTac.Rows[iCongTac]["GioVe"].ToString()));
                                        this.DGVTinhCong.Rows[addCongTac].Cells[7].Value = Math.Round(Convert.ToDouble(dtCongTac.Rows[iCongTac]["CongTinhCongTac"].ToString()), this.iLamTronCong);
                                        this.DGVTinhCong.Rows[addCongTac].Cells[8].Value = Math.Round(Convert.ToDouble(dtCongTac.Rows[iCongTac]["TongGioCongTac"].ToString()), this.iLamTronGio);
                                        this.DGVTinhCong.Rows[addCongTac].Cells[17].Value = "";
                                        this.DGVTinhCong.Rows[addCongTac].Cells[18].Value = this.sKHCongTac;
                                        this.DGVTinhCong.Rows[addCongTac].Cells[20].Value = this.sMaChamCong;
                                        iKiemTraNghi++;
                                    }
                                    else
                                    {
                                        this.DGVTinhCong.Rows[_nhanVien].Cells[0].Value = this.sMaNhanVien;
                                        this.DGVTinhCong.Rows[_nhanVien].Cells[1].Value = this.sTenNhanVien;
                                        DataGridViewCell item26 = this.DGVTinhCong.Rows[_nhanVien].Cells[2];
                                        dateTime = dt.AddDays((double)dem);
                                        item26.Value = string.Format("{0:d}", Convert.ToDateTime(dateTime.ToString()));
                                        DataGridViewCell dataGridViewCell26 = this.DGVTinhCong.Rows[_nhanVien].Cells[3];
                                        dateTime = dt.AddDays((double)dem);
                                        dataGridViewCell26.Value = DateTimeProgress.XuatThuTinhCong((int)dateTime.DayOfWeek);
                                        this.DGVTinhCong.Rows[_nhanVien].Cells[5].Value = string.Format("{0:HH:mm}", Convert.ToDateTime(dtCongTac.Rows[iCongTac]["GioDi"].ToString()));
                                        this.DGVTinhCong.Rows[_nhanVien].Cells[6].Value = string.Format("{0:HH:mm}", Convert.ToDateTime(dtCongTac.Rows[iCongTac]["GioVe"].ToString()));
                                        this.DGVTinhCong.Rows[_nhanVien].Cells[7].Value = Math.Round(Convert.ToDouble(dtCongTac.Rows[iCongTac]["CongTinhCongTac"].ToString()), this.iLamTronCong);
                                        this.DGVTinhCong.Rows[_nhanVien].Cells[8].Value = Math.Round(Convert.ToDouble(dtCongTac.Rows[iCongTac]["TongGioCongTac"].ToString()), this.iLamTronGio);
                                        this.DGVTinhCong.Rows[_nhanVien].Cells[17].Value = "";
                                        this.DGVTinhCong.Rows[_nhanVien].Cells[18].Value = this.sKHCongTac;
                                        this.DGVTinhCong.Rows[_nhanVien].Cells[20].Value = this.sMaChamCong;
                                        iKiemTraNghi++;
                                    }
                                }
                                System.Data.DataTable dtPhepNam = new System.Data.DataTable();
                                this._phepNamDTO.MaChamCong = Convert.ToInt32(this.sMaChamCong);
                                this._phepNamDTO.Ngay = Convert.ToDateTime(this.DGVTinhCong.Rows[_nhanVien].Cells[2].Value.ToString());
                                dtPhepNam = this._phepNamBLL.PhepNamGetTinhCong(this._phepNamDTO);
                                for (int iPhepNam = 0; iPhepNam < dtPhepNam.Rows.Count; iPhepNam++)
                                {
                                    if ((dtKiemTraChamCong.Rows.Count != 0 ? true : iKiemTraNghi != 0))
                                    {
                                        int addPhepNam = this.DGVTinhCong.Rows.Add();
                                        this.DGVTinhCong.Rows[addPhepNam].Cells[0].Value = this.sMaNhanVien;
                                        this.DGVTinhCong.Rows[addPhepNam].Cells[1].Value = this.sTenNhanVien;
                                        DataGridViewCell item27 = this.DGVTinhCong.Rows[addPhepNam].Cells[2];
                                        dateTime = dt.AddDays((double)dem);
                                        item27.Value = string.Format("{0:d}", Convert.ToDateTime(dateTime.ToString()));
                                        DataGridViewCell dataGridViewCell27 = this.DGVTinhCong.Rows[addPhepNam].Cells[3];
                                        dateTime = dt.AddDays((double)dem);
                                        dataGridViewCell27.Value = DateTimeProgress.XuatThuTinhCong((int)dateTime.DayOfWeek);
                                        this.DGVTinhCong.Rows[addPhepNam].Cells[7].Value = dtPhepNam.Rows[iPhepNam]["DemCong"].ToString();
                                        this.DGVTinhCong.Rows[addPhepNam].Cells[8].Value = dtPhepNam.Rows[iPhepNam]["DemGio"].ToString();
                                        this.DGVTinhCong.Rows[addPhepNam].Cells[17].Value = "";
                                        this.DGVTinhCong.Rows[addPhepNam].Cells[18].Value = this.sKHPhepNam;
                                        this.DGVTinhCong.Rows[addPhepNam].Cells[20].Value = this.sMaChamCong;
                                        iKiemTraNghi++;
                                    }
                                    else
                                    {
                                        this.DGVTinhCong.Rows[_nhanVien].Cells[0].Value = this.sMaNhanVien;
                                        this.DGVTinhCong.Rows[_nhanVien].Cells[1].Value = this.sTenNhanVien;
                                        DataGridViewCell item28 = this.DGVTinhCong.Rows[_nhanVien].Cells[2];
                                        dateTime = dt.AddDays((double)dem);
                                        item28.Value = string.Format("{0:d}", Convert.ToDateTime(dateTime.ToString()));
                                        DataGridViewCell dataGridViewCell28 = this.DGVTinhCong.Rows[_nhanVien].Cells[3];
                                        dateTime = dt.AddDays((double)dem);
                                        dataGridViewCell28.Value = DateTimeProgress.XuatThuTinhCong((int)dateTime.DayOfWeek);
                                        this.DGVTinhCong.Rows[_nhanVien].Cells[7].Value = dtPhepNam.Rows[iPhepNam]["DemCong"].ToString();
                                        this.DGVTinhCong.Rows[_nhanVien].Cells[8].Value = dtPhepNam.Rows[iPhepNam]["DemGio"].ToString();
                                        this.DGVTinhCong.Rows[_nhanVien].Cells[17].Value = "";
                                        this.DGVTinhCong.Rows[_nhanVien].Cells[18].Value = this.sKHPhepNam;
                                        this.DGVTinhCong.Rows[_nhanVien].Cells[20].Value = this.sMaChamCong;
                                        iKiemTraNghi++;
                                    }
                                }
                                System.Data.DataTable dtNhanVienVang = new System.Data.DataTable();
                                this._khaiBaoVangChoNhanVienDTO.MaChamCong = Convert.ToInt32(this.sMaChamCong);
                                this._khaiBaoVangChoNhanVienDTO.NgayThang = Convert.ToDateTime(this.DGVTinhCong.Rows[_nhanVien].Cells[2].Value.ToString());
                                dtNhanVienVang = this._khaiBaoVangChoNhanVienBLL.CacLoaiVangGetTinhCong(this._khaiBaoVangChoNhanVienDTO);
                                for (int iLoaiVangNhanVien = 0; iLoaiVangNhanVien < dtNhanVienVang.Rows.Count; iLoaiVangNhanVien++)
                                {
                                    if ((dtKiemTraChamCong.Rows.Count != 0 ? true : iKiemTraNghi != 0))
                                    {
                                        int addCacLoaiVang = this.DGVTinhCong.Rows.Add();
                                        this.DGVTinhCong.Rows[addCacLoaiVang].Cells[0].Value = this.sMaNhanVien;
                                        this.DGVTinhCong.Rows[addCacLoaiVang].Cells[1].Value = this.sTenNhanVien;
                                        DataGridViewCell item29 = this.DGVTinhCong.Rows[addCacLoaiVang].Cells[2];
                                        dateTime = dt.AddDays((double)dem);
                                        item29.Value = string.Format("{0:d}", Convert.ToDateTime(dateTime.ToString()));
                                        DataGridViewCell dataGridViewCell29 = this.DGVTinhCong.Rows[addCacLoaiVang].Cells[3];
                                        dateTime = dt.AddDays((double)dem);
                                        dataGridViewCell29.Value = DateTimeProgress.XuatThuTinhCong((int)dateTime.DayOfWeek);
                                        if (!(dtNhanVienVang.Rows[iLoaiVangNhanVien]["DuocHuongLuong"].ToString() == "True"))
                                        {
                                            this.DGVTinhCong.Rows[addCacLoaiVang].Cells[7].Value = "0";
                                            this.DGVTinhCong.Rows[addCacLoaiVang].Cells[8].Value = 0;
                                        }
                                        else
                                        {
                                            this.DGVTinhCong.Rows[addCacLoaiVang].Cells[7].Value = dtNhanVienVang.Rows[iLoaiVangNhanVien]["NgayCong"].ToString();
                                            this.DGVTinhCong.Rows[addCacLoaiVang].Cells[8].Value = dtNhanVienVang.Rows[iLoaiVangNhanVien]["TongPhut"].ToString();
                                        }
                                        sMaCacLoaiVang = dtNhanVienVang.Rows[iLoaiVangNhanVien]["MaCacLoaiVang"].ToString();
                                        dtCacLoaiVang = new System.Data.DataTable();
                                        this._cacLoaiVangDTO.MaCacLoaiVang = sMaCacLoaiVang;
                                        dtCacLoaiVang = this._cacLoaiVangBLL.CacLoaiVangGetByMaCacLoaiVang(this._cacLoaiVangDTO);
                                        for (iCacLoaiVang = 0; iCacLoaiVang < dtCacLoaiVang.Rows.Count; iCacLoaiVang++)
                                        {
                                            this.DGVTinhCong.Rows[addCacLoaiVang].Cells[18].Value = dtCacLoaiVang.Rows[iCacLoaiVang]["KyHieu"].ToString();
                                        }
                                        this.DGVTinhCong.Rows[addCacLoaiVang].Cells[20].Value = this.sMaChamCong;
                                        iKiemTraNghi++;
                                    }
                                    else
                                    {
                                        this.DGVTinhCong.Rows[_nhanVien].Cells[0].Value = this.sMaNhanVien;
                                        this.DGVTinhCong.Rows[_nhanVien].Cells[1].Value = this.sTenNhanVien;
                                        DataGridViewCell item30 = this.DGVTinhCong.Rows[_nhanVien].Cells[2];
                                        dateTime = dt.AddDays((double)dem);
                                        item30.Value = string.Format("{0:d}", Convert.ToDateTime(dateTime.ToString()));
                                        DataGridViewCell dataGridViewCell30 = this.DGVTinhCong.Rows[_nhanVien].Cells[3];
                                        dateTime = dt.AddDays((double)dem);
                                        dataGridViewCell30.Value = DateTimeProgress.XuatThuTinhCong((int)dateTime.DayOfWeek);
                                        if (!(dtNhanVienVang.Rows[iLoaiVangNhanVien]["DuocHuongLuong"].ToString() == "True"))
                                        {
                                            this.DGVTinhCong.Rows[_nhanVien].Cells[7].Value = "0";
                                            this.DGVTinhCong.Rows[_nhanVien].Cells[8].Value = 0;
                                        }
                                        else
                                        {
                                            this.DGVTinhCong.Rows[_nhanVien].Cells[7].Value = dtNhanVienVang.Rows[iLoaiVangNhanVien]["NgayCong"].ToString();
                                            this.DGVTinhCong.Rows[_nhanVien].Cells[8].Value = dtNhanVienVang.Rows[iLoaiVangNhanVien]["TongPhut"].ToString();
                                        }
                                        sMaCacLoaiVang = dtNhanVienVang.Rows[iLoaiVangNhanVien]["MaCacLoaiVang"].ToString();
                                        dtCacLoaiVang = new System.Data.DataTable();
                                        this._cacLoaiVangDTO.MaCacLoaiVang = sMaCacLoaiVang;
                                        dtCacLoaiVang = this._cacLoaiVangBLL.CacLoaiVangGetByMaCacLoaiVang(this._cacLoaiVangDTO);
                                        for (iCacLoaiVang = 0; iCacLoaiVang < dtCacLoaiVang.Rows.Count; iCacLoaiVang++)
                                        {
                                            this.DGVTinhCong.Rows[_nhanVien].Cells[18].Value = dtCacLoaiVang.Rows[iCacLoaiVang]["KyHieu"].ToString();
                                        }
                                        this.DGVTinhCong.Rows[_nhanVien].Cells[20].Value = this.sMaChamCong;
                                        iKiemTraNghi++;
                                    }
                                }
                            }
                            if (this.iNgonNgu == 0)
                            {
                                DataGridViewCell item31 = this.DGVTinhCong.Rows[_nhanVien].Cells[3];
                                dateTime = dt.AddDays((double)dem);
                                item31.Value = DateTimeProgress.XuatThuTinhCong((int)dateTime.DayOfWeek);
                            }
                            if (this.iNgonNgu == 1)
                            {
                                DataGridViewCell dataGridViewCell31 = this.DGVTinhCong.Rows[_nhanVien].Cells[3];
                                dateTime = dt.AddDays((double)dem);
                                dataGridViewCell31.Value = DateTimeProgress.XuatThuEnglish((int)dateTime.DayOfWeek);
                            }
                            if ((this.sGioVao == null ? true : this.sGioRa == null))
                            {
                            }
                            dem++;
                            if (this.checkBoxCoTinhLuong.Checked)
                            {
                                System.Data.DataTable dtChiTietPhuCapTienCom = new System.Data.DataTable();
                                this._chiTietPhuCapNhanVienDTO.MaChamCong = Convert.ToInt32(this.sMaChamCong);
                                this._chiTietPhuCapNhanVienDTO.Ngay = Convert.ToDateTime(this.DGVTinhCong.Rows[_nhanVien].Cells[2].Value.ToString());
                                this._chiTietPhuCapNhanVienDTO.KyHieuPhuCap = "PCTC";
                                dtChiTietPhuCapTienCom = this._chiTietPhuCapNhanVienBLL.ChiTietPhuCapNhanVienGetByMaChamCongAndNgayAndKyHieuPhuCap(this._chiTietPhuCapNhanVienDTO);
                                for (int iChiTietPhuCapTienCom = 0; iChiTietPhuCapTienCom < dtChiTietPhuCapTienCom.Rows.Count; iChiTietPhuCapTienCom++)
                                {
                                    this.dTongTienPhuCapTienCom += Convert.ToDouble(dtChiTietPhuCapTienCom.Rows[iChiTietPhuCapTienCom]["SoTien"].ToString());
                                }
                                System.Data.DataTable dtChiTietPhuCapKhac = new System.Data.DataTable();
                                this._chiTietPhuCapNhanVienDTO.MaChamCong = Convert.ToInt32(this.sMaChamCong);
                                this._chiTietPhuCapNhanVienDTO.Ngay = Convert.ToDateTime(this.DGVTinhCong.Rows[_nhanVien].Cells[2].Value.ToString());
                                this._chiTietPhuCapNhanVienDTO.KyHieuPhuCap = "PCK";
                                dtChiTietPhuCapKhac = this._chiTietPhuCapNhanVienBLL.ChiTietPhuCapNhanVienGetByMaChamCongAndNgayAndKyHieuPhuCap(this._chiTietPhuCapNhanVienDTO);
                                for (int iChiTietPhuCapKhac = 0; iChiTietPhuCapKhac < dtChiTietPhuCapKhac.Rows.Count; iChiTietPhuCapKhac++)
                                {
                                    this.dTongTienPhuCapKhac += Convert.ToDouble(dtChiTietPhuCapKhac.Rows[iChiTietPhuCapKhac]["SoTien"].ToString());
                                }
                                System.Data.DataTable dtChiTietTamUngLuong = new System.Data.DataTable();
                                this._chiTietTamUngLuongDTO.MaChamCong = Convert.ToInt32(this.sMaChamCong);
                                this._chiTietTamUngLuongDTO.NgayTamUng = Convert.ToDateTime(this.DGVTinhCong.Rows[_nhanVien].Cells[2].Value.ToString());
                                dtChiTietTamUngLuong = this._chiTietTamUngLuongBLL.ChiTietTamUngLuongGetMaChamCongAndNgayTamUng(this._chiTietTamUngLuongDTO);
                                for (int iChiTietTamUngLuong = 0; iChiTietTamUngLuong < dtChiTietTamUngLuong.Rows.Count; iChiTietTamUngLuong++)
                                {
                                    this.dTongTienTamUng += Convert.ToDouble(dtChiTietTamUngLuong.Rows[iChiTietTamUngLuong]["SoTien"].ToString());
                                }
                                System.Data.DataTable dtChiTietViPham = new System.Data.DataTable();
                                this._viPhamDTO.MaChamCong = Convert.ToInt32(this.sMaChamCong);
                                this._viPhamDTO.NgayThang = Convert.ToDateTime(this.DGVTinhCong.Rows[_nhanVien].Cells[2].Value.ToString());
                                dtChiTietViPham = this._viPhamBLL.ViPhamGetMaChamCongAndNgayThang(this._viPhamDTO);
                                for (int iChiTietViPham = 0; iChiTietViPham < dtChiTietViPham.Rows.Count; iChiTietViPham++)
                                {
                                    this.dTongTienViPham += Convert.ToDouble(dtChiTietViPham.Rows[iChiTietViPham]["TienPhat"].ToString());
                                }
                                System.Data.DataTable dtChiTietThuong = new System.Data.DataTable();
                                this._thuongDTO.MaChamCong = Convert.ToInt32(this.sMaChamCong);
                                this._thuongDTO.NgayThuong = Convert.ToDateTime(this.DGVTinhCong.Rows[_nhanVien].Cells[2].Value.ToString());
                                dtChiTietThuong = this._thuongBLL.ThuongGetByMaChamCongAndNgayThuong(this._thuongDTO);
                                for (int iChiTietThuong = 0; iChiTietThuong < dtChiTietThuong.Rows.Count; iChiTietThuong++)
                                {
                                    this.dTongTienThuong += Convert.ToDouble(dtChiTietThuong.Rows[iChiTietThuong]["TienThuong"].ToString());
                                }
                            }
                        }
                        demNhanVienDuocChon++;
                        if (this.checkBoxCoTinhLuong.Checked)
                        {
                            this._chiTietCongTruLuongDTO.MaChamCong = Convert.ToInt32(this.sMaChamCong);
                            this._chiTietCongTruLuongDTO.ChiTietPhuCapCom = this.dTongTienPhuCapTienCom.ToString();
                            this._chiTietCongTruLuongDTO.ChiTietPhuCapKhac = this.dTongTienPhuCapKhac.ToString();
                            this._chiTietCongTruLuongDTO.ChiTietTamUngLuong = this.dTongTienTamUng.ToString();
                            this._chiTietCongTruLuongDTO.ChiTietViPham = this.dTongTienViPham.ToString();
                            this._chiTietCongTruLuongDTO.ChiTietThuong = this.dTongTienThuong.ToString();
                            this._chiTietCongTruLuongBLL.ChiTietCongTruLuongInsert(this._chiTietCongTruLuongDTO);
                        }
                        if (this.iNgonNgu == 0)
                        {
                            _loadTinhCong.progressBar1.Maximum = TestDemNhanVien;
                            testProcess--;
                            demProcess++;
                            ProgressBar progressBar = _loadTinhCong.progressBar1;
                            second = (demProcess + 1) * 100 / TestDemNhanVien;
                            progressBar.Text = string.Concat(second.ToString(), "%");
                            _loadTinhCong.lbDangTinh.Text = "Đang tính công";
                            System.Windows.Forms.Application.DoEvents();
                            if (TestDemNhanVien < 0)
                            {
                            }
                            if (TestDemNhanVien >= 0)
                            {
                                _loadTinhCong.progressBar1.Value = TestDemNhanVien - testProcess;
                            }
                        }
                        if (this.iNgonNgu == 1)
                        {
                            _loadTinhCong.progressBar1.Maximum = TestDemNhanVien;
                            testProcess--;
                            demProcess++;
                            ProgressBar progressBar1 = _loadTinhCong.progressBar1;
                            second = (demProcess + 1) * 100 / TestDemNhanVien;
                            progressBar1.Text = string.Concat(second.ToString(), "%");
                            _loadTinhCong.lbDangTinh.Text = "Calculating";
                            System.Windows.Forms.Application.DoEvents();
                            if (TestDemNhanVien < 0)
                            {
                            }
                            if (TestDemNhanVien >= 0)
                            {
                                _loadTinhCong.progressBar1.Value = TestDemNhanVien - testProcess;
                            }
                        }
                    }
                }
                if (demNhanVienDuocChon != 0)
                {
                    this.lbNhanVienDuocChon.Text = string.Concat("Tổng số nhân viên chọn tính công: ", demNhanVienDuocChon.ToString());
                    this.lbTongSoDongTinhCong.Text = string.Concat("Tổng số dòng tính công: ", this.DGVTinhCong.Rows.Count);
                    this.lbTongSoNgayTinhCong.Text = string.Concat("Tổng số ngày tính công: ", Convert.ToInt32(this.sTongNgayTinh) + 1);
                    this.Cursor = Cursors.Default;
                    for (int iLuuTinhCong = 0; iLuuTinhCong < this.DGVTinhCong.Rows.Count; iLuuTinhCong++)
                    {
                        _loadTinhCong.lbDangTinh.Text = "Đang lưu tính công";
                        System.Windows.Forms.Application.DoEvents();
                        this._tinhCongDTO.MaNhanVien = this.DGVTinhCong.Rows[iLuuTinhCong].Cells[0].Value.ToString();
                        this._tinhCongDTO.TenNhanVien = this.DGVTinhCong.Rows[iLuuTinhCong].Cells[1].Value.ToString();
                        this._tinhCongDTO.Ngay = Convert.ToDateTime(this.DGVTinhCong.Rows[iLuuTinhCong].Cells[2].Value.ToString());
                        this._tinhCongDTO.Thu = this.DGVTinhCong.Rows[iLuuTinhCong].Cells[3].Value.ToString();
                        if (this.DGVTinhCong.Rows[iLuuTinhCong].Cells[4].Value != null)
                        {
                            this._tinhCongDTO.Ca = this.DGVTinhCong.Rows[iLuuTinhCong].Cells[4].Value.ToString();
                        }
                        else
                        {
                            this._tinhCongDTO.Ca = "***";
                        }
                        if (this.DGVTinhCong.Rows[iLuuTinhCong].Cells[5].Value != null)
                        {
                            this._tinhCongDTO.GioVao = this.DGVTinhCong.Rows[iLuuTinhCong].Cells[5].Value.ToString();
                        }
                        else
                        {
                            this._tinhCongDTO.GioVao = "";
                        }
                        if (this.DGVTinhCong.Rows[iLuuTinhCong].Cells[6].Value != null)
                        {
                            this._tinhCongDTO.GioRa = this.DGVTinhCong.Rows[iLuuTinhCong].Cells[6].Value.ToString();
                        }
                        else
                        {
                            this._tinhCongDTO.GioRa = "";
                        }
                        if (this.DGVTinhCong.Rows[iLuuTinhCong].Cells[7].Value != null)
                        {
                            this._tinhCongDTO.Cong = this.DGVTinhCong.Rows[iLuuTinhCong].Cells[7].Value.ToString();
                        }
                        else
                        {
                            this._tinhCongDTO.Cong = "";
                        }
                        if (this.DGVTinhCong.Rows[iLuuTinhCong].Cells[8].Value != null)
                        {
                            this._tinhCongDTO.Gio = this.DGVTinhCong.Rows[iLuuTinhCong].Cells[8].Value.ToString();
                        }
                        else
                        {
                            this._tinhCongDTO.Gio = "";
                        }
                        if (this.DGVTinhCong.Rows[iLuuTinhCong].Cells[9].Value != null)
                        {
                            this._tinhCongDTO.Tre = Convert.ToInt32(this.DGVTinhCong.Rows[iLuuTinhCong].Cells[9].Value.ToString());
                        }
                        else
                        {
                            this._tinhCongDTO.Tre = 0;
                        }
                        if (this.DGVTinhCong.Rows[iLuuTinhCong].Cells[10].Value != null)
                        {
                            this._tinhCongDTO.VeSom = Convert.ToInt32(this.DGVTinhCong.Rows[iLuuTinhCong].Cells[10].Value.ToString());
                        }
                        else
                        {
                            this._tinhCongDTO.VeSom = 0;
                        }
                        if (this.DGVTinhCong.Rows[iLuuTinhCong].Cells[11].Value != null)
                        {
                            this._tinhCongDTO.VeTre = Convert.ToInt32(this.DGVTinhCong.Rows[iLuuTinhCong].Cells[11].Value.ToString());
                        }
                        else
                        {
                            this._tinhCongDTO.VeTre = 0;
                        }
                        if (this.DGVTinhCong.Rows[iLuuTinhCong].Cells[12].Value != null)
                        {
                            this._tinhCongDTO.TC1 = this.DGVTinhCong.Rows[iLuuTinhCong].Cells[12].Value.ToString();
                        }
                        else
                        {
                            this._tinhCongDTO.TC1 = "0";
                        }
                        if (this.DGVTinhCong.Rows[iLuuTinhCong].Cells[13].Value != null)
                        {
                            this._tinhCongDTO.TC2 = this.DGVTinhCong.Rows[iLuuTinhCong].Cells[13].Value.ToString();
                        }
                        else
                        {
                            this._tinhCongDTO.TC2 = "0";
                        }
                        if (this.DGVTinhCong.Rows[iLuuTinhCong].Cells[14].Value != null)
                        {
                            this._tinhCongDTO.TC3 = this.DGVTinhCong.Rows[iLuuTinhCong].Cells[14].Value.ToString();
                        }
                        else
                        {
                            this._tinhCongDTO.TC3 = "0";
                        }
                        if (this.DGVTinhCong.Rows[iLuuTinhCong].Cells[15].Value != null)
                        {
                            this._tinhCongDTO.TC4 = this.DGVTinhCong.Rows[iLuuTinhCong].Cells[15].Value.ToString();
                        }
                        else
                        {
                            this._tinhCongDTO.TC4 = "0";
                        }
                        if (this.DGVTinhCong.Rows[iLuuTinhCong].Cells[16].Value != null)
                        {
                            this._tinhCongDTO.TongGio = this.DGVTinhCong.Rows[iLuuTinhCong].Cells[16].Value.ToString();
                        }
                        else
                        {
                            this._tinhCongDTO.TongGio = "0";
                        }
                        if (this.DGVTinhCong.Rows[iLuuTinhCong].Cells[17].Value != null)
                        {
                            this._tinhCongDTO.DemCong = this.DGVTinhCong.Rows[iLuuTinhCong].Cells[17].Value.ToString();
                        }
                        else
                        {
                            this._tinhCongDTO.DemCong = "0";
                        }
                        if (this.DGVTinhCong.Rows[iLuuTinhCong].Cells[18].Value != null)
                        {
                            this._tinhCongDTO.KyHieu = this.DGVTinhCong.Rows[iLuuTinhCong].Cells[18].Value.ToString();
                        }
                        else
                        {
                            this._tinhCongDTO.KyHieu = "";
                        }
                        if (this.DGVTinhCong.Rows[iLuuTinhCong].Cells[20].Value != null)
                        {
                            this._tinhCongDTO.MaChamCong = Convert.ToInt32(this.DGVTinhCong.Rows[iLuuTinhCong].Cells[20].Value.ToString());
                        }
                        else
                        {
                            this._tinhCongDTO.MaChamCong = 0;
                        }
                        if (this.DGVTinhCong.Rows[iLuuTinhCong].Cells[19].Value != null)
                        {
                            this._tinhCongDTO.KyHieuPhu = this.DGVTinhCong.Rows[iLuuTinhCong].Cells[19].Value.ToString();
                        }
                        else
                        {
                            this._tinhCongDTO.KyHieuPhu = "";
                        }
                        if (this.DGVTinhCong.Rows[iLuuTinhCong].Cells[21].Value != null)
                        {
                            this._tinhCongDTO.PhongBan = this.DGVTinhCong.Rows[iLuuTinhCong].Cells[21].Value.ToString();
                        }
                        else
                        {
                            this._tinhCongDTO.PhongBan = "";
                        }
                        this._tinhCongBLL.TinhCongInsert(this._tinhCongDTO);
                    }
                    if (this.checkBoxCoTinhLuong.Checked)
                    {
                        _loadTinhCong.lbDangTinh.Text = "Đang tính lương";
                        System.Windows.Forms.Application.DoEvents();
                        int iMaChamCongTinhCongTinhLuong = 0;
                        System.Data.DataTable dtTinhCongTinhLuong = new System.Data.DataTable();
                        this._tinhCongDTO.Ngay = Convert.ToDateTime(this.dateTimeTuNgay.Text);
                        dtTinhCongTinhLuong = this._tinhCongBLL.TinhCongGetNgay(this._tinhCongDTO);
                        for (int iTinhCongTinhLuong = 0; iTinhCongTinhLuong < dtTinhCongTinhLuong.Rows.Count; iTinhCongTinhLuong++)
                        {
                            string sDangKyThamGiaBaoHiem = "";
                            if (iMaChamCongTinhCongTinhLuong != Convert.ToInt32(dtTinhCongTinhLuong.Rows[iTinhCongTinhLuong]["MaChamCong"].ToString()))
                            {
                                iMaChamCongTinhCongTinhLuong = Convert.ToInt32(dtTinhCongTinhLuong.Rows[iTinhCongTinhLuong]["MaChamCong"].ToString());
                                int addLuongNhanVien = this.DGVChiTietLuong.Rows.Add();
                                this.DGVChiTietLuong.Rows[addLuongNhanVien].Cells[0].Value = dtTinhCongTinhLuong.Rows[iTinhCongTinhLuong]["MaNhanVien"].ToString();
                                this.DGVChiTietLuong.Rows[addLuongNhanVien].Cells[1].Value = dtTinhCongTinhLuong.Rows[iTinhCongTinhLuong]["TenNhanVien"].ToString();
                                this.DGVChiTietLuong.Rows[addLuongNhanVien].Cells[2].Value = iMaChamCongTinhCongTinhLuong;
                                double dTienLuongNhanVien = 0;
                                double dTienLuongHopDongNhanVien = 0;
                                System.Data.DataTable dtNhanVienGetTinhLuong = new System.Data.DataTable();
                                this._nhanVienDTO.MaChamCong = iMaChamCongTinhCongTinhLuong.ToString();
                                dtNhanVienGetTinhLuong = this._nhanVienBLL.NhanVienGetByMaChamCong(this._nhanVienDTO);
                                for (int iNhanVienGetTinhLuong = 0; iNhanVienGetTinhLuong < dtNhanVienGetTinhLuong.Rows.Count; iNhanVienGetTinhLuong++)
                                {
                                    dTienLuongNhanVien = Convert.ToDouble(dtNhanVienGetTinhLuong.Rows[iNhanVienGetTinhLuong]["TienLuong"].ToString());
                                    DataGridViewCell item32 = this.DGVChiTietLuong.Rows[addLuongNhanVien].Cells[3];
                                    ConvertMoney convertMoney = this._convertMoney;
                                    second = Convert.ToInt32(dTienLuongNhanVien);
                                    item32.Value = convertMoney.chendau(second.ToString());
                                    dTienLuongHopDongNhanVien = Convert.ToDouble(dtNhanVienGetTinhLuong.Rows[iNhanVienGetTinhLuong]["LuongHopDong"].ToString());
                                    DataGridViewCell dataGridViewCell32 = this.DGVChiTietLuong.Rows[addLuongNhanVien].Cells[4];
                                    ConvertMoney convertMoney1 = this._convertMoney;
                                    second = Convert.ToInt32(dTienLuongHopDongNhanVien);
                                    dataGridViewCell32.Value = convertMoney1.chendau(second.ToString());
                                    this.DGVChiTietLuong.Rows[addLuongNhanVien].Cells[5].Value = this.txtNgayCongTinh.Text;
                                    sDangKyThamGiaBaoHiem = dtNhanVienGetTinhLuong.Rows[iNhanVienGetTinhLuong]["DangThamGiaBaoHiem"].ToString();
                                }
                                double dTongCongLamDuocTinhLuong = 0;
                                double dTongTangCaLamDuocTinhLuong = 0;
                                double dTienTangCaLamDuoc = 0;
                                System.Data.DataTable dtNhanVienChiTietTinhLuong = new System.Data.DataTable();
                                this._tinhCongDTO.MaChamCong = iMaChamCongTinhCongTinhLuong;
                                dtNhanVienChiTietTinhLuong = this._tinhCongBLL.TinhCongGetByMaChamCong(this._tinhCongDTO);
                                for (int iNhanVienChiTietTinhLuong = 0; iNhanVienChiTietTinhLuong < dtNhanVienChiTietTinhLuong.Rows.Count; iNhanVienChiTietTinhLuong++)
                                {
                                    dTongCongLamDuocTinhLuong += Convert.ToDouble(dtNhanVienChiTietTinhLuong.Rows[iNhanVienChiTietTinhLuong]["Cong"].ToString());
                                    dTongTangCaLamDuocTinhLuong = dTongTangCaLamDuocTinhLuong + (Convert.ToDouble(dtNhanVienChiTietTinhLuong.Rows[iNhanVienChiTietTinhLuong]["TC1"].ToString()) + Convert.ToDouble(dtNhanVienChiTietTinhLuong.Rows[iNhanVienChiTietTinhLuong]["TC2"].ToString()) + Convert.ToDouble(dtNhanVienChiTietTinhLuong.Rows[iNhanVienChiTietTinhLuong]["TC3"].ToString()) + Convert.ToDouble(dtNhanVienChiTietTinhLuong.Rows[iNhanVienChiTietTinhLuong]["TC4"].ToString()));
                                }
                                this.DGVChiTietLuong.Rows[addLuongNhanVien].Cells[6].Value = dTongCongLamDuocTinhLuong.ToString();
                                this.DGVChiTietLuong.Rows[addLuongNhanVien].Cells[7].Value = dTongTangCaLamDuocTinhLuong.ToString();
                                double dLuongHopDong = Convert.ToDouble(this._convertMoney.loaidau(this.DGVChiTietLuong.Rows[addLuongNhanVien].Cells[4].Value.ToString()));
                                double dLuongTheoNgayCongLamDuoc = Math.Round(dLuongHopDong / Convert.ToDouble(this.txtNgayCongTinh.Text), 0) * dTongCongLamDuocTinhLuong;
                                DataGridViewCell item33 = this.DGVChiTietLuong.Rows[addLuongNhanVien].Cells[8];
                                ConvertMoney convertMoney2 = this._convertMoney;
                                second = Convert.ToInt32(dLuongTheoNgayCongLamDuoc);
                                item33.Value = convertMoney2.chendau(second.ToString());
                                dTienTangCaLamDuoc = Math.Round(Math.Round(dTienLuongHopDongNhanVien / Convert.ToDouble(this.txtNgayCongTinh.Text), 0) / 8, 0) * dTongTangCaLamDuocTinhLuong;
                                DataGridViewCell dataGridViewCell33 = this.DGVChiTietLuong.Rows[addLuongNhanVien].Cells[9];
                                ConvertMoney convertMoney3 = this._convertMoney;
                                second = Convert.ToInt32(dTienTangCaLamDuoc);
                                dataGridViewCell33.Value = convertMoney3.chendau(second.ToString());
                                double dTongTienPhuCapComTinhLuong = 0;
                                double dTongTienPhuCapKhacTinhLuong = 0;
                                double dTongTienTamUngTinhLuong = 0;
                                double dTongTienViPhamTinhLuong = 0;
                                double dTongTienThuongTinhLuong = 0;
                                System.Data.DataTable dtCongTruLuongPhuCapTienCom = new System.Data.DataTable();
                                this._chiTietCongTruLuongDTO.MaChamCong = iMaChamCongTinhCongTinhLuong;
                                dtCongTruLuongPhuCapTienCom = this._chiTietCongTruLuongBLL.ChiTietCongTruLuongGetByMaChamCong(this._chiTietCongTruLuongDTO);
                                for (int iCongTruLuongPhuCapTienCom = 0; iCongTruLuongPhuCapTienCom < dtCongTruLuongPhuCapTienCom.Rows.Count; iCongTruLuongPhuCapTienCom++)
                                {
                                    DataGridViewCell item34 = this.DGVChiTietLuong.Rows[addLuongNhanVien].Cells[10];
                                    ConvertMoney convertMoney4 = this._convertMoney;
                                    second = Convert.ToInt32(dtCongTruLuongPhuCapTienCom.Rows[iCongTruLuongPhuCapTienCom]["ChiTietPhuCapCom"]);
                                    item34.Value = convertMoney4.chendau(second.ToString());
                                    dTongTienPhuCapComTinhLuong = Math.Round(Convert.ToDouble(dtCongTruLuongPhuCapTienCom.Rows[iCongTruLuongPhuCapTienCom]["ChiTietPhuCapCom"].ToString()) / Convert.ToDouble(this.txtNgayCongTinh.Text), 0) * dTongCongLamDuocTinhLuong;
                                    DataGridViewCell dataGridViewCell34 = this.DGVChiTietLuong.Rows[addLuongNhanVien].Cells[11];
                                    ConvertMoney convertMoney5 = this._convertMoney;
                                    second = Convert.ToInt32(dTongTienPhuCapComTinhLuong);
                                    dataGridViewCell34.Value = convertMoney5.chendau(second.ToString());
                                    dTongTienPhuCapKhacTinhLuong = Convert.ToDouble(dtCongTruLuongPhuCapTienCom.Rows[iCongTruLuongPhuCapTienCom]["ChiTietPhuCapKhac"].ToString());
                                    DataGridViewCell item35 = this.DGVChiTietLuong.Rows[addLuongNhanVien].Cells[12];
                                    ConvertMoney convertMoney6 = this._convertMoney;
                                    second = Convert.ToInt32(dTongTienPhuCapKhacTinhLuong);
                                    item35.Value = convertMoney6.chendau(second.ToString());
                                    dTongTienTamUngTinhLuong = Convert.ToDouble(dtCongTruLuongPhuCapTienCom.Rows[iCongTruLuongPhuCapTienCom]["ChiTietTamUngLuong"].ToString());
                                    DataGridViewCell dataGridViewCell35 = this.DGVChiTietLuong.Rows[addLuongNhanVien].Cells[18];
                                    ConvertMoney convertMoney7 = this._convertMoney;
                                    second = Convert.ToInt32(dTongTienTamUngTinhLuong);
                                    dataGridViewCell35.Value = convertMoney7.chendau(second.ToString());
                                    dTongTienViPhamTinhLuong = Convert.ToDouble(dtCongTruLuongPhuCapTienCom.Rows[iCongTruLuongPhuCapTienCom]["ChiTietViPham"].ToString());
                                    DataGridViewCell item36 = this.DGVChiTietLuong.Rows[addLuongNhanVien].Cells[19];
                                    ConvertMoney convertMoney8 = this._convertMoney;
                                    second = Convert.ToInt32(dTongTienViPhamTinhLuong);
                                    item36.Value = convertMoney8.chendau(second.ToString());
                                    dTongTienThuongTinhLuong = Convert.ToDouble(dtCongTruLuongPhuCapTienCom.Rows[iCongTruLuongPhuCapTienCom]["ChiTietThuong"].ToString());
                                    DataGridViewCell dataGridViewCell36 = this.DGVChiTietLuong.Rows[addLuongNhanVien].Cells[13];
                                    ConvertMoney convertMoney9 = this._convertMoney;
                                    second = Convert.ToInt32(dTongTienThuongTinhLuong);
                                    dataGridViewCell36.Value = convertMoney9.chendau(second.ToString());
                                }
                                double dTongLuongTinhLuong = dLuongTheoNgayCongLamDuoc + dTongTienPhuCapComTinhLuong + dTongTienPhuCapKhacTinhLuong + dTienTangCaLamDuoc + dTongTienThuongTinhLuong;
                                DataGridViewCell item37 = this.DGVChiTietLuong.Rows[addLuongNhanVien].Cells[14];
                                ConvertMoney convertMoney10 = this._convertMoney;
                                second = Convert.ToInt32(dTongLuongTinhLuong);
                                item37.Value = convertMoney10.chendau(second.ToString());
                                double dTienBaoHiemXaHoi = 0;
                                double dTienBaoHiemyTe = 0;
                                double dTienBaoHiemThatNghiep = 0;
                                if (!(sDangKyThamGiaBaoHiem == "True"))
                                {
                                    DataGridViewCell dataGridViewCell37 = this.DGVChiTietLuong.Rows[addLuongNhanVien].Cells[15];
                                    ConvertMoney convertMoney11 = this._convertMoney;
                                    second = Convert.ToInt32(dTienBaoHiemXaHoi);
                                    dataGridViewCell37.Value = convertMoney11.chendau(second.ToString());
                                    DataGridViewCell item38 = this.DGVChiTietLuong.Rows[addLuongNhanVien].Cells[16];
                                    ConvertMoney convertMoney12 = this._convertMoney;
                                    second = Convert.ToInt32(dTienBaoHiemyTe);
                                    item38.Value = convertMoney12.chendau(second.ToString());
                                    DataGridViewCell dataGridViewCell38 = this.DGVChiTietLuong.Rows[addLuongNhanVien].Cells[17];
                                    ConvertMoney convertMoney13 = this._convertMoney;
                                    second = Convert.ToInt32(dTienBaoHiemThatNghiep);
                                    dataGridViewCell38.Value = convertMoney13.chendau(second.ToString());
                                }
                                else
                                {
                                    dTienBaoHiemXaHoi = Math.Round(Convert.ToDouble(this._convertMoney.loaidau(this.DGVChiTietLuong.Rows[addLuongNhanVien].Cells[3].Value.ToString())) * this.dHeSoBaoHiemXaHoi / 100);
                                    DataGridViewCell item39 = this.DGVChiTietLuong.Rows[addLuongNhanVien].Cells[15];
                                    ConvertMoney convertMoney14 = this._convertMoney;
                                    second = Convert.ToInt32(dTienBaoHiemXaHoi);
                                    item39.Value = convertMoney14.chendau(second.ToString());
                                    dTienBaoHiemyTe = Math.Round(Convert.ToDouble(this._convertMoney.loaidau(this.DGVChiTietLuong.Rows[addLuongNhanVien].Cells[3].Value.ToString())) * this.dHeSoBaoHiemYTe / 100);
                                    DataGridViewCell dataGridViewCell39 = this.DGVChiTietLuong.Rows[addLuongNhanVien].Cells[16];
                                    ConvertMoney convertMoney15 = this._convertMoney;
                                    second = Convert.ToInt32(dTienBaoHiemyTe);
                                    dataGridViewCell39.Value = convertMoney15.chendau(second.ToString());
                                    dTienBaoHiemThatNghiep = Math.Round(Convert.ToDouble(this._convertMoney.loaidau(this.DGVChiTietLuong.Rows[addLuongNhanVien].Cells[3].Value.ToString())) * this.dHeSoBaoHiemThatNghiep / 100);
                                    DataGridViewCell item40 = this.DGVChiTietLuong.Rows[addLuongNhanVien].Cells[17];
                                    ConvertMoney convertMoney16 = this._convertMoney;
                                    second = Convert.ToInt32(dTienBaoHiemThatNghiep);
                                    item40.Value = convertMoney16.chendau(second.ToString());
                                }
                                double dTongTienTruVaoLuong = dTienBaoHiemXaHoi + dTienBaoHiemyTe + dTienBaoHiemThatNghiep + dTongTienTamUngTinhLuong + dTongTienViPhamTinhLuong;
                                DataGridViewCell dataGridViewCell40 = this.DGVChiTietLuong.Rows[addLuongNhanVien].Cells[20];
                                ConvertMoney convertMoney17 = this._convertMoney;
                                second = Convert.ToInt32(dTongTienTruVaoLuong);
                                dataGridViewCell40.Value = convertMoney17.chendau(second.ToString());
                                DataGridViewCell item41 = this.DGVChiTietLuong.Rows[addLuongNhanVien].Cells[21];
                                ConvertMoney convertMoney18 = this._convertMoney;
                                second = Convert.ToInt32(dTongLuongTinhLuong - dTongTienTruVaoLuong);
                                item41.Value = convertMoney18.chendau(second.ToString());
                               
                            }

                        }
                    }
                    //if (this.checkBoxCoTinhLuong.Checked)
                    //{
                    //    for (int iLuuTinhLuong = 0; iLuuTinhLuong < this.DGVChiTietLuong.Rows.Count; iLuuTinhLuong++)
                    //    {
                    //        this._tinhLuongDTO.MaNhanVien = this.DGVChiTietLuong.Rows[iLuuTinhLuong].Cells[0].Value.ToString();
                    //        this._tinhLuongDTO.TenNhanVien = this.DGVChiTietLuong.Rows[iLuuTinhLuong].Cells[1].Value.ToString();
                    //        this._tinhLuongDTO.MaChamCong = Convert.ToInt32(this.DGVChiTietLuong.Rows[iLuuTinhLuong].Cells[2].Value.ToString());
                    //        this._tinhLuongDTO.LuongCoBanBaoHiem = this._convertMoney.loaidau(this.DGVChiTietLuong.Rows[iLuuTinhLuong].Cells[3].Value.ToString());
                    //        this._tinhLuongDTO.LuongHopDong = this._convertMoney.loaidau(this.DGVChiTietLuong.Rows[iLuuTinhLuong].Cells[4].Value.ToString());
                    //        this._tinhLuongDTO.NgayCongTinh = this.DGVChiTietLuong.Rows[iLuuTinhLuong].Cells[5].Value.ToString();
                    //        this._tinhLuongDTO.NgayCongLamDuoc = this.DGVChiTietLuong.Rows[iLuuTinhLuong].Cells[6].Value.ToString();
                    //        this._tinhLuongDTO.SoGioTangCa = this.DGVChiTietLuong.Rows[iLuuTinhLuong].Cells[7].Value.ToString();
                    //        this._tinhLuongDTO.LuongNgayCongLamDuoc = this._convertMoney.loaidau(this.DGVChiTietLuong.Rows[iLuuTinhLuong].Cells[8].Value.ToString());
                    //        this._tinhLuongDTO.TienTangCa = this._convertMoney.loaidau(this.DGVChiTietLuong.Rows[iLuuTinhLuong].Cells[9].Value.ToString());
                    //        this._tinhLuongDTO.PhuCapTienCom = this._convertMoney.loaidau(this.DGVChiTietLuong.Rows[iLuuTinhLuong].Cells[10].Value.ToString());
                    //        this._tinhLuongDTO.PhuCapTienComTheoNgayCong = this._convertMoney.loaidau(this.DGVChiTietLuong.Rows[iLuuTinhLuong].Cells[11].Value.ToString());
                    //        this._tinhLuongDTO.PhuCapKhac = this._convertMoney.loaidau(this.DGVChiTietLuong.Rows[iLuuTinhLuong].Cells[12].Value.ToString());
                    //        this._tinhLuongDTO.Thuong = this._convertMoney.loaidau(this.DGVChiTietLuong.Rows[iLuuTinhLuong].Cells[13].Value.ToString());
                    //        this._tinhLuongDTO.TongLuong = this._convertMoney.loaidau(this.DGVChiTietLuong.Rows[iLuuTinhLuong].Cells[14].Value.ToString());
                    //        this._tinhLuongDTO.BHXH = this._convertMoney.loaidau(this.DGVChiTietLuong.Rows[iLuuTinhLuong].Cells[15].Value.ToString());
                    //        this._tinhLuongDTO.BHYT = this._convertMoney.loaidau(this.DGVChiTietLuong.Rows[iLuuTinhLuong].Cells[16].Value.ToString());
                    //        this._tinhLuongDTO.BHTN = this._convertMoney.loaidau(this.DGVChiTietLuong.Rows[iLuuTinhLuong].Cells[17].Value.ToString());
                    //        this._tinhLuongDTO.TamUng = this._convertMoney.loaidau(this.DGVChiTietLuong.Rows[iLuuTinhLuong].Cells[18].Value.ToString());
                    //        this._tinhLuongDTO.ViPham = this._convertMoney.loaidau(this.DGVChiTietLuong.Rows[iLuuTinhLuong].Cells[19].Value.ToString());
                    //        this._tinhLuongDTO.TongTienTruVaoLuong = this._convertMoney.loaidau(this.DGVChiTietLuong.Rows[iLuuTinhLuong].Cells[20].Value.ToString());
                    //        this._tinhLuongDTO.LuongThucLanh = this._convertMoney.loaidau(this.DGVChiTietLuong.Rows[iLuuTinhLuong].Cells[21].Value.ToString());
                    //        this._tinhLuongBLL.TinhLuongInsert(this._tinhLuongDTO);
                    //    }
                    //}
                    _loadTinhCong.Close();
                }
                else
                {
                    _loadTinhCong.Close();
                    MessageBox.Show("Bạn chưa chọn nhân viên để tính công");
                }
            }
            else
            {
                MessageBox.Show("Xin chọn lại ngày");
            }
            return;
        Label1:
            this.DGVDuLieuChamCongNguon.Rows[addGioNguonTuDongQuaDemQuaDem].Cells[0].Value = this.sMaChamCong;
            this.DGVDuLieuChamCongNguon.Rows[addGioNguonTuDongQuaDemQuaDem].Cells[1].Value = string.Format("{0:d}", dGioVaoTuDongQuaDemKiemTraLichTrinhVaoRa);
            this.DGVDuLieuChamCongNguon.Rows[addGioNguonTuDongQuaDemQuaDem].Cells[2].Value = dGioVaoTuDongQuaDemKiemTraLichTrinhVaoRa;
            this.DGVDuLieuChamCongNguon.Rows[addGioNguonTuDongQuaDemQuaDem].Cells[3].Value = "Lặp lại";
            this.DGVDuLieuChamCongNguon.Rows[addGioNguonTuDongQuaDemQuaDem].Cells[4].Value = "*";
            this.DGVDuLieuChamCongNguon.Rows[addGioNguonTuDongQuaDemQuaDem].Cells[6].Value = dtChonTuMay.Rows[iChonTuMay]["MaSoMay"].ToString();
            for (iLapLaiTuDongQuaDem = 0; iLapLaiTuDongQuaDem < 7; iLapLaiTuDongQuaDem++)
            {
                this.DGVDuLieuChamCongNguon.Rows[addGioNguonTuDongQuaDemQuaDem].Cells[iLapLaiTuDongQuaDem].Style.BackColor = Color.Red;
            }
            iKiemTraLanChamLichTrinhVaoRa = 0;
           
          // goto Label0;
        Label2:
            this.DGVDuLieuChamCongNguon.Rows[addGioNguonTuDongQuaDemQuaDem].Cells[0].Value = this.sMaChamCong;
            this.DGVDuLieuChamCongNguon.Rows[addGioNguonTuDongQuaDemQuaDem].Cells[1].Value = string.Format("{0:d}", dGioRaTuDongQuaDemKiemTraLichTrinhVaoRa);
            this.DGVDuLieuChamCongNguon.Rows[addGioNguonTuDongQuaDemQuaDem].Cells[2].Value = dGioRaTuDongQuaDemKiemTraLichTrinhVaoRa;
            this.DGVDuLieuChamCongNguon.Rows[addGioNguonTuDongQuaDemQuaDem].Cells[3].Value = "Lặp lại";
            this.DGVDuLieuChamCongNguon.Rows[addGioNguonTuDongQuaDemQuaDem].Cells[4].Value = "***";
            this.DGVDuLieuChamCongNguon.Rows[addGioNguonTuDongQuaDemQuaDem].Cells[6].Value = dtChonTuMay.Rows[iChonTuMay]["MaSoMay"].ToString();
            for (iLapLaiTuDongQuaDem = 0; iLapLaiTuDongQuaDem < 7; iLapLaiTuDongQuaDem++)
            {
                this.DGVDuLieuChamCongNguon.Rows[addGioNguonTuDongQuaDemQuaDem].Cells[iLapLaiTuDongQuaDem].Style.BackColor = Color.Red;
            }
            iKiemTraLanChamLichTrinhVaoRa = 1;
         //  goto Label0;
           
        Label3:
            dGioRaChonTuMay = Convert.ToDateTime(dateGioChamChonTuMay.ToString());
            this.DGVTinhCong.Rows[addChonTuMay].Cells[6].Value = string.Format(this.sDinhDangThoiGian, dGioRaChonTuMay);
            iKiemTraB = 0;
            dtNhanCaChonTuMay = new System.Data.DataTable();
            this._chiTietLichTrinhChoCalamViecDTO.MaLichTrinhCaLamViec = sLTCCLVNhanVien;
            this._chiTietLichTrinhChoCalamViecDTO.Thu = sThu;
            dtNhanCaChonTuMay = this._chiTietLichTrinhChoCaLamViecBLL.ChiTietLichTrinhChoCaLamViecNhanCa(this._chiTietLichTrinhChoCalamViecDTO);
            iChiTietLichTrinhChoCaLamViecChonTuMay = 0;
            if (iChiTietLichTrinhChoCaLamViecChonTuMay < dtNhanCaChonTuMay.Rows.Count)
            {
                cellChiTietLichTrinhChoCaLamViecChonTuMay = 3;
                while (cellChiTietLichTrinhChoCaLamViecChonTuMay < 13)
                {
                    kiemTraVao = 0;
                    kiemTraRa = 0;
                    this.sChonTuMayMaCaLamViec = dtNhanCaChonTuMay.Rows[iChiTietLichTrinhChoCaLamViecChonTuMay][cellChiTietLichTrinhChoCaLamViecChonTuMay].ToString();
                    dtChonTuMayCa1 = new System.Data.DataTable();
                    this._caLamViecDTO.MaCaLamViec = this.sChonTuMayMaCaLamViec;
                    dtChonTuMayCa1 = this._caLamViecBLL.CaLamViecGetByMaCaLamViec(this._caLamViecDTO);
                    iChonTuMayCa1 = 0;
                    while (iChonTuMayCa1 < dtChonTuMayCa1.Rows.Count)
                    {
                        this.sChonTuMayTenCaLamViec = dtChonTuMayCa1.Rows[iChonTuMayCa1]["CaLamViec"].ToString();
                        dBatDauVaoChonTuMayA = Convert.ToDateTime(dtChonTuMayCa1.Rows[iChonTuMayCa1]["BatDauVao"].ToString());
                        sBatDauVaoChonTuMayA = string.Format("{0:T}", dBatDauVaoChonTuMayA);
                        sBatDauVaoChonTuMayB = string.Concat(sNgayCham, " ", sBatDauVaoChonTuMayA);
                        dBatDauVaoChonTuMayB = Convert.ToDateTime(sBatDauVaoChonTuMayB);
                        dKetThucVaoChonTuMayA = Convert.ToDateTime(dtChonTuMayCa1.Rows[iChonTuMayCa1]["KetThucVao"].ToString());
                        sKetThucVaoChonTuMayA = string.Format("{0:T}", dKetThucVaoChonTuMayA);
                        sKetThucVaoChonTuMayB = string.Concat(sNgayCham, " ", sKetThucVaoChonTuMayA);
                        dKetThucVaoChonTuMayB = Convert.ToDateTime(sKetThucVaoChonTuMayB);
                        dBatDauRaChonTuMayA = Convert.ToDateTime(dtChonTuMayCa1.Rows[iChonTuMayCa1]["BatDauRa"].ToString());
                        sBatDauRaChonTuMayA = string.Format("{0:T}", dBatDauRaChonTuMayA);
                        sBatDauRaChonTuMayB = string.Concat(sNgayCham, " ", sBatDauRaChonTuMayA);
                        dBatDauRaChonTuMayB = Convert.ToDateTime(sBatDauRaChonTuMayB);
                        if (!(sBatDauRaChonTuMayB == "12:01:00 AM"))
                        {
                            dBatDauRaChonTuMayB = Convert.ToDateTime(dBatDauRaChonTuMayB);
                        }
                        else
                        {
                            dateTime = dBatDauRaChonTuMayB.AddDays(1);
                            dBatDauRaChonTuMayB = Convert.ToDateTime(dateTime.ToString());
                        }
                        dKetThucRaChonTuMayA = Convert.ToDateTime(dtChonTuMayCa1.Rows[iChonTuMayCa1]["KetThucRa"].ToString());
                        sKetThucRaChonTuMayA = string.Format("{0:T}", dKetThucRaChonTuMayA);
                        sKetThucRaChonTuMayB = string.Concat(sNgayCham, " ", sKetThucRaChonTuMayA);
                        dKetThucRaChonTuMayB = Convert.ToDateTime(sKetThucRaChonTuMayB);
                        if (!(sKetThucRaChonTuMayA == "12:01:00 AM"))
                        {
                            dKetThucRaChonTuMayB = Convert.ToDateTime(dKetThucRaChonTuMayB);
                        }
                        else
                        {
                            dateTime = dKetThucRaChonTuMayB.AddDays(1);
                            dKetThucRaChonTuMayB = Convert.ToDateTime(dateTime.ToString());
                        }
                        if ((dGioVaoChonTuMay < dBatDauVaoChonTuMayB ? false : dGioVaoChonTuMay <= dKetThucVaoChonTuMayB))
                        {
                            kiemTraVao++;
                        }
                        if ((dGioRaChonTuMay < dBatDauRaChonTuMayB ? false : dGioRaChonTuMay <= dKetThucRaChonTuMayB))
                        {
                            kiemTraRa++;
                        }
                        if ((kiemTraVao != 1 ? true : kiemTraRa != 1))
                        {
                            iChonTuMayCa1++;
                        }
                        else
                        {
                            goto Label68;
                        }
                    }
                    if (!(this.sChonTuMayMaCaLamViec == ""))
                    {
                        cellChiTietLichTrinhChoCaLamViecChonTuMay++;
                    }
                    else
                    {
                        this.DGVTinhCong.Rows[addChonTuMay].Cells[4].Value = "***";
                        this.DGVTinhCong.Rows[addChonTuMay].Cells[7].Value = "0";
                        this.DGVTinhCong.Rows[addChonTuMay].Cells[8].Value = "0";
                        this.DGVTinhCong.Rows[addChonTuMay].Cells[9].Value = "0";
                        this.DGVTinhCong.Rows[addChonTuMay].Cells[10].Value = "0";
                        this.DGVTinhCong.Rows[addChonTuMay].Cells[11].Value = "0";
                        this.DGVTinhCong.Rows[addChonTuMay].Cells[12].Value = "0";
                        this.DGVTinhCong.Rows[addChonTuMay].Cells[13].Value = "0";
                        this.DGVTinhCong.Rows[addChonTuMay].Cells[14].Value = "0";
                        this.DGVTinhCong.Rows[addChonTuMay].Cells[15].Value = "0";
                        this.DGVTinhCong.Rows[addChonTuMay].Cells[16].Value = "0";
                        this.DGVTinhCong.Rows[addChonTuMay].Cells[17].Value = "0";
                        this.DGVTinhCong.Rows[addChonTuMay].Cells[18].Value = this.sKHVang;
                        //  goto Label0;
                        break;
                    }
                }
             
             Label68:

                this.DGVTinhCong.Rows[addChonTuMay].Cells[4].Value = this.sChonTuMayTenCaLamViec;
                dtCaLamViecChonTuMay = new System.Data.DataTable();
                this._caLamViecDTO.MaCaLamViec = this.sChonTuMayMaCaLamViec;
                dtCaLamViecChonTuMay = this._caLamViecBLL.CaLamViecGetByMaCaLamViec(this._caLamViecDTO);
                for (iCaLamViecChonTuMay = 0; iCaLamViecChonTuMay < dtCaLamViecChonTuMay.Rows.Count; iCaLamViecChonTuMay++)
                {
                    second = dGioVaoChonTuMay.Second;
                    sGiayGioVao = second.ToString();
                    second = dGioRaChonTuMay.Second;
                    sGiayGioRa = second.ToString();
                    dGioVaoKhaiBaoChonTuMayA = Convert.ToDateTime(dtCaLamViecChonTuMay.Rows[iCaLamViecChonTuMay]["GioVaoLamViec"].ToString());
                    sGioVaoKhaiBaoChonTuMayA = string.Format("{0:T}", dGioVaoKhaiBaoChonTuMayA).Replace("00 ", string.Concat(sGiayGioVao, " "));
                    sGioVaoKhaiBaoChonTuMayB = string.Concat(sNgayCham, " ", sGioVaoKhaiBaoChonTuMayA);
                    dGioVaoKhaiBaoChonTuMayB = Convert.ToDateTime(sGioVaoKhaiBaoChonTuMayB);
                    dGioRaKhaiBaoChonTuMayA = Convert.ToDateTime(dtCaLamViecChonTuMay.Rows[iCaLamViecChonTuMay]["GioKetThucLamViec"].ToString());
                    sGioRaKhaiBaoChonTuMayA = string.Format("{0:T}", dGioRaKhaiBaoChonTuMayA).Replace("00 ", string.Concat(sGiayGioRa, " "));
                    sGioRaKhaiBaoChonTuMayB = string.Concat(sNgayCham, " ", sGioRaKhaiBaoChonTuMayA);
                    dGioRaKhaiBaoChonTuMayB = Convert.ToDateTime(sGioRaKhaiBaoChonTuMayB);
                    sTruGioDiTre = dtCaLamViecChonTuMay.Rows[iCaLamViecChonTuMay]["TruGioDiTre"].ToString();
                    sBatDauTinhDiTre = dtCaLamViecChonTuMay.Rows[iCaLamViecChonTuMay]["BatDauTinhDiTre"].ToString();
                    iChoPhepDiTre = Convert.ToInt32(dtCaLamViecChonTuMay.Rows[iCaLamViecChonTuMay]["ChoPhepDiTre"].ToString());
                    value = dGioVaoChonTuMay - dGioVaoKhaiBaoChonTuMayB;
                    second = Convert.ToInt32(value.TotalMinutes);
                    sPhutTre = second.ToString();
                    if (!(sTruGioDiTre == "True"))
                    {
                        this.DGVTinhCong.Rows[addChonTuMay].Cells[9].Value = "0";
                    }
                    else if (Convert.ToInt32(sPhutTre) >= 0)
                    {
                        iPhutTre = Convert.ToInt32(sPhutTre) - iChoPhepDiTre;
                        if (sBatDauTinhDiTre == "True")
                        {
                            if (iPhutTre >= 1)
                            {
                                this.DGVTinhCong.Rows[addChonTuMay].Cells[9].Value = iPhutTre.ToString();
                            }
                            else
                            {
                                this.DGVTinhCong.Rows[addChonTuMay].Cells[9].Value = "0";
                            }
                        }
                        else if (iPhutTre >= 1)
                        {
                            this.DGVTinhCong.Rows[addChonTuMay].Cells[9].Value = sPhutTre;
                        }
                        else
                        {
                            this.DGVTinhCong.Rows[addChonTuMay].Cells[9].Value = "0";
                        }
                    }
                    else
                    {
                        this.DGVTinhCong.Rows[addChonTuMay].Cells[9].Value = "0";
                    }
                    sTruGioVeSom = dtCaLamViecChonTuMay.Rows[iCaLamViecChonTuMay]["TruGioVeSom"].ToString();
                    sBatDauTinhVeSom = dtCaLamViecChonTuMay.Rows[iCaLamViecChonTuMay]["BatDauTinhVeSom"].ToString();
                    iChoPhepVeSom = Convert.ToInt32(dtCaLamViecChonTuMay.Rows[iCaLamViecChonTuMay]["ChoPhepVeSom"].ToString());
                    value = dGioRaKhaiBaoChonTuMayB - dGioRaChonTuMay;
                    second = Convert.ToInt32(value.TotalMinutes);
                    sPhutVeSom = second.ToString();
                    if (!(sTruGioVeSom == "True"))
                    {
                        this.DGVTinhCong.Rows[addChonTuMay].Cells[10].Value = "0";
                    }
                    else if (Convert.ToInt32(sPhutVeSom) >= 0)
                    {
                        iPhutVeSom = Convert.ToInt32(sPhutVeSom) - iChoPhepVeSom;
                        if (iPhutVeSom < 1)
                        {
                            this.DGVTinhCong.Rows[addChonTuMay].Cells[10].Value = "0";
                        }
                        else if (!(sBatDauTinhVeSom == "True"))
                        {
                            this.DGVTinhCong.Rows[addChonTuMay].Cells[10].Value = sPhutVeSom;
                        }
                        else
                        {
                            this.DGVTinhCong.Rows[addChonTuMay].Cells[10].Value = iPhutVeSom.ToString();
                        }
                    }
                    else
                    {
                        this.DGVTinhCong.Rows[addChonTuMay].Cells[10].Value = "0";
                    }
                    value = dGioRaChonTuMay - dGioRaKhaiBaoChonTuMayB;
                    second = Convert.ToInt32(value.TotalMinutes);
                    sVeTre = second.ToString();
                    if (Convert.ToInt32(sVeTre) <= 0)
                    {
                        this.DGVTinhCong.Rows[addChonTuMay].Cells[11].Value = "0";
                    }
                    else
                    {
                        this.DGVTinhCong.Rows[addChonTuMay].Cells[11].Value = sVeTre;
                    }
                    iPhut = Convert.ToSingle(dtCaLamViecChonTuMay.Rows[iCaLamViecChonTuMay]["TongGioTrongCaLamViec"]) * 60f - (float)(Convert.ToInt32(this.DGVTinhCong.Rows[addChonTuMay].Cells[9].Value.ToString()) + Convert.ToInt32(this.DGVTinhCong.Rows[addChonTuMay].Cells[10].Value));
                    dGio = Math.Round(Convert.ToDouble(iPhut) / 60, this.iLamTronGio);
                    this.DGVTinhCong.Rows[addChonTuMay].Cells[8].Value = dGio.ToString();
                    iGio = Convert.ToDouble(dtCaLamViecChonTuMay.Rows[iCaLamViecChonTuMay]["TongGioTrongCaLamViec"].ToString());
                    dCongTinh = Convert.ToDouble(dtCaLamViecChonTuMay.Rows[iCaLamViecChonTuMay]["CongTinh"].ToString());
                    dCong = Math.Round(dGio * dCongTinh / iGio, this.iLamTronCong);
                    this.DGVTinhCong.Rows[addChonTuMay].Cells[7].Value = dCong.ToString();
                    sTangCaTruocGioLamViec = dtCaLamViecChonTuMay.Rows[iCaLamViecChonTuMay]["TangCaTruocGioLamViec"].ToString();
                    sTangCaSauGioLamViec = dtCaLamViecChonTuMay.Rows[iCaLamViecChonTuMay]["TangCaSauGioLamViec"].ToString();
                    if ((sTangCaTruocGioLamViec != "False" ? false : sTangCaSauGioLamViec == "False"))
                    {
                        this.DGVTinhCong.Rows[addChonTuMay].Cells[12].Value = "0";
                        this.DGVTinhCong.Rows[addChonTuMay].Cells[13].Value = "0";
                        this.DGVTinhCong.Rows[addChonTuMay].Cells[14].Value = "0";
                        this.DGVTinhCong.Rows[addChonTuMay].Cells[15].Value = "0";
                    }
                    sXemCaNayLaTangCa = dtCaLamViecChonTuMay.Rows[iCaLamViecChonTuMay]["XemCaNayLaTangCa"].ToString();
                    iTangCaMuc = Convert.ToInt32(dtCaLamViecChonTuMay.Rows[iCaLamViecChonTuMay]["TangCaMuc"].ToString());
                    if (sXemCaNayLaTangCa == "True")
                    {
                        if (iTangCaMuc == 1)
                        {
                            this.DGVTinhCong.Rows[addChonTuMay].Cells[7].Value = "0";
                            this.DGVTinhCong.Rows[addChonTuMay].Cells[8].Value = "0";
                            this.DGVTinhCong.Rows[addChonTuMay].Cells[12].Value = dGio.ToString();
                            this.DGVTinhCong.Rows[addChonTuMay].Cells[13].Value = "0";
                            this.DGVTinhCong.Rows[addChonTuMay].Cells[14].Value = "0";
                            this.DGVTinhCong.Rows[addChonTuMay].Cells[15].Value = "0";
                        }
                        if (iTangCaMuc == 2)
                        {
                            this.DGVTinhCong.Rows[addChonTuMay].Cells[7].Value = "0";
                            this.DGVTinhCong.Rows[addChonTuMay].Cells[8].Value = "0";
                            this.DGVTinhCong.Rows[addChonTuMay].Cells[12].Value = "0";
                            this.DGVTinhCong.Rows[addChonTuMay].Cells[13].Value = dGio.ToString();
                            this.DGVTinhCong.Rows[addChonTuMay].Cells[14].Value = "0";
                            this.DGVTinhCong.Rows[addChonTuMay].Cells[15].Value = "0";
                        }
                        if (iTangCaMuc == 3)
                        {
                            this.DGVTinhCong.Rows[addChonTuMay].Cells[7].Value = "0";
                            this.DGVTinhCong.Rows[addChonTuMay].Cells[8].Value = "0";
                            this.DGVTinhCong.Rows[addChonTuMay].Cells[12].Value = "0";
                            this.DGVTinhCong.Rows[addChonTuMay].Cells[13].Value = "0";
                            this.DGVTinhCong.Rows[addChonTuMay].Cells[14].Value = dGio.ToString();
                            this.DGVTinhCong.Rows[addChonTuMay].Cells[15].Value = "0";
                        }
                        if (iTangCaMuc == 4)
                        {
                            this.DGVTinhCong.Rows[addChonTuMay].Cells[7].Value = "0";
                            this.DGVTinhCong.Rows[addChonTuMay].Cells[8].Value = "0";
                            this.DGVTinhCong.Rows[addChonTuMay].Cells[12].Value = "0";
                            this.DGVTinhCong.Rows[addChonTuMay].Cells[13].Value = "0";
                            this.DGVTinhCong.Rows[addChonTuMay].Cells[14].Value = "0";
                            this.DGVTinhCong.Rows[addChonTuMay].Cells[15].Value = dGio.ToString();
                        }
                    }
                    sChoPhepTangCaTruocGioLamViecChonTuMay = dtCaLamViecChonTuMay.Rows[iCaLamViecChonTuMay]["TangCaTruocGioLamViec"].ToString();
                    iPhutTangCaTruocGioLamViecChonTuMay = Convert.ToInt32(dtCaLamViecChonTuMay.Rows[iCaLamViecChonTuMay]["SoPhutTangCaTruocGioLamViec"].ToString());
                    iPhutTangCaTruocGioLamViecDatDen = Convert.ToInt32(dtCaLamViecChonTuMay.Rows[iCaLamViecChonTuMay]["TangCaTruocGioLamViecDatDen"].ToString());
                    iPhutTruTangCaTruoc = Convert.ToInt32(dtCaLamViecChonTuMay.Rows[iCaLamViecChonTuMay]["PhutTruTangCaTruoc"].ToString());
                    sChoPhepTangCaSauGioLamViecChonTuMay = dtCaLamViecChonTuMay.Rows[iCaLamViecChonTuMay]["TangCaSauGioLamViec"].ToString();
                    iPhutTangCaSauGioLamViecChonTuMay = Convert.ToInt32(dtCaLamViecChonTuMay.Rows[iCaLamViecChonTuMay]["SoPhutTangCaSauGioLamViec"].ToString());
                    iPhutTangCaSauGioLamViecDatDen = Convert.ToInt32(dtCaLamViecChonTuMay.Rows[iCaLamViecChonTuMay]["TangCaSauGioLamViecDatDen"].ToString());
                    iPhutTruTangCaSau = Convert.ToInt32(dtCaLamViecChonTuMay.Rows[iCaLamViecChonTuMay]["PhutTruTangCaSau"].ToString());
                    iGioiHanTC1ChonTuMay = Convert.ToInt32(dtCaLamViecChonTuMay.Rows[iCaLamViecChonTuMay]["GioiHanTangCa1"].ToString());
                    iGioiHanTC2ChonTuMay = Convert.ToInt32(dtCaLamViecChonTuMay.Rows[iCaLamViecChonTuMay]["GioiHanTangCa2"].ToString());
                    iGioiHanTC3ChonTuMay = Convert.ToInt32(dtCaLamViecChonTuMay.Rows[iCaLamViecChonTuMay]["GioiHanTangCa3"].ToString());
                    iGioiHanTC4ChonTuMay = Convert.ToInt32(dtCaLamViecChonTuMay.Rows[iCaLamViecChonTuMay]["GioiHanTangCa4"].ToString());
                    iTongGioTangCaSauChonTuMay = 0;
                    iTongGioTangCaTruocChonTuMay = 0;
                    if ((sChoPhepTangCaTruocGioLamViecChonTuMay != "False" ? true : !(sChoPhepTangCaSauGioLamViecChonTuMay == "False")))
                    {
                        if (sChoPhepTangCaTruocGioLamViecChonTuMay == "True")
                        {
                            value = dGioVaoKhaiBaoChonTuMayB - dGioVaoChonTuMay;
                            second = Convert.ToInt32(value.TotalMinutes);
                            iThoiGianTruocGioLamChonTuMay = Convert.ToInt32(second.ToString());
                            if (iThoiGianTruocGioLamChonTuMay > 0)
                            {
                                if (iThoiGianTruocGioLamChonTuMay > iPhutTangCaTruocGioLamViecChonTuMay)
                                {
                                    if (iThoiGianTruocGioLamChonTuMay > iPhutTangCaTruocGioLamViecDatDen)
                                    {
                                        iTongGioTangCaTruocChonTuMay = iThoiGianTruocGioLamChonTuMay - iPhutTruTangCaTruoc;
                                    }
                                }
                            }
                        }
                        if (sChoPhepTangCaSauGioLamViecChonTuMay == "True")
                        {
                            value = dGioRaChonTuMay - dGioRaKhaiBaoChonTuMayB;
                            second = Convert.ToInt32(value.TotalMinutes);
                            iThoiGianSauGioLamViecChonTuMay = Convert.ToInt32(second.ToString());
                            if (iThoiGianSauGioLamViecChonTuMay > 0)
                            {
                                if (iThoiGianSauGioLamViecChonTuMay > iPhutTangCaSauGioLamViecChonTuMay)
                                {
                                    if (iThoiGianSauGioLamViecChonTuMay > iPhutTangCaSauGioLamViecDatDen)
                                    {
                                        iTongGioTangCaSauChonTuMay = iThoiGianSauGioLamViecChonTuMay - iPhutTruTangCaSau;
                                    }
                                }
                            }
                        }
                    }
                    else
                    {
                        this.DGVTinhCong.Rows[addChonTuMay].Cells[12].Value = "0";
                        this.DGVTinhCong.Rows[addChonTuMay].Cells[13].Value = "0";
                        this.DGVTinhCong.Rows[addChonTuMay].Cells[14].Value = "0";
                        this.DGVTinhCong.Rows[addChonTuMay].Cells[15].Value = "0";
                    }
                    dTongThoiGianTangCaChonTuMay = Convert.ToDouble(iTongGioTangCaTruocChonTuMay + iTongGioTangCaSauChonTuMay);
                    if (dTongThoiGianTangCaChonTuMay <= 0)
                    {
                        this.DGVTinhCong.Rows[addChonTuMay].Cells[12].Value = "0";
                        this.DGVTinhCong.Rows[addChonTuMay].Cells[13].Value = "0";
                        this.DGVTinhCong.Rows[addChonTuMay].Cells[14].Value = "0";
                        this.DGVTinhCong.Rows[addChonTuMay].Cells[15].Value = "0";
                    }
                    else
                    {
                        if (iGioiHanTC1ChonTuMay == 0)
                        {
                            this.DGVTinhCong.Rows[addChonTuMay].Cells[12].Value = Math.Round(dTongThoiGianTangCaChonTuMay * this.dTangCa1HeSo / 60, this.iLamTronGio);
                            this.DGVTinhCong.Rows[addChonTuMay].Cells[13].Value = "0";
                            this.DGVTinhCong.Rows[addChonTuMay].Cells[14].Value = "0";
                            this.DGVTinhCong.Rows[addChonTuMay].Cells[15].Value = "0";
                        }
                        if ((iGioiHanTC1ChonTuMay == 0 ? false : iGioiHanTC2ChonTuMay == 0))
                        {
                            if (dTongThoiGianTangCaChonTuMay >= Convert.ToDouble(iGioiHanTC1ChonTuMay))
                            {
                                this.DGVTinhCong.Rows[addChonTuMay].Cells[12].Value = Math.Round(Convert.ToDouble(iGioiHanTC1ChonTuMay) / 60 * this.dTangCa1HeSo, this.iLamTronGio);
                                if (dTongThoiGianTangCaChonTuMay - Convert.ToDouble(iGioiHanTC1ChonTuMay) > 0)
                                {
                                    this.DGVTinhCong.Rows[addChonTuMay].Cells[13].Value = Math.Round((dTongThoiGianTangCaChonTuMay - Convert.ToDouble(iGioiHanTC1ChonTuMay)) * this.dTangCa2HeSo / 60, this.iLamTronGio);
                                }
                                this.DGVTinhCong.Rows[addChonTuMay].Cells[14].Value = "0";
                                this.DGVTinhCong.Rows[addChonTuMay].Cells[15].Value = "0";
                            }
                            else
                            {
                                this.DGVTinhCong.Rows[addChonTuMay].Cells[12].Value = Math.Round(dTongThoiGianTangCaChonTuMay * this.dTangCa1HeSo / 60, this.iLamTronGio);
                                this.DGVTinhCong.Rows[addChonTuMay].Cells[13].Value = "0";
                                this.DGVTinhCong.Rows[addChonTuMay].Cells[14].Value = "0";
                                this.DGVTinhCong.Rows[addChonTuMay].Cells[15].Value = "0";
                            }
                        }
                        if ((iGioiHanTC1ChonTuMay == 0 || iGioiHanTC2ChonTuMay == 0 ? false : iGioiHanTC3ChonTuMay == 0))
                        {
                            if (dTongThoiGianTangCaChonTuMay >= Convert.ToDouble(iGioiHanTC1ChonTuMay))
                            {
                                this.DGVTinhCong.Rows[addChonTuMay].Cells[12].Value = Math.Round(Convert.ToDouble(iGioiHanTC1ChonTuMay) * this.dTangCa1HeSo / 60, this.iLamTronGio);
                                if (dTongThoiGianTangCaChonTuMay - Convert.ToDouble(iGioiHanTC1ChonTuMay) >= Convert.ToDouble(iGioiHanTC2ChonTuMay))
                                {
                                    this.DGVTinhCong.Rows[addChonTuMay].Cells[12].Value = Math.Round(Convert.ToDouble(iGioiHanTC1ChonTuMay) * this.dTangCa1HeSo / 60, this.iLamTronGio);
                                    this.DGVTinhCong.Rows[addChonTuMay].Cells[13].Value = Math.Round(Convert.ToDouble(iGioiHanTC2ChonTuMay) * this.dTangCa2HeSo / 60, this.iLamTronGio);
                                    this.DGVTinhCong.Rows[addChonTuMay].Cells[14].Value = Math.Round((dTongThoiGianTangCaChonTuMay - Convert.ToDouble(iGioiHanTC1ChonTuMay) - Convert.ToDouble(iGioiHanTC2ChonTuMay)) * this.dTangCa3HeSo / 60, this.iLamTronGio);
                                    this.DGVTinhCong.Rows[addChonTuMay].Cells[15].Value = "0";
                                }
                                else
                                {
                                    this.DGVTinhCong.Rows[addChonTuMay].Cells[13].Value = Math.Round((dTongThoiGianTangCaChonTuMay - Convert.ToDouble(iGioiHanTC1ChonTuMay)) * this.dTangCa2HeSo / 60, this.iLamTronGio);
                                    this.DGVTinhCong.Rows[addChonTuMay].Cells[14].Value = "0";
                                    this.DGVTinhCong.Rows[addChonTuMay].Cells[15].Value = "0";
                                }
                            }
                            else
                            {
                                this.DGVTinhCong.Rows[addChonTuMay].Cells[12].Value = Math.Round(dTongThoiGianTangCaChonTuMay * this.dTangCa1HeSo / 60, this.iLamTronGio);
                                this.DGVTinhCong.Rows[addChonTuMay].Cells[13].Value = "0";
                                this.DGVTinhCong.Rows[addChonTuMay].Cells[14].Value = "0";
                                this.DGVTinhCong.Rows[addChonTuMay].Cells[15].Value = "0";
                            }
                        }
                        if ((iGioiHanTC1ChonTuMay == 0 || iGioiHanTC2ChonTuMay == 0 || iGioiHanTC3ChonTuMay == 0 ? false : iGioiHanTC4ChonTuMay == 0))
                        {
                        }
                    }
                    value = dGioRaChonTuMay - dGioVaoChonTuMay;
                    second = Convert.ToInt32(value.TotalMinutes);
                    num = Math.Round(Convert.ToDouble(second.ToString()) / 60, this.iLamTronGio);
                    sTongGio = num.ToString();
                    this.DGVTinhCong.Rows[addChonTuMay].Cells[16].Value = sTongGio;
                    this.DGVTinhCong.Rows[addChonTuMay].Cells[17].Value = dtCaLamViecChonTuMay.Rows[iCaLamViecChonTuMay]["CongTinh"].ToString();
                    this.DGVTinhCong.Rows[addChonTuMay].Cells[18].Value = this.sKHDungGio;
                    if (!(DateTimeProgress.XuatIDThu((int)dt.AddDays((double)dem).DayOfWeek) == "0"))
                    {
                        this.DGVTinhCong.Rows[addChonTuMay].Cells[19].Value = "NT";
                    }
                    else
                    {
                        this.DGVTinhCong.Rows[addChonTuMay].Cells[19].Value = "CN";
                    }
                    this.DGVTinhCong.Rows[addChonTuMay].Cells[20].Value = this.sMaChamCong;
                    this.DGVTinhCong.Rows[addChonTuMay].Cells[21].Value = this.sPhongBanTinhCong;
                }
            }
            // goto Label0;
        //    break;
        Label11:
            dGioVaoTuDongKhongQuaDemLichTrinhVaoRa = new DateTime();
            dtTuDong = new System.Data.DataTable();
            this.DGVDuLieuChamCongNguon.Rows[addGioNguonTuDongKhongQuaDem].Cells[0].Value = this.sMaChamCong;
            this.DGVDuLieuChamCongNguon.Rows[addGioNguonTuDongKhongQuaDem].Cells[1].Value = string.Format("{0:d}", dGioVaoTuDongKhongQuaDemLichTrinhVaoRa);
            this.DGVDuLieuChamCongNguon.Rows[addGioNguonTuDongKhongQuaDem].Cells[2].Value = dGioVaoTuDongKhongQuaDemLichTrinhVaoRa;
            this.DGVDuLieuChamCongNguon.Rows[addGioNguonTuDongKhongQuaDem].Cells[3].Value = "Lặp lại";
            this.DGVDuLieuChamCongNguon.Rows[addGioNguonTuDongKhongQuaDem].Cells[4].Value = "*";
            this.DGVDuLieuChamCongNguon.Rows[addGioNguonTuDongKhongQuaDem].Cells[6].Value = dtTuDong.Rows[iTuDong]["MaSoMay"].ToString();
            for (iLapLaiTuDongKhongQuaDem = 0; iLapLaiTuDongKhongQuaDem < 7; iLapLaiTuDongKhongQuaDem++)
            {
                this.DGVDuLieuChamCongNguon.Rows[addGioNguonTuDongKhongQuaDem].Cells[iLapLaiTuDongKhongQuaDem].Style.BackColor = Color.Red;
            }
            iKiemTraLanChamTuDongKhongQuaDemLichTrinhVaoRa = 0;
           
            // goto Label10;
        Label12:
            dGioRaTuDongKhongQuaDemLichTrinhVaoRa = new DateTime();
            this.DGVDuLieuChamCongNguon.Rows[addGioNguonTuDongKhongQuaDem].Cells[0].Value = this.sMaChamCong;
            this.DGVDuLieuChamCongNguon.Rows[addGioNguonTuDongKhongQuaDem].Cells[1].Value = string.Format("{0:d}", dGioRaTuDongKhongQuaDemLichTrinhVaoRa);
            this.DGVDuLieuChamCongNguon.Rows[addGioNguonTuDongKhongQuaDem].Cells[2].Value = dGioRaTuDongKhongQuaDemLichTrinhVaoRa;
            this.DGVDuLieuChamCongNguon.Rows[addGioNguonTuDongKhongQuaDem].Cells[3].Value = "Lặp lại";
            this.DGVDuLieuChamCongNguon.Rows[addGioNguonTuDongKhongQuaDem].Cells[4].Value = "***";
            this.DGVDuLieuChamCongNguon.Rows[addGioNguonTuDongKhongQuaDem].Cells[6].Value = dtTuDong.Rows[iTuDong]["MaSoMay"].ToString();
            for (iLapLaiTuDongKhongQuaDem = 0; iLapLaiTuDongKhongQuaDem < 7; iLapLaiTuDongKhongQuaDem++)
            {
                this.DGVDuLieuChamCongNguon.Rows[addGioNguonTuDongKhongQuaDem].Cells[iLapLaiTuDongKhongQuaDem].Style.BackColor = Color.Red;
            }
            iKiemTraLanChamTuDongKhongQuaDemLichTrinhVaoRa = 1;
          //  goto Label10;
        Label21:
            dtPhanTheoGio = new System.Data.DataTable();
            this.DGVDuLieuChamCongNguon.Rows[addGioNguonTuDongKhongQuaDem].Cells[0].Value = this.sMaChamCong;
            this.DGVDuLieuChamCongNguon.Rows[addGioNguonTuDongKhongQuaDem].Cells[1].Value = string.Format("{0:d}", dGioVaoTuDongKhongQuaDemLichTrinhVaoRa);
            this.DGVDuLieuChamCongNguon.Rows[addGioNguonTuDongKhongQuaDem].Cells[2].Value = dGioVaoTuDongKhongQuaDemLichTrinhVaoRa;
            this.DGVDuLieuChamCongNguon.Rows[addGioNguonTuDongKhongQuaDem].Cells[3].Value = "Lặp lại";
            this.DGVDuLieuChamCongNguon.Rows[addGioNguonTuDongKhongQuaDem].Cells[4].Value = "*";
            this.DGVDuLieuChamCongNguon.Rows[addGioNguonTuDongKhongQuaDem].Cells[6].Value = dtPhanTheoGio.Rows[iPhanTheoGio]["MaSoMay"].ToString();
            for (iLapLaiTuDongKhongQuaDem = 0; iLapLaiTuDongKhongQuaDem < 7; iLapLaiTuDongKhongQuaDem++)
            {
                this.DGVDuLieuChamCongNguon.Rows[addGioNguonTuDongKhongQuaDem].Cells[iLapLaiTuDongKhongQuaDem].Style.BackColor = Color.Red;
            }
            iKiemTraLanChamTuDongKhongQuaDemLichTrinhVaoRa = 0;
           // goto Label20;
        Label22:
            this.DGVDuLieuChamCongNguon.Rows[addGioNguonTuDongKhongQuaDem].Cells[0].Value = this.sMaChamCong;
            this.DGVDuLieuChamCongNguon.Rows[addGioNguonTuDongKhongQuaDem].Cells[1].Value = string.Format("{0:d}", dGioRaTuDongKhongQuaDemLichTrinhVaoRa);
            this.DGVDuLieuChamCongNguon.Rows[addGioNguonTuDongKhongQuaDem].Cells[2].Value = dGioRaTuDongKhongQuaDemLichTrinhVaoRa;
            this.DGVDuLieuChamCongNguon.Rows[addGioNguonTuDongKhongQuaDem].Cells[3].Value = "Lặp lại";
            this.DGVDuLieuChamCongNguon.Rows[addGioNguonTuDongKhongQuaDem].Cells[4].Value = "***";
            this.DGVDuLieuChamCongNguon.Rows[addGioNguonTuDongKhongQuaDem].Cells[6].Value = dtPhanTheoGio.Rows[iPhanTheoGio]["MaSoMay"].ToString();
            for (iLapLaiTuDongKhongQuaDem = 0; iLapLaiTuDongKhongQuaDem < 7; iLapLaiTuDongKhongQuaDem++)
            {
                this.DGVDuLieuChamCongNguon.Rows[addGioNguonTuDongKhongQuaDem].Cells[iLapLaiTuDongKhongQuaDem].Style.BackColor = Color.Red;
            }
            iKiemTraLanChamTuDongKhongQuaDemLichTrinhVaoRa = 1;
        // goto Label20;
        Label28:
            dGioVaoTuDongQuaDemKiemTraLichTrinhVaoRa = new DateTime();
            dtTheoIDMay = new System.Data.DataTable();
            this.DGVDuLieuChamCongNguon.Rows[addGioNguonTuDongQuaDemQuaDem].Cells[0].Value = this.sMaChamCong;
            this.DGVDuLieuChamCongNguon.Rows[addGioNguonTuDongQuaDemQuaDem].Cells[1].Value = string.Format("{0:d}", dGioVaoTuDongQuaDemKiemTraLichTrinhVaoRa);
            this.DGVDuLieuChamCongNguon.Rows[addGioNguonTuDongQuaDemQuaDem].Cells[2].Value = dGioVaoTuDongQuaDemKiemTraLichTrinhVaoRa;
            this.DGVDuLieuChamCongNguon.Rows[addGioNguonTuDongQuaDemQuaDem].Cells[3].Value = "Lặp lại";
            this.DGVDuLieuChamCongNguon.Rows[addGioNguonTuDongQuaDemQuaDem].Cells[4].Value = "*";
            this.DGVDuLieuChamCongNguon.Rows[addGioNguonTuDongQuaDemQuaDem].Cells[6].Value = dtTheoIDMay.Rows[iTheoIDMay]["MaSoMay"].ToString();
            for (iLapLaiTuDongQuaDem = 0; iLapLaiTuDongQuaDem < 7; iLapLaiTuDongQuaDem++)
            {
                this.DGVDuLieuChamCongNguon.Rows[addGioNguonTuDongQuaDemQuaDem].Cells[iLapLaiTuDongQuaDem].Style.BackColor = Color.Red;
            }
            iKiemTraLanChamLichTrinhVaoRa = 0;
        //   goto Label27;
        Label29:
            dGioRaTuDongQuaDemKiemTraLichTrinhVaoRa = new DateTime();
            this.DGVDuLieuChamCongNguon.Rows[addGioNguonTuDongQuaDemQuaDem].Cells[0].Value = this.sMaChamCong;
            this.DGVDuLieuChamCongNguon.Rows[addGioNguonTuDongQuaDemQuaDem].Cells[1].Value = string.Format("{0:d}", dGioRaTuDongQuaDemKiemTraLichTrinhVaoRa);
            this.DGVDuLieuChamCongNguon.Rows[addGioNguonTuDongQuaDemQuaDem].Cells[2].Value = dGioRaTuDongQuaDemKiemTraLichTrinhVaoRa;
            this.DGVDuLieuChamCongNguon.Rows[addGioNguonTuDongQuaDemQuaDem].Cells[3].Value = "Lặp lại";
            this.DGVDuLieuChamCongNguon.Rows[addGioNguonTuDongQuaDemQuaDem].Cells[4].Value = "***";
            this.DGVDuLieuChamCongNguon.Rows[addGioNguonTuDongQuaDemQuaDem].Cells[6].Value = dtTheoIDMay.Rows[iTheoIDMay]["MaSoMay"].ToString();
            for (iLapLaiTuDongQuaDem = 0; iLapLaiTuDongQuaDem < 7; iLapLaiTuDongQuaDem++)
            {
                this.DGVDuLieuChamCongNguon.Rows[addGioNguonTuDongQuaDemQuaDem].Cells[iLapLaiTuDongQuaDem].Style.BackColor = Color.Red;
            }
            iKiemTraLanChamLichTrinhVaoRa = 1;
        // goto Label27;
        Label30:
            dateGioChamTheoIDMay = new DateTime();
               dGioRaTheoIDMay = Convert.ToDateTime(dateGioChamTheoIDMay.ToString());
            this.DGVTinhCong.Rows[addTheoIDMay].Cells[6].Value = string.Format(this.sDinhDangThoiGian, dGioRaTheoIDMay);
            iKiemTraB = 0;
            dtNhanCaTheoIDMay = new System.Data.DataTable();
            this._chiTietLichTrinhChoCalamViecDTO.MaLichTrinhCaLamViec = sLTCCLVNhanVien;
            this._chiTietLichTrinhChoCalamViecDTO.Thu = sThu;
            dtNhanCaTheoIDMay = this._chiTietLichTrinhChoCaLamViecBLL.ChiTietLichTrinhChoCaLamViecNhanCa(this._chiTietLichTrinhChoCalamViecDTO);
            iChiTietLichTrinhChoCaLamViecTheoIDMay = 0;
            if (iChiTietLichTrinhChoCaLamViecTheoIDMay < dtNhanCaTheoIDMay.Rows.Count)
            {
                cellChiTietLichTrinhChoCaLamViecTheoIDMay = 3;
                while (cellChiTietLichTrinhChoCaLamViecTheoIDMay < 13)
                {
                    kiemTraVao = 0;
                    kiemTraRa = 0;
                    this.sTheoIDMayMaCaLamViec = dtNhanCaTheoIDMay.Rows[iChiTietLichTrinhChoCaLamViecTheoIDMay][cellChiTietLichTrinhChoCaLamViecTheoIDMay].ToString();
                    dtTheoIDMayCa1 = new System.Data.DataTable();
                    this._caLamViecDTO.MaCaLamViec = this.sTheoIDMayMaCaLamViec;
                    dtTheoIDMayCa1 = this._caLamViecBLL.CaLamViecGetByMaCaLamViec(this._caLamViecDTO);
                    iTheoIDMayCa1 = 0;
                    while (iTheoIDMayCa1 < dtTheoIDMayCa1.Rows.Count)
                    {
                        this.sTheoIDMayTenCaLamViec = dtTheoIDMayCa1.Rows[iTheoIDMayCa1]["CaLamViec"].ToString();
                        dBatDauVaoTheoIDMayA = Convert.ToDateTime(dtTheoIDMayCa1.Rows[iTheoIDMayCa1]["BatDauVao"].ToString());
                        sBatDauVaoTheoIDMayA = string.Format("{0:T}", dBatDauVaoTheoIDMayA);
                        sBatDauVaoTheoIDMayB = string.Concat(sNgayCham, " ", sBatDauVaoTheoIDMayA);
                        dBatDauVaoTheoIDMayB = Convert.ToDateTime(sBatDauVaoTheoIDMayB);
                        dKetThucVaoTheoIDMayA = Convert.ToDateTime(dtTheoIDMayCa1.Rows[iTheoIDMayCa1]["KetThucVao"].ToString());
                        sKetThucVaoTheoIDMayA = string.Format("{0:T}", dKetThucVaoTheoIDMayA);
                        sKetThucVaoTheoIDMayB = string.Concat(sNgayCham, " ", sKetThucVaoTheoIDMayA);
                        dKetThucVaoTheoIDMayB = Convert.ToDateTime(sKetThucVaoTheoIDMayB);
                        dBatDauRaTheoIDMayA = Convert.ToDateTime(dtTheoIDMayCa1.Rows[iTheoIDMayCa1]["BatDauRa"].ToString());
                        sBatDauRaTheoIDMayA = string.Format("{0:T}", dBatDauRaTheoIDMayA);
                        sBatDauRaTheoIDMayB = string.Concat(sNgayCham, " ", sBatDauRaTheoIDMayA);
                        dBatDauRaTheoIDMayB = Convert.ToDateTime(sBatDauRaTheoIDMayB);
                        if (!(sBatDauRaTheoIDMayB == "12:01:00 AM"))
                        {
                            dBatDauRaTheoIDMayB = Convert.ToDateTime(dBatDauRaTheoIDMayB);
                        }
                        else
                        {
                            dateTime = dBatDauRaTheoIDMayB.AddDays(1);
                            dBatDauRaTheoIDMayB = Convert.ToDateTime(dateTime.ToString());
                        }
                        dKetThucRaTheoIDMayA = Convert.ToDateTime(dtTheoIDMayCa1.Rows[iTheoIDMayCa1]["KetThucRa"].ToString());
                        sKetThucRaTheoIDMayA = string.Format("{0:T}", dKetThucRaTheoIDMayA);
                        sKetThucRaTheoIDMayB = string.Concat(sNgayCham, " ", sKetThucRaTheoIDMayA);
                        dKetThucRaTheoIDMayB = Convert.ToDateTime(sKetThucRaTheoIDMayB);
                        if (!(sKetThucRaTheoIDMayA == "12:01:00 AM"))
                        {
                            dKetThucRaTheoIDMayB = Convert.ToDateTime(dKetThucRaTheoIDMayB);
                        }
                        else
                        {
                            dateTime = dKetThucRaTheoIDMayB.AddDays(1);
                            dKetThucRaTheoIDMayB = Convert.ToDateTime(dateTime.ToString());
                        }
                        dGioVaoTheoIDMay = new DateTime();
                        if ((dGioVaoTheoIDMay < dBatDauVaoTheoIDMayB ? false : dGioVaoTheoIDMay <= dKetThucVaoTheoIDMayB))
                        {
                            kiemTraVao++;
                        }
                        if ((dGioRaTheoIDMay < dBatDauRaTheoIDMayB ? false : dGioRaTheoIDMay <= dKetThucRaTheoIDMayB))
                        {
                            kiemTraRa++;
                        }
                        if ((kiemTraVao != 1 ? true : kiemTraRa != 1))
                        {
                            iTheoIDMayCa1++;
                        }
                        else
                        {
                            goto Label70;
                        }
                    }
                    if (!(this.sTheoIDMayMaCaLamViec == ""))
                    {
                        cellChiTietLichTrinhChoCaLamViecTheoIDMay++;
                    }
                    else
                    {
                        this.DGVTinhCong.Rows[addTheoIDMay].Cells[4].Value = "***";
                        this.DGVTinhCong.Rows[addTheoIDMay].Cells[7].Value = "0";
                        this.DGVTinhCong.Rows[addTheoIDMay].Cells[8].Value = "0";
                        this.DGVTinhCong.Rows[addTheoIDMay].Cells[9].Value = "0";
                        this.DGVTinhCong.Rows[addTheoIDMay].Cells[10].Value = "0";
                        this.DGVTinhCong.Rows[addTheoIDMay].Cells[11].Value = "0";
                        this.DGVTinhCong.Rows[addTheoIDMay].Cells[12].Value = "0";
                        this.DGVTinhCong.Rows[addTheoIDMay].Cells[13].Value = "0";
                        this.DGVTinhCong.Rows[addTheoIDMay].Cells[14].Value = "0";
                        this.DGVTinhCong.Rows[addTheoIDMay].Cells[15].Value = "0";
                        this.DGVTinhCong.Rows[addTheoIDMay].Cells[16].Value = "0";
                        this.DGVTinhCong.Rows[addTheoIDMay].Cells[17].Value = "0";
                        this.DGVTinhCong.Rows[addTheoIDMay].Cells[18].Value = this.sKHVang;
                        //     goto Label27;
                        break;
                    }
                }
            Label70:
                this.DGVTinhCong.Rows[addTheoIDMay].Cells[4].Value = this.sTheoIDMayTenCaLamViec;
                dtCaLamViecTheoIDMay = new System.Data.DataTable();
                this._caLamViecDTO.MaCaLamViec = this.sTheoIDMayMaCaLamViec;
                dtCaLamViecTheoIDMay = this._caLamViecBLL.CaLamViecGetByMaCaLamViec(this._caLamViecDTO);
                dGioVaoTheoIDMay = new DateTime(); 
                for (iCaLamViecTheoIDMay = 0; iCaLamViecTheoIDMay < dtCaLamViecTheoIDMay.Rows.Count; iCaLamViecTheoIDMay++)
                {  
                    second = dGioVaoTheoIDMay.Second;
                    sGiayGioVao = second.ToString();
                    second = dGioRaTheoIDMay.Second;
                    sGiayGioRa = second.ToString();
                    dGioVaoKhaiBaoTheoIDMayA = Convert.ToDateTime(dtCaLamViecTheoIDMay.Rows[iCaLamViecTheoIDMay]["GioVaoLamViec"].ToString());
                    sGioVaoKhaiBaoTheoIDMayA = string.Format("{0:T}", dGioVaoKhaiBaoTheoIDMayA).Replace("00 ", string.Concat(sGiayGioVao, " "));
                    sGioVaoKhaiBaoTheoIDMayB = string.Concat(sNgayCham, " ", sGioVaoKhaiBaoTheoIDMayA);
                    dGioVaoKhaiBaoTheoIDMayB = Convert.ToDateTime(sGioVaoKhaiBaoTheoIDMayB);
                    dGioRaKhaiBaoTheoIDMayA = Convert.ToDateTime(dtCaLamViecTheoIDMay.Rows[iCaLamViecTheoIDMay]["GioKetThucLamViec"].ToString());
                    sGioRaKhaiBaoTheoIDMayA = string.Format("{0:T}", dGioRaKhaiBaoTheoIDMayA).Replace("00 ", string.Concat(sGiayGioRa, " "));
                    sGioRaKhaiBaoTheoIDMayB = string.Concat(sNgayCham, " ", sGioRaKhaiBaoTheoIDMayA);
                    dGioRaKhaiBaoTheoIDMayB = Convert.ToDateTime(sGioRaKhaiBaoTheoIDMayB);
                    sTruGioDiTre = dtCaLamViecTheoIDMay.Rows[iCaLamViecTheoIDMay]["TruGioDiTre"].ToString();
                    sBatDauTinhDiTre = dtCaLamViecTheoIDMay.Rows[iCaLamViecTheoIDMay]["BatDauTinhDiTre"].ToString();
                    iChoPhepDiTre = Convert.ToInt32(dtCaLamViecTheoIDMay.Rows[iCaLamViecTheoIDMay]["ChoPhepDiTre"].ToString());
                    value = dGioVaoTheoIDMay - dGioVaoKhaiBaoTheoIDMayB;
                    second = Convert.ToInt32(value.TotalMinutes);
                    sPhutTre = second.ToString();
                    if (!(sTruGioDiTre == "True"))
                    {
                        this.DGVTinhCong.Rows[addTheoIDMay].Cells[9].Value = "0";
                    }
                    else if (Convert.ToInt32(sPhutTre) >= 0)
                    {
                        iPhutTre = Convert.ToInt32(sPhutTre) - iChoPhepDiTre;
                        if (sBatDauTinhDiTre == "True")
                        {
                            if (iPhutTre >= 1)
                            {
                                this.DGVTinhCong.Rows[addTheoIDMay].Cells[9].Value = iPhutTre.ToString();
                            }
                            else
                            {
                                this.DGVTinhCong.Rows[addTheoIDMay].Cells[9].Value = "0";
                            }
                        }
                        else if (iPhutTre >= 1)
                        {
                            this.DGVTinhCong.Rows[addTheoIDMay].Cells[9].Value = sPhutTre;
                        }
                        else
                        {
                            this.DGVTinhCong.Rows[addTheoIDMay].Cells[9].Value = "0";
                        }
                    }
                    else
                    {
                        this.DGVTinhCong.Rows[addTheoIDMay].Cells[9].Value = "0";
                    }
                    sTruGioVeSom = dtCaLamViecTheoIDMay.Rows[iCaLamViecTheoIDMay]["TruGioVeSom"].ToString();
                    sBatDauTinhVeSom = dtCaLamViecTheoIDMay.Rows[iCaLamViecTheoIDMay]["BatDauTinhVeSom"].ToString();
                    iChoPhepVeSom = Convert.ToInt32(dtCaLamViecTheoIDMay.Rows[iCaLamViecTheoIDMay]["ChoPhepVeSom"].ToString());
                    value = dGioRaKhaiBaoTheoIDMayB - dGioRaTheoIDMay;
                    second = Convert.ToInt32(value.TotalMinutes);
                    sPhutVeSom = second.ToString();
                    if (!(sTruGioVeSom == "True"))
                    {
                        this.DGVTinhCong.Rows[addTheoIDMay].Cells[10].Value = "0";
                    }
                    else if (Convert.ToInt32(sPhutVeSom) >= 0)
                    {
                        iPhutVeSom = Convert.ToInt32(sPhutVeSom) - iChoPhepVeSom;
                        if (iPhutVeSom < 1)
                        {
                            this.DGVTinhCong.Rows[addTheoIDMay].Cells[10].Value = "0";
                        }
                        else if (!(sBatDauTinhVeSom == "True"))
                        {
                            this.DGVTinhCong.Rows[addTheoIDMay].Cells[10].Value = sPhutVeSom;
                        }
                        else
                        {
                            this.DGVTinhCong.Rows[addTheoIDMay].Cells[10].Value = iPhutVeSom.ToString();
                        }
                    }
                    else
                    {
                        this.DGVTinhCong.Rows[addTheoIDMay].Cells[10].Value = "0";
                    }
                    value = dGioRaTheoIDMay - dGioRaKhaiBaoTheoIDMayB;
                    second = Convert.ToInt32(value.TotalMinutes);
                    sVeTre = second.ToString();
                    if (Convert.ToInt32(sVeTre) <= 0)
                    {
                        this.DGVTinhCong.Rows[addTheoIDMay].Cells[11].Value = "0";
                    }
                    else
                    {
                        this.DGVTinhCong.Rows[addTheoIDMay].Cells[11].Value = sVeTre;
                    }
                    iPhut = Convert.ToSingle(dtCaLamViecTheoIDMay.Rows[iCaLamViecTheoIDMay]["TongGioTrongCaLamViec"]) * 60f - (float)(Convert.ToInt32(this.DGVTinhCong.Rows[addTheoIDMay].Cells[9].Value.ToString()) + Convert.ToInt32(this.DGVTinhCong.Rows[addTheoIDMay].Cells[10].Value));
                    dGio = Math.Round(Convert.ToDouble(iPhut) / 60, this.iLamTronGio);
                    this.DGVTinhCong.Rows[addTheoIDMay].Cells[8].Value = dGio.ToString();
                    iGio = Convert.ToDouble(dtCaLamViecTheoIDMay.Rows[iCaLamViecTheoIDMay]["TongGioTrongCaLamViec"].ToString());
                    dCongTinh = Convert.ToDouble(dtCaLamViecTheoIDMay.Rows[iCaLamViecTheoIDMay]["CongTinh"].ToString());
                    dCong = Math.Round(dGio * dCongTinh / iGio, this.iLamTronCong);
                    this.DGVTinhCong.Rows[addTheoIDMay].Cells[7].Value = dCong.ToString();
                    sTangCaTruocGioLamViec = dtCaLamViecTheoIDMay.Rows[iCaLamViecTheoIDMay]["TangCaTruocGioLamViec"].ToString();
                    sTangCaSauGioLamViec = dtCaLamViecTheoIDMay.Rows[iCaLamViecTheoIDMay]["TangCaSauGioLamViec"].ToString();
                    if ((sTangCaTruocGioLamViec != "False" ? false : sTangCaSauGioLamViec == "False"))
                    {
                        this.DGVTinhCong.Rows[addTheoIDMay].Cells[12].Value = "0";
                        this.DGVTinhCong.Rows[addTheoIDMay].Cells[13].Value = "0";
                        this.DGVTinhCong.Rows[addTheoIDMay].Cells[14].Value = "0";
                        this.DGVTinhCong.Rows[addTheoIDMay].Cells[15].Value = "0";
                    }
                    sXemCaNayLaTangCa = dtCaLamViecTheoIDMay.Rows[iCaLamViecTheoIDMay]["XemCaNayLaTangCa"].ToString();
                    iTangCaMuc = Convert.ToInt32(dtCaLamViecTheoIDMay.Rows[iCaLamViecTheoIDMay]["TangCaMuc"].ToString());
                    if (sXemCaNayLaTangCa == "True")
                    {
                        if (iTangCaMuc == 1)
                        {
                            this.DGVTinhCong.Rows[addTheoIDMay].Cells[7].Value = "0";
                            this.DGVTinhCong.Rows[addTheoIDMay].Cells[8].Value = "0";
                            this.DGVTinhCong.Rows[addTheoIDMay].Cells[12].Value = dGio.ToString();
                            this.DGVTinhCong.Rows[addTheoIDMay].Cells[13].Value = "0";
                            this.DGVTinhCong.Rows[addTheoIDMay].Cells[14].Value = "0";
                            this.DGVTinhCong.Rows[addTheoIDMay].Cells[15].Value = "0";
                        }
                        if (iTangCaMuc == 2)
                        {
                            this.DGVTinhCong.Rows[addTheoIDMay].Cells[7].Value = "0";
                            this.DGVTinhCong.Rows[addTheoIDMay].Cells[8].Value = "0";
                            this.DGVTinhCong.Rows[addTheoIDMay].Cells[12].Value = "0";
                            this.DGVTinhCong.Rows[addTheoIDMay].Cells[13].Value = dGio.ToString();
                            this.DGVTinhCong.Rows[addTheoIDMay].Cells[14].Value = "0";
                            this.DGVTinhCong.Rows[addTheoIDMay].Cells[15].Value = "0";
                        }
                        if (iTangCaMuc == 3)
                        {
                            this.DGVTinhCong.Rows[addTheoIDMay].Cells[7].Value = "0";
                            this.DGVTinhCong.Rows[addTheoIDMay].Cells[8].Value = "0";
                            this.DGVTinhCong.Rows[addTheoIDMay].Cells[12].Value = "0";
                            this.DGVTinhCong.Rows[addTheoIDMay].Cells[13].Value = "0";
                            this.DGVTinhCong.Rows[addTheoIDMay].Cells[14].Value = dGio.ToString();
                            this.DGVTinhCong.Rows[addTheoIDMay].Cells[15].Value = "0";
                        }
                        if (iTangCaMuc == 4)
                        {
                            this.DGVTinhCong.Rows[addTheoIDMay].Cells[7].Value = "0";
                            this.DGVTinhCong.Rows[addTheoIDMay].Cells[8].Value = "0";
                            this.DGVTinhCong.Rows[addTheoIDMay].Cells[12].Value = "0";
                            this.DGVTinhCong.Rows[addTheoIDMay].Cells[13].Value = "0";
                            this.DGVTinhCong.Rows[addTheoIDMay].Cells[14].Value = "0";
                            this.DGVTinhCong.Rows[addTheoIDMay].Cells[15].Value = dGio.ToString();
                        }
                    }
                    sChoPhepTangCaTruocGioLamViecTheoIDMay = dtCaLamViecTheoIDMay.Rows[iCaLamViecTheoIDMay]["TangCaTruocGioLamViec"].ToString();
                    iPhutTangCaTruocGioLamViecTheoIDMay = Convert.ToInt32(dtCaLamViecTheoIDMay.Rows[iCaLamViecTheoIDMay]["SoPhutTangCaTruocGioLamViec"].ToString());
                    iPhutTangCaTruocGioLamViecDatDen = Convert.ToInt32(dtCaLamViecTheoIDMay.Rows[iCaLamViecTheoIDMay]["TangCaTruocGioLamViecDatDen"].ToString());
                    iPhutTruTangCaTruoc = Convert.ToInt32(dtCaLamViecTheoIDMay.Rows[iCaLamViecTheoIDMay]["PhutTruTangCaTruoc"].ToString());
                    sChoPhepTangCaSauGioLamViecTheoIDMay = dtCaLamViecTheoIDMay.Rows[iCaLamViecTheoIDMay]["TangCaSauGioLamViec"].ToString();
                    iPhutTangCaSauGioLamViecTheoIDMay = Convert.ToInt32(dtCaLamViecTheoIDMay.Rows[iCaLamViecTheoIDMay]["SoPhutTangCaSauGioLamViec"].ToString());
                    iPhutTangCaSauGioLamViecDatDen = Convert.ToInt32(dtCaLamViecTheoIDMay.Rows[iCaLamViecTheoIDMay]["TangCaSauGioLamViecDatDen"].ToString());
                    iPhutTruTangCaSau = Convert.ToInt32(dtCaLamViecTheoIDMay.Rows[iCaLamViecTheoIDMay]["PhutTruTangCaSau"].ToString());
                    iGioiHanTC1TheoIDMay = Convert.ToInt32(dtCaLamViecTheoIDMay.Rows[iCaLamViecTheoIDMay]["GioiHanTangCa1"].ToString());
                    iGioiHanTC2TheoIDMay = Convert.ToInt32(dtCaLamViecTheoIDMay.Rows[iCaLamViecTheoIDMay]["GioiHanTangCa2"].ToString());
                    iGioiHanTC3TheoIDMay = Convert.ToInt32(dtCaLamViecTheoIDMay.Rows[iCaLamViecTheoIDMay]["GioiHanTangCa3"].ToString());
                    iGioiHanTC4TheoIDMay = Convert.ToInt32(dtCaLamViecTheoIDMay.Rows[iCaLamViecTheoIDMay]["GioiHanTangCa4"].ToString());
                    iTongGioTangCaSauTheoIDMay = 0;
                    iTongGioTangCaTruocTheoIDMay = 0;
                    if ((sChoPhepTangCaTruocGioLamViecTheoIDMay != "False" ? true : !(sChoPhepTangCaSauGioLamViecTheoIDMay == "False")))
                    {
                        if (sChoPhepTangCaTruocGioLamViecTheoIDMay == "True")
                        {
                            value = dGioVaoKhaiBaoTheoIDMayB - dGioVaoTheoIDMay;
                            second = Convert.ToInt32(value.TotalMinutes);
                            iThoiGianTruocGioLamTheoIDMay = Convert.ToInt32(second.ToString());
                            if (iThoiGianTruocGioLamTheoIDMay > 0)
                            {
                                if (iThoiGianTruocGioLamTheoIDMay > iPhutTangCaTruocGioLamViecTheoIDMay)
                                {
                                    if (iThoiGianTruocGioLamTheoIDMay > iPhutTangCaTruocGioLamViecDatDen)
                                    {
                                        iTongGioTangCaTruocTheoIDMay = iThoiGianTruocGioLamTheoIDMay - iPhutTruTangCaTruoc;
                                    }
                                }
                            }
                        }
                        if (sChoPhepTangCaSauGioLamViecTheoIDMay == "True")
                        {
                            value = dGioRaTheoIDMay - dGioRaKhaiBaoTheoIDMayB;
                            second = Convert.ToInt32(value.TotalMinutes);
                            iThoiGianSauGioLamViecTheoIDMay = Convert.ToInt32(second.ToString());
                            if (iThoiGianSauGioLamViecTheoIDMay > 0)
                            {
                                if (iThoiGianSauGioLamViecTheoIDMay > iPhutTangCaSauGioLamViecTheoIDMay)
                                {
                                    if (iThoiGianSauGioLamViecTheoIDMay > iPhutTangCaSauGioLamViecDatDen)
                                    {
                                        iTongGioTangCaSauTheoIDMay = iThoiGianSauGioLamViecTheoIDMay - iPhutTruTangCaSau;
                                    }
                                }
                            }
                        }
                    }
                    else
                    {
                        this.DGVTinhCong.Rows[addTheoIDMay].Cells[12].Value = "0";
                        this.DGVTinhCong.Rows[addTheoIDMay].Cells[13].Value = "0";
                        this.DGVTinhCong.Rows[addTheoIDMay].Cells[14].Value = "0";
                        this.DGVTinhCong.Rows[addTheoIDMay].Cells[15].Value = "0";
                    }
                    dTongThoiGianTangCaTheoIDMay = Convert.ToDouble(iTongGioTangCaTruocTheoIDMay + iTongGioTangCaSauTheoIDMay);
                    if (dTongThoiGianTangCaTheoIDMay <= 0)
                    {
                        this.DGVTinhCong.Rows[addTheoIDMay].Cells[12].Value = "0";
                        this.DGVTinhCong.Rows[addTheoIDMay].Cells[13].Value = "0";
                        this.DGVTinhCong.Rows[addTheoIDMay].Cells[14].Value = "0";
                        this.DGVTinhCong.Rows[addTheoIDMay].Cells[15].Value = "0";
                    }
                    else
                    {
                        if (iGioiHanTC1TheoIDMay == 0)
                        {
                            this.DGVTinhCong.Rows[addTheoIDMay].Cells[12].Value = Math.Round(dTongThoiGianTangCaTheoIDMay * this.dTangCa1HeSo / 60, this.iLamTronGio);
                            this.DGVTinhCong.Rows[addTheoIDMay].Cells[13].Value = "0";
                            this.DGVTinhCong.Rows[addTheoIDMay].Cells[14].Value = "0";
                            this.DGVTinhCong.Rows[addTheoIDMay].Cells[15].Value = "0";
                        }
                        if ((iGioiHanTC1TheoIDMay == 0 ? false : iGioiHanTC2TheoIDMay == 0))
                        {
                            if (dTongThoiGianTangCaTheoIDMay >= Convert.ToDouble(iGioiHanTC1TheoIDMay))
                            {
                                this.DGVTinhCong.Rows[addTheoIDMay].Cells[12].Value = Math.Round(Convert.ToDouble(iGioiHanTC1TheoIDMay) / 60 * this.dTangCa1HeSo, this.iLamTronGio);
                                if (dTongThoiGianTangCaTheoIDMay - Convert.ToDouble(iGioiHanTC1TheoIDMay) > 0)
                                {
                                    this.DGVTinhCong.Rows[addTheoIDMay].Cells[13].Value = Math.Round((dTongThoiGianTangCaTheoIDMay - Convert.ToDouble(iGioiHanTC1TheoIDMay)) * this.dTangCa2HeSo / 60, this.iLamTronGio);
                                }
                                this.DGVTinhCong.Rows[addTheoIDMay].Cells[14].Value = "0";
                                this.DGVTinhCong.Rows[addTheoIDMay].Cells[15].Value = "0";
                            }
                            else
                            {
                                this.DGVTinhCong.Rows[addTheoIDMay].Cells[12].Value = Math.Round(dTongThoiGianTangCaTheoIDMay * this.dTangCa1HeSo / 60, this.iLamTronGio);
                                this.DGVTinhCong.Rows[addTheoIDMay].Cells[13].Value = "0";
                                this.DGVTinhCong.Rows[addTheoIDMay].Cells[14].Value = "0";
                                this.DGVTinhCong.Rows[addTheoIDMay].Cells[15].Value = "0";
                            }
                        }
                        if ((iGioiHanTC1TheoIDMay == 0 || iGioiHanTC2TheoIDMay == 0 ? false : iGioiHanTC3TheoIDMay == 0))
                        {
                            if (dTongThoiGianTangCaTheoIDMay >= Convert.ToDouble(iGioiHanTC1TheoIDMay))
                            {
                                this.DGVTinhCong.Rows[addTheoIDMay].Cells[12].Value = Math.Round(Convert.ToDouble(iGioiHanTC1TheoIDMay) * this.dTangCa1HeSo / 60, this.iLamTronGio);
                                if (dTongThoiGianTangCaTheoIDMay - Convert.ToDouble(iGioiHanTC1TheoIDMay) >= Convert.ToDouble(iGioiHanTC2TheoIDMay))
                                {
                                    this.DGVTinhCong.Rows[addTheoIDMay].Cells[12].Value = Math.Round(Convert.ToDouble(iGioiHanTC1TheoIDMay) * this.dTangCa1HeSo / 60, this.iLamTronGio);
                                    this.DGVTinhCong.Rows[addTheoIDMay].Cells[13].Value = Math.Round(Convert.ToDouble(iGioiHanTC2TheoIDMay) * this.dTangCa2HeSo / 60, this.iLamTronGio);
                                    this.DGVTinhCong.Rows[addTheoIDMay].Cells[14].Value = Math.Round((dTongThoiGianTangCaTheoIDMay - Convert.ToDouble(iGioiHanTC1TheoIDMay) - Convert.ToDouble(iGioiHanTC2TheoIDMay)) * this.dTangCa3HeSo / 60, this.iLamTronGio);
                                    this.DGVTinhCong.Rows[addTheoIDMay].Cells[15].Value = "0";
                                }
                                else
                                {
                                    this.DGVTinhCong.Rows[addTheoIDMay].Cells[13].Value = Math.Round((dTongThoiGianTangCaTheoIDMay - Convert.ToDouble(iGioiHanTC1TheoIDMay)) * this.dTangCa2HeSo / 60, this.iLamTronGio);
                                    this.DGVTinhCong.Rows[addTheoIDMay].Cells[14].Value = "0";
                                    this.DGVTinhCong.Rows[addTheoIDMay].Cells[15].Value = "0";
                                }
                            }
                            else
                            {
                                this.DGVTinhCong.Rows[addTheoIDMay].Cells[12].Value = Math.Round(dTongThoiGianTangCaTheoIDMay * this.dTangCa1HeSo / 60, this.iLamTronGio);
                                this.DGVTinhCong.Rows[addTheoIDMay].Cells[13].Value = "0";
                                this.DGVTinhCong.Rows[addTheoIDMay].Cells[14].Value = "0";
                                this.DGVTinhCong.Rows[addTheoIDMay].Cells[15].Value = "0";
                            }
                        }
                        if ((iGioiHanTC1TheoIDMay == 0 || iGioiHanTC2TheoIDMay == 0 || iGioiHanTC3TheoIDMay == 0 ? false : iGioiHanTC4TheoIDMay == 0))
                        {
                        }
                    }
                    value = dGioRaTheoIDMay - dGioVaoTheoIDMay;
                    second = Convert.ToInt32(value.TotalMinutes);
                    num = Math.Round(Convert.ToDouble(second.ToString()) / 60, this.iLamTronGio);
                    sTongGio = num.ToString();
                    this.DGVTinhCong.Rows[addTheoIDMay].Cells[16].Value = sTongGio;
                    this.DGVTinhCong.Rows[addTheoIDMay].Cells[17].Value = dtCaLamViecTheoIDMay.Rows[iCaLamViecTheoIDMay]["CongTinh"].ToString();
                    this.DGVTinhCong.Rows[addTheoIDMay].Cells[18].Value = this.sKHDungGio;
                    if (!(DateTimeProgress.XuatIDThu((int)dt.AddDays((double)dem).DayOfWeek) == "0"))
                    {
                        this.DGVTinhCong.Rows[addTheoIDMay].Cells[19].Value = "NT";
                    }
                    else
                    {
                        this.DGVTinhCong.Rows[addTheoIDMay].Cells[19].Value = "CN";
                    }
                    this.DGVTinhCong.Rows[addTheoIDMay].Cells[20].Value = this.sMaChamCong;
                    this.DGVTinhCong.Rows[addTheoIDMay].Cells[21].Value = this.sPhongBanTinhCong;
                }
            }
         
        // goto Label27;
        Label42:
            dGioVaoTinhTheoGioLichTrinhVaoRa = new DateTime();
           this.DGVDuLieuChamCongNguon.Rows[addGioNguonTinhTheoGio].Cells[0].Value = this.sMaChamCong;
            this.DGVDuLieuChamCongNguon.Rows[addGioNguonTinhTheoGio].Cells[1].Value = string.Format("{0:d}", dGioVaoTinhTheoGioLichTrinhVaoRa);
            this.DGVDuLieuChamCongNguon.Rows[addGioNguonTinhTheoGio].Cells[2].Value = dGioVaoTinhTheoGioLichTrinhVaoRa;
            this.DGVDuLieuChamCongNguon.Rows[addGioNguonTinhTheoGio].Cells[3].Value = "Lặp lại";
            this.DGVDuLieuChamCongNguon.Rows[addGioNguonTinhTheoGio].Cells[4].Value = "U";
            dtTinhTheoGio = new System.Data.DataTable();
            this.DGVDuLieuChamCongNguon.Rows[addGioNguonTinhTheoGio].Cells[6].Value = dtTinhTheoGio.Rows[iTinhTheoGio]["MaSoMay"].ToString();
            for (iLapLaiTinhTheoGio = 0; iLapLaiTinhTheoGio < 7; iLapLaiTinhTheoGio++)
            {
                this.DGVDuLieuChamCongNguon.Rows[addGioNguonTinhTheoGio].Cells[iLapLaiTinhTheoGio].Style.BackColor = Color.Red;
            }
            iKiemTraLanChamTinhTheoGioLichTrinhVaoRa = 0;
        // goto Label41;
        Label43:
            dGioRaTinhTheoGioLichTrinhVaoRa = new DateTime();
            this.DGVDuLieuChamCongNguon.Rows[addGioNguonTinhTheoGio].Cells[0].Value = this.sMaChamCong;
            this.DGVDuLieuChamCongNguon.Rows[addGioNguonTinhTheoGio].Cells[1].Value = string.Format("{0:d}", dGioRaTinhTheoGioLichTrinhVaoRa);
            this.DGVDuLieuChamCongNguon.Rows[addGioNguonTinhTheoGio].Cells[2].Value = dGioRaTinhTheoGioLichTrinhVaoRa;
            this.DGVDuLieuChamCongNguon.Rows[addGioNguonTinhTheoGio].Cells[3].Value = "Lặp lại";
            this.DGVDuLieuChamCongNguon.Rows[addGioNguonTinhTheoGio].Cells[4].Value = "U";
            this.DGVDuLieuChamCongNguon.Rows[addGioNguonTinhTheoGio].Cells[6].Value = dtTinhTheoGio.Rows[iTinhTheoGio]["MaSoMay"].ToString();
            for (iLapLaiTinhTheoGio = 0; iLapLaiTinhTheoGio < 7; iLapLaiTinhTheoGio++)
            {
                this.DGVDuLieuChamCongNguon.Rows[addGioNguonTinhTheoGio].Cells[iLapLaiTinhTheoGio].Style.BackColor = Color.Red;
            }
            iKiemTraLanChamTinhTheoGioLichTrinhVaoRa = 1;
       // goto Label41;
        Label49:
            dtTuDongQuaDem = new System.Data.DataTable();
            dGioVaoTuDongQuaDemKiemTraLichTrinhVaoRa = new DateTime();
            this.DGVDuLieuChamCongNguon.Rows[addGioNguonTuDongQuaDemQuaDem].Cells[0].Value = this.sMaChamCong;
            this.DGVDuLieuChamCongNguon.Rows[addGioNguonTuDongQuaDemQuaDem].Cells[1].Value = string.Format("{0:d}", dGioVaoTuDongQuaDemKiemTraLichTrinhVaoRa);
            this.DGVDuLieuChamCongNguon.Rows[addGioNguonTuDongQuaDemQuaDem].Cells[2].Value = dGioVaoTuDongQuaDemKiemTraLichTrinhVaoRa;
            this.DGVDuLieuChamCongNguon.Rows[addGioNguonTuDongQuaDemQuaDem].Cells[3].Value = "Lặp lại";
            this.DGVDuLieuChamCongNguon.Rows[addGioNguonTuDongQuaDemQuaDem].Cells[4].Value = "*";
         this.DGVDuLieuChamCongNguon.Rows[addGioNguonTuDongQuaDemQuaDem].Cells[6].Value = dtTuDongQuaDem.Rows[iTuDongQuaDem]["MaSoMay"].ToString();
            for (iLapLaiTuDongQuaDem = 0; iLapLaiTuDongQuaDem < 7; iLapLaiTuDongQuaDem++)
            {
                this.DGVDuLieuChamCongNguon.Rows[addGioNguonTuDongQuaDemQuaDem].Cells[iLapLaiTuDongQuaDem].Style.BackColor = Color.Red;
                
            }
            iKiemTraLanChamLichTrinhVaoRa = 0;
       //goto Label48;
        Label50:
            dGioRaTuDongQuaDemKiemTraLichTrinhVaoRa = new DateTime();
            this.DGVDuLieuChamCongNguon.Rows[addGioNguonTuDongQuaDemQuaDem].Cells[0].Value = this.sMaChamCong;
            this.DGVDuLieuChamCongNguon.Rows[addGioNguonTuDongQuaDemQuaDem].Cells[1].Value = string.Format("{0:d}", dGioRaTuDongQuaDemKiemTraLichTrinhVaoRa);
            this.DGVDuLieuChamCongNguon.Rows[addGioNguonTuDongQuaDemQuaDem].Cells[2].Value = dGioRaTuDongQuaDemKiemTraLichTrinhVaoRa;
            this.DGVDuLieuChamCongNguon.Rows[addGioNguonTuDongQuaDemQuaDem].Cells[3].Value = "Lặp lại";
            this.DGVDuLieuChamCongNguon.Rows[addGioNguonTuDongQuaDemQuaDem].Cells[4].Value = "***";
           this.DGVDuLieuChamCongNguon.Rows[addGioNguonTuDongQuaDemQuaDem].Cells[6].Value = dtTuDongQuaDem.Rows[iTuDongQuaDem]["MaSoMay"].ToString();
            for (iLapLaiTuDongQuaDem = 0; iLapLaiTuDongQuaDem < 7; iLapLaiTuDongQuaDem++)
            {
                this.DGVDuLieuChamCongNguon.Rows[addGioNguonTuDongQuaDemQuaDem].Cells[iLapLaiTuDongQuaDem].Style.BackColor = Color.Red;
            }
            iKiemTraLanChamLichTrinhVaoRa = 1;
            // goto Label48;
        }

        private void loadTuyChon()
        {
            System.Data.DataTable dtLoadTuyChon = new System.Data.DataTable();
            this._tuyChonDTO.MaTuyChinh = "TC00001";
            dtLoadTuyChon = this._tuyChonBLL.showLoadTuyChon(this._tuyChonDTO);
            for (int iLoadTuyChon = 0; iLoadTuyChon < dtLoadTuyChon.Rows.Count; iLoadTuyChon++)
            {
                this.iLamTronCong = Convert.ToInt32(dtLoadTuyChon.Rows[iLoadTuyChon]["LamTronCong"].ToString());
                this.iLamTronGio = Convert.ToInt32(dtLoadTuyChon.Rows[iLoadTuyChon]["LamTronGio"].ToString());
                this.sDinhDangThoiGian = dtLoadTuyChon.Rows[iLoadTuyChon]["DinhDangThoiGian"].ToString();
                this.dTangCa1HeSo = Convert.ToDouble(dtLoadTuyChon.Rows[iLoadTuyChon]["TC1HeSo"].ToString());
                this.dTangCa2HeSo = Convert.ToDouble(dtLoadTuyChon.Rows[iLoadTuyChon]["TC2HeSo"].ToString());
                this.dTangCa3HeSo = Convert.ToDouble(dtLoadTuyChon.Rows[iLoadTuyChon]["TC3HeSo"].ToString());
                this.dTangCa4HeSo = Convert.ToDouble(dtLoadTuyChon.Rows[iLoadTuyChon]["TC4HeSo"].ToString());
                this.dTangCaChuNhatHeSo = Convert.ToDouble(dtLoadTuyChon.Rows[iLoadTuyChon]["ChuNhatHeSo"].ToString());
                this.sLuaChonKhaiBaoLuongBaoHiem = dtLoadTuyChon.Rows[iLoadTuyChon]["LuaChonKhaiBaoLuong"].ToString();
                this.dSoTienKhaiBao = Convert.ToDouble(dtLoadTuyChon.Rows[iLoadTuyChon]["SoTienKhaiBao"].ToString());
                this.dHeSoBaoHiemXaHoi = Convert.ToDouble(dtLoadTuyChon.Rows[iLoadTuyChon]["BaoHiemXaHoi"].ToString());
                this.dHeSoBaoHiemYTe = Convert.ToDouble(dtLoadTuyChon.Rows[iLoadTuyChon]["BaoHiemYTe"].ToString());
                this.dHeSoBaoHiemThatNghiep = Convert.ToDouble(dtLoadTuyChon.Rows[iLoadTuyChon]["BaoHiemThatNghiep"].ToString());
            }
        }

        private void button1_Click(object sender, EventArgs e)
        {
            bool _selectAllNhanVien = true;
            _selectAllNhanVien = !_selectAllNhanVien;
            if (!_selectAllNhanVien)
            {
                for (int iNhanVienMoi = 0; iNhanVienMoi < this.DGVDanhSachNhanVien.Rows.Count; iNhanVienMoi++)
                {
                    this.DGVDanhSachNhanVien.Rows[iNhanVienMoi].Cells[0].Value = _selectAllNhanVien;
                }
            }
        }

        private void button2_Click(object sender, EventArgs e)
        {
            bool _selectAllNhanVien = false;
            _selectAllNhanVien = !_selectAllNhanVien;
            if (_selectAllNhanVien)
            {
                for (int iNhanVienMoi = 0; iNhanVienMoi < this.DGVDanhSachNhanVien.Rows.Count; iNhanVienMoi++)
                {
                    this.DGVDanhSachNhanVien.Rows[iNhanVienMoi].Cells[0].Value = _selectAllNhanVien;
                }
            }
        }

        private void ngayTinhCong()
        {
            System.Data.DataTable _dtLoadNgayTinhCong = new System.Data.DataTable();
            _dtLoadNgayTinhCong = this._ngayTinhCongBLL.showThongTinNgayTinhCong(this._ngayTinhCongDTO);
            if (_dtLoadNgayTinhCong.Rows.Count != 0)
            {
                this._ngayTinhCongDTO.ID = 1;
                _dtLoadNgayTinhCong = this._ngayTinhCongBLL.showLoadNgayTinhCong(this._ngayTinhCongDTO);
                for (int i = 0; i < _dtLoadNgayTinhCong.Rows.Count; i++)
                {
                    this.dateTimeTuNgay.Text = _dtLoadNgayTinhCong.Rows[i]["NgayBatDau"].ToString();
                    this.dateTimeDenNgay.Text = _dtLoadNgayTinhCong.Rows[i]["NgayKetThuc"].ToString();
                }
            }
            else
            {
                this.dateTimeTuNgay.Text = DateTime.Now.ToString();
                this.dateTimeDenNgay.Text = DateTime.Now.ToString();
            }
        }

        private void dateTimeDenNgay_ValueChanged(object sender, EventArgs e)
        {
            this.xuatThuDenNgay();
        }

        private void dateTimeTuNgay_ValueChanged(object sender, EventArgs e)
        {
            this.xuatThuTuNgay();
        }

        private void treeViewSoDoQuanLy_AfterSelect(object sender, TreeViewEventArgs e)
        {
            int num;
            this.sMaCongTyTreeView = "";
            this.sMaKhuVucTreeView = "";
            this.sMaPhongBanTreeView = "";
            this.sMaChucVuTreeView = "";
            this.sDanhSachNhanVienMoi = "";
            this.sNghiViecTamThoi = "";
            this.DGVDanhSachNhanVien.Rows.Clear();
            this._tenNode = this.treeViewSoDoQuanLy.SelectedNode.Text;
            System.Data.DataTable dtTreeviewPhongBan = new System.Data.DataTable();
            this._phongBanDTO.TenPhongBan = this._tenNode;
            dtTreeviewPhongBan = this._phongBanBLL.PhongBanGetTreeView(this._phongBanDTO);
            for (int iTreeviewPhongBan = 0; iTreeviewPhongBan < dtTreeviewPhongBan.Rows.Count; iTreeviewPhongBan++)
            {
                this.sMaPhongBanTreeView = dtTreeviewPhongBan.Rows[iTreeviewPhongBan]["MaPhongBan"].ToString();
            }
            System.Data.DataTable dtTreeViewCongTy = new System.Data.DataTable();
            this._congTyDTO.TenCongTy = this._tenNode;
            dtTreeViewCongTy = this._congTyBLL.CongTygetTreeView(this._congTyDTO);
            for (int iTreeviewCongTy = 0; iTreeviewCongTy < dtTreeViewCongTy.Rows.Count; iTreeviewCongTy++)
            {
                this.sMaCongTyTreeView = dtTreeViewCongTy.Rows[iTreeviewCongTy]["MaCongTy"].ToString();
            }
            System.Data.DataTable dtTreeViewKhuVuc = new System.Data.DataTable();
            this._khuVucDTO.TenKhuVuc = this._tenNode;
            dtTreeViewKhuVuc = this._khuVucBLL.KhuVucgetTreeView(this._khuVucDTO);
            for (int iTreeviewKhuVuc = 0; iTreeviewKhuVuc < dtTreeViewKhuVuc.Rows.Count; iTreeviewKhuVuc++)
            {
                this.sMaKhuVucTreeView = dtTreeViewKhuVuc.Rows[iTreeviewKhuVuc]["MaKhuVuc"].ToString();
            }
            System.Data.DataTable dtTreeViewChucVu = new System.Data.DataTable();
            this._chucVuDTO.TenChucVu = this._tenNode;
            dtTreeViewChucVu = this._chucVuBLL.ChucVugetTreeView(this._chucVuDTO);
            for (int iTreeviewChucVu = 0; iTreeviewChucVu < dtTreeViewChucVu.Rows.Count; iTreeviewChucVu++)
            {
                this.sMaChucVuTreeView = dtTreeViewChucVu.Rows[iTreeviewChucVu]["MaChucVu"].ToString();
            }
            System.Data.DataTable dtNhanVien = new System.Data.DataTable();
            this._nhanVienDTO.MaCongTy = this.sMaCongTyTreeView;
            this._nhanVienDTO.MaKhuVuc = this.sMaKhuVucTreeView;
            this._nhanVienDTO.MaPhongBan = this.sMaPhongBanTreeView;
            this._nhanVienDTO.MaChucVu = this.sMaChucVuTreeView;
            dtNhanVien = this._nhanVienBLL.NhanViengetFromTreeview(this._nhanVienDTO);
            for (int iNhanVien = 0; iNhanVien < dtNhanVien.Rows.Count; iNhanVien++)
            {
                int addNhanVien = this.DGVDanhSachNhanVien.Rows.Add();
                this.DGVDanhSachNhanVien.Rows[addNhanVien].Cells[1].Value = dtNhanVien.Rows[iNhanVien]["MaNhanVien"].ToString();
                this.DGVDanhSachNhanVien.Rows[addNhanVien].Cells[2].Value = dtNhanVien.Rows[iNhanVien]["TenNhanVien"].ToString();
                this.DGVDanhSachNhanVien.Rows[addNhanVien].Cells[3].Value = dtNhanVien.Rows[iNhanVien]["MaChamCong"].ToString();
                this.DGVDanhSachNhanVien.Rows[addNhanVien].Cells[4].Value = dtNhanVien.Rows[iNhanVien]["NgayVaoLamViec"].ToString();
                DataGridViewCell item = this.DGVDanhSachNhanVien.Rows[addNhanVien].Cells[5];
                ConvertMoney convertMoney = this._convertMoney;
                num = Convert.ToInt32(dtNhanVien.Rows[iNhanVien]["TienLuong"]);
                item.Value = convertMoney.chendau(num.ToString());
                this.DGVDanhSachNhanVien.Rows[addNhanVien].Cells[6].Value = dtNhanVien.Rows[iNhanVien]["DangThamGiaBaoHiem"].ToString();
                this.DGVDanhSachNhanVien.Rows[addNhanVien].Cells[7].Value = dtNhanVien.Rows[iNhanVien]["MaPhongBan"].ToString();
                DataGridViewCell dataGridViewCell = this.DGVDanhSachNhanVien.Rows[addNhanVien].Cells[8];
                ConvertMoney convertMoney1 = this._convertMoney;
                num = Convert.ToInt32(dtNhanVien.Rows[iNhanVien]["LuongHopDong"]);
                dataGridViewCell.Value = convertMoney1.chendau(num.ToString());
            }
            if (this._tenNode == "Danh sách nhân viên mới")
            {
                System.Data.DataTable dtNhanVienMoi = new System.Data.DataTable();
                this._nhanVienDTO.NhanVienMoi = true;
                dtNhanVienMoi = this._nhanVienBLL.NhanViengetFromTreeviewNhanVienMoi(this._nhanVienDTO);
                for (int iNhanVienMoi = 0; iNhanVienMoi < dtNhanVienMoi.Rows.Count; iNhanVienMoi++)
                {
                    int addNhanVienMoi = this.DGVDanhSachNhanVien.Rows.Add();
                    this.DGVDanhSachNhanVien.Rows[addNhanVienMoi].Cells[1].Value = dtNhanVienMoi.Rows[iNhanVienMoi]["MaNhanVien"].ToString();
                    this.DGVDanhSachNhanVien.Rows[addNhanVienMoi].Cells[2].Value = dtNhanVienMoi.Rows[iNhanVienMoi]["TenNhanVien"].ToString();
                    this.DGVDanhSachNhanVien.Rows[addNhanVienMoi].Cells[3].Value = dtNhanVienMoi.Rows[iNhanVienMoi]["MaChamCong"].ToString();
                    this.DGVDanhSachNhanVien.Rows[addNhanVienMoi].Cells[4].Value = dtNhanVienMoi.Rows[iNhanVienMoi]["NgayVaoLamViec"].ToString();
                    DataGridViewCell item1 = this.DGVDanhSachNhanVien.Rows[addNhanVienMoi].Cells[5];
                    ConvertMoney convertMoney2 = this._convertMoney;
                    num = Convert.ToInt32(dtNhanVienMoi.Rows[iNhanVienMoi]["TienLuong"]);
                    item1.Value = convertMoney2.chendau(num.ToString());
                    this.DGVDanhSachNhanVien.Rows[addNhanVienMoi].Cells[6].Value = dtNhanVienMoi.Rows[iNhanVienMoi]["DangThamGiaBaoHiem"].ToString();
                    this.DGVDanhSachNhanVien.Rows[addNhanVienMoi].Cells[7].Value = dtNhanVienMoi.Rows[iNhanVienMoi]["MaPhongBan"].ToString();
                    DataGridViewCell dataGridViewCell1 = this.DGVDanhSachNhanVien.Rows[addNhanVienMoi].Cells[8];
                    ConvertMoney convertMoney3 = this._convertMoney;
                    num = Convert.ToInt32(dtNhanVienMoi.Rows[iNhanVienMoi]["LuongHopDong"]);
                    dataGridViewCell1.Value = convertMoney3.chendau(num.ToString());
                }
            }
            if (this._tenNode == "Nhân viên nghỉ việc")
            {
                System.Data.DataTable dtNhanVienNghiViec = new System.Data.DataTable();
                this._nhanVienDTO.NghiViecTamThoi = true;
                dtNhanVienNghiViec = this._nhanVienBLL.NhanViengetFromTreeviewNhanVienNghiViec(this._nhanVienDTO);
                for (int iNhanVienNghiViec = 0; iNhanVienNghiViec < dtNhanVienNghiViec.Rows.Count; iNhanVienNghiViec++)
                {
                    int addNhanVienNghiViec = this.DGVDanhSachNhanVien.Rows.Add();
                    this.DGVDanhSachNhanVien.Rows[addNhanVienNghiViec].Cells[1].Value = dtNhanVienNghiViec.Rows[iNhanVienNghiViec]["MaNhanVien"].ToString();
                    this.DGVDanhSachNhanVien.Rows[addNhanVienNghiViec].Cells[2].Value = dtNhanVienNghiViec.Rows[iNhanVienNghiViec]["TenNhanVien"].ToString();
                    this.DGVDanhSachNhanVien.Rows[addNhanVienNghiViec].Cells[3].Value = dtNhanVienNghiViec.Rows[iNhanVienNghiViec]["MaChamCong"].ToString();
                    this.DGVDanhSachNhanVien.Rows[addNhanVienNghiViec].Cells[4].Value = dtNhanVienNghiViec.Rows[iNhanVienNghiViec]["NgayVaoLamViec"].ToString();
                    DataGridViewCell item2 = this.DGVDanhSachNhanVien.Rows[addNhanVienNghiViec].Cells[5];
                    ConvertMoney convertMoney4 = this._convertMoney;
                    num = Convert.ToInt32(dtNhanVienNghiViec.Rows[iNhanVienNghiViec]["TienLuong"]);
                    item2.Value = convertMoney4.chendau(num.ToString());
                    this.DGVDanhSachNhanVien.Rows[addNhanVienNghiViec].Cells[6].Value = dtNhanVienNghiViec.Rows[iNhanVienNghiViec]["DangThamGiaBaoHiem"].ToString();
                    this.DGVDanhSachNhanVien.Rows[addNhanVienNghiViec].Cells[7].Value = dtNhanVienNghiViec.Rows[iNhanVienNghiViec]["MaPhongBan"].ToString();
                    DataGridViewCell dataGridViewCell2 = this.DGVDanhSachNhanVien.Rows[addNhanVienNghiViec].Cells[8];
                    ConvertMoney convertMoney5 = this._convertMoney;
                    num = Convert.ToInt32(dtNhanVienNghiViec.Rows[iNhanVienNghiViec]["LuongHopDong"]);
                    dataGridViewCell2.Value = convertMoney5.chendau(num.ToString());
                }
            }
        }


    }
}
